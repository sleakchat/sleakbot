window.wized_config = window.wized_config || [];
window.wized_config.push({
  createdTimestamp: 1704010273,
  type: 'development',
  id: 'AgHNimYmypMOzBRxta3T',
  projectId: 'Rf8yeUW1v69XTFsgppWM',
  showBranding: false,
  version: 2,
  publishedTimestamp: 1734614069,
  updatedTimestamp: 1734614069,
  cookies: [],
  folders: [
    { name: 'image upload', id: '0b4805ef-4501-41ec-85aa-8202e40e914a', type: 'requests' },
    { name: 'subscriptions', id: '194e3442-b0d9-4eec-a253-a63b41d014e6', type: 'requests' },
    { parent: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c', name: 'chatbot page', id: '1e11a85b-77a9-441a-a07e-79727b419fd9', type: 'events' },
    { parent: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c', name: 'chatbots dropdown', id: '206c14ea-c3ef-4b95-bdd4-2150463e4999', type: 'events' },
    { parent: '8339c00a-50de-4a25-99f6-68a9f4835506', name: 'chat list items', id: '25e9cc3d-2659-4485-9b30-26916278b400', type: 'events' },
    { parent: '8339c00a-50de-4a25-99f6-68a9f4835506', name: 'livechat', id: '25fe132c-9171-46e3-b363-84ff68552eeb', type: 'events' },
    { parent: '8339c00a-50de-4a25-99f6-68a9f4835506', name: 'inbox elements', id: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d', type: 'events' },
    { parent: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8', name: 'elements visibility', id: '282de06d-bce3-4d8b-b577-d9e0ec11a35d', type: 'events' },
    { name: 'chatbot kennis', id: '319c7ed9-3917-444b-91aa-11a3ed455fdb', type: 'events' },
    { parent: '55214649-2bac-4398-a861-03d94d2aad9d', name: 'knowledgebase topics', id: '35c9310c-a444-4ece-99e2-cb12a2ef992c', type: 'events' },
    { parent: '9bd4f98a-2919-4312-b5e7-d34099241fca', name: 'chatbot settings', id: '3ffad400-fc90-4dd0-bf87-f4e01bd8e9da', type: 'requests' },
    { parent: '8339c00a-50de-4a25-99f6-68a9f4835506', name: 'messages list items', id: '45787f48-6bd2-43a9-b98d-6fd20db89712', type: 'events' },
    { name: 'data sources', id: '55214649-2bac-4398-a861-03d94d2aad9d', type: 'events' },
    { name: 'subscriptions', id: '5779119e-f2d3-4a89-b784-ea7a58253f4a', type: 'events' },
    { parent: '9bd4f98a-2919-4312-b5e7-d34099241fca', name: 'chatbots', id: '579e40ce-81ee-4ae2-9f2e-6d1ff9e9e84f', type: 'requests' },
    { parent: '55214649-2bac-4398-a861-03d94d2aad9d', name: 'csv upload', id: '5d2e1b6e-42e5-4332-a023-7b90f25f3849', type: 'events' },
    { parent: '9bd4f98a-2919-4312-b5e7-d34099241fca', name: 'data sources forms', id: '64988cf5-3857-4f68-927b-a07d29e6d8ae', type: 'requests' },
    { parent: '9bd4f98a-2919-4312-b5e7-d34099241fca', name: 'integrations', id: '65f02e16-efcd-429d-973e-87423edb8916', type: 'requests' },
    { name: 'inbox', id: '8339c00a-50de-4a25-99f6-68a9f4835506', type: 'events' },
    { parent: '9bd4f98a-2919-4312-b5e7-d34099241fca', name: 'authentication', id: '879ed82b-481f-43dd-96c5-cd5646fb65ae', type: 'requests' },
    { parent: '8339c00a-50de-4a25-99f6-68a9f4835506', name: 'filters', id: '8b09a83c-4f71-4518-b39e-ee8e709e1b14', type: 'events' },
    { parent: 'b19e3643-8ab2-44df-b648-b38f323cc6e9', name: 'datasource sharing lists', id: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679', type: 'events' },
    { name: 'analytics', id: '8fda368d-3d91-4ddc-84e0-352930ddb0c4', type: 'events' },
    { parent: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8', name: 'organizations / users', id: '9604a1d7-0df8-496f-b4b4-8f0975084ef1', type: 'events' },
    { parent: '8339c00a-50de-4a25-99f6-68a9f4835506', name: 'inbox data', id: '99a16fdd-65fc-4ba5-9c99-4847a2473e67', type: 'events' },
    { name: 'supabase', id: '9bd4f98a-2919-4312-b5e7-d34099241fca', type: 'requests' },
    { parent: '55214649-2bac-4398-a861-03d94d2aad9d', name: 'api tool lists', id: '9e6f3363-0e9e-4dd2-8928-334d30e52b27', type: 'events' },
    { name: 'settings', id: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd', type: 'events' },
    { name: 'firecrawl / scraping', id: 'CqZ7ecJx8VbThbBpVrsG', type: 'requests' },
    { parent: 'gccMuQyf668xZ0Ngt6Cg', name: 'scrape - elements', id: 'PNvaP7BxV1nqggz2UG79', type: 'events' },
    { name: 'navigation / ux', id: 'a4ad4e2f-834f-4b84-bb43-5fc23d252a62', type: 'events' },
    { parent: '9bd4f98a-2919-4312-b5e7-d34099241fca', name: 'data sources', id: 'a6dae514-2ae2-434c-a7d3-0ac47c3ade46', type: 'requests' },
    { parent: '55214649-2bac-4398-a861-03d94d2aad9d', name: 'Data sources - form handling', id: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee', type: 'events' },
    { name: 'datasource sharing', id: 'b19e3643-8ab2-44df-b648-b38f323cc6e9', type: 'events' },
    { parent: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd', name: 'image upload', id: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0', type: 'events' },
    { parent: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd', name: 'navigatie', id: 'cc645055-40dd-4cef-8be2-ca815f73404b', type: 'events' },
    { parent: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c', name: 'chatbot list', id: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca', type: 'events' },
    { name: 'chatbot management', id: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c', type: 'events' },
    { parent: '9bd4f98a-2919-4312-b5e7-d34099241fca', name: 'analytics', id: 'dce9343b-4a31-4362-bbcf-8109144441a7', type: 'requests' },
    { parent: '9bd4f98a-2919-4312-b5e7-d34099241fca', name: 'messages / chats', id: 'e4636b01-7b40-4857-bb00-58134146644d', type: 'requests' },
    { name: 'authentication', id: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8', type: 'events' },
    { parent: '8339c00a-50de-4a25-99f6-68a9f4835506', name: 'agents', id: 'f2d1f791-109f-4ba0-8d6e-78a76539eb5e', type: 'events' },
    { parent: '55214649-2bac-4398-a861-03d94d2aad9d', name: 'Data sources - elements', id: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7', type: 'events' },
    { parent: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd', name: 'integraties', id: 'f8158d09-0ac8-4653-9ebe-dba0b72a2b38', type: 'events' },
    { name: 'aaa scrape tool', id: 'gccMuQyf668xZ0Ngt6Cg', type: 'events' },
    { parent: 'b19e3643-8ab2-44df-b648-b38f323cc6e9', name: 'datasource sharing navbar list', id: 'hiARdgSU6l4YoqRL86jN', type: 'events' },
    { id: 'nLn7Qh9PmZWTT77lvcQT', type: 'events', name: 'pdf2 upload', parent: '55214649-2bac-4398-a861-03d94d2aad9d' }
  ],
  parameters: [],
  variables: [
    {
      id: '048b86bc-635d-4a43-8a20-595553857001',
      name: 'filteredchats',
      initialValue:
        'const allChats = v.allchats;\n\nconst value = i["inbox-search-input"];\n\nif (value) {\n  \n  return allChats.filter(chat => \n    chat.messages.some(message => \n      message.body && message.body.includes(value)\n    )\n  );\n  \n} else {\n  return allChats;\n}',
      computed: true
    },
    { name: 'apiPropertiesArray', id: '072a8e74-b82d-493e-9951-71f147fe9b10', initialValue: 'return []' },
    { name: 'active_datasource', storage: 'local', id: '07918847-6922-492a-a629-8a362a8bfbd3' },
    { name: 'codemirrorInitialized', id: '10eaaf64-7eac-4b25-9fe0-d6da5fab0673', initialValue: 'return false' },
    { id: '160mIi3SDpBM6gPze32g', name: 'chatbotCustomFields', initialValue: 'return []' },
    {
      computed: true,
      name: 'filteredKbList',
      id: '1a7a99e7-7f97-4509-8248-aa195e93bd17',
      initialValue:
        'const entries = r.get_datasources.data.find(item => item.id === v.active_datasource).kb_topics;\n\nconst searchQuery = i["kennisbank-search-input"];\n\nif (searchQuery) {\n  const lowerCaseQuery = searchQuery.toLowerCase();\n  return entries.filter(entry => \n    entry.content.toLowerCase().includes(lowerCaseQuery) || entry.name.toLowerCase().includes(lowerCaseQuery)\n  );\n} else {\n  return entries;\n}\n'
    },
    { name: 'active_chat_index', id: '1ca79852-585f-4803-9ab5-1a561b5e88ad', initialValue: 'return 0' },
    { name: 'livechatstatus', id: '2122c660-915c-49cc-ba24-23222f9ac9f5' },
    { name: 'weightTotal', id: '2ed1b7e6-ceb0-4f63-808d-69b88d6e0bf5' },
    {
      computed: true,
      name: 'chats',
      id: '2f334105-03bd-477e-8aed-a937f28769bb',
      initialValue:
        'const allchats = v.filteredchats;\n\n// Filter chats that have at least two messages\nconst filteredChats = allchats.filter(chat => chat.messages && chat.messages.length >= 2);\n\nconst sortedChats = filteredChats.sort((a, b) => {\n  // Sort based on the updated_at property of the chat\n  return new Date(b.updated_at) - new Date(a.updated_at);\n});\n\nvar chatItems = document.querySelectorAll(".chat-list-item");\n\nreturn sortedChats;\n'
    },
    {
      computed: true,
      name: 'scrapetool_urls_list_listener',
      id: '2zaQ6849rh0h7fL0oT72',
      initialValue: 'const filteredList = v.scrapetool_urls_list_filtered;\n\nwindow.updateCheckboxVisibilityAndCounts();\n'
    },
    { name: 'usedFilters', id: '3168988b-8f67-40cb-889b-18722b034a02', initialValue: 'return false' },
    { name: 'csvContent', id: '3306be9d-6803-4a62-aba4-2e426847af50' },
    {
      computed: true,
      name: 'datasourceSharingChatbotsDropdown',
      id: '364ff220-f36c-4484-be8d-2f14da1592b1',
      initialValue:
        'var activeDatasource = r.get_datasources.data.find(item => item.id === v.active_datasource);\n\nvar chatbots = r.get_chatbots.data;\nvar createdByChatbot = activeDatasource.chatbot_id;\n\nvar chatbotsWithAccess = r.get_chatbots_datasources_joins.data.map(chatbot => chatbot.chatbot_id);\n\nvar filteredChatbots = chatbots.filter(chatbot => chatbot.id !== activeDatasource.chatbot_id && !chatbotsWithAccess.includes(chatbot.id));\n\nreturn filteredChatbots;\n'
    },
    { name: 'dataSourceUpdatedStatus', id: '3fff4fea-597d-4ec1-a4fd-22e7a73a4ade', initialValue: 'return null' },
    { id: '3li0aOUcq7MjccK3Vc8O', name: 'chatbotTags', initialValue: 'return []' },
    { name: 'apiPropertiesArrayII', id: '4295b325-1596-4217-ac05-0b71f6d209b4', initialValue: '[]' },
    { name: 'active_integrations_tab', id: '4c2e4d3a-3e0d-4155-97d0-b6e6aadf2826', initialValue: 'return "installatie"' },
    { name: 'inboxFilterLabel', id: '4e30c6ed-bfb0-4a39-846a-8c1c574200ea', initialValue: "return 'open'" },
    { computed: true, name: 'toast_requests', id: '50b02507-0bc3-4908-8f63-8bc118d00b98' },
    { name: 'randomVariable', id: '52893450-6c51-4203-a331-7cc94fc86016' },
    { name: 'active_kb_topic', id: '5518bc86-f4ee-4f67-b50c-eff342ecf02c' },
    {
      computed: true,
      name: 'trialExpiry',
      id: '60f0e23b-3885-46a1-b8e8-7eb719e2873d',
      initialValue:
        'const paths = [\n  "/login",\n  "/signup",\n  "/resetpassword",\n  "/password-update",\n  "payment-success",\n  "redirect",\n];\n\nif (!paths.includes(n.path)) {\n  // console.log("trialExpiry comp var");\n\n  const organization = r.get_user_data.data[0].organizations[0];\n  // console.log("organization: ", organization);\n\n  const trialExpiryModal = document.querySelector(\'[w-el="trial-expiry-modal"]\');\n  function unsetExpiry() {\n    localStorage.removeItem("sleakTrialExpired");\n    trialExpiryModal.style.display = "none";\n    // console.log("is not expired");\n    return true;\n  }\n\n  if (organization.subscription_status !== "active" || organization.subscription_status == null) {\n    // console.log("subscription is not active");\n\n    function setExpiry() {\n      localStorage.setItem("sleakTrialExpired", true);\n      trialExpiryModal.style.display = "flex";\n      // console.log("is expired");\n      return false;\n    }\n\n    const currentDate = new Date();\n    const createdAt = new Date(organization.created_at);\n    const fourteenDaysAgo = new Date();\n    fourteenDaysAgo.setDate(currentDate.getDate() - 14);\n\n    if (fourteenDaysAgo > createdAt) {\n      // console.log("+14 days ago");\n\n      if (organization.trial_extended) {\n        // console.log("trial is extended");\n        const extendedDate = new Date(organization.trial_extended);\n        if (extendedDate < currentDate) {\n          // console.log("extended date is earlier than current date");\n          return setExpiry();\n        } else {\n          // console.log("extended date is later than current date");\n          return unsetExpiry();\n        }\n      } else {\n        // console.log("no extended date");\n        return setExpiry();\n      }\n    } else {\n      // console.log("not +14 days ago");\n      return unsetExpiry();\n    }\n  } else if (localStorage.getItem("sleakTrialExpired")) {\n    // console.log("subscription is active");\n    unsetExpiry();\n    location.reload();\n    return true;\n  }\n}\n'
    },
    { computed: true, name: 'numbers', id: '6e612018-f833-449b-b7be-c8e1ffb05c80' },
    { name: 'active_chatbot_index', id: '7057b288-ce3f-4610-ad36-1b495a34b3c1', storage: 'local', initialValue: 'return 0' },
    { name: 'i', id: '73e1527e-2e47-4aea-b609-6d5c4d232c72', initialValue: 'return 0' },
    {
      id: '77ooo7PdGtGckTXLtQXu',
      name: 'filteredTags',
      initialValue:
        'if (n.path.includes(\'/chat-inbox\')) {\n  const chatChatbot = v.chats.find((item) => item.id == v.active_chat).chatbot_id;\n  const chatChatbotTags = r.get_chatbots.data.find((item) => item.id == chatChatbot).tags;\n  if (chatChatbotTags) {\n    if (i["manualtags-input"] !== "") {\n      return chatChatbotTags.filter(item => \n        item.tag.toLowerCase().includes(i["manualtags-input"].toLowerCase())\n      );\n    } else {\n      return chatChatbotTags\n    }\n  } else {\n    return []\n  }\n}',
      computed: true
    },
    { computed: true, name: 'labels', id: '7b64050a-1d38-4493-af8f-0d6cc9c3a597' },
    { computed: true, name: 'toast_log', id: '7bd8c703-969d-45a9-ac83-8fca87e6af08', initialValue: 'return []' },
    { name: 'datasource_sharing_selected', id: '8243bbec-7bec-4de2-86e0-f1211ba5da8a', initialValue: 'return null' },
    { name: 'delete_chatbots_datasources_join', id: '828f6228-548b-4508-9410-7d0e56d5cf70' },
    {
      id: '837133b8-cac1-44a8-8f23-8002bffa154c',
      name: 'messages',
      initialValue:
        "const activeChatId = v.active_chat;\nconst allChats = v.chats;\nconst activeChat = allChats.find(chat => chat.id === activeChatId);\n\nif (allChats.length > 0 && activeChat) {\n  const messages = activeChat.messages;\n  const hasFileOrImage = messages.some(message => message.message_type === 'image');\n\n  let lightboxElements;\n\n  if (hasFileOrImage) {\n    lightboxElements = { items: [], group: 'inbox_images' };\n\n    messages.forEach((message) => {\n      if (message.message_type === 'image') {\n        const newImageProps = {\n          _id: message.id,\n          origFileName: message.message_type_data?.file_name || '',\n          fileName: message.message_type_data?.file_name || '',\n          fileSize: message.message_type_data?.file_size || '',\n          height: 'auto',\n          width: 'auto',\n          url: message.file_path ? message.file_path.replace(/(\\.[^.]+)$/, '-preview$1') : '',\n          type: 'image'\n        };\n\n        // console.log('ðŸžï¸ Message:', newImageProps.url);\n\n        lightboxElements.items.push(newImageProps);\n        // console.log('ðŸžï¸ Lightbox Element:', newImageProps);\n      }\n    });\n\n    document.querySelector('.w-json').textContent = JSON.stringify(lightboxElements);\n    setTimeout(() => {\n      // console.log('Re-initializing Webflow');\n      Webflow.destroy();\n      Webflow.ready();\n    }, 10);\n  }\n}\n",
      computed: true
    },
    { computed: true, name: 'rawchats', id: '8a8fc077-57b5-42e2-b28b-e84be6d80d1a', initialValue: 'return r.get_chats.data' },
    { name: 'active_chatbot', storage: 'local', id: '8ad2d1ef-f178-4ad8-a489-eb0bbfb17ba3' },
    { name: 'active_datasource_type', id: '8b7a453a-ae62-4d54-b8b7-dbc496fdd2fa', storage: 'local' },
    { id: '96Kx2EwRvqDcvGvCdkuz', name: 'selectedMessageId', initialValue: 'return null' },
    { name: 'subscriptionPriceId', id: '98b73f10-47f5-4d7e-b196-127dccb6247c' },
    { name: 'active_chat', id: '98e4400c-0ada-4542-b752-32c895f0d6f1' },
    { computed: true, name: 'newchats', id: '9a9021fe-5a8c-45d7-ada8-0b81e244ca28', initialValue: 'return []' },
    { name: 'scrapetool_urls_list_deleted', id: 'EpBcAWv5nBvvaRFjWRps', initialValue: 'return []' },
    { id: 'F5mFcJ2x4f0zPYyVZFeR', name: 'compressedImageInbox', initialValue: 'return null' },
    {
      computed: true,
      name: 'scrapetool_urls_list_filtered',
      id: 'Ic508Qp1dFC09pK8sxpV',
      initialValue:
        "const activeEntries = v.scrapetool_urls_list;\nlet filteredEntries;\nlet searchResults;\n\nconst searchQuery = i[\"scrape-search-input\"];\nconst filterCompleted = i[\"scrape-filter-completed\"]\nconst filterQueue = i[\"scrape-filter-queue\"]\nconst filterFailed = i[\"scrape-filter-failed\"]\nconst filterNotFound = i[\"scrape-filter-notfound\"]\n\nif (searchQuery) {\n  const lowerCaseQuery = searchQuery.trim().toLowerCase();\n  console.log('Search Query:', lowerCaseQuery);  // Log the query\n\n  searchResults = activeEntries.filter(entry => {\n    const urlToCheck = entry.url.trim().toLowerCase();\n    console.log('Checking URL:', urlToCheck);  // Log the URL being checked\n    \n    const urlMatch = urlToCheck.includes(lowerCaseQuery);\n    const nameMatch = entry.name && entry.name.trim().toLowerCase().includes(lowerCaseQuery);\n\n    return urlMatch || nameMatch;\n  });\n} else {\n  searchResults = activeEntries;  // No search query, show all entries\n}\n\n\n\n// Apply checkbox filters if any of the checkboxes are checked\nfilteredEntries = searchResults.filter(entry => {\n  if (filterCompleted && entry.status === 'completed') return true;\n  if (filterQueue && entry.status === 'queued') return true;\n  if (filterFailed && entry.status === 'failed') return true;\n  if (filterNotFound && entry.status === 'not_found') return true;\n  \n  // If no checkboxes are checked, show all\n  return (!filterCompleted && !filterQueue && !filterFailed && !filterNotFound);\n});\n\nreturn filteredEntries.sort((a, b) => new Date(a.created_at) - new Date(b.created_at));\n"
    },
    { name: 'lastScrapeBatchUrls', id: 'Lxi8YTrhBV69v7HriJP0', storage: 'local', initialValue: 'return null' },
    {
      id: 'Nl5VP0Wq9s83kgOYfgYr',
      name: 'mergedEvents',
      initialValue:
        "if (n.path.includes('/chat-inbox')) {\n  const events = r.get_chatevents.data;\n\n  const messages = v.chats\n    .find(chat => chat.id === v.active_chat)\n    .messages.filter(message => (message.message_type === 'default_user' || message.message_type === 'success_message' || message.message_type === 'operator_changed') && message.visitor_id === v.active_chat);\n\n  let remappedMessages = [];\n\n  messages.forEach(rawMessage => {\n    let group;\n    if (rawMessage.message_type == 'operator_changed') {\n      group = 'operator_changed';\n    } else if (rawMessage.message_type == 'default_user') {\n      group = 'message_user';\n    } else if (rawMessage.message_type == 'success_message') {\n      group = 'handoff_requested'\n    }\n    const message = {\n      event: 'message',\n      type: 'sleak_event',\n      event_group: group,\n      content: rawMessage.body,\n      chat_id: rawMessage.visitor_id,\n      organization_id: rawMessage.organization_id,\n      chatbot_id: rawMessage.chatbot_id,\n      created_at: rawMessage.created_at,\n      message_type_data: rawMessage.message_type_data\n    };\n    remappedMessages.push(message);\n  });\n\n  const mergedEvents = [...remappedMessages, ...events];\n\n  mergedEvents.sort((a, b) => {\n    const dateA = new Date(a.created_at);\n    const dateB = new Date(b.created_at);\n    return dateB - dateA;\n  });\n  return mergedEvents;\n}",
      computed: true
    },
    {
      computed: true,
      name: 'scrapelist_checkboxhandling',
      id: 'SbbanRBGNWvxug8dejsM',
      initialValue:
        "function updateDisplayBasedOnCheckboxes() {\n  const controlElement = document.querySelector('[w-el=\"scrape-addurl-controls\"]');\n  const checkboxes = document.querySelectorAll('input[w-el=\"scrape-list-checkbox\"]');\n  const selectedControlElement = document.querySelector('[w-el=\"scrape-selected-controls\"]');\n  const selectedCountElement = document.querySelector('[w-el=\"scrape-urls-selected\"]');\n\n  const anyChecked = Array.from(checkboxes).some(checkbox => checkbox.checked);\n  const selectedCount = Array.from(checkboxes).filter(checkbox => checkbox.checked).length;\n\n  controlElement.style.display = anyChecked ? 'none' : 'flex';\n  selectedControlElement.style.display = anyChecked ? 'flex' : 'none';\n\n  // Update the count of selected URLs\n  if (selectedCountElement) {\n    selectedCountElement.textContent = selectedCount;\n  }\n}\n\nlet lastChecked = null;\n\n// Function to handle shift + click selection\nfunction handleCheck(thisElement, e, currentCheckbox) {\n  const labels = document.querySelectorAll('[w-el=\"scrape-list-checkbox-label\"]');\n  const labelsArray = Array.from(labels);\n\n  const currentLabelIndex = labelsArray.indexOf(thisElement);\n  const lastCheckedIndex = labelsArray.indexOf(lastChecked);\n\n  // Check for invalid indices\n  if (currentLabelIndex === -1 || lastCheckedIndex === -1) {\n    console.error('Invalid indices:', { currentLabelIndex, lastCheckedIndex });\n    return; // Cannot proceed without valid indices\n  }\n\n  // Determine the range to select\n  const [startIndex, endIndex] = [lastCheckedIndex, currentLabelIndex].sort((a, b) => a - b);\n\n  // Validate indices before looping\n  if (startIndex < 0 || endIndex >= labels.length) {\n    console.error('Index out of bounds:', { startIndex, endIndex, labelsLength: labels.length });\n    return;\n  }\n\n  // Select all checkboxes in the range\n  for (let i = startIndex; i <= endIndex; i++) {\n    const checkId = labels[i].getAttribute('for');\n    const checkbox = document.getElementById(checkId);\n    if (checkbox) {\n      checkbox.checked = true;\n    }\n  }\n}\n\nwindow.checkboxLabelClick = function (thisElement, e) {\n  const checkboxId = thisElement.getAttribute('for');\n  const associatedCheckbox = document.getElementById(checkboxId);\n\n  if (!associatedCheckbox) return;\n\n  // Toggle the checkbox state (allow checking and unchecking)\n  associatedCheckbox.checked = !associatedCheckbox.checked;\n\n  // Handle the shift-click logic (only if the checkbox is being checked)\n  if (e.shiftKey && associatedCheckbox.checked) {\n    handleCheck(thisElement, e, associatedCheckbox);\n  }\n\n  updateDisplayBasedOnCheckboxes();\n  lastChecked = thisElement; // Update the last checked label\n};\n\nconst wildcardCheckbox = document.getElementById('toggle_crawl_checkall'); // Reference the wildcard checkbox\n\n// Add event listener to the wildcard checkbox (use 'change' event)\nwildcardCheckbox.addEventListener('change', function (e) {\n  const allChecked = wildcardCheckbox.checked;\n  const labels = document.querySelectorAll('[w-el=\"scrape-list-checkbox-label\"]');\n\n  labels.forEach(label => {\n    const checkboxId = label.getAttribute('for');\n    const associatedCheckbox = document.getElementById(checkboxId);\n\n    // Check or uncheck all checkboxes based on wildcard's state\n    associatedCheckbox.checked = allChecked;\n  });\n\n  updateDisplayBasedOnCheckboxes();\n});\n\n// Add logic for the reset button\nconst resetBtn = document.querySelector('[w-el=\"scrape-selected-reset-btn\"]');\n\nresetBtn.addEventListener('click', function () {\n  const checkboxes = document.querySelectorAll('input[w-el=\"scrape-list-checkbox\"]');\n  checkboxes.forEach(checkbox => {\n    checkbox.checked = false;\n  });\n  wildcardCheckbox.checked = false;\n  updateDisplayBasedOnCheckboxes();\n});"
    },
    {
      name: 'scrapetool_progress_logic',
      id: 'Y7Dr0Gb9o0eFO4PWvDEI',
      initialValue:
        "// elements visibility\nwindow.showProgressBarAndHideControls = function () {\n  $('[w-el=\"scrape-progress-container\"]').css('display', 'flex');\n  $('[w-el=\"controls-container\"]').css('display', 'none');\n  $('[w-el=\"scrape-addurl-controls\"]').css('visibility', 'hidden');\n};\n\nwindow.hideProgressBarAndShowControls = function () {\n  $('[w-el=\"scrape-progress-container\"]').css('display', 'none');\n  $('[w-el=\"controls-container\"]').css('display', 'flex');\n  $('[w-el=\"scrape-addurl-controls\"]').css('visibility', 'visible');\n};\n\nwindow.resetProgressBar = function () {\n  // reset progress bar\n  $('[w-el=\"scrape-progressbar-bar\"]').css('width', '0%');\n  $('[w-el=\"scrape-progressbar-percentage\"]').text('0%');\n};\n\n// update display and counts\nwindow.updateStatusCountsDisplay = function (statusCounts) {\n\n  const completedCheckbox = $('[w-el=\"scrape-filter-completed\"]');\n  completedCheckbox.closest('.label-container').css('display', statusCounts.completed > 0 ? 'block' : 'none');\n  completedCheckbox.closest('.label-container').find('.count').text(statusCounts.completed);\n  if (statusCounts.completed === 0) {\n    console.log('Setting completed checkbox to false');\n    completedCheckbox.checked = false;\n    i[\"scrape-filter-completed\"] = false;\n  }\n\n  const queuedCheckbox = $('[w-el=\"scrape-filter-queue\"]');\n  queuedCheckbox.closest('.label-container').css('display', statusCounts.queued > 0 ? 'block' : 'none');\n  queuedCheckbox.closest('.label-container').find('.count').text(statusCounts.queued);\n  if (statusCounts.queued === 0) {\n    console.log('Setting queued checkbox to false');\n    queuedCheckbox.checked = false;\n    i[\"scrape-filter-queue\"] = false;\n  }\n\n  const failedCheckbox = $('[w-el=\"scrape-filter-failed\"]');\n  failedCheckbox.closest('.label-container').css('display', statusCounts.failed > 0 ? 'block' : 'none');\n  failedCheckbox.closest('.label-container').find('.count').text(statusCounts.failed);\n  if (statusCounts.failed === 0) {\n    console.log('Setting failed checkbox to false');\n    failedCheckbox.checked = false;\n    i[\"scrape-filter-failed\"] = false;\n  }\n\n  const notFoundCheckbox = $('[w-el=\"scrape-filter-notfound\"]');\n  notFoundCheckbox.closest('.label-container').css('display', statusCounts.notFound > 0 ? 'block' : 'none');\n  notFoundCheckbox.closest('.label-container').find('.count').text(statusCounts.notFound);\n  if (statusCounts.notFound === 0) {\n    console.log('Setting not-found checkbox to false');\n    notFoundCheckbox.checked = false;\n    i[\"scrape-filter-notfound\"] = false;\n  }\n\n  // Total count\n  const totalCount = v.scrapetool_urls_list.length;\n  $('[w-el=\"scrape-urls-total\"]').text(totalCount);\n};\n\n\n// main logic\nwindow.updateCheckboxVisibilityAndCounts = function () {\n  const activeEntries = v.scrapetool_urls_list;\n\n  const statusCounts = {\n    completed: 0,\n    queued: 0,\n    failed: 0,\n    notFound: 0\n  };\n\n  // Count entries for each status\n  activeEntries.forEach(entry => {\n    if (entry.status === 'completed') statusCounts.completed++;\n    else if (entry.status === 'queued') statusCounts.queued++;\n    else if (entry.status === 'failed') statusCounts.failed++;\n    else if (entry.status === 'not-found') statusCounts.notFound++;\n  });\n\n  console.log('execute updateCheckboxVisibilityAndCounts');\n  console.log('Status Counts:', statusCounts);\n  console.log('v.isScrapeJobInitiated:', v.isScrapeJobInitiated);\n  console.log('v.lastScrapeBatchUrls:', v.lastScrapeBatchUrls);\n\n  // Update display and counts\n  window.updateStatusCountsDisplay(statusCounts);\n\n  // Adjusted logic starts here\n  if (v.isScrapeJobInitiated) {\n    console.log('Scrape job is initiated');\n\n    // Show progress bar\n    window.showProgressBarAndHideControls();\n\n    if (activeEntries.length === 0) {\n      console.log('Entries array is empty, showing progress bar at 0%');\n      // Set progress bar to 0%\n      $('[w-el=\"scrape-progressbar-percentage\"]').text(`0%`);\n      $('[w-el=\"scrape-progressbar-bar\"]').css({\n        width: `0%`,\n        transition: 'width 0.5s ease'\n      });\n      // Do not proceed further\n      return;\n    }\n\n    // Proceed with progress bar logic\n    if (v.lastScrapeBatchUrls && v.lastScrapeBatchUrls.length > 0) {\n      console.log('v.lastScrapeBatchUrls:', v.lastScrapeBatchUrls);\n      console.log('activeEntries:', activeEntries);\n\n      // Filter active entries that are part of the last scrape batch\n      const lastBatchEntries = activeEntries.filter(entry => v.lastScrapeBatchUrls.includes(entry.url));\n      console.log('lastBatchEntries:', lastBatchEntries);\n\n      // Count of non-queued entries in the last scrape batch\n      const completedBatchCount = lastBatchEntries.filter(entry => entry.status !== 'queued').length;\n      console.log('completedBatchCount:', completedBatchCount);\n\n      // Calculate completed percentage\n      const totalBatchCount = v.lastScrapeBatchUrls.length;\n      const completedPercentage = (completedBatchCount / totalBatchCount) * 100;\n      console.log('completedPercentage:', completedPercentage);\n\n      // Update progress percentage\n      $('[w-el=\"scrape-progressbar-percentage\"]').text(`${Math.round(completedPercentage)}%`);\n      $('[w-el=\"scrape-progressbar-bar\"]').css({\n        width: `${completedPercentage}%`,\n        transition: 'width 0.5s ease'\n      });\n\n      // Hide progress bar and show control elements when complete after a delay\n      if (completedPercentage >= 100) {\n        if (!window.progressBarHideTimeout) {\n          console.log('Completed percentage is 100%, initiating timeout to reset progress bar');\n\n          // uncheck all filter checkboxes\n          const checkboxes = document.querySelectorAll('[w-el=\"scrape-filter-queue\"]');\n          console.log('checkboxes:', checkboxes);\n          checkboxes.forEach(checkbox => {\n            checkbox.checked = false;\n            console.log('checkbox checked:', checkbox.checked);\n          });\n          i['scrape-filter-queue'] = false;\n\n          window.progressBarHideTimeout = setTimeout(() => {\n            window.hideProgressBarAndShowControls();\n            window.resetProgressBar();\n            v.lastScrapeBatchUrls = [];\n            v.isScrapeJobInitiated = false;\n            window.progressBarHideTimeout = null;\n\n            window.showToastNotification('Scraping voltooid', 'success');\n          }, 3000);\n        }\n      } else {\n        // Clear any existing timer if progress drops below 100%\n        if (window.progressBarHideTimeout) {\n          console.log('Completed percentage dropped below 100%, clearing timeout');\n          clearTimeout(window.progressBarHideTimeout);\n          window.progressBarHideTimeout = null;\n        }\n      }\n    } else {\n      console.log('v.lastScrapeBatchUrls is empty or undefined');\n    }\n  } else {\n    console.log('Scrape job is not initiated');\n\n    // Only hide the progress bar if it's currently visible\n    if ($('[w-el=\"scrape-progress-container\"]').is(':visible')) {\n      window.hideProgressBarAndShowControls();\n      window.resetProgressBar();\n    }\n    // Do not set v.isScrapeJobInitiated = false here\n  }\n};\n"
    },
    { name: 'crawledpages', id: 'YxvNCmVyyPHps5GeSY7H', initialValue: 'return []' },
    { id: 'ZCYM6dkxsngAwyOJB5rc', name: 'chatTags', initialValue: 'return v.chats.find(chat => chat.id === v.active_chat).tags', computed: true },
    { computed: true, name: 'labels_30', id: 'a2425a3f-ba94-4782-ae77-903023852e14' },
    { name: 'chatbots', id: 'a41cb465-a44d-4dd1-bde3-b55a884813eb', storage: 'local' },
    { name: 'apiHeadersArray', id: 'ae7acfda-48ea-4755-8fae-917e00d63841', initialValue: 'return []' },
    { computed: true, name: 'numbers_30', id: 'aeaad10a-60b3-4d19-851d-9d2f4db5d79d' },
    { computed: true, name: 'loadmorechats', id: 'af93ce0c-ab16-4975-812f-4f3b73b86d4c', initialValue: 'return []' },
    { name: 'iII', id: 'b754b06d-70b9-42de-81b3-0484243d1c91' },
    {
      computed: true,
      name: 'datasourceSharingNavbarList',
      id: 'bUoa4c8ermieb8bT0S1q',
      initialValue:
        'const activeChatbot = v.active_chatbot\n\nconst filteredDataSources = r.get_chatbots.data.find((item) => item.id === v.active_chatbot).data_sources.filter(\n  dataSource => dataSource.chatbot_id !== activeChatbot\n);\n\nreturn filteredDataSources;\n'
    },
    { name: 'outputSchemaObjectIsValid', id: 'c3cb61a8-d70d-484d-b8eb-04c22422f202' },
    { name: 'pagination', id: 'c5ecd119-6515-4035-b36d-ca0914930ff5', initialValue: 'return "0-2"' },
    { name: 'weightTotal_30', id: 'ceabff0f-cf80-4414-bbe1-0affe187109a' },
    { name: 'active_settings_tab', id: 'd25db782-6a67-4c1f-930a-b6899f5dfc24', initialValue: "return 'algemeen'" },
    { name: 'inboxFilterStatus', id: 'd3ed20e3-4b50-4898-98ca-e98dbab31ad5', initialValue: "return 'all'" },
    {
      computed: true,
      name: 'allchats',
      id: 'd958a5cb-d662-4852-b25e-d9077595a6eb',
      initialValue: 'const rawchats = v.rawchats;\nconst newchats = v.newchats;\nconst morechats = v.loadmorechats;\n\nallchats = [...rawchats, ...newchats, ...morechats];\n\nreturn allchats '
    },
    { name: 'filter_toast_log', id: 'df9c05ee-22e0-4d03-b157-9de5f2b6fce5' },
    { computed: true, name: 'inboxFilterChatbots', id: 'e7bc7d40-341e-485d-82a9-819b17c42f7c', initialValue: '[]' },
    {
      computed: true,
      name: 'loadmoreScrollbox',
      id: 'f2143830-d96a-4133-be32-9615974808a2',
      initialValue:
        'const scrollBox = document.querySelector(\'[w-el="chats-list-container"]\');\nconst isAtBottom = scrollBox.scrollHeight - scrollBox.scrollTop === scrollBox.clientHeight;\nreturn (isAtBottom)'
    },
    {
      computed: true,
      name: 'datasourceSharingChatbotsActiveList',
      id: 'f792a4da-a42c-495e-bad8-094406fdf71d',
      initialValue:
        'var activeDatasource = r.get_datasources.data.find(item => item.id === v.active_datasource);\n\nvar chatbots = r.get_chatbots_datasources_joins.data;\nvar createdByChatbot = activeDatasource.chatbot_id\n\nvar filteredChatbots = chatbots.filter(chatbot => chatbot.chatbot_id !== createdByChatbot);\n\nreturn filteredChatbots\n'
    },
    { name: 'csv_rows', id: 'f87058eb-ac8f-48da-97d4-6f5ea1f3fe66', initialValue: 'return []' },
    { name: 'active_agent', id: 'faa4803e-078a-4557-8606-acbb662dd519' },
    { name: 'isScrapeJobInitiated', id: 'fnaySemcBdMSB1GPH2UE', storage: 'local', initialValue: 'return false' },
    { id: 'rhV9TxayXDea3UaUXSPM', name: 'index', initialValue: 'return []' },
    {
      computed: true,
      name: 'scrapetool_urls_list',
      id: 'sCkqWb3qoXnToAkqPYJv',
      initialValue:
        "let entries;\n\n// Get the initial data from the response\nentries = r.get_scrape_pages.data;\n\n// Filter out deleted entries by ID using v.scrapetool_urls_list_deleted\nlet activeEntries = entries.filter(entry => \n  !(v.scrapetool_urls_list_deleted || []).includes(entry.id)  // Ensure we are checking against the 'id' field\n);\n\nreturn activeEntries.sort((a, b) => new Date(a.created_at) - new Date(b.created_at));\n"
    },
    { name: 'crawledpages_datasource', id: 'v0mdRnrn9VqhfeXV6oYV', initialValue: 'return []' },
    { id: 'ynoGfTjQA8SYE4B6m8d5', name: 'chatbotConversationStarters', initialValue: 'return []' }
  ],
  apps: [
    {
      id: '45d758d8-1856-489b-9512-2c39b200a1b9',
      name: 'n8n',
      type: 'rest',
      baseUrl: 'const pageUrl = window.location.href;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  return "https://api.sleak.chat"\n} else {\n  return "https://api.dev.sleak.chat"\n}'
    },
    {
      baseUrl:
        'const pageUrl = window.location.href;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  return "https://sygpwnluwwetrkmwilea.supabase.co/rest/v1";\n} else {\n  return "https://xvqjuiyrmzkhsfosfozs.supabase.co/rest/v1";\n}',
      name: 'supabase rest',
      id: '49ab8303-bcff-4e34-a9f1-97bda48106fe',
      type: 'rest'
    },
    { baseUrl: "return 'http://161.35.83.249:3000/api/v1'", name: 'flowise', id: '7305c401-dca7-4a7c-806a-a96785fe8cc2', type: 'rest' },
    {
      id: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'supabase',
      type: 'supabase',
      apiUrl: 'https://xvqjuiyrmzkhsfosfozs.supabase.co',
      apiKey:
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2cWp1aXlybXpraHNmb3Nmb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTkzMDgyNDQsImV4cCI6MjAzNDg4NDI0NH0.l4EDmKGcSXAolPPAfjL4X1X9T6cxIO0bg9s6oAbu_3E'
    },
    { id: 'HyRqqrnG2idR6xMaSsLE', name: 'gcp', type: 'rest', baseUrl: 'return "https://embedding-pdf-849186242728.europe-west4.run.app"' },
    { name: 'any', id: 'ZiNO0Y4x8QncHJmi9Unh', type: 'rest' },
    { baseUrl: 'return "https://api.firecrawl.dev/v1"', name: 'Firecrawl v1', id: 'pxgD9BuECTQMg1mdbHak', type: 'rest' }
  ],
  actions: [
    {
      name: 'Create data source form - PDF (now kb)',
      attributes: [{ name: 'form-create-datasource-pdf' }],
      id: '00093c98-1ef4-4acc-b8f2-2898396dfe5f',
      type: 'element',
      actions: [
        {
          condition: "return (n.path.includes ('/kennis/databronnen'))",
          function:
            'Wized.requests.execute("create_pdf");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\ndataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\nwindow.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  // Deprecaten - .find() method gebruiken\n  Wized.data.v.active_datasource_type = "pdf";\n\n  // Element visibility\n  const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n  const editForm = document.querySelector("[w-el=\'form-container-edit-pdf\']");\n  editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n  await Wized.requests.waitFor(\'create_pdf\');\n\n  Wized.requests.execute("get_datasources");\n  Wized.data.v.active_datasource = r.create_pdf.data.id;\n\n  await Wized.requests.waitFor("get_datasources");\n  // update container visibility\n  editForm.style.display = "flex";\n\n\n  // reset create forms - al gedaan bovenin?\n  // const allForms = document.querySelectorAll(".datasources-formblock");\n  // const formWrapperInitial = document.getElementById("create-datasource-form");\n  // allForms.style.display = "none";\n  // formWrapperInitial.style.display = "flex";\n});',
          action: 'run-function',
          resetForm: true,
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        },
        {
          condition: "return (n.path.includes ('/kennis/prompt'))",
          function: "Wized.requests.execute(\"create_pdf\");\nawait Wized.requests.waitFor('create_pdf');\n\nv.active_datasource = r.create_pdf.data.id;\n\nn.path = '/kennis/databronnen?tn=cd'",
          action: 'run-function',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee'
    },
    {
      name: 'api - headers visibility',
      attributes: [{ name: 'api-headers-visibility' }],
      id: '0120cfe0-ab30-4c1b-af07-235abeefeed5',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i["input-headers_enabled"] == false) {\n  return "none"\n} else {\n  return "flex"\n}', setting: 'style' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'set data_source content area csv preview - date',
      attributes: [{ name: 'datasource-csv-preview-timestamp-date' }],
      id: '01666906-5a4c-4724-a39d-7ec5ca356c82',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.date;', setting: 'text' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'Set active chatbot created at',
      attributes: [{ name: 'active-chatbot-createdat' }],
      id: '0201ff78-4063-40a1-87de-80cfdda04666',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            "const isoDateString = r.get_chatbots.data.find((item) => item.id === v.active_chatbot).created_at;\n\nconst date = new Date(isoDateString);\n\n// Get today's date\nconst today = new Date();\n\n// Calculate the difference in days\nconst differenceInDays = (today - date) / (1000 * 3600 * 24);\n\n// Define the date format options\nconst dateFormatOptions = {\n    month: 'long', // \"april\"\n    day: 'numeric' // \"29\"\n};\n\n// Include the year if the difference is 365 days or more\nif (differenceInDays <= -365) {\n    dateFormatOptions.year = 'numeric'; // \"2024\"\n}\n\n// Convert to a more readable format in Dutch\nconst readableDate = date.toLocaleDateString('nl-NL', dateFormatOptions);\n\nreturn readableDate;",
          setting: 'text'
        }
      ],
      folderId: '1e11a85b-77a9-441a-a07e-79727b419fd9'
    },
    {
      name: 'prompt form handling',
      attributes: [{ name: 'fom-basis-prompt' }],
      id: '02b4b4b2-c493-4c5d-b297-9f4896023737',
      type: 'element',
      actions: [
        { request: '2341ce1b-64f5-4ded-9952-3487bca24247', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' },
        { value: 'return {\n  basis_prompt: r.get_chatbot.data.system_message,\n  identiteit_prompt: r.get_chatbot.data.system_message_identity\n}', setting: 'form' }
      ],
      folderId: '319c7ed9-3917-444b-91aa-11a3ed455fdb'
    },
    {
      name: 'organization dropdown - set name',
      attributes: [{ name: 'organization-name' }],
      id: '035e4485-f41b-4753-bb51-98db9b985148',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_user_data.data[0].organizations[0].company_name', setting: 'text' }],
      folderId: '9604a1d7-0df8-496f-b4b4-8f0975084ef1'
    },
    {
      name: 'skeleton loader | chatbots list',
      attributes: [{ name: 'chatbots-skeleton' }],
      id: '039e473e-b51a-4363-ae5a-c8ede1a20334',
      type: 'element',
      actions: [{ value: 'return (r.get_chatbots.ok !== true)', setting: 'visibility' }],
      folderId: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c'
    },
    {
      name: 'set chat label - livechat',
      attributes: [{ name: 'livechat-label' }],
      id: '0530c904-1e31-46d5-8183-cb55a502ac81',
      type: 'element',
      actions: [{ value: 'return v.chats[v.i].livechat === true', setting: 'visibility' }],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'api - email_validaiton visibility',
      attributes: [{ name: 'api-tool-emailvalidation-visibility' }],
      id: '0610cab7-0138-4ece-be3b-ef75d111475e',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i["input-email_validation"] == true) {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: '/home - set user first name',
      attributes: [{ name: 'user-name' }],
      id: '065e5c1e-9699-4119-ae05-a735f516075a',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_user_data.data[0].first_name', setting: 'text' }],
      folderId: '9604a1d7-0df8-496f-b4b4-8f0975084ef1'
    },
    {
      condition: 'return (n.path.includes("integraties"))',
      name: 'Integrations | navigation',
      after: [
        {
          function:
            'function changeTabs() {\n  // Define all your tab elements\n  const installatie = document.querySelector("[settings-tab=\'installatie\']");\n  const gtm = document.querySelector("[settings-tab=\'gtm\']");\n  const webhooks = document.querySelector("[settings-tab=\'webhooks\']");\n\n  window.updateSettingsDisplay = function (activeTab) {\n    const tabElements = {\n      installatie: installatie,\n      gtm: gtm,\n      webhooks: webhooks,\n    };\n\n    // console.log(\'tabElements: \', tabElements);\n\n    // Hide all elements\n    Object.values(tabElements).forEach((el) => {\n      if (el) el.style.display = "none";\n    });\n\n    // Show the active element\n    const activeElement = tabElements[activeTab];\n    if (activeElement) activeElement.style.display = "block";\n  };\n\n  // Update display with the initial tab\n  window.updateSettingsDisplay(v.active_integrations_tab);\n}\n\nfunction settingsTabClickEventListeners() {\n  window.Wized = window.Wized || [];\n  window.Wized.push((Wized) => {\n    const settingsTabItems = document.querySelectorAll("[w-el=\'settings-tab\']");\n\n    settingsTabItems.forEach((item) => {\n      item.addEventListener("click", (event) => {\n        settingsTabItems.forEach((tab) => tab.classList.remove("active"));\n        const clickedItem = event.currentTarget;\n        clickedItem.classList.add("active");\n        const dataValue = clickedItem.getAttribute("data-value");\n        Wized.data.v.active_integrations_tab = dataValue;\n        // console.log(\'datavalue: \', dataValue);\n\n        // Call updateSettingsDisplay to reflect the change\n        window.updateSettingsDisplay(Wized.data.v.active_integrations_tab);\n      });\n    });\n  });\n}\n\nsettingsTabClickEventListeners();\nchangeTabs();\n',
          action: 'run-function'
        }
      ],
      trigger: 'page-loading',
      id: '07531a64-b9ce-43a5-9d2b-e36ebcdc1dad',
      type: 'event',
      hasCondition: true,
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      request: '8cc144e4-b421-46f5-a9e7-ee3f00940a07',
      condition: 'return (n.path.includes("instellingen"))',
      name: 'multi-select inputs',
      id: '07a8a5bc-7ebe-49cf-a227-ece1a3ce67a5',
      trigger: 'after-request',
      after: [
        {
          function:
            'setTimeout(() => {\n\n  // widget_styling.widget_header\n\n  const checkboxes = document.querySelectorAll("[multi-select=\'widget_header\']");\n  var hiddenInput = document.querySelector(\n    "[multi-select-input=\'widget_header\']"\n  );\n\n  var dbValue = r.get_chatbot.data.widget_styling.widget_header;\n\n  checkboxes.forEach(function (checkbox) {\n    if (checkbox.getAttribute("data-value") === dbValue) {\n      checkbox.classList.add("selected");\n    }\n    hiddenInput.value = dbValue;\n  });\n\n  checkboxes.forEach(function (checkbox) {\n    checkbox.addEventListener("click", function () {\n      checkboxes.forEach(function (option) {\n        option.classList.remove("selected");\n      });\n      checkbox.classList.add("selected");\n      hiddenInput.value = checkbox.getAttribute("data-value");\n    });\n  });\n\n}, 1000);',
          action: 'run-function'
        },
        {
          function:
            'setTimeout(() => {\n\n  // widget_styling.user_message_primary_color\n\n  const checkboxes = document.querySelectorAll("[multi-select=\'user_message\']");\n  var hiddenInput = document.querySelector("[multi-select-input=\'user_message\']");\n\n  var dbValue = r.get_chatbot.data.widget_styling.user_message_primary_color;\n\n  checkboxes.forEach(function (checkbox) {\n    if (checkbox.getAttribute("data-value") === dbValue) {\n      checkbox.classList.add("selected");\n    }\n    hiddenInput.value = dbValue;\n  });\n\n  checkboxes.forEach(function (checkbox) {\n    checkbox.addEventListener("click", function () {\n      checkboxes.forEach(function (option) {\n        option.classList.remove("selected");\n      });\n      checkbox.classList.add("selected");\n      hiddenInput.value = checkbox.getAttribute("data-value");\n    });\n  });\n\n}, 1000);',
          action: 'run-function'
        },
        {
          function:
            'setTimeout(() => {\n\n  // widget_styling.widget_border\n\n  const checkboxes = document.querySelectorAll("[multi-select=\'widget_border\']");\n  var hiddenInput = document.querySelector("[multi-select-input=\'widget_border\']");\n\n  var dbValue = r.get_chatbot.data.widget_styling.widget_border;\n\n  checkboxes.forEach(function (checkbox) {\n    if (checkbox.getAttribute("data-value") === dbValue) {\n      checkbox.classList.add("selected");\n    }\n    hiddenInput.value = dbValue;\n  });\n\n  checkboxes.forEach(function (checkbox) {\n    checkbox.addEventListener("click", function () {\n      checkboxes.forEach(function (option) {\n        option.classList.remove("selected");\n      });\n      checkbox.classList.add("selected");\n      hiddenInput.value = checkbox.getAttribute("data-value");\n    });\n  });\n\n}, 1000);',
          action: 'run-function'
        },
        {
          function:
            'setTimeout(() => {\n    // human_handoff.type\n\n    const checkboxes = document.querySelectorAll(\n      "[multi-select=\'human_handoff_type\']"\n    );\n    var hiddenInput = document.querySelector(\n      "[multi-select-input=\'human_handoff_type\']"\n    );\n\n    var dbValue = r.get_chatbot.data.human_handoff.type;\n    hiddenInput.value = dbValue;\n    i["input-handoff-external"] = dbValue;\n\n    checkboxes.forEach(function (checkbox) {\n      if (checkbox.getAttribute("data-value") === dbValue) {\n        checkbox.classList.add("selected");\n      }\n    });\n\n    checkboxes.forEach(function (checkbox) {\n      checkbox.addEventListener("click", function () {\n        checkboxes.forEach(function (option) {\n          option.classList.remove("selected");\n        });\n        checkbox.classList.add("selected");\n        hiddenInput.value = checkbox.getAttribute("data-value");\n        i["input-handoff-external"] = checkbox.getAttribute("data-value");\n      });\n    });\n  }, 2000);',
          action: 'run-function'
        },
        {
          function:
            'setTimeout(() => {\n    // language\n\n    const checkboxes = document.querySelectorAll(\n      "[multi-select=\'language\']"\n    );\n    var hiddenInput = document.querySelector("[multi-select-input=\'language\']");\n\n    var dbValue = r.get_chatbot.data.language;\n\n    checkboxes.forEach(function (checkbox) {\n      if (checkbox.getAttribute("data-value") === dbValue) {\n        checkbox.classList.add("active");\n      }\n      hiddenInput.value = dbValue;\n    });\n\n    checkboxes.forEach(function (checkbox) {\n      checkbox.addEventListener("click", function () {\n        checkboxes.forEach(function (option) {\n          option.classList.remove("active");\n        });\n        checkbox.classList.add("active");\n        hiddenInput.value = checkbox.getAttribute("data-value");\n        console.log("value", checkbox.getAttribute("data-value"));\n        i["input-language"] = checkbox.getAttribute("data-value");\n        console.log("value", i["input-language"])\n      });\n    });\n  }, 1000);',
          action: 'run-function'
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      name: '2b. operator_changed - body',
      attributes: [{ name: 'message_list_item-body' }],
      id: '07dd67a4-5f2b-48cf-bc1a-18a406bc7280',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "operator_changed") {\n    \n      if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.event_type == "joined") {\n          return "heeft de chat overgenomen"\n      } else if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.event_type == "left") {\n          return "heeft de chat verlaten"\n      }\n\n    }',
          setting: 'text'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      condition: 'return (n.path.includes("/testomgeving") && v.active_chatbot !== null)\n',
      name: 'render testomgeving',
      id: '0855e0e8-0cb9-4136-ac0b-7b43ad5edd63',
      after: [
        {
          function:
            'function createCookie() {\n  visitorId = crypto.randomUUID();\n  Cookies.set(cookieKey, visitorId, {\n    expires: 365,\n    sameSite: "None",\n    secure: true,\n  });\n  console.log("new cookie = ", visitorId);\n}\n\nconst pageUrl = window.location.href;\nlet baseUrl;\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  baseUrl = "https://widget.sleak.chat";\n} else {\n  baseUrl = "https://staging.sleak.chat";\n}\n\nconst activeChatbot = v.active_chatbot;\n\nconst cookieKey = "sleakVisitorId_admin_" + activeChatbot;\nconsole.log("cookieKey = ", cookieKey);\n\nconst cookie = Cookies.get(cookieKey);\n\nlet visitorId;\n\nif (cookie) {\n  console.log("cookie exists, value = ", cookie);\n  visitorId = cookie;\n} else {\n  console.log("cookie does not exist");\n  createCookie();\n}\n\nconst sleakIframe = document.querySelector("[w-el=\'sleak-ui-iframe\']");\nasync function renderWidget() {\n  const iframeSource = `${baseUrl}/${activeChatbot}/?id=${visitorId}&placement=admin`;\n  sleakIframe.src = iframeSource;\n}\nrenderWidget();\n\n// reset chat\n\nconst resetBtn = document.querySelector("[w-el=\'training-reset-chat\']");\n\nconst testOmgevingSkeleton = document.querySelector(\n  "[w-el=\'testomgeving-skeleton\']"\n);\n\nresetBtn.addEventListener("click", () => {\n  // testOmgevingSkeleton.style.display = "flex";\n  // sleakIframe.style.display = "none";\n  Cookies.set(cookieKey, visitorId, {\n    expires: 365,\n    sameSite: "None",\n    secure: true,\n  });\n  createCookie();\n  renderWidget();\n});\n',
          action: 'run-function'
        }
      ],
      trigger: 'page-loading',
      type: 'event',
      hasCondition: true
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      name: 'create users, organizations if not existing',
      id: '09506d63-4fe6-44f4-8800-e80813bb5cb7',
      trigger: 'after-request',
      after: [
        {
          condition: 'return (r.get_user_data.data[0].organizations.length == 0);\n',
          function:
            "Wized.requests.execute('create_organization');\nawait Wized.requests.waitFor('create_organization');\nif (r.create_organization.ok == true) {\n\n  Wized.requests.execute('create_organization_member');\n  await Wized.requests.waitFor('create_organization_member');\n  if (r.create_organization_member.ok == true) {\n\n    Wized.requests.execute('get_user_data');\n\n  }\n}",
          action: 'run-function',
          hasCondition: true
        }
      ],
      type: 'event',
      folderId: '9604a1d7-0df8-496f-b4b4-8f0975084ef1'
    },
    {
      name: 'datasource sharing - dropdown list - set chatbot website_url',
      attributes: [{ name: 'datasource-sharing-chatbot-list-item-url' }],
      id: '0a90fc20-7f05-41b0-bc16-061acb21e5c1',
      type: 'element',
      actions: [{ type: 'text', value: '// return v.chatbots[v.i].name\nreturn v.datasourceSharingChatbotsDropdown[v.i].website_url', setting: 'text' }],
      folderId: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679'
    },
    {
      name: 'image preview - agent image',
      attributes: [{ name: 'agents-list-iem-avatar' }],
      id: '0ba369c6-1ed0-43a8-b503-0000c6eb377c',
      type: 'element',
      actions: [
        {
          value:
            'if (i["agent-avatar-input"]["0"]["0"]) {\n    if (i["agent-avatar-input"]["0"] == \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\') {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\n    } else {\n        "object"\n        return URL.createObjectURL(i["agent-avatar-input"]["0"]["0"]);\n        // return i["agent-avatar-input"]\n    }\n} else {\n    if (r.get_agents.ok == true) {\n        if (r.get_agents.data[0].avatar !== null) {\n            return r.get_agents.data[0].avatar;\n        } else {\n            return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n        }    \n\n    } else {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n    }\n}',
          key: 'src',
          setting: 'attribute'
        }
      ],
      folderId: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0'
    },
    {
      name: 'Set chatbot list item url',
      attributes: [{ name: 'chatbot-list-item-url' }],
      id: '0ba81220-9c29-4c04-805f-757cbfd35221',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data[v.i].website_url.replace("https://", "")', setting: 'text' }],
      folderId: '206c14ea-c3ef-4b95-bdd4-2150463e4999'
    },
    {
      name: '3c. link_preview - title',
      attributes: [{ name: 'link_preview-title' }],
      id: '0bea97db-4a07-4319-9f63-e7084f12927a',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.title\n\n}',
          setting: 'text'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'delete api header',
      attributes: [{ name: 'api-headers-list-item-delete-btn' }],
      id: '0c6236f6-dc1e-41d4-bb78-174a68145322',
      type: 'element',
      actions: [
        {
          function:
            "var keys = document.querySelectorAll('[api-headers-table=key]');\nvar values = document.querySelectorAll('[api-headers-table=value]');\nvar headers = [];\n\nkeys.forEach((keyInput, index) => {\n    var valueInput = values[index];\n    headers.push({ index: index, key: keyInput.value, value: valueInput.value });\n});\n\nv.apiHeadersArray = headers;\n\nfunction deleteObjectByIndex(index) {\n  if (index !== -1) {\n    v.apiHeadersArray.splice(index, 1); // Remove 1 item at the given index\n  } else {\n    console.log(\"No object found with index\", index);\n  }\n}\n\nvar actualRow = event.target.closest(\"[w-el='api-headers-list-item']\");\nvar parentContainer = actualRow.parentNode;\nvar children = Array.from(parentContainer.children);\nvar index = children.indexOf(actualRow);\n\ndeleteObjectByIndex(index);\n",
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        },
        { value: 'return v.apiHeadersArray[v.i].index', key: 'index', setting: 'attribute' }
      ],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      id: '0f8ee86d-bc89-4801-b600-e84df88da149',
      name: 'set active chat on page load',
      folderId: '8339c00a-50de-4a25-99f6-68a9f4835506',
      type: 'event',
      trigger: 'after-request',
      request: 'fefe687b-b6dd-4efc-af07-f5b4c1810457',
      hasCondition: true,
      condition: 'return (n.path == "/chat-inbox")',
      after: [
        {
          action: 'run-function',
          function:
            '// Set active chat to most recent chat\nv.active_chat = v.chats[0].id;\n\n// if livechat is false, disable input\nif (v.chats.find((chat) => chat.id === v.active_chat).livechat == false) {\n    document.querySelector(\'[w-el="admin-ui-chat-input"]\').setAttribute(\'readonly\', true);\n}\n\nlet skeletonElement = document.querySelector("[w-el=\'skeleton-inbox-initial\']");\nif (skeletonElement.style.display !== "none") {\n    skeletonElement.style.display = "none";\n}\n'
        }
      ]
    },
    {
      name: 'filters - chatbots - active list images',
      attributes: [{ name: 'filter-chatbots-active-image' }],
      id: '107efd44-08f6-432f-8439-86cc6bc4c5e3',
      type: 'element',
      actions: [
        {
          value:
            'if (r.get_chatbots.data.find(item => item.id === v.inboxFilterChatbots[v.i]).avatar_url) {\n  return r.get_chatbots.data.find(item => item.id === v.inboxFilterChatbots[v.i]).avatar_url;\n} else {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\n}',
          key: 'src',
          setting: 'attribute'
        }
      ],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      request: 'd2b868e4-84da-4910-a98d-781589052b49',
      name: 'access control',
      after: [
        {
          function:
            'const preloader = document.querySelector("[w-el=\'preloader\']");\n\n\nif (!r.get_user.ok) {\n  \n  localStorage.setItem("sleak_loggedin", "false");\n\n  if (n.path !== "/signup" && n.path !== "/login" && n.path !== "/resetpassword" && n.path !== "/payment-success" && n.path !== "/redirect") {\n    n.path = "/login";\n  }\n} else if (r.get_user.ok) {\n\n  if (n.path == "/signup" || n.path == "/login") {\n    localStorage.setItem("sleak_loggedin", "true");\n    n.path = "/";\n  }\n\n  if (\n    localStorage.getItem("sleak_loggedin") === "false" ||\n    localStorage.getItem("sleak_loggedin") === null\n  ) {\n    localStorage.setItem("sleak_loggedin", "true");\n    setTimeout(() => {\n      preloader.style.display = "none";\n      console.log("hide element");\n    }, 2000);\n  }\n}',
          action: 'run-function'
        }
      ],
      trigger: 'after-request',
      id: '109e1281-e5cf-4399-827f-5a2d698ced86',
      type: 'event',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8'
    },
    {
      name: 'notice - all chats loaded',
      attributes: [{ name: 'chats-loaded' }],
      id: '122067f4-4c2c-47b9-a3a6-2650569c9af7',
      type: 'element',
      actions: [{ value: 'return (r.get_chats_pagination.data == 0)', setting: 'visibility' }],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      request: 'ac8cdd98-98da-45f1-9556-6e3e1cd38837',
      name: 'agents click events',
      after: [
        {
          function:
            'v.active_agent = r.get_agents.data[0];\n\nwindow.Wized = window.Wized || [];\nwindow.Wized.push((Wized) => {\n  const agentItems = document.querySelectorAll("[w-el=\'agents-list-item\']");\n\n  agentItems.forEach((item) => {\n    item.addEventListener("click", (event) => {\n      const dataValue = event.currentTarget.getAttribute("id");\n\n      Wized.data.v.active_agent = r.get_agents.data.find(\n        (agent) => agent.id === dataValue\n      );\n    });\n  });\n});',
          action: 'run-function'
        }
      ],
      trigger: 'after-request',
      id: '151903ae-f8dd-4f98-b56f-315a31939289',
      type: 'event',
      folderId: 'f2d1f791-109f-4ba0-8d6e-78a76539eb5e'
    },
    {
      name: '3a. LIST ITEM - link_preview',
      attributes: [{ name: 'message-type-link_preview' }],
      id: '15400274-68b4-442e-91d4-1ff6d7872543',
      type: 'element',
      actions: [{ value: 'return (\n  v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview"\n);\n', setting: 'visibility' }],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: '1c. default_message - timestamps',
      attributes: [{ name: 'message_list-timestamp' }],
      id: '1561296e-348a-446c-9eda-2a4f972266e2',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'if (["default_user", "default_bot", "default_agent"].includes(\n    v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type\n)) {\n  const rawTimestamp = v.chats.find(chat => chat.id === v.active_chat).messages[v.i].created_at;\n  const date = new Date(rawTimestamp);\n  return `${date.getHours().toString().padStart(2, \'0\')}:${date.getMinutes().toString().padStart(2, \'0\')}`;\n}\n',
          setting: 'text'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'active datasource status color',
      attributes: [{ name: 'active-datasource-status-color' }],
      id: '17e179ef-a054-4b07-815d-09119bc7ee46',
      type: 'element',
      actions: [
        {
          style: 'background-color',
          value:
            'if (v.dataSourceUpdatedStatus !== null) {\n  status = v.dataSourceUpdatedStatus\n} else {\n  status = r.get_datasources.data.find((item) => item.id === v.active_datasource).status;\n}\n\nif (status == "draft") {\n  return "#e7b549"\n} else if (status == "active") {\n  return "#25d366"\n} else if (status == "inactive") {\n  return "#F37A80"\n} else {\n  return "#fff"\n}',
          setting: 'style'
        }
      ],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      id: '17fe1900-f004-420d-9a6f-8a86f682fea0',
      name: 'submit live chat form - disable',
      folderId: '25fe132c-9171-46e3-b363-84ff68552eeb',
      type: 'element',
      attributes: [{ name: 'form-livechat-leave' }],
      actions: [
        { setting: 'on-event', event: 'submit', preventDefault: true, resetForm: true, action: 'perform-request', request: '82226b3c-8d16-44b1-a3a1-4e93611378c0' },
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          resetForm: true,
          action: 'run-function',
          function:
            "document.querySelector('[w-el=\"admin-ui-chat-input\"]').setAttribute('readonly', true);\n\nconst livechatModal = document.querySelector('[w-el=\"livechat-popup-leave\"]');\nlivechatModal.style.display = 'none';\n\nlet leaveLivechatEvent = new Event('leaveLivechat');\nwindow.dispatchEvent(leaveLivechatEvent);"
        },
        { setting: 'on-event', event: 'submit', preventDefault: true, resetForm: true, action: 'perform-request', request: 'a1103dab-b50e-40b9-9d71-45a4e8878ede' },
        { setting: 'on-event', event: 'submit', preventDefault: true, resetForm: true, action: 'set-variable', variable: '2122c660-915c-49cc-ba24-23222f9ac9f5', value: 'return false' }
      ]
    },
    {
      name: 'scrape-pagination-itemsperpage dropdown (copy)',
      attributes: [{ name: 'scrape-pagination-itemsperpage' }],
      id: '18G0LnnRW8E6cEeO0Vud',
      type: 'element',
      actions: [
        {
          function:
            'console.log("x")\nconst selectedValue = event.currentTarget.getAttribute("data-value");\nconsole.log("x", selectedValue)\ni["scrape-pagination-itemsperpage"] = selectedValue\n\n\nconst visibleTextElement = document.querySelector(\'[w-el="scrape-pagination-text"]\');\nif (visibleTextElement) {\n  visibleTextElement.innerText = selectedValue + " weergeven";\n}',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'show settings-container after get_chatbot',
      attributes: [{ name: 'test-cloak' }],
      id: '18e4b74f-937d-4700-a96d-933dbca893db',
      type: 'element',
      actions: [{ value: 'return (r.get_chatbot.ok)', setting: 'visibility' }],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      name: 'datasource sharing - active list delete btn',
      attributes: [{ name: 'datasource-sharing-list-item-delete-btn' }],
      id: '194ebfad-87ec-49d1-8324-885fc374e397',
      type: 'element',
      actions: [
        { value: '// return r.get_chatbots_datasources_joins.data[v.i].id\nreturn v.datasourceSharingChatbotsActiveList[v.i].id', key: 'id', setting: 'attribute' },
        {
          function:
            'const dataValue = event.currentTarget.getAttribute("id");\nv.delete_chatbots_datasources_join = dataValue;\nconsole.log(dataValue);\n\nWized.requests.execute("delete_chatbots_datasources_join");\nawait Wized.requests.waitFor("delete_chatbots_datasources_join");\n\nWized.requests.execute("get_chatbots_datasources_joins");',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679'
    },
    {
      name: 'empty state - chatbots list',
      attributes: [{ name: 'emptystate-datasources' }],
      id: '19d573fb-5dfd-422e-8a3d-04240d0c380b',
      type: 'element',
      actions: [{ value: 'return (r.get_datasources.data.length == 0 && r.get_chatbots.data.length !== 0)', setting: 'visibility' }],
      folderId: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca'
    },
    {
      name: 'sharing - render active chatbots list',
      attributes: [{ name: 'datasource-sharing-list-item' }],
      id: '19e65000-d5bc-4b39-9d9e-df8ac10772c1',
      type: 'element',
      actions: [{ indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.datasourceSharingChatbotsActiveList', setting: 'list' }],
      folderId: 'b19e3643-8ab2-44df-b648-b38f323cc6e9'
    },
    {
      name: 'datasource sharing - active list - set chatbot name',
      attributes: [{ name: 'datasource-sharing-list-item-name' }],
      id: '19ee1e48-bca3-45c9-bc4e-466d9b6f1738',
      type: 'element',
      actions: [
        { type: 'text', value: '// return v.chatbots[v.i].name\nreturn r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).name', setting: 'text' }
      ],
      folderId: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679'
    },
    {
      name: 'chatbot count visibility',
      attributes: [{ name: 'chatbot-count-label' }],
      id: '1ESxtwyq4Tq7UqPJDvXx',
      type: 'element',
      actions: [
        {
          value:
            'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nreturn (organization.subscription_plan && organization.subscription_plan.includes("expert") || maxChatbots !== null)',
          setting: 'visibility'
        }
      ],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'set chat timestamp',
      attributes: [{ name: 'chat-list-item-time' }],
      id: '1b3e6e91-4bad-41eb-9b8c-bbc372c5669c',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            '// const lastMessage = v.chats[v.i].messages[v.chats[v.i].messages.length - 1];\n// const messageTimestamp = lastMessage.created_at;\n\nconst messageTimestamp = v.chats[v.i].updated_at;\n\n// static timestamp for testing purposes\n// const messageTimestamp = "2024-07-17 15:37:44.006764+00";\n\n//\n\nfunction padZero(number) {\n  return number < 10 ? "0" + number : number.toString();\n}\n\nconst now = new Date();\nconst created_at = new Date(messageTimestamp);\nconst timeDiff = now - created_at;\nconst minutes = Math.floor(timeDiff / 60000);\nconst hours = Math.floor(minutes / 60);\nconst days = Math.floor(hours / 24);\n\nif (minutes < 1) {\n  return "zojuist";\n} else if (days > 7) {\n  const monthNames = [\n    "januari",\n    "februari",\n    "maart",\n    "april",\n    "mei",\n    "juni",\n    "juli",\n    "augustus",\n    "september",\n    "oktober",\n    "november",\n    "december",\n  ];\n  return `${created_at.getDate()} ${monthNames[created_at.getMonth()]}`;\n} else if (days >= 3) {\n  const dayNames = [\n    "zondag",\n    "maandag",\n    "dinsdag",\n    "woensdag",\n    "donderdag",\n    "vrijdag",\n    "zaterdag",\n  ];\n  return `${dayNames[created_at.getDay()]}`;\n} else if (days > 1) {\n  return `${days} dagen geleden`;\n} else if (\n  now.getUTCFullYear() > created_at.getUTCFullYear() ||\n  now.getUTCMonth() > created_at.getUTCMonth() ||\n  now.getUTCDate() > created_at.getUTCDate()\n) {\n  return "gisteren";\n} else if (hours >= 1) {\n  return `${padZero(created_at.getHours())}:${padZero(\n    created_at.getMinutes()\n  )}`;\n} else {\n  return `${minutes} min. geleden`;\n}\n',
          setting: 'text'
        }
      ],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'global showToastNotification function',
      id: '1cdfd897-024d-45d6-96ab-7ba95261339b',
      trigger: 'page-loading',
      after: [
        {
          function:
            '// transitions\n\nfunction openToast(toastElement) {\n  toastElement.style.display = "flex";\n  toastElement.style.opacity = 0;\n  toastElement.style.transform = "translateY(40px) scale(0.6)";\n\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 1;\n      toastElement.style.transform = "translateY(0) scale(1)";\n    });\n  });\n}\n\nfunction closeToast(toastElement) {\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 0;\n      toastElement.style.transform = "translateY(40px) scale(0.6)";\n      setTimeout(() => {\n        toastElement.style.display = "none";\n      }, 150);\n    });\n  });\n}\n\nasync function manageToast(toastElement) {\n  openToast(toastElement);\n  await new Promise((resolve) => setTimeout(resolve, 5000));\n  closeToast(toastElement);\n}\n\n// toast notifications\n\nwindow.showToastNotification = async function(message, type) {\n  const toastMessage = {\n    id: crypto.randomUUID(),\n    expiration: new Date().getTime() + 5000,\n    type: type,\n    message: message,\n  };\n\n  v.toast_log.push(toastMessage);\n\n  const toastElement = document.querySelector(\n    `[toast_item_id=\'${toastMessage.id}\']`\n  );\n\n  manageToast(toastElement);\n}',
          action: 'run-function'
        }
      ],
      type: 'event'
    },
    {
      name: 'set drag area visibility',
      attributes: [{ name: 'csv-dragarea' }],
      id: '1d483ff6-bb24-4cd8-9b39-51d98b115d31',
      type: 'element',
      actions: [{ style: 'display', value: 'if (v.csvContent && v.csv_rows.length > 0) {\n  return "none"\n} else {\n  return "flex"\n}', setting: 'style' }],
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849'
    },
    {
      name: 'active chat chatbot name',
      attributes: [{ name: 'active-chat-inbox-chatbot-name' }],
      id: '22d6c0cd-f343-489e-bfe9-378e9c61b1c2',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            '// return v.chats.find((chat) => chat.id === v.active_chat).chatbots.name\n\nreturn r.get_chatbots.data.find((item) => item.id === v.chats.find((chat) => chat.id === v.active_chat).chatbot_id).name',
          setting: 'text'
        }
      ],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      name: 'Set active chatbot avatar',
      attributes: [{ name: 'active-chatbot-avatar' }],
      id: '2448c1a5-5ac9-425d-8162-b357f35ed721',
      type: 'element',
      actions: [{ value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).avatar_url\n', key: 'src', setting: 'attribute' }],
      folderId: '1e11a85b-77a9-441a-a07e-79727b419fd9'
    },
    {
      name: 'image preview - background',
      attributes: [{ name: 'settings-background-imagepreview' }],
      id: '26e8a073-39ca-4b44-b867-13ea034bf919',
      type: 'element',
      actions: [
        {
          value:
            'if (i["settigs-background-input"]["0"]) {\n\n    if (!i["settigs-background-input"]) {\n        return null\n    } else {\n        return URL.createObjectURL(i["settigs-background-input"]["0"]);\n        // return i["settigs-background-input"]\n    }\n    \n} else {\n    if (r.get_chatbot.ok == true) {\n\n        if (r.get_chatbot.data.background_image !== null) {\n            return r.get_chatbot.data.background_image;\n        } else {\n            return null;\n        }    \n\n    } else {\n        return null;\n    }\n}',
          key: 'src',
          setting: 'attribute'
        },
        {
          value:
            'if (i["settigs-background-input"]["0"]) {\n\n    if (!i["settigs-background-input"]) {\n        return false\n    } else {\n        return true\n        // return i["settigs-background-input"]\n    }\n    \n} else {\n    if (r.get_chatbot.ok == true) {\n\n        if (r.get_chatbot.data.background_image !== null) {\n            return true;\n        } else {\n            return false;\n        }    \n\n    } else {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n    }\n}',
          setting: 'visibility'
        }
      ],
      folderId: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0'
    },
    {
      name: 'Output scheme toggle event listener',
      attributes: [{ name: 'outputscheme-toggle-wrap' }],
      id: '2756b91d-da31-4d64-86cf-db8d27b522a3',
      type: 'element',
      actions: [
        {
          condition: 'return (v.codemirrorInitialized == false)',
          function:
            'setTimeout(() => {\n  // text-editor\n  // outputScheme code-editor\n\n  let textarea = document.getElementById("code-editor");\n  let codeMirrorInstance;\n  let validModal = document.querySelector("[w-el=\'modal-valid-json\']");\n  let invalidModal = document.querySelector("[w-el=\'modal-invalid-json\']");\n\n  function isValidJsonObject(value) {\n    try {\n      const parsed = JSON.parse(value);\n      return !!parsed && typeof parsed === "object" && !Array.isArray(parsed);\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function objectIsValid() {\n    validModal.style.display = "flex";\n    invalidModal.style.display = "none";\n    v.outputSchemaObjectIsValid = true;\n  }\n\n  function objectIsInvalid() {\n    validModal.style.display = "none";\n    invalidModal.style.display = "flex";\n    v.outputSchemaObjectIsValid = false;\n  }\n\n  function programmaticallySetValue(value, textarea, codeMirrorInstance) {\n    if (v.codemirrorInitialized == false) {\n      codeMirrorInstance = CodeMirror.fromTextArea(textarea, {\n        mode: "application/json",\n        theme: "dracula",\n        lineNumbers: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        indentUnit: 2,\n        tabSize: 2,\n        gutters: ["CodeMirror-lint-markers"],\n        lint: {\n          lintOnChange: true,\n          tooltips: false,\n        },\n      });\n\n      // input event listener\n      codeMirrorInstance.on("change", function (cm, change) {\n        inputEventValue = cm.getValue();\n        // console.log("Content changed:", cm.getValue());\n        if (isValidJsonObject(inputEventValue)) {\n          objectIsValid();\n        } else {\n          objectIsInvalid();\n        }\n      });\n    }\n\n    textarea.value = value;\n    if (v.codemirrorInitialized == false) {\n      codeMirrorInstance.setValue(value);\n      if (isValidJsonObject(value)) {\n        objectIsValid();\n      } else {\n        objectIsInvalid();\n      }\n    }\n    v.codemirrorInitialized = true;\n  }\n\n  const activeDatasource = r.get_datasources.data.find(\n    (item) => item.id === v.active_datasource\n  ).datasource_type_config;\n  const rawValue = activeDatasource.outputSchema;\n  const value = JSON.parse(rawValue);\n  // console.log(value);\n\n  programmaticallySetValue(value, textarea, codeMirrorInstance);\n}, 10);',
          action: 'run-function',
          event: 'click',
          hasCondition: true,
          setting: 'on-event'
        }
      ],
      folderId: '55214649-2bac-4398-a861-03d94d2aad9d'
    },
    {
      name: 'render chatbot list',
      attributes: [{ name: 'chatbot-list-item' }],
      id: '293ffa23-8d52-444d-b822-b24cdcdca25c',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: '// return v.chatbots\nreturn r.get_chatbots.data', setting: 'list' },
        { style: 'display', value: 'return "flex"', setting: 'style' },
        {
          value:
            "// hover interactions for chatbot list item actions (target elements after wized init)\n// function fadeInUp(element) {\n//   element.style.display = 'flex';\n//     element.style.opacity = '1';\n//     element.style.transform = 'translateY(0)';\n// }\n// \n// function fadeOutDown(element) {\n//   element.style.opacity = '0';\n//   element.style.transform = 'translateY(20px)';\n//   setTimeout(() => {\n//     element.style.display = 'none';\n//   }, 200);\n// }\n// \n// const listItems = document.querySelectorAll('.chatbot-list-item');\n// \n// listItems.forEach(item => {\n//   const actionWrap = item.querySelector('.chatbot-item-action-wrap');\n// \n// \titem.addEventListener('mouseenter', () => {\n//     fadeInUp(actionWrap);\n//   });\n//   item.addEventListener('mouseleave', () => {\n//     fadeOutDown(actionWrap);\n//   });\n//   \n// });\n\nreturn r.get_chatbots.data[v.i].id",
          key: 'data-value',
          setting: 'attribute'
        },
        { value: 'return r.get_chatbots.data[v.i].name', key: 'name', setting: 'attribute' },
        { value: 'return r.get_chatbots.data[v.i].website_url', key: 'url', setting: 'attribute' },
        {
          function:
            'const dataValue = event.currentTarget.getAttribute("data-value");\nconst chatbotName = event.currentTarget.getAttribute("name");\n\nconst placement = event.currentTarget.getAttribute("placement");\n\nif (placement === "datasource-sharing") {\n  v.datasource_sharing_selected = dataValue;\n} else {\n  v.active_chatbot = dataValue;\n\n  // toast notifications\n  const toastMessage = {\n    id: crypto.randomUUID(),\n    expiration: new Date().getTime() + 5000,\n    type: "success",\n    message: "Chatbot <b>" + chatbotName + "</b> geselecteerd",\n  };\n\n  // transitions\n  function openToast(toastElement) {\n    toastElement.style.display = "flex";\n    toastElement.style.opacity = 0;\n    toastElement.style.transform = "translateY(40px) scale(0.6)";\n    requestAnimationFrame(() => {\n      requestAnimationFrame(() => {\n        toastElement.style.opacity = 1;\n        toastElement.style.transform = "translateY(0) scale(1)";\n      });\n    });\n  }\n\n  function closeToast(toastElement) {\n    requestAnimationFrame(() => {\n      requestAnimationFrame(() => {\n        toastElement.style.opacity = 0;\n        toastElement.style.transform = "translateY(40px) scale(0.6)";\n        setTimeout(() => {\n          toastElement.style.display = "none";\n        }, 150);\n      });\n    });\n  }\n\n  async function manageToast(toastElement) {\n    openToast(toastElement);\n    await new Promise((resolve) => setTimeout(resolve, 5000));\n    closeToast(toastElement);\n  }\n\n  v.toast_log.push(toastMessage);\n\n  const toastElement = document.querySelector(\n    `[toast_item_id=\'${toastMessage.id}\']`\n  );\n\n  manageToast(toastElement);\n\n  // navigation\n\n  if (n.path !== "/chatbot") {\n    n.path = "/chatbot";\n  } else {\n    v.inboxFilterChatbots = [v.active_chatbot];\n    Wized.requests.execute("get_chats");\n\n    chatbotsChart1.destroy();\n    chatbotsChart2.destroy();\n\n    Wized.requests.execute("get_chats_analytics");\n  }\n}\n',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        },
        { condition: '// set active state\nreturn (r.get_chatbots.data[v.i].id == v.active_chatbot)\n', class: 'active', setting: 'class' }
      ],
      folderId: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca'
    },
    {
      name: 'Data sources elements - set name',
      attributes: [{ name: 'datasource-list-name' }],
      id: '2a3a6f3f-29de-4d48-9213-8f6289c1ce28',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_datasources.data[v.i].name', setting: 'text' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'datasource sharing active list visibility',
      attributes: [{ name: 'datasource-sharing-list-container' }],
      id: '2a3bb275-76fa-48db-8917-5afe1547ddf0',
      type: 'element',
      actions: [{ value: 'return (v.datasourceSharingChatbotsActiveList.length !== 0)', setting: 'visibility' }],
      folderId: 'b19e3643-8ab2-44df-b648-b38f323cc6e9'
    },
    {
      name: 'api - render headers list key value',
      attributes: [{ name: 'api-headers-list-item-key' }],
      id: '2b175076-bfcf-4c7f-8c7b-43a878c2f1ac',
      type: 'element',
      actions: [{ value: 'return v.apiHeadersArray[v.i].key', setting: 'value' }],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'calculate remaining trial days',
      attributes: [{ name: 'trial-modal-days-remaining' }],
      id: '2b430d68-ae75-42bb-a2f2-2b6c0f47dbaa',
      type: 'element',
      actions: [
        {
          type: 'html',
          value:
            'const organization = r.get_user_data.data[0].organizations[0];\n\nif (organization.subscription_status !== "active" || organization.subscription_status == null) {\n    const currentDate = new Date();\n    const createdAt = new Date(organization.created_at);\n    const trialPeriodDays = 14;\n\n    const diffTime = currentDate - createdAt;\n    \n    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n    const remainingDays = trialPeriodDays - diffDays;\n\n    if (remainingDays > 0) {\n        return `Nog ${remainingDays} dagen over`;\n    } else {\n        return `${Math.abs(remainingDays)} dagen verlopen`;\n    }\n  }',
          setting: 'text'
        }
      ],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'filters - label',
      attributes: [{ name: 'filter-label' }],
      id: '2c243dd6-5aa1-45b3-90f5-dcf8247b9990',
      type: 'element',
      actions: [
        {
          function:
            'const targetValue = event.currentTarget.getAttribute("filter-value");\n\nv.inboxFilterLabel = targetValue;\n\ndocument.querySelectorAll(\'[w-el="filter-label"]\').forEach((element) => {\n  element.classList.remove("active");\n});\n\nevent.currentTarget.classList.add("active");\n',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      name: 'set chatbot list status indicator',
      attributes: [{ name: 'chatbot-list-status-indicator' }],
      id: '2c553920-db3a-4e7f-8d98-5e83bdf80c90',
      type: 'element',
      actions: [
        {
          style: 'background-color',
          value: 'if (r.get_chatbots.data[v.i].publishing.published == true) {\n  return "#25d366"\n} else if (r.get_chatbots.data[v.i].publishing.published == false) {\n  return "#F37A80"\n}',
          setting: 'style'
        }
      ],
      folderId: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca'
    },
    {
      request: 'ad7fd706-ec0e-4f2c-972b-c7d42a014bfb',
      name: 'redirect to checkout url',
      id: '2c6c2440-5038-44a4-8505-9adb4eacc937',
      trigger: 'after-request',
      after: [
        {
          condition: '// return (r.create_checkout_session.data.checkout_url !== null)\nreturn false',
          action: 'navigate-to',
          hasCondition: true,
          url: 'return r.create_checkout_session.data.checkout_url',
          openInNewTab: true
        },
        {
          condition: 'return false',
          function: "const redirectUrl = r.create_checkout_session.data.checkout_url;\nconsole.log(redirectUrl);\nwindow.open(redirectUrl, '_blank', 'noopener,noreferrer');",
          action: 'run-function',
          hasCondition: true
        }
      ],
      type: 'event',
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      id: '2ce1a7cb-4ce1-4752-9c1b-9b01dc77d239',
      name: 'submit update_password form',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      type: 'element',
      attributes: [{ name: 'form-password-update' }],
      actions: [{ setting: 'on-event', event: 'submit', preventDefault: true, action: 'run-function', function: 'Wized.requests.execute("update_password");' }]
    },
    {
      name: 'settings form handling - integraties | webhooks',
      attributes: [{ name: 'form-integrations-webhooks' }],
      id: '2e13e5ab-ce7d-40c7-9fcd-bdb11e70ce25',
      type: 'element',
      actions: [
        {
          value:
            'function removePrefix(url) {\n  const formattedUrl = url.replace("https://", "");\n  return formattedUrl;\n};\n\nconst chatInitiatedEndpoint = removePrefix(r.get_chatbot.data.webhooks.chatInitiated.endpoint_url);\nconst sentContactDetailsEndpoint = removePrefix(r.get_chatbot.data.webhooks.sentContactDetails.endpoint_url);\nconst humanHandoffActivatedEndpoint = removePrefix(r.get_chatbot.data.webhooks.humanHandoffActivated.endpoint_url);\nconst livechatNewMessageEndpoint = removePrefix(r.get_chatbot.data.webhooks.livechatNewMessage.endpoint_url);\n\nreturn {\n  webhooks_toggle_chatInitiated: r.get_chatbot.data.webhooks.chatInitiated.enabled,\n  chatInitiated_endpoint: chatInitiatedEndpoint,\n\n  webhooks_toggle_sentContactDetails: r.get_chatbot.data.webhooks.sentContactDetails.enabled,\n  sentContactDetails_endpoint: sentContactDetailsEndpoint,\n\n  webhooks_toggle_humanHandoffActivated: r.get_chatbot.data.webhooks.humanHandoffActivated.enabled,\n  humanHandoffActivated_endpoint: humanHandoffActivatedEndpoint,\n\n  webhooks_toggle_livechatNewMessage: r.get_chatbot.data.webhooks.humanHandoffActivated.enabled,\n  livechatNewMessage_endpoint: livechatNewMessageEndpoint,\n};',
          setting: 'form'
        },
        { request: 'f94c1b4b-1663-4e0b-9987-e2694332fc53', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' }
      ],
      folderId: 'f8158d09-0ac8-4653-9ebe-dba0b72a2b38'
    },
    {
      name: 'datasource-list-item-shared',
      attributes: [{ name: 'datasource-list-item-shared' }],
      id: '2zAQ87QbOFcNMYACM2Yz',
      type: 'element',
      actions: [{ indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.datasourceSharingNavbarList;\n', setting: 'list' }],
      folderId: 'hiARdgSU6l4YoqRL86jN'
    },
    {
      id: '314a1416-0a2b-470e-ab6b-a401abe22942',
      name: 'Active data source elements - set img src',
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7',
      type: 'element',
      attributes: [{ name: 'active-datasource-list-item-img-src' }],
      actions: [
        {
          setting: 'attribute',
          key: 'src',
          value:
            "const dataType = r.get_datasources.data.find(item => item.id === v.active_datasource).data_type\n\nif (dataType == 'pdf') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc1cd277ec15f33fdc7b3_file-info-alt.svg'\n} else if (dataType == 'csv') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc226b395d689963bd587_database.svg'\n} else if (dataType === 'pdf2') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/67239dd4e768c478e10fb6b4_file%20(1).svg'\n} else if (dataType == 'url') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7e4473d4ee68c12db_link-h.svg'\n} else if (dataType == 'api') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7ac7247ea9e3f5e3f_code-branch.svg'\n}"
        }
      ]
    },
    {
      name: 'datasource sharing - dropdown list - set chatbot avatar',
      attributes: [{ name: 'datasource-sharing-chatbots-dropdown-list-item-avatar' }],
      id: '3281db3a-9ef2-49d9-a075-21c112508dcc',
      type: 'element',
      actions: [
        { value: '// return v.chatbots[v.i].name\nreturn v.datasourceSharingChatbotsDropdown[v.i].avatar_url', key: 'src', setting: 'attribute' },
        {
          value: 'return (v.datasourceSharingChatbotsDropdown[v.i].avatar_url !== "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png")',
          setting: 'visibility'
        }
      ],
      folderId: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679'
    },
    {
      name: '2c. operator_changed - image',
      attributes: [{ name: 'message_list_item-img' }],
      id: '32d45f25-9acc-4dcb-96e9-aaa1204793b4',
      type: 'element',
      actions: [
        {
          value:
            'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "operator_changed") {\n\n      return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.operator_avatar_img\n\n    }',
          key: 'src',
          setting: 'attribute'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'delete kb_topic form',
      attributes: [{ name: 'form-delete-kb-item' }],
      id: '3309613e-3340-41cb-8363-b40b1c602090',
      type: 'element',
      actions: [
        {
          function:
            'Wized.requests.execute("delete_kb_topic");\n\nawait Wized.requests.waitFor("delete_kb_topic");\n\nWized.requests.execute("get_datasources");\n\n\nv.active_kb_topic = null;\n\nconst modals = document.querySelectorAll(\'[popupmodal]\');\nmodals.forEach((modal) => {\n  modal.style.display = "none";\n});',
          action: 'run-function',
          event: 'submit',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      name: 'KB search empty state',
      attributes: [{ name: 'emptystate-kblist-search' }],
      id: '3329e9c5-90a5-4cc0-8723-5b8bdb7ee92b',
      type: 'element',
      actions: [{ value: 'const searchQuery = i["kennisbank-search-input"];\n\nreturn (searchQuery && v.filteredKbList.length == 0)', setting: 'visibility' }],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      id: '33ee7d2f-b91e-4ad1-a48a-93d254295ec6',
      name: 'redirect on auth',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      type: 'event',
      trigger: 'after-request',
      request: '8403ef0c-56ca-46b6-acb6-99ad469be5de',
      after: [
        {
          action: 'navigate-to',
          url: "if (window.innerWidth <= 768) {\n  return '/chat-inbox'\n} else {\n  return '/'\n}",
          hasCondition: true,
          condition: "return (!n.path.includes('/redirect') && r.auth_user.ok == true)"
        },
        {
          action: 'run-function',
          function:
            "const signupButton = document.querySelector('[multi-step-signup=\"button\"]');\nconst spinner = document.querySelector('[spinner=\"auth\"]');\n\nspinner.style.display = 'none';\nsignupButton.setAttribute('value', 'Inloggen');",
          hasCondition: true,
          condition: 'return (r.auth_user.ok !== true)'
        }
      ]
    },
    {
      name: 'Active language span',
      attributes: [{ name: 'active-language' }],
      id: '34f1c1de-6e0e-4a1c-827f-475e588d3ffa',
      type: 'element',
      actions: [
        {
          type: 'html',
          value:
            'if (i["input-language"] == "nl") {\n  return `Nederlands <span class="land">ðŸ‡³ðŸ‡±</span>`;\n} else if (i["input-language"] == "en") {\n  return `Engels <span class="land">ðŸ‡¬ðŸ‡§</span>`;\n} else if (i["input-language"] == "fr") {\n  return `Frans <span class="land">ðŸ‡«ðŸ‡·</span>`;\n} else if (i["input-language"] == "de") {\n  return `Duits <span class="land">ðŸ‡©ðŸ‡ª</span>`;\n} else if (i["input-language"] == "es") {\n  return `Spaans <span class="land">ðŸ‡ªðŸ‡¸</span>`;\n} else if (i["input-language"] == "it") {\n  return `Italiaans <span class="land">ðŸ‡®ðŸ‡¹</span>`;\n} else if (i["input-language"] == "pl") {\n  return `Pools <span class="land">ðŸ‡µðŸ‡±</span>`;\n} else if (i["input-language"] == "pt") {\n  return `Portugees <span class="land">ðŸ‡µðŸ‡¹</span>`;\n} ',
          setting: 'text'
        }
      ],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      name: 'message type timestamp - date',
      attributes: [{ name: 'chat-message-timestamp' }],
      id: '350193f9-c999-409e-9977-7c8c479a9e5d',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            "const date = new Date(v.chats.find((chat) => chat.id === v.active_chat).created_at);\n\nlet options = { weekday: 'long', day: 'numeric', month: 'long' };\nlet formattedDate = date.toLocaleDateString('nl-NL', options);\n\nif (date.getFullYear() !== new Date().getFullYear()) {\n  formattedDate += ' ' + date.getFullYear();\n}\n\nreturn formattedDate.charAt(0).toUpperCase() + formattedDate.slice(1);",
          setting: 'text'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'channels visibility',
      attributes: [{ name: 'visibility-channels-disabled' }],
      id: '3570e123-e12e-44a6-b14a-34c130b3e160',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i["toggle_channels"] == true) {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      name: 'Set active chatbot organisation',
      attributes: [{ name: 'active-chatbot-organization' }],
      id: '362dede2-7720-4e52-8ab5-8370ef0c68ea',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).organization_name\n', setting: 'text' }],
      folderId: '1e11a85b-77a9-441a-a07e-79727b419fd9'
    },
    {
      name: 'agent list - set agent img',
      attributes: [{ name: 'agents-list-iem-avatar' }],
      id: '39573b10-b510-4d6e-aa07-cfed5b9436be',
      type: 'element',
      actions: [{ value: 'return r.get_agents.data[v.i].avatar', key: 'src', setting: 'attribute' }],
      folderId: 'f2d1f791-109f-4ba0-8d6e-78a76539eb5e'
    },
    {
      name: 'csv input clear btn',
      attributes: [{ name: 'clear-csv-btn' }],
      id: '3d883067-431f-4d69-aaac-66bf9c3ad2c6',
      type: 'element',
      actions: [
        {
          function: 'i["csv-upload"] = {};\nconst form = document.querySelector("[w-el=\'form-create-datasource-csv\']")\nform.reset();\nv.csv_rows = []\nv.csvContent = null',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849'
    },
    {
      name: 'empty state | chats / inbox > geen chatbots',
      attributes: [{ name: 'emptystate-chats-chatbot' }],
      id: '3d8a6e3c-1553-40e0-a860-add6bc253d0d',
      type: 'element',
      actions: [{ value: 'return (r.get_chatbots.data.length == 0)', setting: 'visibility' }],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      name: 'datasource sharing - active list - set chatbot initials',
      attributes: [{ name: 'datasource-sharing-list-item-initials' }],
      id: '3f4696e4-d93a-4a6f-879e-8dc20aff4330',
      type: 'element',
      actions: [
        {
          type: 'text',
          value: '// return v.chatbots[v.i].name\nreturn r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).name.charAt(0)\n',
          setting: 'text'
        }
      ],
      folderId: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679'
    },
    {
      name: 'Create data source form - API',
      attributes: [{ name: 'form-create-datasource-api' }],
      id: '4186c920-1213-47be-aba1-8f95b2b09604',
      type: 'element',
      actions: [
        {
          condition: "return (n.path.includes ('/kennis/databronnen'))",
          function:
            'Wized.requests.execute("create_api");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\ndataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\nwindow.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  // Deprecaten - .find() method gebruiken\n  Wized.data.v.active_datasource_type = "api";\n\n  // Element visibility\n  const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n  const editForm = document.querySelector("[w-el=\'form-container-edit-api\']");\n  editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n  await Wized.requests.waitFor(\'create_api\');\n\n  Wized.requests.execute("get_datasources");\n  Wized.data.v.active_datasource = r.create_api.data.id;\n\n  await Wized.requests.waitFor("get_datasources");\n  // update container visibility\n  editForm.style.display = "flex";\n\n\n  // reset create forms - al gedaan bovenin?\n  // const allForms = document.querySelectorAll(".datasources-formblock");\n  // const formWrapperInitial = document.getElementById("create-datasource-form");\n  // allForms.style.display = "none";\n  // formWrapperInitial.style.display = "flex";\n});\n',
          resetForm: true,
          action: 'run-function',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        },
        {
          condition: "return (n.path.includes ('/kennis/prompt') || n.path.includes ('/admin-create-datasource'))",
          function: "Wized.requests.execute(\"create_api\");\nawait Wized.requests.waitFor('create_api');\n\nv.active_datasource = r.create_api.data.id;\n\nn.path = '/kennis/databronnen?tn=cd'",
          action: 'run-function',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee'
    },
    {
      name: 'set chat label - handoff',
      attributes: [{ name: 'handoff-label-2' }],
      id: '43b00bd3-ed48-470a-a138-0d434c62410a',
      type: 'element',
      actions: [{ value: 'return v.chats[v.i].agent_requested === true', setting: 'visibility' }],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'Set KB list item name',
      attributes: [{ name: 'document-list-item-name' }],
      id: '43e18fd4-d405-4ef2-a93a-c88c26221638',
      type: 'element',
      actions: [{ type: 'text', value: '// return r.get_kb_topics.data.data[v.i].name\nreturn v.filteredKbList[v.i].name', setting: 'text' }],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      name: 'set file preview name',
      attributes: [{ name: 'csv-upload-preview-name' }],
      id: '445f2f6e-0f53-4f3f-bd6a-8f4d44e22788',
      type: 'element',
      actions: [{ type: 'text', value: 'return v.csvContent.name', setting: 'text' }],
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849'
    },
    {
      id: '44db1bd3-b228-4b97-b1a7-b325b1d908e5',
      name: 'after get_datasources',
      folderId: '55214649-2bac-4398-a861-03d94d2aad9d',
      type: 'event',
      trigger: 'after-request',
      request: '9d139b25-dc47-41e5-8bfd-f09ec49d71da',
      hasCondition: true,
      condition: 'return n.path.includes("/kennis")',
      after: [
        {
          action: 'run-function',
          function:
            "document.querySelector(\"[w-el='datasources-skeleton-wrapper']\").style.display = 'none';\n\nif (!v.active_datasource) {\n  // for first item\n  v.active_datasource = r.get_datasources.data[0].id;\n}\n\n// Element visibility\nconst editDatasourcesForms = document.querySelectorAll('[wized-cloak]');\n\nconst pdfForm = document.querySelector(\"[w-el='form-container-edit-pdf']\");\nconst csvForm = document.querySelector(\"[w-el='form-container-edit-csv']\");\nconst urlForm = document.querySelector(\"[w-el='form-container-edit-url']\");\nconst apiForm = document.querySelector(\"[w-el='form-container-edit-api']\");\nconst pdf2Form = document.querySelector(\"[w-el='form-container-edit-pdf2']\");\n\neditDatasourcesForms.forEach(item => {\n  item.style.visibility = 'visible !important';\n  item.style.display = 'flex !important';\n  item.removeAttribute('wized-cloak');\n});\n\n// document.querySelector(\"[w-el='datasources-skeleton-wrapper']\").style.display = \"none\";\n\nconst activeType = r.get_datasources.data.find(item => item.id === v.active_datasource).data_type;\n\nif (activeType === 'pdf') {\n  pdfForm.style.display = 'flex';\n} else if (activeType === 'csv') {\n  csvForm.style.display = 'flex';\n} else if (activeType === 'pdf2') {\n  pdf2Form.style.display = 'flex';\n} else if (activeType === 'url') {\n  Wized.requests.execute('get_scrape_pages');\n  const checkboxes = document.querySelectorAll('input[w-el=\"scrape-list-checkbox\"], input[w-el=\"scrape-list-checkbox-wildcard\"]');\n  checkboxes.forEach(checkbox => {\n      checkbox.checked = false;\n  });\n  document.querySelector('[w-el=\"scrape-addurl-controls\"]').style.display = 'flex';\n  lastChecked = null;\n  await Wized.requests.waitFor(\"get_scrape_pages\");\n  urlForm.style.display = \"flex\";\n\n} else if (activeType === 'api') {\n  apiForm.style.display = 'flex';\n\n  // headers, properties lists\n  var activedataSource = r.get_datasources.data.find(item => item.id === v.active_datasource);\n  v.apiPropertiesArrayII = activedataSource.datasource_type_config.properties;\n\n  var activedataSource = r.get_datasources.data.find(item => item.id === v.active_datasource);\n  var headersObject = activedataSource.datasource_type_config.headers;\n\n  var headersArray = Object.keys(headersObject).map(key => {\n    return { key: key, value: headersObject[key] };\n  });\n\n  v.apiHeadersArray = headersArray;\n  // multi-select boxes\n\n  // datasource_type_config.method\n  const checkboxesApi = document.querySelectorAll(\"[multi-select='api_method']\");\n  var hiddenInputMethod = document.querySelector(\"[multi-select-input='api_method']\");\n\n  var dbValue = r.get_datasources.data.find(item => item.id === v.active_datasource).datasource_type_config.method;\n\n  checkboxesApi.forEach(function (checkbox) {\n    if (checkbox.getAttribute('data-value') === dbValue) {\n      checkbox.classList.add('selected');\n    }\n    hiddenInputMethod.value = dbValue;\n    $('[w-el=\"api-form-active-method\"]').text(dbValue);\n  });\n\n  checkboxesApi.forEach(function (checkbox) {\n    checkbox.addEventListener('click', function () {\n      checkboxesApi.forEach(function (option) {\n        option.classList.remove('selected');\n      });\n      checkbox.classList.add('selected');\n\n      var newValueCheckboxMethod = checkbox.getAttribute('data-value');\n      hiddenInputMethod.value = newValueCheckboxMethod;\n      $('[w-el=\"api-form-active-method\"]').text(newValueCheckboxMethod);\n    });\n  });\n\n  //\n\n  // datasource_type_config.protocol\n  const checkboxesProtocol = document.querySelectorAll('[multi-select=\"api_authprotocol\"]');\n  var hiddenInputProtocol = document.querySelector('[multi-select-input=\"api_authprotocol\"]');\n\n  var dbValue = r.get_datasources.data.find(item => item.id === v.active_datasource).datasource_type_config.protocol;\n\n  checkboxesProtocol.forEach(function (checkbox) {\n    if (checkbox.getAttribute('data-value') === dbValue) {\n      checkbox.classList.add('selected');\n    }\n    hiddenInputProtocol.value = dbValue;\n    i['input-api_authprotocol'] = dbValue;\n    $('[w-el=\"api-form-active-authprotocol\"]').text(dbValue);\n  });\n\n  checkboxesProtocol.forEach(function (checkbox) {\n    checkbox.addEventListener('click', function () {\n      checkboxesProtocol.forEach(function (option) {\n        option.classList.remove('selected');\n      });\n      checkbox.classList.add('selected');\n\n      var newValueProtocol = checkbox.getAttribute('data-value');\n      hiddenInputProtocol.value = newValueProtocol;\n      i['input-api_authprotocol'] = newValueProtocol;\n      $('[w-el=\"api-form-active-authprotocol\"]').text(newValueProtocol);\n    });\n  });\n\n  //\n\n  // datasource_type_config.bodyType\n  const checkboxesBodytype = document.querySelectorAll(\"[multi-select='api_body_type']\");\n  var hiddenInputBodytype = document.querySelector(\"[multi-select-input='api_body_type']\");\n\n  var dbValue = r.get_datasources.data.find(item => item.id === v.active_datasource).datasource_type_config.bodyType;\n\n  checkboxesBodytype.forEach(function (checkbox) {\n    if (checkbox.getAttribute('data-value') === dbValue) {\n      checkbox.classList.add('selected');\n    }\n    hiddenInputBodytype.value = dbValue;\n    i['input-api_body_type'] = dbValue;\n    $('[w-el=\"api-form-active-bodytype\"]').text(dbValue);\n  });\n\n  checkboxesBodytype.forEach(function (checkbox) {\n    checkbox.addEventListener('click', function () {\n      checkboxesBodytype.forEach(function (option) {\n        option.classList.remove('selected');\n      });\n      checkbox.classList.add('selected');\n\n      var newValueBodyType = checkbox.getAttribute('data-value');\n      hiddenInputBodytype.value = newValueBodyType;\n      i['input-api_body_type'] = newValueBodyType;\n      $('[w-el=\"api-form-active-bodytype\"]').text(newValueBodyType);\n    });\n  });\n\n  // text-editor\n  // outputScheme code-editor\n\n  let textarea = document.getElementById('code-editor');\n  let codeMirrorInstance;\n  let validModal = document.querySelector(\"[w-el='modal-valid-json']\");\n  let invalidModal = document.querySelector(\"[w-el='modal-invalid-json']\");\n\n  function isValidJsonObject(value) {\n    try {\n      const parsed = JSON.parse(value);\n      return !!parsed && typeof parsed === 'object' && !Array.isArray(parsed);\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function objectIsValid() {\n    validModal.style.display = 'flex';\n    invalidModal.style.display = 'none';\n    v.outputSchemaObjectIsValid = true;\n  }\n\n  function objectIsInvalid() {\n    validModal.style.display = 'none';\n    invalidModal.style.display = 'flex';\n    v.outputSchemaObjectIsValid = false;\n  }\n\n  function programmaticallySetValue(value, textarea, codeMirrorInstance) {\n    if (v.codemirrorInitialized == false) {\n      codeMirrorInstance = CodeMirror.fromTextArea(textarea, {\n        mode: 'application/json',\n        theme: 'dracula',\n        lineNumbers: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        indentUnit: 2,\n        tabSize: 2,\n        gutters: ['CodeMirror-lint-markers'],\n        lint: {\n          lintOnChange: true,\n          tooltips: false\n        }\n      });\n\n      // input event listener\n      codeMirrorInstance.on('change', function (cm, change) {\n        inputEventValue = cm.getValue();\n        // console.log(\"Content changed:\", cm.getValue());\n        if (isValidJsonObject(inputEventValue)) {\n          objectIsValid();\n        } else {\n          objectIsInvalid();\n        }\n      });\n    }\n\n    textarea.value = value;\n    if (v.codemirrorInitialized == false) {\n      codeMirrorInstance.setValue(value);\n      if (isValidJsonObject(value)) {\n        objectIsValid();\n      } else {\n        objectIsInvalid();\n      }\n    }\n    v.codemirrorInitialized = true;\n  }\n\n  const activeDatasource = r.get_datasources.data.find(item => item.id === v.active_datasource).datasource_type_config;\n  const rawValue = activeDatasource.outputSchema;\n  const value = JSON.parse(rawValue);\n  // console.log(value);\n\n  if (activeDatasource.outputformatting_enabled == true) {\n    programmaticallySetValue(value, textarea, codeMirrorInstance);\n  }\n\n  //\n}\n"
        }
      ]
    },
    {
      name: "sharing - 'toevoegen' button",
      attributes: [{ name: 'add-datasource-access-btn' }],
      id: '4a92a3cd-cbbd-48e2-addf-75f574b92593',
      type: 'element',
      actions: [
        { value: 'return (v.datasource_sharing_selected !== null)', setting: 'visibility' },
        {
          function:
            'Wized.requests.execute("create_chatbots_datasources_join");\nawait Wized.requests.waitFor("create_chatbots_datasources_join");\n\nv.datasource_sharing_selected = null;\n\nWized.requests.execute("get_chatbots_datasources_joins");',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: 'b19e3643-8ab2-44df-b648-b38f323cc6e9'
    },
    {
      name: '3e. link_preview - image',
      attributes: [{ name: 'link_preview-img' }],
      id: '4ae1a217-c01c-4ebd-8774-b748858b192b',
      type: 'element',
      actions: [
        {
          value:
            'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.image\n\n}',
          key: 'src',
          setting: 'attribute'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'chat has_unread indicator',
      attributes: [{ name: 'chats-list-item-hasunread' }],
      id: '4b2142d6-2194-4ab4-b089-b27277391f95',
      type: 'element',
      actions: [{ value: 'return v.chats[v.i].has_unread', setting: 'visibility' }],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'settings form handling - beveiliging',
      attributes: [{ name: 'form-settings-beveiliging' }],
      id: '4be1434a-8f57-4bc9-ac27-de310ed71f03',
      type: 'element',
      actions: [
        { value: 'return {\n  moderation_prompt: r.get_chatbot.data.input_moderation.prompt,\n  moderation_fallback: r.get_chatbot.data.input_moderation.fallback_message\n}', setting: 'form' },
        { request: '392c5e72-c99b-4a39-965f-d40c74befce7', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' }
      ],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      name: 'set chatbot title',
      attributes: [{ name: 'chatbot-list-item-name' }],
      id: '4d794c4e-faa7-49f4-bb42-f898f5d5e298',
      type: 'element',
      actions: [{ type: 'text', value: '// return v.chatbots[v.i].name\nreturn r.get_chatbots.data[v.i].name', setting: 'text' }],
      folderId: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca'
    },
    {
      name: 'Set active chatbot title [DEPR?]',
      attributes: [{ name: 'dropdown-active-chatbot-name' }],
      id: '4edee48b-dfaf-4645-b8b6-c03f3fe42341',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).name', setting: 'text' }],
      folderId: '206c14ea-c3ef-4b95-bdd4-2150463e4999'
    },
    {
      name: 'active chat timestamp - date',
      attributes: [{ name: 'active-chat-inbox-date' }],
      id: '4eed7c3f-bf5f-4bac-81a4-62b17f6b8329',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            "const date = new Date(v.chats.find(chat => chat.id === v.active_chat).created_at);\nconst day = date.getDate().toString().padStart(2, '0');\nconst month = (date.getMonth() + 1).toString().padStart(2, '0');\nconst year = date.getFullYear();\nreturn `${day}-${month}${year !== new Date().getFullYear() ? `-${year}` : ''}`;\n",
          setting: 'text'
        }
      ],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      name: 'set chat label - archive',
      attributes: [{ name: 'archive-label' }],
      id: '4f0f034d-828b-4ffe-9410-a7383c3b7c32',
      type: 'element',
      actions: [{ value: 'return (\n  (v.chats[v.i].archived == true)\n);\n', setting: 'visibility' }],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'api - render headers list',
      attributes: [{ name: 'api-headers-list-item' }],
      id: '4f8dc25b-b31b-4c5a-be77-d1303f90eacb',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.apiHeadersArray', setting: 'list' },
        { value: 'return v.apiHeadersArray[v.i].index', key: 'index', setting: 'attribute' },
        {
          function:
            "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"api-headers-list-item-delete-btn\"]');\n\ncloseButton.style.display = 'flex';\nsetTimeout(() => {\n  closeButton.style.opacity = '1';\ncloseButton.style.transform = 'translateY(0)';\n}, 1);\n",
          action: 'run-function',
          event: 'mouseenter',
          setting: 'on-event'
        },
        {
          function:
            "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"api-headers-list-item-delete-btn\"]');\ncloseButton.style.transform = 'translateY(3px)';\ncloseButton.style.opacity = '0';\nsetTimeout(() => {\n  closeButton.style.display = 'none';\n}, 200);",
          action: 'run-function',
          event: 'mouseleave',
          setting: 'on-event'
        }
      ],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'filters - chatbots - set img',
      attributes: [{ name: 'filter-chatbots-img' }],
      id: '4feb8eb6-0c65-4897-abf8-579217c6a486',
      type: 'element',
      actions: [
        {
          value:
            'if (r.get_chatbots.data[v.i].avatar_url) {\n  return r.get_chatbots.data[v.i].avatar_url\n} else {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\n}',
          key: 'src',
          setting: 'attribute'
        }
      ],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      name: 'set chatbot list avatar',
      attributes: [{ name: 'chatbots-dropdown-list-item-avatar' }],
      id: '509b40ef-efd3-477d-ae85-5e4189ec803c',
      type: 'element',
      actions: [
        { value: 'return r.get_chatbots.data[v.i].avatar_url', key: 'src', setting: 'attribute' },
        { value: 'return (r.get_chatbots.data[v.i].avatar_url !== "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png")', setting: 'visibility' }
      ],
      folderId: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca'
    },
    {
      name: 'Set KB list item created at',
      attributes: [{ name: 'kb-artikel-datum' }],
      id: '50a09084-650e-49b6-ad43-8a92ac40ed7a',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            "const rawDate = v.filteredKbList[v.i].created_at;\nconst date = new Date(rawDate);\nconst month = date.toLocaleDateString('nl-NL', { month: 'long' }).substring(0, 3);\nconst day = date.getDate();\nconst formattedDate = `${day} ${month}`;\nreturn formattedDate;",
          setting: 'text'
        }
      ],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      name: 'empty state - kennisbank',
      attributes: [{ name: 'emptystate-kennisbank' }],
      id: '50ec39b5-7a46-4985-8075-56197ccaddd8',
      type: 'element',
      actions: [
        {
          value:
            'const searchQuery = i["kennisbank-search-input"];\n\nif (searchQuery) {\n  return false\n} else if (\n  r.get_datasources.data.find((item) => item.id === v.active_datasource)\n    .data_type == "pdf"\n) {\n  if (\n    r.get_datasources.data.find((item) => item.id === v.active_datasource)\n      .kb_topics.length == 0\n  ) {\n    return true;\n  } else {\n    return false;\n  }\n} else {\n  return false;\n}\n',
          setting: 'visibility'
        }
      ],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      name: 'create chatbot',
      attributes: [{ name: 'form-create-chatbot' }],
      id: '54574645-e6d0-440e-a8ac-f2cafd25d8a2',
      type: 'element',
      actions: [
        {
          condition:
            'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nif (maxChatbots !== null) {\n  if (chatbots.length < maxChatbots) {\n    return true\n  } else {\n    return false\n  }\n} else {\n  if (organization.subscription_plan && organization.subscription_plan.includes("expert")) {\n    if (chatbots.length < 3) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    if (chatbots.length < 1) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n}',
          function:
            "Wized.requests.execute('create_chatbot');\n\n// element visibility\nconst createChatbotModal = document.getElementById('popup-create-chatbot');\n\nawait Wized.requests.waitFor('create_chatbot');\nWized.requests.execute('get_chatbots');\n\n// data logic\n\nv.active_chatbot = r.create_chatbot.data.id\n\nif (n.path !== \"/chatbot\") {\n  n.path = \"/chatbot?tn=cc\"\n} else {\n  createChatbotModal.style.display = \"none\";\n  var form = document.querySelector(\"[w-el='form-create-chatbot']\"); // Replace 'myForm' with your form's ID\n  var inputs = form.querySelectorAll('input');\n  inputs.forEach(function(input) {\n  input.value = '';\n});\n}\n",
          action: 'run-function',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        },
        {
          condition:
            'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nif (maxChatbots !== null) {\n  if (chatbots.length < maxChatbots) {\n    return false\n  } else {\n    return true\n  }\n} else {\n  if (organization.subscription_plan && organization.subscription_plan.includes("expert")) {\n    if (chatbots.length < 3) {\n      return false;\n    } else {\n      return true;\n    }\n  } else {\n    if (chatbots.length < 1) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n}',
          function:
            'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nif (maxChatbots !== null) {\n  if (chatbots.length < maxChatbots) {\n  } else {\n    document.querySelector(\'[w-el="popup-create-chatbot"]\').style.display = "none";\n    window.showToastNotification(`Bij je huidige pakket zijn maximaal ${maxChatbots} chatbots inbegrepen`, "warning");\n  }\n} else {\n  if (organization.subscription_plan && organization.subscription_plan.includes("expert")) {\n    if (chatbots.length < 3) {\n    } else {\n      document.querySelector(\'[w-el="popup-create-chatbot"]\').style.display = "none";\n      window.showToastNotification("Bij je huidige pakket zijn maximaal 3 chatbots inbegrepen", "warning");\n    }\n  } else {\n    if (chatbots.length < 1) {\n    } else {\n      document.querySelector(\'[w-el="popup-create-chatbot"]\').style.display = "none";\n      window.showToastNotification("Bij je huidige pakket is maximaal 1 chatbot inbegrepen", "warning");\n    }\n  }\n}',
          action: 'run-function',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c'
    },
    {
      name: 'Active data source elements - set name (copy)',
      attributes: [{ name: 'active-datasource-list-item-name' }],
      id: '559de423-31aa-4ff6-a9cd-6f02d19e274f',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_datasources.data.find(item => item.id === v.active_datasource).name\n', setting: 'text' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'chime visibility mobile',
      attributes: [{ name: 'chime-visibility-mobile' }],
      id: '586322cb-2772-4e2a-a04c-9193129f16a8',
      type: 'element',
      actions: [{ style: 'display', value: 'if ( i.toggle_popup_enabled_mobile == true) {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      name: 'active chat chatbot image',
      attributes: [{ name: 'active-chat-inbox-chatbot-image' }],
      id: '58aa933f-f253-4ffb-b50b-bfd1ead2ea9c',
      type: 'element',
      actions: [
        {
          value:
            '// if (v.chats.find((chat) => chat.id === v.active_chat).chatbots.avatar_url) {\n//   return v.chats.find((chat) => chat.id === v.active_chat).chatbots.avatar_url;\n// } else {\n//   return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n// }\n\nreturn r.get_chatbots.data.find((item) => item.id === v.chats.find((chat) => chat.id === v.active_chat).chatbot_id).avatar_url',
          key: 'src',
          setting: 'attribute'
        }
      ],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      name: 'set chat label - mail',
      attributes: [{ name: 'mail-label' }],
      id: '5aed6096-3625-4027-8eb6-5ec1b0c70f1b',
      type: 'element',
      actions: [
        {
          value: "return (\n  (v.chats[v.i].enduser_email !== null && v.chats[v.i].enduser_email !== '') ||\n  (v.chats[v.i].chat_user_email !== null && v.chats[v.i].chat_user_email !== '')\n);\n",
          setting: 'visibility'
        }
      ],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'create-portal visibility',
      attributes: [{ name: 'create-portal' }, { name: 'review-button' }],
      id: '5b5d515e-ccbe-4203-a1aa-04d65f441193',
      type: 'element',
      actions: [{ value: 'return (r.get_user_data.data[0].organizations[0].subscription_status == "active")', setting: 'visibility' }],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'filters- chatbots - active list',
      attributes: [{ name: 'filter-chatbots-active-image' }],
      id: '5c06bddb-a19a-4968-b435-1b5656a013aa',
      type: 'element',
      actions: [{ indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.inboxFilterChatbots', setting: 'list' }],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      name: 'api - render properties list',
      attributes: [{ name: 'api-properties-list-item' }],
      id: '5c4f3a9a-653d-4737-b8de-1e32a8ba2cae',
      type: 'element',
      actions: [
        { indexVariable: 'b754b06d-70b9-42de-81b3-0484243d1c91', value: 'return v.apiPropertiesArrayII', setting: 'list' },
        { value: 'return v.apiPropertiesArrayII[v.iII].index', key: 'index', setting: 'attribute' },
        {
          function:
            "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"api-properties-list-item-delete-btn\"]');\n\ncloseButton.style.display = 'flex';\nsetTimeout(() => {\n  closeButton.style.opacity = '1';\ncloseButton.style.transform = 'translateY(0)';\n}, 1);\n",
          action: 'run-function',
          event: 'mouseenter',
          setting: 'on-event'
        },
        {
          function:
            "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"api-properties-list-item-delete-btn\"]');\ncloseButton.style.transform = 'translateY(3px)';\ncloseButton.style.opacity = '0';\nsetTimeout(() => {\n  closeButton.style.display = 'none';\n}, 200);",
          action: 'run-function',
          event: 'mouseleave',
          setting: 'on-event'
        }
      ],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'load more event listener (copy)',
      attributes: [{ name: 'chats-list-container' }],
      id: '5c9cf002-835c-44ec-bb29-9ec33ee03e65',
      type: 'element',
      actions: [
        {
          request: '2b0b056c-0433-40b4-b023-013a58dd4123',
          condition:
            '// console.log("scroll");\nvar scrollBox = document.querySelector(\'[w-el="chats-list-container"]\');\n\nconst chatItems = document.querySelectorAll(".chat-list-item");\n\nconst isAtBottom = scrollBox.scrollHeight - scrollBox.scrollTop === scrollBox.clientHeight;\nreturn (isAtBottom)',
          action: 'perform-request',
          event: 'scroll',
          hasCondition: true,
          setting: 'on-event'
        }
      ],
      folderId: '99a16fdd-65fc-4ba5-9c99-4847a2473e67'
    },
    {
      name: 'gtm notice visibility',
      attributes: [{ name: 'gtm-notice' }],
      id: '5d1ce544-16df-464c-89e9-dd7845046d7f',
      type: 'element',
      actions: [{ value: 'if (i["installation-script-toggle"] == true) {\n  return true\n} else {\n  return false\n}', setting: 'visibility' }],
      folderId: 'f8158d09-0ac8-4653-9ebe-dba0b72a2b38'
    },
    {
      name: 'filters - chatbots - render list',
      attributes: [{ name: 'filter-chatbots-list-item' }],
      id: '5d9734ce-f7e1-4573-93b6-76b26bfc45c2',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return r.get_chatbots.data', setting: 'list' },
        { value: 'return r.get_chatbots.data[v.i].id', key: 'id', setting: 'attribute' },
        {
          function:
            'const targetId = event.currentTarget.getAttribute("id");\nconsole.log(targetId);\n\nif (v.inboxFilterChatbots.includes(targetId)) {\n\n  v.inboxFilterChatbots = v.inboxFilterChatbots.filter(item => item !== targetId);\n} else {\n\n  v.inboxFilterChatbots.push(targetId);\n}\n',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        },
        { condition: 'return (v.inboxFilterChatbots.includes(r.get_chatbots.data[v.i].id))', class: 'active', setting: 'class' }
      ],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      name: 'set chatbot list status label indicator - cocept',
      attributes: [{ name: 'active-chatbot-status-label-concept' }],
      id: '5ee99b74-095d-4c2c-be23-21a23cc06c3f',
      type: 'element',
      actions: [{ value: 'return (r.get_chatbots.data.find((item) => item.id === v.active_chatbot).publishing.published == false)', setting: 'visibility' }],
      folderId: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca'
    },
    {
      name: 'filters - chatbots - apply',
      attributes: [{ name: 'filter-apply' }],
      id: '5ef09c5f-cdd2-4a42-9ab2-804cd8ada9b5',
      type: 'element',
      actions: [
        { request: 'fefe687b-b6dd-4efc-af07-f5b4c1810457', action: 'perform-request', event: 'click', preventDefault: true, setting: 'on-event' },
        {
          function:
            'v.loadmorechats = [];\nv.usedFilters = true;\n\nconst dropdownModals = document.querySelectorAll(\'[w-el="filters-dropdown"]\');\n\ndropdownModals.forEach(function(modal) {\n    modal.style.display = "none";\n});\n\nconst filterbar = document.querySelector("[w-el=\'inbox-subheader-activefilters\']");\nif (v.inboxFilterLabel == "archived") {\n    filterbar.style.display = "flex";\n} else if (v.inboxFilterStatus == "escalated" || v.inboxFilterStatus == "livechat") {\n    filterbar.style.display = "flex";\n} else if (v.inboxFilterLabel == "open" && v.inboxFilterStatus == "all" ) {\n    filterbar.style.display = "none";\n}',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      condition: "return (n.path == '/')",
      name: 'get meter summary on page load',
      id: '5fab3acd-4bcc-4834-9431-8a3a8c858a5d',
      trigger: 'after-request',
      after: [
        {
          condition: 'return !!(r.get_user_data?.data?.[0]?.organizations?.[0]?.subscriptions?.find((sub) => sub.subscription_type == "meter")) ?? false;',
          function:
            "Wized.requests.execute('get_meter_summary');\nawait Wized.requests.waitFor('get_meter_summary');\n\nif (r.get_meter_summary.data.data[0]) {\n  document.querySelector('[w-el=\"analytics-meter-summary\"]').innerHTML = r.get_meter_summary.data.data[0].aggregated_value;\n\n  const rawBillingperiod = r.get_meter_summary.data.data[0].start_time;\n\n  let billingPeriod = new Date(rawBillingperiod * 1000);\n\n  const months = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\n\n  let month = months[billingPeriod.getMonth()];\n\n  const periodValue = 'Periode vanaf ' + billingPeriod.getDate() + ' ' + month;\n  document.querySelector('[w-el=\"analytics-billingperiod\"]').innerHTML = periodValue;\n}",
          action: 'run-function',
          hasCondition: true
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      id: '5qVjN7Ndbn3LVMdTolq1',
      name: 'datasource-list-item-indicator-shared',
      folderId: 'hiARdgSU6l4YoqRL86jN',
      type: 'element',
      attributes: [{ name: 'datasource-list-item-indicator-shared' }],
      actions: [
        {
          setting: 'style',
          style: 'background-color',
          value:
            'if (v.datasourceSharingNavbarList[v.i].status == "draft") {\n  return "#e7b549"\n} else if (v.datasourceSharingNavbarList[v.i].status == "active") {\n  return "#25d366"\n} else if (v.datasourceSharingNavbarList[v.i].status == "inactive") {\n  return "#F37A80"\n}\n'
        }
      ]
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      name: 'get [chats & [DEPR]] agents',
      trigger: 'after-request',
      after: [{ request: 'ac8cdd98-98da-45f1-9556-6e3e1cd38837', condition: "return (n.path.includes('/chat-inbox'))", action: 'perform-request', hasCondition: true }],
      id: '602ad772-2011-4a25-bb1d-b0adcee524e9',
      type: 'event',
      folderId: '99a16fdd-65fc-4ba5-9c99-4847a2473e67'
    },
    {
      name: 'handoff notice visibility',
      attributes: [{ name: 'notice-handoff-external' }],
      id: '635431e5-3edf-45ea-8489-5ead0119b1e1',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i["input-handoff-external"] == "escalation") {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      name: 'scrape visible count',
      attributes: [{ name: 'scrape-urls-visible' }],
      id: '63lN9u1Ucof2TJ9gkpRw',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'const totalPages = v.scrapetool_urls_list.length\nconst filteredPages = v.scrapetool_urls_list_filtered.length\n\nconst amountVisiblePages = i["scrape-pagination-itemsperpage"]; // Get the number of items per page\n\nif (amountVisiblePages == 20) {\n  if (filteredPages >= 20){\n    return 20\n  } else {\n    return filteredPages\n  };  \n} else {\n  return filteredPages; \n}',
          setting: 'text'
        }
      ],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'create portal session',
      attributes: [{ name: 'create-portal' }],
      id: '66af33e0-c9b5-4688-9ba1-d756afa742bf',
      type: 'element',
      actions: [{ function: 'Wized.requests.execute("create_portal_session");', action: 'run-function', event: 'click', setting: 'on-event' }],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'settings form handling - widget',
      attributes: [{ name: 'form-settings-widget' }],
      id: '6825a9a3-3f44-4d2a-811e-d7b87fa84813',
      type: 'element',
      actions: [
        {
          value:
            "inputValue = r.get_chatbot.data.primary_color;\n\nif (inputValue.charAt(0) === '#') {\n  primaryColor = inputValue.slice(1);\n} else {\n  primaryColor = inputValue;\n}\n\nreturn {\n  primary_color: primaryColor,\n\n  offset_x_desktop: r.get_chatbot.data.btn_offset.x_desktop,\n  offset_y_desktop: r.get_chatbot.data.btn_offset.y_desktop,\n  offset_x_mobile: r.get_chatbot.data.btn_offset.x_mobile,\n  offset_y_mobile: r.get_chatbot.data.btn_offset.y_mobile,\n\n  toggle_popup_enabled_desktop: r.get_chatbot.data.popup.desktop,\n  toggle_popup_enabled_mobile: r.get_chatbot.data.popup.mobile, \n  popup_chime_desktop: r.get_chatbot.data.popup.chime.desktop,\n  popup_chime_mobile: r.get_chatbot.data.popup.chime.mobile,\n\n  widget_header: r.get_chatbot.data.widget_styling.widget_header,\n  user_message_primary_color: r.get_chatbot.data.widget_styling.user_message_primary_color,\n  widget_border: r.get_chatbot.data.widget_styling.widget_border,\n\n  ai_badge: r.get_chatbot.data.ai_badge\n}",
          setting: 'form'
        },
        { request: '0262a872-8cdd-451c-899b-c5d13661a54f', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' },
        {
          request: 'b90e0912-d43f-4620-95a8-6aceb6904847',
          condition: 'if (i["settigs-background-input"]["0"]) {\n  if (i["settigs-background-input"] == null) {\n    return false\n  } else {\n    return true\n  }\n} else {\n  return false\n}',
          action: 'perform-request',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        },
        {
          request: '4d999dbd-a786-4f0b-ae22-0b6e7fed3ab2',
          condition: '\n  if (i["settigs-background-input"] == null) {\n    return true\n  } else {\n    return false\n  }',
          action: 'perform-request',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      request: 'd2b868e4-84da-4910-a98d-781589052b49',
      condition: 'return (r.get_user.ok == true && n.path.includes("/kennis/"))',
      name: 'get chatbot datasources on page load',
      after: [{ request: '9d139b25-dc47-41e5-8bfd-f09ec49d71da', condition: 'return (v.active_chatbot !== null)', action: 'perform-request', hasCondition: true }],
      id: '68ae55e9-1c4d-4168-873f-e8cf2f4a1dd0',
      trigger: 'after-request',
      type: 'event',
      hasCondition: true,
      folderId: '55214649-2bac-4398-a861-03d94d2aad9d'
    },
    {
      name: 'filters - active filter label - escalated',
      attributes: [{ name: 'active-filter-label-escalated' }],
      id: '6945a848-f471-4eb1-b348-445bf6764d1a',
      type: 'element',
      actions: [{ value: 'return (v.inboxFilterStatus == "escalated")', setting: 'visibility' }],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      name: 'datasource sharing dropdown visibility',
      attributes: [{ name: 'dataource-sharing-dropdown-container' }],
      id: '6e7236d6-5c8f-4fc3-a153-a3df67e6809e',
      type: 'element',
      actions: [{ style: 'display', value: 'if (v.datasourceSharingChatbotsDropdown.length == 0) {\n return "none"\n} else {\n  return "flex"\n}', setting: 'style' }],
      folderId: 'b19e3643-8ab2-44df-b648-b38f323cc6e9'
    },
    {
      name: 'form handling - update kb topic',
      attributes: [{ name: 'form-edit-topic' }],
      id: '6ec53390-5bb0-442c-b257-25369f403122',
      type: 'element',
      actions: [
        {
          value:
            'return {\n  "name": r.get_datasources.data.find(item => item.id === v.active_datasource).kb_topics.find(item => item.id === v.active_kb_topic).name,\n  "content": r.get_datasources.data.find(item => item.id === v.active_datasource).kb_topics.find(item => item.id === v.active_kb_topic).content\n}',
          setting: 'form'
        },
        {
          function:
            'window.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  Wized.requests.execute("update_kb_topic");\n  await Wized.requests.waitFor("update_kb_topic");\n  Wized.requests.execute("get_datasources");\n\n  const modals = document.querySelectorAll(\'[popupmodal]\');\n  modals.forEach((modal) => {\n    modal.style.display = "none";\n  });\n\n})',
          action: 'run-function',
          event: 'submit',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      name: 'datasource sharing - active list - set chatbot website_url',
      attributes: [{ name: 'datasource-sharing-list-item-name-url' }],
      id: '6f856cee-c60f-4598-8928-02c42085b80f',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).website_url', setting: 'text' }],
      folderId: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679'
    },
    {
      name: 'datasource sharing - render dropdown list',
      attributes: [{ name: 'datasource-sharing-chatbot-list-item' }],
      id: '6fae305e-c23f-4e15-8f23-178ad1cec2d5',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: '// return v.chatbots\nreturn v.datasourceSharingChatbotsDropdown', setting: 'list' },
        { style: 'display', value: 'return "flex"', setting: 'style' },
        { value: 'return v.datasourceSharingChatbotsDropdown[v.i].id', key: 'data-value', setting: 'attribute' },
        { value: 'return v.datasourceSharingChatbotsDropdown[v.i].name', key: 'name', setting: 'attribute' },
        { function: 'const dataValue = event.currentTarget.getAttribute("data-value");\nv.datasource_sharing_selected = dataValue;', action: 'run-function', event: 'click', setting: 'on-event' }
      ],
      folderId: 'b19e3643-8ab2-44df-b648-b38f323cc6e9'
    },
    {
      name: 'set data_source content area csv preview - time',
      attributes: [{ name: 'datasource-csv-preview-timestamp-time' }],
      id: '6fbcecdd-5b6d-40f2-ad2c-15b40bcdb2dd',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.time;', setting: 'text' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      id: '70b912a3-51a8-4a7c-8615-fc24770c804e',
      name: 'Set active chatbot avatar',
      folderId: '206c14ea-c3ef-4b95-bdd4-2150463e4999',
      type: 'element',
      attributes: [{ name: 'dropdown-active-chatbot-avatar' }],
      actions: [
        { setting: 'attribute', key: 'src', value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).avatar_url\n' },
        {
          setting: 'visibility',
          value:
            'return (r.get_chatbots.data.find((item) => item.id === v.active_chatbot).avatar_url !== "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png")'
        }
      ]
    },
    {
      name: 'settings form handling - human handoff',
      attributes: [{ name: 'form-settings-humanhandff' }],
      id: '7137440a-de8b-4df7-875f-9ebe4e942aa7',
      type: 'element',
      actions: [
        {
          value:
            'function removePrefix(url) {\n  const formattedUrl = url.replace("https://", "");\n  return formattedUrl;\n}\n\nlet handoffEndpoint;\nif (r.get_chatbot.data.human_handoff.endpoint) {\n  handoffEndpoint = removePrefix(r.get_chatbot.data.human_handoff.endpoint);\n}\n\nreturn {\n  handoff_type: r.get_chatbot.data.human_handoff.type,\n  handoff_endpoint: handoffEndpoint,\n  handoff_trigger: r.get_chatbot.data.human_handoff.triggers[0],\n\n  handoff_prompt: r.get_chatbot.data.human_handoff.prompt,\n\n  handoff_fallback_before: r.get_chatbot.data.human_handoff.fallback_before,\n  handoff_fallback_after: r.get_chatbot.data.human_handoff.fallback_after,\n};',
          setting: 'form'
        },
        { request: '372875e4-b533-436f-ad8d-7e4dd5bf0a4f', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' }
      ],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      name: 'submit reset_password',
      attributes: [{ name: 'form-password-reset' }],
      id: '713faddf-50de-4da5-b9de-0b6091bc96b6',
      type: 'element',
      actions: [{ function: 'Wized.requests.execute("reset_password");', action: 'run-function', event: 'submit', setting: 'on-event' }],
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8'
    },
    {
      name: 'filters - status',
      attributes: [{ name: 'filter-status' }],
      id: '73187578-0b8c-44cb-8148-4478a0a698e1',
      type: 'element',
      actions: [
        {
          function:
            'const targetValue = event.currentTarget.getAttribute("filter-value");\n\nv.inboxFilterStatus = targetValue;\n\ndocument.querySelectorAll(\'[w-el="filter-status"]\').forEach((element) => {\n  element.classList.remove("active");\n});\n\nevent.currentTarget.classList.add("active");\n',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      name: 'datasource sharing - dropdown list - set chatbot name',
      attributes: [{ name: 'datasource-sharing-chatbot-list-item-name' }],
      id: '73afc280-ff09-4f55-8033-4df45010ec07',
      type: 'element',
      actions: [{ type: 'text', value: '// return v.chatbots[v.i].name\nreturn v.datasourceSharingChatbotsDropdown[v.i].name', setting: 'text' }],
      folderId: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679'
    },
    {
      name: 'pakketten visibility',
      attributes: [{ name: 'pakketten-btn' }, { name: 'trial-notice' }],
      id: '740d84bd-5cd3-4a50-bbc8-2952225bf4e8',
      type: 'element',
      actions: [{ style: 'display', value: 'if (r.get_user_data.data[0].organizations[0].subscription_status !== "active") {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'toast list | render list',
      attributes: [{ name: 'toast-notification' }],
      id: '74363de2-7691-4539-8d7f-81db0c76d9d0',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.toast_log', setting: 'list' },
        { value: 'return v.toast_log[v.i].id', key: 'toast_item_id', setting: 'attribute' }
      ],
      folderId: 'a4ad4e2f-834f-4b84-bb43-5fc23d252a62'
    },
    {
      name: 'active chat name',
      attributes: [{ name: 'active-chat-inbox-name' }],
      id: '744e9513-c4b7-4b1f-90a6-aead722d5242',
      type: 'element',
      actions: [{ type: 'text', value: 'return v.chats.find((chat) => chat.id === v.active_chat).name', setting: 'text' }],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      request: 'f17bfcd0-9a6f-482d-b7f9-ea4e263098b8',
      name: 'redirect to portal url',
      id: '75574973-6d2a-4c07-9e83-00b2b4138d06',
      trigger: 'after-request',
      after: [
        {
          condition: 'return (r.create_portal_session.data.checkout_url !== null)',
          action: 'navigate-to',
          hasCondition: true,
          url: 'return r.create_portal_session.data.portal_url',
          openInNewTab: true
        }
      ],
      type: 'event',
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      id: '7572a6b7-9052-43d5-8487-fd665e95e4dd',
      name: 'submit live chat form',
      folderId: '25fe132c-9171-46e3-b363-84ff68552eeb',
      type: 'element',
      attributes: [{ name: 'form-livechat' }],
      actions: [
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function:
            'v.livechatstatus = true;\n\ndocument.querySelector(\'[w-el="admin-ui-chat-input"]\').removeAttribute(\'readonly\');\n\nconst livechatModal = document.querySelector(\'[w-el="livechat-popup"]\');\nlivechatModal.style.display = "none";\n\nfunction changeOperator() {\n  Wized.requests.execute("update_chat_livechat");\n  Wized.requests.execute("create_message_operatorchanged");\n}\n\nif (i["agent-avatar-input"][0]["0"]) {\n  if (r.upsert_agent_avatar_file.ok) {\n    changeOperator();\n  } else {\n    Wized.requests.execute("upsert_agent_avatar_file");\n    \n    if (r.get_agents.data[0].name !== i["agents-list-item-name-input"][0]) {\n        v.active_agent.name = i["agents-list-item-name-input"][0];\n    }\n    \n    await Wized.requests.waitFor("upsert_agent_avatar_file");\n    v.active_agent.avatar = r.upsert_agent_avatar_file.data.publicUrl;\n\n    Wized.requests.execute("update_agent_avatar_file");\n    changeOperator();\n    \n    await Wized.requests.waitFor("update_agent_avatar_file");\n\n    // i["agent-avatar-input"][0]["0"] = null;\n    Wized.requests.execute("get_agents");\n  }\n} else {\n  if (r.get_agents.data[0].name !== i["agents-list-item-name-input"][0]) {\n    v.active_agent.name = i["agents-list-item-name-input"][0];\n    Wized.requests.execute("update_agent_avatar_file");\n\n    changeOperator();\n  } else {\n    changeOperator();\n  }\n}\n\n\nlet joinLivechatEvent = new CustomEvent(\'joinLivechat\', { detail: { message: \'Joining live chat\' } });\nwindow.dispatchEvent(joinLivechatEvent);\n'
        }
      ]
    },
    {
      name: 'skeleton loader | load more',
      attributes: [{ name: 'inbox-skeleton-wrapper' }],
      id: '761b1184-4afb-47f5-a480-307d2ee5c33d',
      type: 'element',
      actions: [{ value: 'return (r.get_chats_pagination.isRequesting == true)', setting: 'visibility' }],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      name: 'update data source form - CSV',
      attributes: [{ name: 'form-edit-csv' }],
      id: '78a8378b-1507-4232-9c35-d38eeb30c495',
      type: 'element',
      actions: [
        {
          value:
            'return {\n status: r.get_datasources.data.find(item => item.id === v.active_datasource).status,\n tool_description: r.get_datasources.data.find(item => item.id === v.active_datasource).tool_description\n}',
          setting: 'form'
        },
        {
          function: 'Wized.requests.execute("update_csv");\n\nawait Wized.requests.waitFor(\'update_csv\');\n\nWized.requests.execute("get_datasources");\n',
          action: 'run-function',
          event: 'submit',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee'
    },
    {
      id: '78b2ffcb-9638-4da2-9b65-bb726015c819',
      name: 'toast notifications handling',
      folderId: 'a4ad4e2f-834f-4b84-bb43-5fc23d252a62',
      type: 'event',
      trigger: 'page-complete',
      after: [
        {
          action: 'run-function',
          function:
            'Wized.on("request", (result) => {\n  if (result.ok == true) {\n    // console.log(result);\n    if (result.name === "create_kb_topic") {\n      window.showToastNotification("Artikel toegevoegd", "success");\n      console.log(result);\n    } else if (result.name === "update_kb_topic") {\n      window.showToastNotification("Artikel bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "delete_kb_topic") {\n      window.showToastNotification("Artikel verwijderd", "success");\n      console.log(result);\n    } else if (result.name === "create_organization") {\n      window.showToastNotification("Organisatie aangemaakt", "success");\n      console.log(result);\n    } else if (result.name === "create_chatbot") {\n      if (n.path.includes("/kennis/databronnen")) {\n        window.showToastNotification("Chatbot aangemaakt", "success");\n        console.log(result);\n      }\n    } else if (result.name === "delete_chatbot") {\n      v.active_chatbot = null;\n      n.path = "/?tn=dc";\n      console.log(result);\n    } else if (result.name === "update_chatbot") {\n      window.showToastNotification("Chatbot bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "update_chatbot_prompt") {\n      window.showToastNotification("Prompt opgeslagen", "success");\n      console.log(result);\n    } else if (result.name === "create_pdf") {\n      window.showToastNotification("Kennisbank aangemaakt", "success");\n      console.log(result);\n    } else if (result.name === "create_pdf2") {\n      window.showToastNotification("PDF databron aangemaakt", "success");\n      console.log(result);\n    } else if (result.name === "create csv") {\n      window.showToastNotification("CSV databron aangemaakt", "success");\n      console.log(result);\n    } else if (result.name === "create_url") {\n      window.showToastNotification("URL toegevoegd", "success");\n      console.log(result);\n    } else if (result.name === "create_api") {\n      window.showToastNotification("API toegevoegd", "success");\n      console.log(result);\n    } else if (result.name === "update_pdf" || result.name === "update_kb") {\n      window.showToastNotification("Kennisbank databron  bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "update_csv") {\n      window.showToastNotification("CSV databron bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "update_url") {\n      window.showToastNotification("Website databron bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "update_api") {\n      window.showToastNotification("API databron bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "delete_datasource") {\n      window.showToastNotification("Databron verwijderd", "success");\n      console.log(result);\n    } else if (result.name === "update_chat_livechat") {\n      if (result.data.livechat === true) {\n        console.log(result);\n        window.showToastNotification("Livechat overgenomen", "success");\n      } else if (result.data.livechat === false) {\n        console.log(result);\n        window.showToastNotification("Livechat verlaten", "success");\n      }\n    } else if (result.name.includes("update_chatbot_settings")) {\n      window.showToastNotification("Chatbot instellingen opgeslagen", "success");\n      console.log(result);\n    } else if (result.name.includes("update_chatbot_integrations")) {\n      window.showToastNotification("Integratie instellingen opgeslagen", "success");\n      console.log(result);\n    } else if (result.name.includes("update_agent_avatar_file")) {\n      window.showToastNotification("Medewerker ge-update", "success");\n      console.log(result);\n    } else if (result.name == "delete_chat") {\n      window.showToastNotification("Chat verwijderd", "success");\n      console.log(result);\n    } else if (result.name == "update_chat_archive") {\n      if (result.data.archived == true) {\n        window.showToastNotification("Chat gearchiveerd", "success");\n      } else if (result.data.archived == false) {\n        window.showToastNotification("Chat uit archief gehaald", "success");\n      }\n    } else if (result.name == "update_user_notifications") {\n      if (result.data.inbox_notifications_enabled == true) {\n        window.showToastNotification("Inbox meldingen ingeschakeld", "success");\n      } else if (result.data.inbox_notifications_enabled == false) {\n        window.showToastNotification("Inbox meldingen uitgeschakeld", "success");\n      }\n      console.log(result);\n    } else if (result.name == "delete_chatbots_datasources_join") {\n      window.showToastNotification("Toegang ingetrokken", "success");\n      console.log(result);\n    } else if (result.name == "create_chatbots_datasources_join") {\n      window.showToastNotification("Toegang gegeven", "success");\n      console.log(result);\n    } else if (result.name === "update_password") {\n      window.showToastNotification("Wachtwoord gereset", "success");\n      console.log(result);\n      n.path = "/";\n      // n.path = "/";\n    } else if (result.name === "reset_password") {\n      window.showToastNotification("Wachtwoord herstel email gestuurd", "success");\n      console.log(result);\n    } else {\n      // console.log(result.name);\n    }\n  } else {\n    if (result.name === "get_user") {\n      console.log(result);\n    } else if (result.name === "auth_user") {\n      if (result.data.error === "Invalid login credentials") {\n        window.showToastNotification("Ongeldig wachtwoord", "error");\n      }\n    } else if (result.name == "create_user") {\n      if (result.data.error == "User already registered") {\n        window.showToastNotification(\n          "Er bestaat al een gebruiker met dit E-mailadres",\n          "error"\n        );\n      }\n    } else if (result.name == "update_password") {\n      if (result.data.error == "New password should be different from the old password") {\n        window.showToastNotification(\n          "Nieuwe wachtwoord moet anders zijn dan het huidige wachtoord",\n          "error"\n        );\n      }\n    } else {\n      window.showToastNotification(\n        "Er is iets misgegaan. Neem contact op met de Sleak admin voor hulp.",\n        "error"\n      );\n      console.log("error:", result);\n    }\n  }\n});\n'
        }
      ]
    },
    {
      name: 'emptystate-scrapelist visibility',
      attributes: [{ name: 'emptystate-scrapelist' }],
      id: '7Ymqg779o8TADk6adLnq',
      type: 'element',
      actions: [{ value: 'return (v.scrapetool_urls_list_filtered.length == 0)', setting: 'visibility' }],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'crawled_urls list checkboxes',
      attributes: [{ name: 'scrape-list-checkbox' }],
      id: '7YnCoyR4GbKkJeivBCVT',
      type: 'element',
      actions: [{ value: 'return `scrape-page-` + v.i\n', key: 'id', setting: 'attribute' }],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'api - body visibility',
      attributes: [{ name: 'api-requestbody-visibility' }],
      id: '7a9c4ee7-3268-44b1-9524-f4e1f6071473',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i["input-api_body_type"] == "json") {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'set chatbot list initials',
      attributes: [{ name: 'chatbots-dropdown-list-item-initials' }],
      id: '7c50db7b-17e1-42e5-9bcd-e4fbc9ade691',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data[v.i].name.charAt(0);', setting: 'text' }],
      folderId: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca'
    },
    {
      id: '7cf4ea40-a1a3-4df6-9772-795d993d82ec',
      name: 'disable livechat - input',
      folderId: '25fe132c-9171-46e3-b363-84ff68552eeb',
      type: 'element',
      attributes: [{ name: 'admin-ui-chat-input' }],
      actions: [{ setting: 'style', style: 'pointer-events', value: 'if (v.chats.find((chat) => chat.id === v.active_chat).livechat == false) {\n  return "none"\n} else {\n  return "auto"\n}' }]
    },
    {
      name: 'set chat avatar',
      attributes: [{ name: 'chat-list-item-avatar' }],
      id: '7e7fb247-3a02-42a9-bac9-28243158d2b1',
      type: 'element',
      actions: [{ style: 'background-image', value: "const image = v.chats[v.i].avatar;\nreturn `url('${image}')`", setting: 'style' }],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'channels visibility - whatsapp',
      attributes: [{ name: 'visibility_toggle_channels_whatsapp' }],
      id: '7f9cbf1b-104a-42eb-9190-7629d5fff964',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i.toggle_channels_whatsapp == true) {\n  return "block"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      id: '82eN8E89huAFsxW2crpM',
      name: 'datasources RT sub',
      type: 'event',
      trigger: 'after-request',
      request: '9d139b25-dc47-41e5-8bfd-f09ec49d71da',
      after: [
        {
          action: 'run-function',
          function:
            "// after get_datasources on /kennis/databronnen\n\nasync function realtimeInit() {\n  let supaClient;\n\n  const { version, client } = await Wized.requests.getClient('supabase');\n\n  supaClient = client;\n\n  // get datasource ids\n  const idsArray = r.get_datasources.data.map(item => item.id);\n  const formattedIds = `in.(${idsArray.join(', ')})`;\n\n  const userId = r.get_user.data.user.id;\n\n  supaClient\n    .channel('adminUiDatasources_' + userId)\n\n    .on(\n      'postgres_changes',\n      {\n        event: 'UPDATE',\n        schema: 'public',\n        table: 'data_sources',\n        filter: `id=${formattedIds}`\n      },\n      payload => {\n        if (payload.new.data_type == 'csv' || payload.new.data_type == 'pdf2') {\n          console.log('realtime update: ', payload);\n          const updatedDatasource = r.get_datasources.data.find(item => item.id === payload.new.id);\n\n          if (updatedDatasource) {\n            Object.assign(updatedDatasource, payload.new);\n            const status = payload.new.file_upload_status;\n            const oldStatus = payload.old.file_upload_status;\n            if (oldStatus !== status) {\n              if (status === 'success') {\n                window.showToastNotification('Bestand succesvol verwerkt', 'success');\n              } else if (status === 'failed') {\n                window.showToastNotification('Er is een fout opgetreden tijdens het verwerken.', 'error');\n              }\n            }\n          }\n        }\n      }\n    )\n\n    .subscribe(status => {\n      console.log('realtime status changed: ', status);\n    });\n}\n\nrealtimeInit();\n",
          hasCondition: true,
          condition: "return (r.get_datasources.data.some(item => item.file_upload_status === 'processing'));"
        }
      ]
    },
    {
      name: 'filters - chatbots - set name',
      attributes: [{ name: 'filter-chatbots-name' }],
      id: '8362d914-3554-4c82-b8a1-d5d2930d9368',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data[v.i].name', setting: 'text' }],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      name: 'KB search bar visibility',
      attributes: [{ name: 'kennisbank-search-container' }],
      id: '8366617d-fc9f-4a4a-ab68-7c0109ee64c7',
      type: 'element',
      actions: [
        {
          style: 'display',
          value:
            'const searchQuery = i["kennisbank-search-input"];\n\nif (v.filteredKbList.length > 0) {\n  return "flex";\n} else if (!searchQuery.length == 0) {\n  return "flex";\n} else {\n  return "none";\n}\n',
          setting: 'style'
        }
      ],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      name: 'filters - active filter label - livechat',
      attributes: [{ name: 'active-filter-label-livechat' }],
      id: '847a7771-3ffd-432a-b990-1ef5fe401c69',
      type: 'element',
      actions: [{ value: 'return (v.inboxFilterStatus == "livechat")', setting: 'visibility' }],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      name: '2d. operator_changed - name',
      attributes: [{ name: 'message_list_item-name' }],
      id: '847e61e7-dab8-43af-b88a-97b0f67326a4',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "operator_changed") {\n\n      return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.operator_name\n\n    }',
          setting: 'text'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'sign out user',
      attributes: [{ name: 'logout-btn' }],
      id: '852d1119-4c0c-4890-97e7-17901ba6ca03',
      type: 'element',
      actions: [
        {
          function:
            '// clear local storage\nfor (let i = localStorage.length - 1; i >= 0; i--) {\n    const key = localStorage.key(i);\n    if (key.startsWith(\'wized_\')) {\n        localStorage.removeItem(key);\n    }\n}\n\nWized.requests.execute("signout_user");',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8'
    },
    {
      name: 'toast list | set image',
      attributes: [{ name: 'toast-icon' }],
      id: '85a38ab9-fc58-4c9e-8747-65e917d35fae',
      type: 'element',
      actions: [
        {
          value:
            '// return v.toast_log[v.i].message\n\nif (v.toast_log[v.i].type == "success") {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b2df4b53fe42c9223f00f2_check-circle%20(3).svg"\n} else if (v.toast_log[v.i].type == "error") {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65abe22a6f01cd5e4b5d261a_exclamation-circle%20(3).svg"\n} else if (v.toast_log[v.i].type == "warning") {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/661e2f3ec25b14bc1450b90b_exclamation-circle%20(5).svg"\n}',
          key: 'src',
          setting: 'attribute'
        }
      ],
      folderId: 'a4ad4e2f-834f-4b84-bb43-5fc23d252a62'
    },
    {
      name: 'update datasource form handling - API',
      attributes: [{ name: 'form-edit-api' }],
      id: '87083161-05b6-49d2-8ba6-1badb32d8cc7',
      type: 'element',
      actions: [
        {
          value:
            'var dataSource = r.get_datasources.data.find((item) => item.id === v.active_datasource);\n\nreturn {\n  status: dataSource.status,\n  name: dataSource.name,\n  tool_description: dataSource.tool_description,\n  // api_body_type: dataSource.datasource_type_config.bodyType,\n  // method: dataSource.datasource_type_config.method,\n  // protocol: dataSource.datasource_type_config.protocol,\n  body: dataSource.datasource_type_config.body,\n  // api_headers: dataSource.datasource_type_config.headers,\n  // properties: dataSource.datasource_type_config.properties,\n  endpoint_url: dataSource.datasource_type_config.endpointUrl,\n  formatting: dataSource.datasource_type_config.outputSchema,\n  auth_username: dataSource.datasource_type_config.basicAuthCredentials.username,\n  auth_password: dataSource.datasource_type_config.basicAuthCredentials.password,\n  headers_enabled: dataSource.datasource_type_config.headers_enabled,\n  formattig_enabled: dataSource.datasource_type_config.outputformatting_enabled,\n  email_validation: dataSource.datasource_type_config.email_validation.enabled,\n  emailvalidation_keypath: dataSource.datasource_type_config.email_validation.emailKey\n}',
          setting: 'form'
        },
        {
          condition: 'return (v.outputSchemaObjectIsValid == true || v.codemirrorInitialized == false)',
          function: 'Wized.requests.execute("update_api");\n\nawait Wized.requests.waitFor(\'update_api\');\n\nWized.requests.execute("get_datasources");',
          action: 'run-function',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        },
        {
          condition: 'return (v.outputSchemaObjectIsValid == false)',
          function:
            '// transitions\n\nfunction openToast(toastElement) {\n  toastElement.style.display = "flex";\n  toastElement.style.opacity = 0;\n  toastElement.style.transform = "translateY(40px) scale(0.6)";\n\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 1;\n      toastElement.style.transform = "translateY(0) scale(1)";\n    });\n  });\n}\n\nfunction closeToast(toastElement) {\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 0;\n      toastElement.style.transform = "translateY(40px) scale(0.6)";\n      setTimeout(() => {\n        toastElement.style.display = "none";\n      }, 150);\n    });\n  });\n}\n\nasync function manageToast(toastElement) {\n  openToast(toastElement);\n  await new Promise((resolve) => setTimeout(resolve, 5000));\n  closeToast(toastElement);\n}\n\n// toast notifications\n\nasync function showToastNotification(message, type) {\n  const toastMessage = {\n    id: crypto.randomUUID(),\n    expiration: new Date().getTime() + 5000,\n    type: type,\n    message: message,\n  };\n\n  v.toast_log.push(toastMessage);\n\n  const toastElement = document.querySelector(\n    `[toast_item_id=\'${toastMessage.id}\']`\n  );\n\n  manageToast(toastElement);\n}\n\n/// \n\n\nshowToastNotification(\n  "Het output schema JSON object is invalide.",\n  "error"\n);',
          action: 'run-function',
          event: 'submit',
          hasCondition: true,
          setting: 'on-event'
        },
        { function: 'console.log("submit")', action: 'run-function', event: 'submit', preventDefault: true, setting: 'on-event' }
      ],
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee'
    },
    {
      name: 'form handling - create kb topic',
      attributes: [{ name: 'form-create-topic' }],
      id: '884779a6-0bb4-4479-8281-ff235f3ba93d',
      type: 'element',
      actions: [
        {
          function:
            'window.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  const modals = document.querySelectorAll(\'[popupmodal]\');\n  modals.forEach((modal) => {\n    modal.style.display = "none";\n  });\n\n  Wized.requests.execute("create_kb_topic");\n  await Wized.requests.waitFor("create_kb_topic");\n  Wized.requests.execute("get_datasources");\n})',
          action: 'run-function',
          resetForm: true,
          event: 'submit',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      name: 'image preview - avatar',
      attributes: [{ name: 'settings-avatar-imagepreview' }],
      id: '88b2fd95-37c6-43f3-83f3-ad7cf22e7380',
      type: 'element',
      actions: [
        {
          value:
            'if (i["settigs-avatar-input"]["0"]) {\n\n    if (i["settigs-avatar-input"] == \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\') {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\n    } else {\n        return URL.createObjectURL(i["settigs-avatar-input"]["0"]);\n        // return i["settigs-avatar-input"]\n    }\n    \n} else {\n    if (r.get_chatbot.ok == true) {\n\n        if (r.get_chatbot.data.avatar_url !== null) {\n            return r.get_chatbot.data.avatar_url;\n        } else {\n            return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n        }    \n\n    } else {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n    }\n}',
          key: 'src',
          setting: 'attribute'
        }
      ],
      folderId: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0'
    },
    {
      name: '2a. LIST ITEM - operator_Joined',
      attributes: [{ name: 'message-type-operatorjoined' }],
      id: '891d381e-12ee-4048-b01e-921dc6315088',
      type: 'element',
      actions: [{ value: 'return (\n  v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "operator_changed"\n);\n', setting: 'visibility' }],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'api - formatting visibility',
      attributes: [{ name: 'api-tool-formattig-visibility' }],
      id: '8ac185ef-ac02-4bf8-80ea-54671e3497a3',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i["input-formattig_enabled"] == true) {\n  return "flex"\n} else {\n  return "none"\n}\n\n// return true', setting: 'style' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'agent list - set agent title',
      attributes: [{ name: 'agents-list-item-name-input' }],
      id: '9254985a-cf54-4959-ad8c-d140aae05cf6',
      type: 'element',
      actions: [{ value: 'return r.get_agents.data[v.i].name', setting: 'value' }],
      folderId: 'f2d1f791-109f-4ba0-8d6e-78a76539eb5e'
    },
    {
      name: 'handoff visibility',
      attributes: [{ name: 'visibility-handoff-disabled' }],
      id: '92b1a248-81b7-4cb8-8d5f-1e7b4daedb38',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i["input-handoff-external"] == "disabled") {\n  return "none"\n} else {\n  return "flex"\n}', setting: 'style' }],
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      name: 'create api header',
      attributes: [{ name: 'create-btn-api-headers' }],
      id: '92ed7621-3199-4dc0-a36b-c38ce4330f7c',
      type: 'element',
      actions: [
        {
          function:
            'const nextIndexProperty = v.apiHeadersArray.length;\nconst emptyObjectProperty = { "index": nextIndexProperty, "key": "", "value": "" };\n\nconst newArray = v.apiHeadersArray.concat([emptyObjectProperty]);\n\nv.apiHeadersArray = newArray;\n\n\n',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'sharing - set selected name',
      attributes: [{ name: 'datasource-sharing-selected-name' }],
      id: '944acd20-e282-41dc-8b9a-ec27aaed58c4',
      type: 'element',
      actions: [
        {
          type: 'text',
          value: 'if (!v.datasource_sharing_selected) {\n  return "Chatbot selecteren"\n} else {\n  return (r.get_chatbots.data.find((item) => item.id === v.datasource_sharing_selected)).name\n}',
          setting: 'text'
        }
      ],
      folderId: 'b19e3643-8ab2-44df-b648-b38f323cc6e9'
    },
    {
      name: 'clear avatar image',
      attributes: [{ name: 'avatar-delete' }],
      id: '94ff18d4-76ad-4e3f-80c8-05388d9cc1d0',
      type: 'element',
      actions: [
        {
          function: 'i["settigs-avatar-input"] = "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0'
    },
    {
      request: '9425c8a3-851f-4aea-994c-af3b88ad7fe8',
      condition: "return (n.path.includes('/chatbot') && !n.path.includes('/chatbot/preview') && !n.path.includes('/chatbot-instellingen') || n.path == '/')",
      name: 'Get all chats',
      after: [{ request: '8578e3e8-9133-4087-bdcd-c038e305fcb9', action: 'perform-request' }],
      id: '957a10dc-0d56-4f5b-963a-8f8ce0261d6b',
      trigger: 'after-request',
      type: 'event',
      hasCondition: true,
      folderId: '8fda368d-3d91-4ddc-84e0-352930ddb0c4'
    },
    {
      name: 'api - protocol visibility',
      attributes: [{ name: 'authcredentials-visibility' }],
      id: '971779a9-0d1e-436a-a13e-3a1debbe9843',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i["input-api_authprotocol"] !== "none") {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'toast list | set type',
      attributes: [{ name: 'toast-notification' }],
      id: '976178a3-0a7f-41b7-8152-95016500c0e7',
      type: 'element',
      actions: [
        { condition: 'return (v.toast_log[v.i].type == "success")', class: 'success', setting: 'class' },
        { condition: 'return (v.toast_log[v.i].type == "error")', class: 'error', setting: 'class' },
        { condition: 'return (v.toast_log[v.i].type == "warning")', class: 'warning', setting: 'class' }
      ],
      folderId: 'a4ad4e2f-834f-4b84-bb43-5fc23d252a62'
    },
    {
      name: '1a. LIST ITEM - default',
      attributes: [{ name: 'message-list-item-default' }],
      id: '97cc68ce-d11d-44a5-aec7-e1fa47b809bc',
      type: 'element',
      actions: [
        {
          value: 'return (\n  ["default_user", "default_bot", "default_agent"].includes(\n    v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type\n  )\n);\n',
          setting: 'visibility'
        },
        { condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_user")', class: 'user', setting: 'class' },
        { condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_agent")', class: 'agent', setting: 'class' },
        { condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_bot")', class: 'bot', setting: 'class' }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: '3b. link_preview - url',
      attributes: [{ name: 'link_preview-url' }],
      id: '98237cf7-14ad-4566-a9f0-a92b75b9deaf',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.url \n\n}',
          setting: 'text'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'Set KB list item content',
      attributes: [{ name: 'document-list-item-topic' }],
      id: '98e86250-7d91-4d2d-8890-c8872a0f572a',
      type: 'element',
      actions: [{ type: 'text', value: 'return v.filteredKbList[v.i].content', setting: 'text' }],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      id: '994b863e-7b9c-46d9-8cc5-be1bad2a12a9',
      name: 'Create data source form - URL',
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee',
      type: 'element',
      attributes: [{ name: 'form-create-datasource-url' }],
      actions: [
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function:
            'Wized.requests.execute("create_url");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\n// redundant?\n// dataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\n\n  // Deprecaten - .find() method gebruiken\n  Wized.data.v.active_datasource_type = "url";\n\n  // Element visibility\n  const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n  const editForm = document.querySelector("[w-el=\'form-container-edit-url\']");\n  editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n  await Wized.requests.waitFor(\'create_url\');\n  console.log("url id = ", r.create_url.data.id);\n\n  Wized.requests.execute("get_datasources");\n  Wized.data.v.active_datasource = r.create_url.data.id;\n\n  await Wized.requests.waitFor("get_datasources");\n  // update container visibility\n  editForm.style.display = "flex";\n\n\n  // reset create forms - al gedaan bovenin?\n  // const allForms = document.querySelectorAll(".datasources-formblock");\n  // const formWrapperInitial = document.getElementById("create-datasource-form");\n  // allForms.style.display = "none";\n  // formWrapperInitial.style.display = "flex";\n\n\n\nWized.requests.execute(\'upsert_urls\');\n  console.log("active datasource = ", v.active_datasource);\n  console.log("upsert_urls executed");\n\n  document.querySelector(\'[popupmodal="create-datasource"]\').style.display = "none";\n\n  window.showProgressBarAndHideControls();\n\n  await Wized.requests.waitFor(\'upsert_urls\');\n\n  console.log("upsert_urls finished");\n  Wized.requests.execute(\'get_scrape_pages\');\n\n  if (r.upsert_urls.ok) {\n    console.log("upsert_urls is OK");\n    v.lastScrapeBatchUrls = v.crawledpages\n\n    // Set the flag indicating a scrape job has been initiated\n    v.isScrapeJobInitiated = true;\n\n    window.updateCheckboxVisibilityAndCounts();\n    \n    // reset crawled array\n    v.crawledpages = []\n  }',
          hasCondition: true,
          condition:
            'const organization = r.get_user_data.data[0].organizations[0];\n\nreturn (n.path.includes (\'/kennis/databronnen\') && v.crawledpages.length > 0 && (organization.subscription_status == "active" && organization.subscription_plan.includes("expert")))'
        },
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function: "Wized.requests.execute(\"create_url\");\nawait Wized.requests.waitFor('create_url');\n\nv.active_datasource = r.create_url.data.id;\n\nn.path = '/kennis/databronnen?tn=cd'",
          hasCondition: true,
          condition: "return (n.path.includes ('/kennis/prompt') || n.path.includes ('/admin-create-datasource'))"
        },
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function:
            '// Show expert gate with animations\nconst popup = document.querySelector(\'[popupmodal="expert-gate"]\');\n\npopup.style.transform = "translateY(10px)";\npopup.style.opacity = 0;\npopup.style.display = "flex";\n\nsetTimeout(() => {\n    popup.style.transition = "transform 0.2s ease, opacity 0.2s ease";\n    popup.style.transform = "translateY(0)";\n    popup.style.opacity = 1;\n}, 10);\n',
          hasCondition: true,
          condition: 'const organization = r.get_user_data.data[0].organizations[0];\nreturn (organization.subscription_status !== "active" || !organization.subscription_plan.includes("expert"))'
        }
      ]
    },
    {
      name: '4a. LIST ITEM - success_message',
      attributes: [{ name: 'message-type-success_message' }],
      id: '9ae8ac77-22c5-4254-95b6-a7fa691ab8e4',
      type: 'element',
      actions: [{ value: 'return (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type == "success_message")\n', setting: 'visibility' }],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      id: '9c6cf4a6-a2f7-4d75-9b86-16c8131bc4c9',
      name: 'render chats list',
      folderId: '99a16fdd-65fc-4ba5-9c99-4847a2473e67',
      type: 'element',
      attributes: [{ name: 'chat-list-item' }],
      actions: [
        { setting: 'list', value: 'return v.chats;', indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72' },
        { setting: 'attribute', key: 'id', value: 'return v.chats[v.i].id' },
        {
          setting: 'on-event',
          event: 'click',
          action: 'run-function',
          function:
            'const dataValue = event.currentTarget.getAttribute("id");\n\nv.active_chat = dataValue;\n\nv.livechatstatus = v.chats[v.active_chat_index].livechat;\n\nWized.requests.execute("update_chat_hasunread");\n\nif (window.innerWidth <= 768) {\n  document.querySelector(\'[w-el="messages-grid-container"]\').style.display = "flex";\n}'
        },
        { setting: 'class', class: 'active', condition: "return (v.chats[v.i].id == v.active_chat && n.path.includes(\"inbox\") )\n//   return '#F8FAFF'\n// } else {\n//   return '#fff'\n// }" }
      ]
    },
    {
      name: 'clear background image',
      attributes: [{ name: 'background-delete' }],
      id: '9c7f9e54-0d32-4020-9b7a-9a4680b29e1c',
      type: 'element',
      actions: [
        { function: 'i["settigs-background-input"] = null', action: 'run-function', event: 'click', setting: 'on-event' },
        {
          value:
            'if (i["settigs-background-input"]["0"]) {\n\n    if (!i["settigs-background-input"]) {\n        return false\n    } else {\n        return true\n        // return i["settigs-background-input"]\n    }\n    \n} else {\n    if (r.get_chatbot.ok == true) {\n\n        if (r.get_chatbot.data.background_image !== null) {\n            return true;\n        } else {\n            return false;\n        }    \n\n    } else {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n    }\n}',
          setting: 'visibility'
        }
      ],
      folderId: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0'
    },
    {
      name: 'edit agent click events',
      attributes: [{ name: 'agent-list-item-edit' }],
      id: '9d64212c-b37f-4b2c-b11b-94638e8b3179',
      type: 'element',
      actions: [
        {
          function:
            'const editAgentBtn = document.querySelector("[w-el=\'agent-list-item-edit\']");\nconst agentInput = document.querySelector("[w-el=\'agents-list-item-name-input\']");\nconst agentPseudo = document.querySelector("[w-el=\'agents-list-item-name-pseudo\']");\nconst agentImagePseudo = document.querySelector("[w-el=\'edit-agent-image-btn\']");\n\ne.stopPropagation(); // Stop the event from propagating to the document\nagentInput.focus();\nagentPseudo.style.visibility = "hidden";\n// agentImagePseudo.style.display = "flex";\n\ndocument.addEventListener("click", (e) => {\n    let isEditButton = Array.from(editAgentBtn).some(btn => btn.contains(e.target));\n    if (!agentInput.contains(e.target) && !agentImagePseudo.contains(e.target) && !isEditButton) {\n        agentPseudo.style.visibility = "visible";\n        // agentImagePseudo.style.display = "none";\n    }\n});',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: 'f2d1f791-109f-4ba0-8d6e-78a76539eb5e'
    },
    {
      request: 'd2b868e4-84da-4910-a98d-781589052b49',
      name: 'get user data after get_user',
      trigger: 'after-request',
      after: [{ request: '76ea538c-0c75-4819-8bc2-0115402aa40f', condition: 'return (r.get_user.ok == true)', action: 'perform-request', hasCondition: true }],
      id: '9f996a6d-00b9-4c05-b154-1fdcc3ba13f1',
      type: 'event',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8'
    },
    {
      id: 'Bd4nOGAfLH80LogTrtbx',
      name: 'file upload status (copy)',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      type: 'element',
      attributes: [{ name: 'active-datasource-fileupload-status-indicator' }],
      actions: [
        {
          setting: 'style',
          style: 'background-color',
          value:
            'const activeDatasourcestatus = (r.get_datasources.data.find((item) => item.id === v.active_datasource).file_upload_status);\n\nif (activeDatasourcestatus == "success") {\n  return "#00b343"\n} else if (activeDatasourcestatus == "processing") {\n  return "#4285F4"\n} else if (activeDatasourcestatus == "failed") {\n  return "#F37A80"\n} else if (activeDatasourcestatus == "") {\n  // orange\n  return "#e7b549"\n}\n'
        }
      ]
    },
    {
      name: 'add scrape urls container visibility',
      attributes: [{ name: 'scrape-addcrawlsitemap' }],
      id: 'CNbNSXVUaN8Rqqj21lLf',
      type: 'element',
      actions: [{ style: 'display', value: 'if (v.crawledpages.length !== 0) {\n  return "none"\n} else {\n  return "flex"\n}', setting: 'style' }],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'activate recurring scrape addon',
      attributes: [{ name: 'activate-recurring-scrape-addon' }],
      id: 'DEHHDxT0r00i2E8LgfQd',
      type: 'element',
      actions: [
        {
          function:
            'Wized.requests.execute("activate_recurring_scrape_addon");\nawait Wized.requests.waitFor(\'activate_recurring_scrape_addon\');\n\nconst modal = document.querySelector(\'[popupmodal="recurringscrape-upgrade"]\');\nmodal.style.display = "none"\n\nif (r.activate_recurring_scrape_addon.ok == true) {\n\n  window.showToastNotification(\'Periodieke scraping addon ge-activeerd\', "success");\n  Wized.requests.execute("update_url");\n\n}',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'Expert gate activate button',
      attributes: [{ name: 'expert-gate-activatebtn' }],
      id: 'DpooDXFseW0HYdv8cyzE',
      type: 'element',
      actions: [
        {
          function:
            'const organization = r.get_user_data.data[0].organizations[0];\n\nif (organization.subscription_plan == "active") {\n\n  Wized.requests.execute("create_portal_session");\n\n} else  {\n\n  const priceId = "price_1NIIgZDFhUQDWcdkAZ3QBkMi"\n  // dev\n  // const priceId = "price_1NIIgZDFhUQDWcdkXLttXIiW"\n  v.subscriptionPriceId = priceId;\n\n  Wized.requests.execute("create_checkout_session");\n  await Wized.requests.waitFor(\'create_checkout_session\');\n\n  const redirectUrl = r.create_checkout_session.data.checkout_url;\n\n  function checkUserAgent() {\n    const userAgent = navigator.userAgent;\n    return userAgent.includes("Chrome");\n  }\n\n  if (checkUserAgent()) {\n    window.open(redirectUrl, \'_blank\', \'noopener,noreferrer\');\n  } else {\n    window.location.href = redirectUrl;\n  }\n\n}',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'crawl_url',
      attributes: [{ name: 'create-btn-crawl-websiteurl' }],
      id: 'Dqq3GMirjsPh5L0DM2TV',
      type: 'element',
      actions: [
        {
          function:
            "function validateUrl(url) {\n  try {\n    const parsedUrl = new URL(url);\n\n    // Check if the hostname contains at least one dot (.)\n    if (!parsedUrl.hostname.includes('.')) {\n      return false;\n    }\n\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nif (i['input-crawl-websiteurl'] && !r.firecrawl_map.isRequesting) {\n  let url = i['input-crawl-websiteurl'].trim();\n\n  // If no protocol is provided, prepend 'https://'\n  if (!/^https?:\\/\\//i.test(url)) {\n    url = 'https://' + url;\n  }\n\n  if (validateUrl(url)) {\n    Wized.requests.execute('firecrawl_map');\n    document.querySelectorAll('[spinner=\"crawl-urls\"]').forEach(function (element) {\n      element.style.display = 'flex';\n    });\n  } else {\n    window.showToastNotification('Ongeldige URL', 'warning');\n  }\n} else {\n  window.showToastNotification('Website URL vereist', 'warning');\n}\n",
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      id: 'EAhoI5T6QpmxMFXAfXQY',
      name: 'set drag area visibility pdf2',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      type: 'element',
      attributes: [{ name: 'pdf2-dragarea' }],
      actions: [{ setting: 'style', style: 'display', value: 'if (i[\'pdf2-upload\']["0"]) {\n    return "none";\n} else {\n    return "flex";\n}' }]
    },
    {
      name: 'get_sitemap',
      attributes: [{ name: 'create-btn-crawl-sitemap' }],
      id: 'EFgE44kXkWZ5Gijbo9tj',
      type: 'element',
      actions: [
        {
          function:
            "function validateUrl(url) {\n  try {\n    const parsedUrl = new URL(url);\n\n    // Check if the URL ends with .xml\n    if (!parsedUrl.pathname.endsWith('.xml')) {\n      return false;\n    }\n\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nif (i['input-crawl-sitemap'] && !r.get_sitemap.isRequesting) {\n  let url = i['input-crawl-sitemap'].trim();\n\n  // If no protocol is provided, prepend 'https://'\n  if (!/^https?:\\/\\//i.test(url)) {\n    url = 'https://' + url;\n  }\n\n  if (validateUrl(url)) {\n    Wized.requests.execute('get_sitemap');\n    document.querySelectorAll('[spinner=\"get-sitemap\"]').forEach(function (element) {\n      element.style.display = 'flex';\n    });\n  } else {\n    window.showToastNotification('Ongeldige sitemap URL - een sitemap URL eindigt met \".xml\"', 'warning');\n  }\n} else {\n  window.showToastNotification('Website URL vereist', 'warning');\n}\n",
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      name: 'show content after get_user_data',
      attributes: [{ name: 'user-cloak' }],
      id: 'ELkednSyAXBFhY7FhhKB',
      type: 'element',
      actions: [{ value: 'return (r.get_user_data.ok)', setting: 'visibility' }],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      name: 'render crawled_urls list',
      attributes: [{ name: 'scrape-results-lis-item' }],
      id: 'GuJk2GvkqgP336Zxonph',
      type: 'element',
      actions: [{ indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.crawledpages', setting: 'list' }],
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      condition: 'return (n.path.includes("/databronnen"))',
      name: 'clear crawled urls',
      id: 'GxhKz7XVFjnI0yrmYbJ9',
      trigger: 'page-loading',
      after: [
        {
          function:
            "const closeTriggers = document.querySelectorAll('[popupmodal-closetrigger]');\n\nconst popupElement = document.querySelector('[w-el=\"popup-create-datasource\"]');\nconst crawlUrlsElement = document.querySelector('[datasourcesform=\"website\"]');\nconst crawledUrlsElement = document.querySelector('[datasourcesform=\"url\"]');\n\ncloseTriggers.forEach(trigger => {\n    trigger.addEventListener('click', () => {\n        v.crawledpages = [];\n\n        document.querySelector('[w-el=\"form-create-datasource-url\"]').reset();\n        document.querySelector('[w-el=\"form-upsert-urls\"]').reset();\n\n        const isPopupVisible = window.getComputedStyle(popupElement).display === 'flex';\n        const isCrawlElementVisible = window.getComputedStyle(crawledUrlsElement).display === 'flex';\n        \n        // Show the URL form and hide the website form\n        if (isCrawlElementVisible) {\n            crawlUrlsElement.style.display = 'flex';\n        }\n        crawledUrlsElement.style.display = 'none';\n    })\n});\n\nconst crawlStepBackButton = document.querySelector('[daasource-crawl-back]')\ncrawlStepBackButton.addEventListener('click', () => {\n    v.crawledpages = [];\n    crawlUrlsElement.style.display = 'flex';\n    crawledUrlsElement.style.display = 'none';\n\n})",
          action: 'run-function'
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      id: 'HCxF5u1uARUuRDtmJPQv',
      name: 'scraped urls list - status label dot',
      folderId: 'PNvaP7BxV1nqggz2UG79',
      type: 'element',
      attributes: [{ name: 'scrape-list-status-indicator-dot' }],
      actions: [
        {
          setting: 'style',
          style: 'background-color',
          value:
            'const scrapeStatus = v.scrapetool_urls_list_filtered[v.i].status;\n\nif (scrapeStatus == "completed") {\n  return "#00b343"\n} else if (scrapeStatus == "queued") {\n  return "#4285F4"\n} else if (scrapeStatus == "failed") {\n  return "#F37A80"\n} else if (scrapeStatus == "not-found") {\n  return "#e7b549"\n}\n'
        }
      ]
    },
    {
      name: 'datasource-list-item-shared container visibility',
      attributes: [{ name: 'datasource-list-sharing-container' }],
      id: 'HpJClXsPqqnuADQQoI12',
      type: 'element',
      actions: [{ value: 'return (v.datasourceSharingNavbarList.length > 0);\n', setting: 'visibility' }],
      folderId: 'hiARdgSU6l4YoqRL86jN'
    },
    {
      name: 'chatbot count - current',
      attributes: [{ name: 'chatbot-count-current' }],
      id: 'IYirpmHA7WWcJ7omzfqq',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data.length', setting: 'text' }],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'datasource-list-item-name-shared',
      attributes: [{ name: 'datasource-list-name-shared' }],
      id: 'JTggIevhrVvPJY8kzf9L',
      type: 'element',
      actions: [{ type: 'text', value: 'return v.datasourceSharingNavbarList[v.i].name\n', setting: 'text' }],
      folderId: 'hiARdgSU6l4YoqRL86jN'
    },
    {
      name: 'upsert_urls on url list submit',
      attributes: [{ name: 'form-upsert-urls' }],
      id: 'Jjh1HscH8m63DgtnIfUX',
      type: 'element',
      actions: [
        {
          condition: 'return (v.crawledpages.length !== 0)',
          function:
            'Wized.requests.execute(\'upsert_urls\');\ndocument.querySelector(\'[popupmodal="add-crawl-urls"]\').style.display = "none";\n\nwindow.showProgressBarAndHideControls();\n\nawait Wized.requests.waitFor(\'upsert_urls\');\nif (r.upsert_urls.ok) {\n  v.lastScrapeBatchUrls = v.crawledpages\n  console.log("set crawled pages = ", v.lastScrapeBatchUrls)\n\n  // Set the flag indicating a scrape job has been initiated\n  v.isScrapeJobInitiated = true;\n\n  window.updateCheckboxVisibilityAndCounts();\n  \n  // reset crawled array\n  v.crawledpages = []\n}',
          resetForm: true,
          action: 'run-function',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      name: 'scraped urls list - status label text',
      attributes: [{ name: 'scrape-list-status-text' }],
      id: 'KbtmuoKEfQZhXs3enwOu',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'const scrapeStatus = v.scrapetool_urls_list_filtered[v.i].status;\n\nif (scrapeStatus == "completed") {\n  return "Voltooid"\n} else if (scrapeStatus == "queued") {\n  return "Wachtrij"\n} else if (scrapeStatus == "failed") {\n  return "Fout"\n} else if (scrapeStatus == "not-found") {\n  return "Niet gevonden"\n}\n',
          setting: 'text'
        },
        {
          style: 'color',
          value:
            'const scrapeStatus = v.scrapetool_urls_list_filtered[v.i].status;\n\nif (scrapeStatus == "completed") {\n  return "#00b343"\n} else if (scrapeStatus == "queued") {\n  return "#4285F4"\n} else if (scrapeStatus == "failed") {\n  return "#F37A80"\n} else if (scrapeStatus == "not-found") {\n  return "#e7b549"\n}\n',
          setting: 'style'
        }
      ],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'helpcenter - calendly url',
      attributes: [{ name: 'helpcenter-schedule-call-btn' }],
      id: 'MMHqwXW5OtoKYVcEOyCF',
      type: 'element',
      actions: [
        {
          value:
            'if (r.get_user_data.data[0].organizations[0].subscription_status !== "active") {\n  return "https://www.sleak.chat/product-demo"\n} else {\n  const callButton = document.querySelector(\'[w-el="helpcenter-schedule-call-btn"]\')\n  callButton.querySelector(\'.purplebox-text\').textContent = \'Online videocall\';\n  return "https://calendly.com/sleak-chat/support"\n}',
          key: 'href',
          setting: 'attribute'
        }
      ],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      id: 'P6nmvIB3xfmSNn3VALIk',
      name: 'create pdf2 select-box visibility',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      type: 'element',
      attributes: [{ name: 'create-datasorce-pdf2-selectbox' }],
      actions: [
        {
          setting: 'style',
          style: 'display',
          value:
            'const organization = r.get_user_data.data[0].organizations[0];\nconst pdfEnabled = (organization.pdfupload_enabled == true)\nif (pdfEnabled) {\n  return "flex"\n} else {\n  return "none"\n}'
        }
      ]
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      condition: 'const organization = r.get_user_data.data[0].organizations[0];\n\nreturn (organization.subscription_status !== "active")',
      name: 'remaining trial days chart',
      id: 'PEEmEnfonqNMALNBtERV',
      trigger: 'after-request',
      after: [
        {
          function:
            "// Get the organization data\nconst organization = r.get_user_data.data[0].organizations[0];\n\n// Check if the subscription is not active or null\nconst currentDate = new Date();\nconst createdAt = new Date(organization.created_at);\nconst trialPeriodDays = 14;\nconst maxDays = trialPeriodDays + 1; // Adjusted to ensure 14 days is not 100% filled\n\n// Calculate the difference in days between the current date and created date\nconst diffTime = currentDate - createdAt;\nconst diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\nconst remainingDays = trialPeriodDays - diffDays;\n\n// Render the doughnut chart to show the trial status visually\nconst usedDays = maxDays - remainingDays;\n\nif (remainingDays >= 0) {\n  const ctx = document.getElementById('canvasCircle2').getContext('2d');\n\n  // Create a doughnut chart with the remaining and used days\n  const chart = new Chart(ctx, {\n    type: 'doughnut',\n    data: {\n      datasets: [\n        {\n          backgroundColor: ['#EFE9FE', '#7E79F0'], // Colors for remaining and used days\n          data: [usedDays, remainingDays], // Remaining days and used days\n          borderWidth: 0, // Optional: remove borders between segments to make them cleaner\n          borderRadius: 10,\n          borderCapStyle: 'round'\n        }\n      ],\n      labels: ['Remaining Days', 'Used Days'] // Labels for the data\n    },\n    options: {\n      cutout: '60%', // Increase cutout percentage to make the doughnut larger\n      responsive: true,\n      maintainAspectRatio: false,\n      plugins: {\n        legend: {\n          display: false // Hide the legend\n        },\n        tooltip: {\n          enabled: false // Disable tooltips\n        }\n      },\n      hover: {\n        mode: null // Disable hover mode to avoid extra rendering\n      }\n    }\n  });\n} else {\n  console.warn('Trial period has ended.');\n}\n",
          action: 'run-function'
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'scraped urls list - status label',
      attributes: [{ name: 'scrape-list-status' }],
      id: 'QzJVInqwEREy38DECHz1',
      type: 'element',
      actions: [
        {
          style: 'background-color',
          value:
            'const scrapeStatus = v.scrapetool_urls_list_filtered[v.i].status;\n\nif (scrapeStatus == "completed") {\n  return "#E4FAEC"\n} else if (scrapeStatus == "queued") {\n  return "#E6F0FF"\n} else if (scrapeStatus == "failed") {\n  return "#FFF0F0"\n} else if (scrapeStatus == "not-found") {\n  return "#FBF3E0"\n}',
          setting: 'style'
        }
      ],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      id: 'RHYdYs3e8mpxUFPKuSX0',
      name: 'Create data source form - pdf2',
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee',
      type: 'element',
      attributes: [{ name: 'form-create-datasource-pdf2' }],
      actions: [
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function:
            'Wized.requests.execute("create_pdf2");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\ndataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\n\n// Deprecaten - .find() method gebruiken\nWized.data.v.active_datasource_type = "pdf2";\n\n// Element visibility\nconst editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\nconst editForm = document.querySelector("[w-el=\'form-container-edit-pdf2\']");\neditDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\nawait Wized.requests.waitFor(\'create_pdf2\');\n\nWized.requests.execute("get_datasources");\nWized.data.v.active_datasource = r.create_pdf2.data.id;\n\nawait Wized.requests.waitFor("get_datasources");\n\n// update container visibility\neditForm.style.display = "flex";\n\n// manage clientside before upserting\nWized.requests.execute("upsert_pdf2");\nawait Wized.requests.waitFor(\'upsert_pdf2\');\n\ni["pdf2-upload"] = {};\nconst pdfForm = document.querySelector("[w-el=\'form-create-datasource-pdf2\']")\npdfForm.reset()',
          hasCondition: true,
          condition:
            '// const organization = r.get_user_data.data[0].organizations[0];\n\n// return (n.path.includes (\'/kennis/databronnen\') && (organization.subscription_status == "active" && organization.subscription_plan.includes("expert")))\n\nreturn true'
        },
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function:
            '// Show expert gate with animations\nconst popup = document.querySelector(\'[popupmodal="expert-gate"]\');\n\npopup.style.transform = "translateY(10px)";\npopup.style.opacity = 0;\npopup.style.display = "flex";\n\nsetTimeout(() => {\n    popup.style.transition = "transform 0.2s ease, opacity 0.2s ease";\n    popup.style.transform = "translateY(0)";\n    popup.style.opacity = 1;\n}, 10);\n',
          hasCondition: true,
          condition:
            '// const organization = r.get_user_data.data[0].organizations[0];\n// return (organization.subscription_status !== "active" || !organization.subscription_plan.includes("expert"))\n\nreturn false'
        }
      ]
    },
    {
      name: 'render crawled_urls list url value',
      attributes: [{ name: 'crawl-list-item-value' }],
      id: 'TkeuDVRu8IzvsWdrVHeY',
      type: 'element',
      actions: [{ type: 'text', value: 'return v.crawledpages[v.i]', setting: 'text' }],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'render scraped urls list',
      attributes: [{ name: 'scrapelist-list-item' }],
      id: 'WXYlZS8KnZvHuqdc1lLu',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.scrapetool_urls_list_filtered', setting: 'list' },
        { value: 'return v.scrapetool_urls_list_filtered[v.i].id;\n', key: 'record_id', setting: 'attribute' },
        {
          style: 'display',
          value:
            'const amountVisiblePages = i["scrape-pagination-itemsperpage"]; // Get the number of items per page\n\nif (amountVisiblePages == 20) {\n  if (v.i < 20){\n    return "flex"\n  } else {\n    return "none"\n  };  \n} else {\n  return "flex"; \n}',
          setting: 'style'
        }
      ],
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      name: 'crawled_urls total count',
      attributes: [{ name: 'crawl-urls-total' }],
      id: 'WoYVeLGHHjoICVJPLLDf',
      type: 'element',
      actions: [{ type: 'text', value: 'return v.crawledpages.length', setting: 'text' }],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'crawled_urls list checkboxes labels',
      attributes: [{ name: 'scrape-list-checkbox-label' }],
      id: 'X12Gf2R1VciMJesY5qCe',
      type: 'element',
      actions: [
        { value: 'return `scrape-page-` + v.i', key: 'for', setting: 'attribute' },
        {
          function: 'thisElement = event.currentTarget\n\nconsole.log("click", thisElement, event)\nconsole.log("shift = ", event.shiftKey)\nwindow.checkboxLabelClick(thisElement, event)',
          action: 'run-function',
          event: 'click',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'rescrape_urls on btn click',
      attributes: [{ name: 'scrape-rescrape-btn' }],
      id: 'Y7wYINPLzT6TRD5H3O13',
      type: 'element',
      actions: [
        {
          condition: 'return Array.from(document.querySelectorAll(\'input[w-el="scrape-list-checkbox"]\')).some(checkbox => checkbox.checked);',
          function:
            "const selectedRows = [];\nconst checkboxes = document.querySelectorAll('input[w-el=\"scrape-list-checkbox\"]:checked');\n\ncheckboxes.forEach(checkbox => {\n  const rowElement = checkbox.closest('[w-el=\"scrapelist-list-item\"]');\n  if (rowElement) {\n    const id = rowElement.getAttribute('record_id');\n    const matchedItem = v.scrapetool_urls_list_filtered.find(item => item.id === id);\n    if (matchedItem) {\n      selectedRows.push(matchedItem.url);\n    }\n  }\n});\n\nWized.requests.execute('rescrape_urls');\n\nawait Wized.requests.waitFor('rescrape_urls');\nif (r.rescrape_urls.ok) {\n  v.lastScrapeBatchUrls = selectedRows\n  v.isScrapeJobInitiated = true;\n  window.showProgressBarAndHideControls();\n  window.updateCheckboxVisibilityAndCounts();\n}",
          action: 'run-function',
          event: 'click',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      name: 'set chat body',
      attributes: [{ name: 'chat-list-item-body' }],
      id: 'a05f1bc8-c325-4a2e-820c-fe113e646f52',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            "// var messages = v.chats[v.i].messages;\n// var last_index = messages.length - 2;\n// return messages[last_index].body;\n\nconst messages = v.chats[v.i].messages;\nconst userMessages = messages.filter(msg => msg.message_type === 'default_user');\nconst lastUserMessage = userMessages.pop(); // This gets the last element of the array\n\n// Check if there is a last user message, and if so, return its body\nreturn lastUserMessage.body;\n\n",
          setting: 'text'
        }
      ],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'create api property',
      attributes: [{ name: 'create-btn-api-properties' }],
      id: 'a0a64333-9dad-442f-bc93-91cccde304d8',
      type: 'element',
      actions: [
        {
          function:
            'const nextIndexProperty = v.apiPropertiesArrayII.length;\nconst emptyObjectProperty = { "index": nextIndexProperty, "property": "", "description": "" };\n\nconst newArray = v.apiPropertiesArrayII.concat([emptyObjectProperty]);\n\nv.apiPropertiesArrayII = newArray;\n\n\n',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'chime visibility desktop',
      attributes: [{ name: 'chime-visibility-desktop' }],
      id: 'a2c6a4ac-c07f-4836-9519-46408ec60082',
      type: 'element',
      actions: [{ style: 'display', value: 'if ( i.toggle_popup_enabled_desktop == true) {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      name: 'datasource sharing notice visibility',
      attributes: [{ name: 'datasource-sharing-notice' }],
      id: 'a363fd17-5ac7-47f4-a227-2997aec9456c',
      type: 'element',
      actions: [{ style: 'display', value: 'if (v.datasourceSharingChatbotsDropdown.length == 0) {\n return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'b19e3643-8ab2-44df-b648-b38f323cc6e9'
    },
    {
      name: 'api - render properties list description value',
      attributes: [{ name: 'api-properties-list-item-value' }],
      id: 'a3ec3c6e-b7dd-428a-ae23-c398ae68b0a8',
      type: 'element',
      actions: [{ value: 'return v.apiPropertiesArrayII[v.iII].description', setting: 'value' }],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'update data source form - URL',
      attributes: [{ name: 'form-edit-url' }],
      id: 'a88178f6-3938-4d42-854c-25ef37612476',
      type: 'element',
      actions: [
        {
          value:
            'var dataSource = r.get_datasources.data.find((item) => item.id === v.active_datasource);\n\nreturn {\n  status: dataSource.status,\n  website_url: dataSource.datasource_type_config.website_url,\n  recurringscrape: dataSource.datasource_type_config.recurring\n}',
          setting: 'form'
        },
        {
          function: 'Wized.requests.execute("update_url");\n\nawait Wized.requests.waitFor(\'update_url\');\n\nWized.requests.execute("get_datasources");\n',
          action: 'run-function',
          event: 'submit',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee'
    },
    {
      name: 'api - render headers list value value',
      attributes: [{ name: 'api-headers-list-item-value' }],
      id: 'a889dc1d-7b82-46f9-83af-4a326ed92d1b',
      type: 'element',
      actions: [{ value: 'return v.apiHeadersArray[v.i].value', setting: 'value' }],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'Set active chatbot website url',
      attributes: [{ name: 'active-chatbot-websiteurl' }],
      id: 'a91386ef-b7fa-4681-ad8f-b56070e0f241',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).website_url\n', setting: 'text' }],
      folderId: '1e11a85b-77a9-441a-a07e-79727b419fd9'
    },
    {
      name: 'delete api property',
      attributes: [{ name: 'api-properties-list-item-delete-btn' }],
      id: 'ab962a5f-035d-46b8-97c2-9f7b3604bf34',
      type: 'element',
      actions: [
        {
          function:
            "var keys = document.querySelectorAll('[api-properties-table=key]');\nvar values = document.querySelectorAll('[api-properties-table=value]');\nvar properties = [];\n\nkeys.forEach((keyInput, index) => {\n    var valueInput = values[index];\n    properties.push({ index: index, property: keyInput.value, description: valueInput.value });\n});\n\nv.apiPropertiesArrayII = properties;\n\nfunction deleteObjectByIndex(index) {\n  if (index !== -1) {\n    v.apiPropertiesArrayII.splice(index, 1); // Remove 1 item at the given index\n  } else {\n    console.log(\"No object found with index\", index);\n  }\n}\n\nvar actualRow = event.target.closest(\"[w-el='api-properties-list-item']\");\nvar parentContainer = actualRow.parentNode;\nvar children = Array.from(parentContainer.children);\nvar index = children.indexOf(actualRow);\n\ndeleteObjectByIndex(index);\n",
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        },
        { value: 'return v.apiPropertiesArrayII[v.i].index', key: 'index', setting: 'attribute' }
      ],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'empty state - datasources list ',
      attributes: [{ name: 'emptystate-chatbots' }],
      id: 'abedf0e4-f7a6-4904-ae96-41d352af62eb',
      type: 'element',
      actions: [{ value: 'return (r.get_chatbots.data.length == 0)', setting: 'visibility' }],
      folderId: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca'
    },
    {
      name: 'set data_source content area csv preview - size',
      attributes: [{ name: 'datasource-csv-preview-size' }],
      id: 'ad6cd286-111a-462d-862c-486dbd798cf5',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.size;', setting: 'text' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'api - render properties list property value',
      attributes: [{ name: 'api-properties-list-item-key' }],
      id: 'adf6baee-20ff-4eed-b4af-c2f60bb12c42',
      type: 'element',
      actions: [{ value: 'return v.apiPropertiesArrayII[v.iII].property', setting: 'value' }],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'checkbox click logic livechat',
      attributes: [{ name: 'livechat-toggle' }],
      id: 'adf7ae37-7d34-4666-8378-42305b550aab',
      type: 'element',
      actions: [
        {
          function:
            'if (v.chats.find((chat) => chat.id === v.active_chat).livechat == false) {\n  const livechatModal = document.querySelector(\'[w-el="livechat-popup"]\');\n  livechatModal.style.display = "flex";\n  livechatModal.style.opacity = 1;\n} else if (v.chats.find((chat) => chat.id === v.active_chat).livechat == true) {\n  const livechatModal = document.querySelector(\'[w-el="livechat-popup-leave"]\');\n  livechatModal.style.display = "flex";\n  livechatModal.style.opacity = 1;\n}\n\n',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '25fe132c-9171-46e3-b363-84ff68552eeb'
    },
    {
      id: 'aee0c1be-330e-4f80-a115-964778cd3ecc',
      name: 'validate csv',
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849',
      type: 'event',
      trigger: 'condition',
      condition: 'if (v.csvContent) {\n  return true\n}',
      after: [
        {
          action: 'run-function',
          function:
            '// Create CSV to JSON Array Function using Papa Parse with dynamic delimiter detection\nasync function readCSVAsNormalizedArrayOfObjects(fileInput) {\n  if (!fileInput) {\n    console.log("No file input provided.");\n    return [];\n  }\n\n  return new Promise((resolve, reject) => {\n    const maxRows = 3000;\n    const maxRowLength = 8000;\n\n    let rowCount = 0;\n    let dataArray = [];\n    let parsingAborted = false;\n\n    // Function to detect the delimiter based on the first occurrence in the first non-empty line\n    function detectDelimiter(text) {\n      const lines = text.split(/\\r\\n|\\n/);\n      let firstNonEmptyLine = "";\n\n      // Find the first non-empty line\n      for (let line of lines) {\n        if (line.trim() !== "") {\n          firstNonEmptyLine = line;\n          break;\n        }\n      }\n\n      console.log("First non-empty line for delimiter detection:", firstNonEmptyLine);\n\n      // List of possible delimiters\n      const possibleDelimiters = [",", ";", "\\t", "|"];\n\n      // Check for the first occurrence of any delimiter\n      for (let delimiter of possibleDelimiters) {\n        if (firstNonEmptyLine.includes(delimiter)) {\n          console.log(`Detected delimiter: \'${delimiter}\'`);\n          return delimiter;\n        }\n      }\n\n      // Default to comma if no delimiter is found\n      console.log("No delimiter detected. Defaulting to comma.");\n      return ",";\n    }\n\n    // First, detect the delimiter\n    const delimiter = detectDelimiter(fileInput);\n\n    // if (delimiter === ";") {\n    //   reject(\'file has ";" delimiter\');\n    //   window.showToastNotification(\n    //     \'CSV gebruikt door ";" gescheiden waarden. Gebruik een bestand met door komma gescheiden waarden.\',\n    //     "error"\n    //   );\n    //   return;\n    // }\n\n    Papa.parse(fileInput, {\n      delimiter: delimiter,\n      header: true,\n      skipEmptyLines: true,\n      quoteChar: \'"\', // Ensure proper handling of quoted fields\n      escapeChar: \'"\',\n      step: function (results, parser) {\n        if (parsingAborted) {\n          parser.abort();\n          return;\n        }\n\n        rowCount++;\n        let row = results.data;\n\n        // Convert the row to a string to check its length\n        let rowString = JSON.stringify(row);\n\n        // Check if the row exceeds the maximum length\n        if (rowString.length > maxRowLength) {\n          // Clear input\n          i["csv-upload"] = {};\n          v.csvContent = null;\n          const form = document.querySelector("[w-el=\'form-create-datasource-csv\']");\n          if (form) {\n            form.reset();\n          }\n\n          console.log("Row exceeds 8000 characters:", row);\n          window.showToastNotification(\n            "Een of meer rijen overschrijden de karakterlimiet. Upload een bestand met rijen van minder dan 8.000 karakters.",\n            "error"\n          );\n\n          parsingAborted = true;\n          parser.abort(); // Stop parsing further rows\n          return;\n        }\n\n        // Check if the row count exceeds the maximum allowed rows\n        if (rowCount > maxRows) {\n          // Clear input\n          i["csv-upload"] = {};\n          v.csvContent = null;\n          const form = document.querySelector("[w-el=\'form-create-datasource-csv\']");\n          if (form) {\n            form.reset();\n          }\n\n          console.log("Row limit exceeded. Maximum allowed is 3000 rows.");\n          window.showToastNotification(\n            "Rijlimiet overschreden. Je kunt maximaal 3000 rijen uploaden.",\n            "error"\n          );\n\n          parsingAborted = true;\n          parser.abort(); // Stop parsing further rows\n          return;\n        }\n\n        // Add the row to the data array without modifying field values\n        dataArray.push(row);\n      },\n      complete: function () {\n        if (parsingAborted) {\n          resolve([]); // Resolve with an empty array if parsing was aborted\n        } else {\n          console.log("Parsed Results:", dataArray);\n          resolve(dataArray); // Resolve with the parsed data\n        }\n      },\n      error: function (err) {\n        console.error("Papa Parse Error:", err);\n        reject(err);\n      },\n    });\n  });\n}\n\n// Turn CSV File into a JSON Array\nvar file = v.csvContent.value;\nreadCSVAsNormalizedArrayOfObjects(file)\n  .then((objects) => {\n    v.csv_rows = objects; // Set your Wized variable\n    console.log("CSV Rows:", v.csv_rows); // Console log the new Wized variable\n    // Further processing can be done here\n  })\n  .catch((error) => {\n    console.error("Error reading file:", error);\n  });\n'
        }
      ]
    },
    {
      condition: 'return (n.path.includes("/kennis") || n.path.includes("/admin-create-datasource"))',
      name: 'csv file drop',
      id: 'aeec71e7-e3c2-4e41-8df4-a39bcdf61547',
      trigger: 'page-complete',
      after: [
        {
          function:
            'const dragArea = document.querySelector(\'[w-el="csv-dragarea"]\');\nconst fileInput = document.querySelector(\'[w-el="csv-upload"]\');\n\n// // Highlight the drag area when file is dragged over it\n// dragArea.addEventListener("dragover", (event) => {\n//   event.preventDefault();\n//   dragArea.style.backgroundColor = "#F5F5FE";\n//   // console.log("File over drag area");\n// });\n\n// // Revert styling when dragging leaves the area\n// dragArea.addEventListener("dragleave", (event) => {\n//   dragArea.style.backgroundColor = "";\n//   // console.log("File left drag area");\n// });\n\n// // Handle the file drop\n// dragArea.addEventListener("drop", (event) => {\n//   event.preventDefault(); // Prevent default behavior (opening the file)\n//   dragArea.style.backgroundColor = "";\n//   dragArea.style.display = "none";\n\n//   const files = event.dataTransfer.files;\n//   if (files.length > 0 && files[0].type === "text/csv") {\n//     const dataTransfer = new DataTransfer();\n//     dataTransfer.items.add(files[0]);\n//     fileInput.files = dataTransfer.files;\n//     // console.log("File uploaded:", fileInput.files[0].name);\n//     // console.log("Data object:", files[0]);\n\n//     // Read the file content\n//     const reader = new FileReader();\n//     reader.onload = function (e) {\n//       // console.log("File content:", e.target.result);\n\n//       function sizeInMBorKB(sizeBytes) {\n//         const sizeMB = (sizeBytes / (1024 * 1024)).toFixed(2);\n//         if (sizeBytes < 1024 * 1024) {\n//           const sizeKB = (sizeBytes / 1024).toFixed(2);\n//           return `${sizeKB} KB`;\n//         }\n//         return `${sizeMB} MB`;\n//       }\n//       const fileSize = files[0].size;\n//       const readableSize = sizeInMBorKB(fileSize);\n\n//       const createdAt = new Date();\n//         const prettyDate = createdAt.getDate().toString().padStart(2, \'0\') + "-" + (createdAt.getMonth() + 1).toString().padStart(2, \'0\') + "-" + createdAt.getFullYear();\n//         const prettyTime = createdAt.getHours().toString().padStart(2, \'0\') + ":" + createdAt.getMinutes().toString().padStart(2, \'0\');\n\n//       v.csvContent = {\n//         value: e.target.result,\n//         name: files[0].name,\n//         size: readableSize,\n//         date: prettyDate,\n//         time: prettyTime,\n//       };\n//       // console.log(v.csvContent)\n\n//     };\n//     reader.readAsText(files[0]);\n//   } else {\n//     alert("Alleen CSV toegestaan.");\n//   }\n// });\n\n// Allow file input via clicking the drag area\ndragArea.addEventListener("click", () => {\n  fileInput.click();\n});\n',
          action: 'run-function'
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849'
    },
    {
      id: 'af5b6fc8-6d6f-43fd-8f06-02ef7e4a2384',
      name: 'Create data source form - CSV',
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee',
      type: 'element',
      attributes: [{ name: 'form-create-datasource-csv' }],
      actions: [
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function:
            'Wized.requests.execute("create_csv");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\ndataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\nwindow.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  // Deprecaten - .find() method gebruiken\n  Wized.data.v.active_datasource_type = "csv";\n\n  // Element visibility\n  const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n  const editForm = document.querySelector("[w-el=\'form-container-edit-csv\']");\n  editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n  await Wized.requests.waitFor(\'create_csv\');\n  \n  Wized.requests.execute("upsert_csv");\n  await Wized.requests.waitFor(\'upsert_csv\');\n\n  Wized.requests.execute("get_datasources");\n  Wized.data.v.active_datasource = r.create_csv.data.id;\n\n  await Wized.requests.waitFor("get_datasources");\n  // update container visibility\n  editForm.style.display = "flex";\n\n  i["csv-upload"] = {};\n  const form = document.querySelector("[w-el=\'form-create-datasource-csv\']")\n  form.reset();\n  v.csv_rows = []\n\n\n  // reset create forms - al gedaan bovenin?\n  // const allForms = document.querySelectorAll(".datasources-formblock");\n  // const formWrapperInitial = document.getElementById("create-datasource-form");\n  // allForms.style.display = "none";\n  // formWrapperInitial.style.display = "flex";\n});\n',
          hasCondition: true,
          condition:
            'const organization = r.get_user_data.data[0].organizations[0];\n\nreturn (n.path.includes (\'/kennis/databronnen\') && (organization.subscription_status == "active" && organization.subscription_plan.includes("expert")))'
        },
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function:
            "Wized.requests.execute(\"create_csv\");\nawait Wized.requests.waitFor('create_csv');\n\nWized.requests.execute(\"upsert_csv\");\nawait Wized.requests.waitFor('upsert_csv');\n\nv.active_datasource = r.create_csv.data.id;\n\nn.path = '/kennis/databronnen?tn=cd'\n\n",
          hasCondition: true,
          condition: "return (n.path.includes ('/kennis/prompt') || n.path.includes ('/admin-create-datasource'))"
        },
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function:
            '// Show expert gate with animations\nconst popup = document.querySelector(\'[popupmodal="expert-gate"]\');\n\npopup.style.transform = "translateY(10px)";\npopup.style.opacity = 0;\npopup.style.display = "flex";\n\nsetTimeout(() => {\n    popup.style.transition = "transform 0.2s ease, opacity 0.2s ease";\n    popup.style.transform = "translateY(0)";\n    popup.style.opacity = 1;\n}, 10);\n',
          hasCondition: true,
          condition: 'const organization = r.get_user_data.data[0].organizations[0];\nreturn (organization.subscription_status !== "active" || !organization.subscription_plan.includes("expert"))'
        }
      ]
    },
    {
      name: 'set chat title',
      attributes: [{ name: 'chat-list-item-name' }],
      id: 'b203bb9c-666d-4975-bd4e-c8bf7bb98ba2',
      type: 'element',
      actions: [{ type: 'text', value: 'return v.chats[v.i].name', setting: 'text' }],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'channels visibility - form',
      attributes: [{ name: 'visibility_toggle_channels_form' }],
      id: 'b222784a-b549-4b91-b9b8-d9c897886cb4',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i.toggle_channels_form == true) {\n  return "block"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      name: 'get user on page load',
      trigger: 'page-loading',
      after: [{ request: 'd2b868e4-84da-4910-a98d-781589052b49', action: 'perform-request' }],
      id: 'b2a33695-1336-47b6-a062-f202717860b8',
      type: 'event',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8'
    },
    {
      name: 'Set active chatbot website_url',
      attributes: [{ name: 'active-chatbot-url' }],
      id: 'b45211a0-bfc2-453c-a12e-3cbb632cbaea',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).website_url', setting: 'text' }],
      folderId: '206c14ea-c3ef-4b95-bdd4-2150463e4999'
    },
    {
      name: 'api properties empty state visibility',
      attributes: [{ name: 'emptystate-api-list-properties' }],
      id: 'b45d78dc-ac24-4e07-a7f0-849196bc4548',
      type: 'element',
      actions: [{ value: 'return (v.apiPropertiesArrayII.length == 0)', setting: 'visibility' }],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'create checkout session',
      attributes: [{ name: 'create-checkout' }],
      id: 'b6075a8b-59fd-481c-b975-4fa07f8fcc11',
      type: 'element',
      actions: [
        {
          function:
            'const priceId = event.currentTarget.getAttribute("price-id");\nv.subscriptionPriceId = priceId;\n\nWized.requests.execute("create_checkout_session");\nawait Wized.requests.waitFor(\'create_checkout_session\');\n\nconst redirectUrl = r.create_checkout_session.data.checkout_url;\n\nfunction checkUserAgent() {\n  const userAgent = navigator.userAgent;\n  return userAgent.includes("Chrome");\n}\n\nif (checkUserAgent()) {\n  window.open(redirectUrl, \'_blank\', \'noopener,noreferrer\');\n} else {\n  window.location.href = redirectUrl;\n}\n',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      name: 'settings form handling - algemeen',
      attributes: [{ name: 'form-settings-algemeen' }],
      id: 'b6615487-f7e3-495e-80ea-248de59ab1c7',
      type: 'element',
      actions: [
        {
          value:
            "const rawUrl = r.get_chatbot.data.website_url;\n\nconst formattedUrl = rawUrl.replace('https://', '');\n\nreturn {\n  chatbot_name: r.get_chatbot.data.name,\n  organization_name: r.get_chatbot.data.organization_name,\n  website_url: formattedUrl,\n  language: r.get_chatbot.data.language,\n  first_message: r.get_chatbot.data.first_message,\n  cs_email: r.get_chatbot.data.cs_email\n}\n",
          setting: 'form'
        },
        { request: '2432144e-fed0-4ad8-8649-a6631c46b1fb', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' },
        {
          request: '04896350-7db5-44ee-b832-ca64a811430e',
          condition:
            'if (i["settigs-avatar-input"]["0"]) {\n  if (i["settigs-avatar-input"] == \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\') {\n    return false\n  } else {\n    return true\n  }\n} else {\n  return false\n}',
          action: 'perform-request',
          event: 'submit',
          hasCondition: true,
          preventDefault: true,
          setting: 'on-event'
        },
        {
          request: '29fa247a-9d03-4453-b85a-4c894e73d52d',
          condition:
            'if (i["settigs-avatar-input"]["0"]) {\n  if (i["settigs-avatar-input"] == \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\') {\n    return true\n  } else {\n    return false\n  }\n} else {\n  return false\n}',
          action: 'perform-request',
          event: 'submit',
          hasCondition: true,
          setting: 'on-event'
        }
      ],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      name: 'set chatbot list status label indicator - published',
      attributes: [{ name: 'active-chatbot-status-label-published' }],
      id: 'b7ffcc0d-76b0-421c-a6c3-dd17af04866a',
      type: 'element',
      actions: [{ value: 'return (r.get_chatbots.data.find((item) => item.id === v.active_chatbot).publishing.published == true)', setting: 'visibility' }],
      folderId: 'd4fa708e-59ec-41b3-9c1f-7e1ffce32bca'
    },
    {
      name: 'set data_source content area csv preview - name',
      attributes: [{ name: 'datasource-csv-preview-timestamp-filename' }],
      id: 'b891aa3b-9282-4918-9f52-caffa3651c93',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.name;', setting: 'text' }],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'settings form handling - integraties | gtm',
      attributes: [{ name: 'form-integrations-gtm' }],
      id: 'b932ee9a-e5b5-4ba7-98bf-8dd135dd9f6e',
      type: 'element',
      actions: [
        {
          value:
            'return {\n    "gtm_enabled": r.get_chatbot.data.gtm_events.enabled,\n    "toggle_chatInitiated": r.get_chatbot.data.gtm_events.sleakChatInitiated,\n    "toggle_sentContactDetails": r.get_chatbot.data.gtm_events.sleakSentContactDetails,\n    "toggle_humanHandoffActivated": r.get_chatbot.data.gtm_events.sleakHumanHandoffActivated\n}',
          setting: 'form'
        },
        { request: '96a6fbbd-3c0f-41c2-a192-9e8a05c8b6d6', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' }
      ],
      folderId: 'f8158d09-0ac8-4653-9ebe-dba0b72a2b38'
    },
    {
      id: 'bAlRp09Y50bLbpmVQM29',
      name: 'set pdf2 file preview visibility',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      type: 'element',
      attributes: [{ name: 'pdf2-upload-preview' }],
      actions: [{ setting: 'style', style: 'display', value: 'if (i["pdf2-upload"]["0"]) {\n  return "flex"\n} else {\n  return "none"\n}' }]
    },
    {
      name: 'scraped urls list - set url',
      attributes: [{ name: 'scrapelst-url' }],
      id: 'bGHIKeYnON1D4LVeqzug',
      type: 'element',
      actions: [{ type: 'text', value: 'return v.scrapetool_urls_list_filtered[v.i].url;', setting: 'text' }],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'toast list | set message',
      attributes: [{ name: 'toast-message' }],
      id: 'be67f6f4-c438-4501-acd7-f8aabf3dea47',
      type: 'element',
      actions: [{ type: 'html', value: 'return v.toast_log[v.i].message', setting: 'text' }],
      folderId: 'a4ad4e2f-834f-4b84-bb43-5fc23d252a62'
    },
    {
      name: 'Set livechat checkbox value',
      attributes: [{ name: 'checkbox-livechat' }],
      id: 'c0a82cac-6470-4a67-a27a-6adb455d1e5a',
      type: 'element',
      actions: [{ value: 'return v.chats.find((chat) => chat.id === v.active_chat).livechat', setting: 'value' }],
      folderId: '25fe132c-9171-46e3-b363-84ff68552eeb'
    },
    {
      name: 'render agents list',
      attributes: [{ name: 'agents-list-item' }],
      id: 'c124924a-d42c-4c66-b146-3401e2c08f79',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return r.get_agents.data', setting: 'list' },
        { condition: 'return true', class: 'visible', setting: 'class' },
        { value: 'return r.get_agents.data[v.i].id', key: 'id', setting: 'attribute' }
      ],
      folderId: 'f2d1f791-109f-4ba0-8d6e-78a76539eb5e'
    },
    {
      name: 'filters - active filter label - archived',
      attributes: [{ name: 'active-filter-label-archived' }],
      id: 'c1869ba3-574a-45a4-b954-f7b9cdcceba9',
      type: 'element',
      actions: [{ value: 'return (v.inboxFilterLabel == "archived")', setting: 'visibility' }],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      id: 'c202e45d-4cad-4c57-bb1e-76c2a3704615',
      name: 'archive chats',
      folderId: '8339c00a-50de-4a25-99f6-68a9f4835506',
      type: 'element',
      attributes: [{ name: 'archive-chat' }],
      actions: [
        {
          setting: 'on-event',
          event: 'click',
          action: 'run-function',
          function:
            'Wized.requests.execute("update_chat_archive");\n\nawait Wized.requests.waitFor("update_chat_archive");\n\n// remove chat from array\nlet index = v.chats.findIndex((chat) => chat.id === v.active_chat);\n\nif (index !== -1) {\n  let newActiveChatIndex;\n  if (index === v.chats.length - 1) {\n    newActiveChatIndex = v.chats.length > 2 ? index - 1 : null;\n  } else {\n    newActiveChatIndex = index;\n  }\n\n  ["loadmorechats", "newchats", "rawchats"].forEach((chatArrayName) => {\n    let chatArray = v[chatArrayName];\n    let indexInChatArray = chatArray.findIndex(\n      (chat) => chat.id === v.active_chat\n    );\n    if (indexInChatArray !== -1) {\n      chatArray.splice(indexInChatArray, 1);\n    };\n    \n  });\n\n  // Set the new active chat before splicing\n  v.active_chat = v.chats[newActiveChatIndex].id;\n} else {\n  console.error("No chat found for chat with chat_id:", payload.new.chat_id);\n}\n'
        },
        {
          setting: 'text',
          type: 'text',
          value:
            'if (v.chats.find((item) => item.id == v.active_chat).archived == false) {\n  return "Chat archiveren"\n} else if (v.chats.find((item) => item.id == v.active_chat).archived == true) {\n  return "De-archiveren"\n}'
        }
      ]
    },
    {
      name: 'datasource sharing - dropdown list - set chatbot initials',
      attributes: [{ name: 'datasource-sharing-chatbots-dropdown-list-item-initials' }],
      id: 'c3ba1207-490b-4f56-82ee-551b2b4b637b',
      type: 'element',
      actions: [{ type: 'text', value: '// return v.chatbots[v.i].name\nreturn v.datasourceSharingChatbotsDropdown[v.i].name.charAt(0)', setting: 'text' }],
      folderId: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679'
    },
    {
      request: 'b90e0912-d43f-4620-95a8-6aceb6904847',
      name: 'add storage item to row - background',
      id: 'c3bad054-6aab-464d-bdce-c827a3316cdc',
      trigger: 'after-request',
      after: [
        {
          request: '4d999dbd-a786-4f0b-ae22-0b6e7fed3ab2',
          condition: 'if (i["settigs-background-input"]["0"]) {\n  return true\n} else {\n  return false\n}',
          action: 'perform-request',
          hasCondition: true
        }
      ],
      type: 'event',
      folderId: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0'
    },
    {
      name: 'active datasource status',
      attributes: [{ name: 'active-datasource-status' }],
      id: 'c3ceac9e-c9f1-4084-8973-6331207d49c7',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'if (v.dataSourceUpdatedStatus !== null) {\n  status = v.dataSourceUpdatedStatus\n} else {\n  status = r.get_datasources.data.find((item) => item.id === v.active_datasource).status;\n}\n\nif (status == "draft") {\n  return "Concept"\n} else if (status == "active") {\n  return "Actief"\n} else if (status == "inactive") {\n  return "Inactief"\n} else {\n  return ""\n}',
          setting: 'text'
        }
      ],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      request: '04896350-7db5-44ee-b832-ca64a811430e',
      name: 'add storage item to row - avatar',
      id: 'c48623ae-939b-4bc5-9139-dec8b638be70',
      after: [
        {
          request: '29fa247a-9d03-4453-b85a-4c894e73d52d',
          condition: 'if (i["settigs-avatar-input"]["0"]) {\n  return true\n} else {\n  return false\n}',
          action: 'perform-request',
          hasCondition: true
        }
      ],
      trigger: 'after-request',
      type: 'event',
      folderId: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0'
    },
    {
      name: 'empty state | inbox > filtering > reset filters',
      attributes: [{ name: 'reset-filters' }],
      id: 'c8770acb-fc38-4e2e-9ff7-b070c51e10fd',
      type: 'element',
      actions: [
        {
          function:
            'v.loadmorechats = [];\n\nv.inboxFilterLabel = "open";\nv.inboxFilterStatus = "all";\nv.inboxFilterChatbots = r.get_chatbots.data.map(chatbot => chatbot.id);\n\nWized.requests.execute("get_chats");\n\n// reset active filter preheader\nconst filterbar = document.querySelector("[w-el=\'inbox-subheader-activefilters\']");\nfilterbar.style.display = "none"\n\n// reset filter buttons\ndocument.querySelectorAll(\'[w-el="filter-label"]\').forEach((element) => {\n  element.classList.remove("active");\n});\ndocument.querySelector("[filter-value=\'open\']").classList.add("active");\n\ndocument.querySelectorAll(\'[w-el="filter-status"]\').forEach((element) => {\n  element.classList.remove("active");\n});\ndocument.querySelector("[filter-value=\'all\']").classList.add("active");',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '8b09a83c-4f71-4518-b39e-ee8e709e1b14'
    },
    {
      name: 'email gate blocking visibility',
      attributes: [{ name: 'email_gate_blocking_container' }, { name: 'emailgate_confirmation_message' }],
      id: 'c8c33eda-beec-4b53-9314-46eb70f3951e',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i.emailgate_enabled == true) {\n  return "flex"\n} else {\n  return "none"\n}\n\n', setting: 'style' }],
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      id: 'ca91b26b-7a9c-47f2-b885-f813a2225dfc',
      name: 'after get_chatbots - RT logic + set filiter variables',
      folderId: '8339c00a-50de-4a25-99f6-68a9f4835506',
      type: 'event',
      trigger: 'after-request',
      request: '9425c8a3-851f-4aea-994c-af3b88ad7fe8',
      after: [
        {
          action: 'run-function',
          function:
            'let chime = new Audio(\n  "https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/sleak-chime.mp3"\n);\n\nasync function realtimeInit() {\n  let supaClient;\n\n  const { version, client } = await Wized.requests.getClient("supabase");\n\n  supaClient = client;\n  // console.log("supa client:", supaClient);\n\n  // get chatbot ids\n  const idsArray = r.get_chatbots.data.map((item) => item.id);\n  const formattedIds = `in.(${idsArray.join(", ")})`;\n\n  const userId = r.get_user.data.user.id;\n\n  supaClient\n    .channel("adminUi_" + userId)\n\n    .on(\n      "postgres_changes",\n      {\n        event: "INSERT",\n        schema: "public",\n        table: "messages",\n        filter: `chatbot_id=${formattedIds}`,\n      },\n      (payload) => {\n        console.log("New message:", payload);\n\n        const chat = v.allchats.find(\n          (chat) => chat.id === payload.new.visitor_id\n        );\n        if (chat) {\n          if (!chat.messages) {\n            chat.messages = [];\n          }\n\n          // message entrance animations\n\n          async function showMessage(toastElement) {\n            toastElement.style.display = "flex";\n            toastElement.style.opacity = 0;\n            toastElement.style.transform = "translateY(20px)";\n            requestAnimationFrame(() => {\n              requestAnimationFrame(() => {\n                toastElement.style.opacity = 1;\n                toastElement.style.transform = "translateY(0)";\n              });\n            });\n          }\n          async function pushMessage(payload) {\n            chat.messages.push(payload);\n            const toastElement = document.querySelector(\n              `[message_list_id=\'${payload.id}\']`\n            );\n            showMessage(toastElement);\n          }\n\n          pushMessage(payload.new);\n\n          // chime\n\n          if (payload.new.message_type === "default_user") {\n            if (i["checkbox-inbox-notifications"] == true) {\n              chime\n                .play()\n                .catch((error) => console.error("Error playing chime:", error));\n            }\n          }\n        } else {\n          console.log(\n            "No chat found for message with visitor_id:",\n            payload.new.visitor_id\n          );\n        }\n      }\n    )\n\n    // insert chats\n\n    .on(\n      "postgres_changes",\n      {\n        event: "INSERT",\n        schema: "public",\n        table: "chats",\n        filter: `chatbot_id=${formattedIds}`,\n      },\n      (payload) => {\n        console.log("New chat:", payload);\n\n        if (payload.new.placement !== "admin") {\n          v.newchats.unshift(payload.new);\n        }\n      }\n    )\n\n    // update chats\n\n    .on(\n      "postgres_changes",\n      {\n        event: "UPDATE",\n        schema: "public",\n        table: "chats",\n        filter: `chatbot_id=${formattedIds}`,\n      },\n      (payload) => {\n        // console.log("Updated chat payload:", payload);\n        if (payload.new.placement !== "admin") {\n          const updatedChat = v.allchats.find(\n            (chat) => chat.id === payload.new.id\n          );\n          if (updatedChat) {\n            Object.assign(updatedChat, payload.new);\n            console.log("Chat updated:", updatedChat);\n          } else {\n            console.log(\n              "No chat found for chat with visitor_id:",\n              payload.new.visitor_id\n            );\n          }\n        }\n      }\n    )\n\n    .subscribe();\n\n  ////\n\n  // isTyping channel broadcast\n\n  let isTypingChannel;\n  await new Promise((res) => setTimeout(res, 1000));\n  let currentChat = v.active_chat;\n  let inputEventListener = false;\n\n  function initializeLiveChatChannel(supaClient) {\n    isTypingChannel = supaClient.channel("isTyping_" + currentChat);\n\n    // console.log("first log", isTypingChannel);\n\n    isTypingChannel.subscribe((status) => {\n      // if (status !== "SUBSCRIBED") {\n      //   console.log("not subscribed");\n      // } else {\n      //   console.log("Subscribed");\n      // }\n\n      function sendIsTyping() {\n        isTypingChannel.send({\n          type: "broadcast",\n          event: "isTypingAdmin",\n          // payload: { message: "Subscribed to isTypingChannel" },\n        });\n      }\n\n      // input event listener\n      const input = document.querySelector("[w-el=\'admin-ui-chat-input\']");\n      let isTypingFlag = false;\n\n      if (inputEventListener == false) {\n        input.addEventListener("input", () => {\n          if (isTypingFlag == false) {\n            console.log("input event");\n            sendIsTyping();\n            isTypingFlag = true;\n            setTimeout(() => {\n              isTypingFlag = false;\n            }, 5000);\n          }\n        });\n      }\n      inputEventListener = true;\n    });\n  }\n\n  function closeLiveChatChannel() {\n    isTypingChannel.unsubscribe();\n    isTypingChannel = null;\n  }\n\n  // operatorChanged event listeners\n  window.addEventListener("joinLivechat", (event) => {\n    initializeLiveChatChannel(supaClient);\n  });\n  window.addEventListener("leaveLivechat", (event) => {\n    if (isTypingChannel) {\n      closeLiveChatChannel(supaClient);\n    }\n  });\n\n  if (v.active_chat.livechat == true) {\n    initializeLiveChatChannel(supaClient);\n  }\n}\n\nrealtimeInit();\n',
          hasCondition: true,
          condition: 'return (n.path == "/chat-inbox" && localStorage.getItem("sleakTrialExpired") !== "true")\n'
        },
        {
          action: 'run-function',
          function: 'v.inboxFilterChatbots = r.get_chatbots.data.map(chatbot => chatbot.id);\n\nWized.requests.execute("get_chats");',
          hasCondition: true,
          condition: 'return (n.path == "/chat-inbox" && localStorage.getItem("sleakTrialExpired") !== "true")\n'
        },
        { action: 'run-function', function: 'v.inboxFilterChatbots = [v.active_chatbot];\n\nWized.requests.execute("get_chats");\n', hasCondition: true, condition: 'return (n.path == "/chatbot")' }
      ]
    },
    {
      name: 'delete chat form',
      attributes: [{ name: 'form-delete-chat' }],
      id: 'cb538cd4-df05-4492-8bc2-b55b817d598c',
      type: 'element',
      actions: [
        {
          function:
            'window.Wized = window.Wized || [];\n\nWized.requests.execute("delete_chat");\n\ndocument.querySelectorAll("[popupmodal]").forEach((item) => {\n  item.style.display = "none";\n});\n\nawait Wized.requests.waitFor("delete_chat");\n\n// remove chat from array\nlet index = v.chats.findIndex((chat) => chat.id === v.active_chat);\n\nif (index !== -1) {\n  let newActiveChatIndex;\n  if (index === v.chats.length - 1) {\n    newActiveChatIndex = v.chats.length > 2 ? index - 1 : null;\n  } else {\n    newActiveChatIndex = index;\n  }\n\n  ["loadmorechats", "newchats", "rawchats"].forEach((chatArrayName) => {\n    let chatArray = v[chatArrayName];\n    let indexInChatArray = chatArray.findIndex(\n      (chat) => chat.id === v.active_chat\n    );\n    if (indexInChatArray !== -1) {\n      chatArray.splice(indexInChatArray, 1);\n      // console.log("chat removed from", chatArrayName);\n    }\n  });\n\n  // Set the new active chat before splicing\n  v.active_chat = v.chats[newActiveChatIndex].id;\n  // console.log("new chat", v.chats[newActiveChatIndex].id);\n} else {\n  console.error("No chat found for chat with chat_id:", payload.new.chat_id);\n}\n',
          action: 'run-function',
          event: 'submit',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: '99a16fdd-65fc-4ba5-9c99-4847a2473e67'
    },
    {
      name: 'beta modal datasources',
      attributes: [{ name: 'beta-modal' }],
      id: 'cd5c8f3f-2189-415c-add8-16cda328e4c0',
      type: 'element',
      actions: [
        {
          value:
            'const activeDatasourceType = (r.get_datasources.data.find((item) => item.id === v.active_datasource).data_type);\nreturn (activeDatasourceType == "api" || activeDatasourceType == "url")',
          setting: 'visibility'
        }
      ]
    },
    {
      id: 'cdc486bf-3383-4e39-86c2-11ca41ee8833',
      name: 'submit auth_user',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      type: 'element',
      attributes: [{ name: 'form-auth' }, { name: 'form-auth-signup' }],
      actions: [
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function:
            'const signupButton = document.querySelector(\'[multi-step-signup="button"]\');\nconst spinner = document.querySelector(\'[spinner="auth"]\');\nspinner.style.display = \'flex\';\nsignupButton.setAttribute(\'value\', \'\');\n\n// clear local storage\nfor (let i = localStorage.length - 1; i >= 0; i--) {\n    const key = localStorage.key(i);\n    if (key.startsWith(\'wized_\')) {\n        localStorage.removeItem(key);\n    }\n}\n\nv.chatbots = null;\nv.active_chatbot = null;\nv.active_datasource = null;\nv.active_datasource_type = null;\nconsole.log("set to null");\n\nif (n.path === \'/signup\') {\n  if (!localStorage.getItem("sleakSignedUp")) {\n  dataLayer.push({\n    event: "trialSignup",\n    eventCategory: "Form",\n    eventAction: "SignupForm",\n    eventLabel: "Trial Signup",\n  });\n  localStorage.setItem("sleakSignedUp", "true");\n  console.log("signup event");\n  }\n  \n  return Wized.requests.execute(\'create_user\')\n} else {\n  return Wized.requests.execute(\'auth_user\')\n}'
        }
      ]
    },
    {
      name: 'delete chatbot form',
      attributes: [{ name: 'form-delete-chatbot' }],
      id: 'ce3955f9-6c2f-40a7-b49e-dcd0dab23095',
      type: 'element',
      actions: [{ function: 'Wized.requests.execute("delete_chatbot");', action: 'run-function', event: 'submit', preventDefault: true, setting: 'on-event' }],
      folderId: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c'
    },
    {
      name: 'settings form handling - extra opties',
      attributes: [{ name: 'form-settings-extraopties' }],
      id: 'ce5d8a0f-ad66-442d-833d-bb69d0f1d9bc',
      type: 'element',
      actions: [
        {
          value:
            'return {\n  toggle_channels: r.get_chatbot.data.channels_data.enabled,\n  \n  toggle_channels_phone: r.get_chatbot.data.channels_data.phone.enabled,\n  channels_phone_value: r.get_chatbot.data.channels_data.phone.value,\n  channels_phone_message: r.get_chatbot.data.channels_data.phone.message,\n\n  toggle_channels_whatsapp: r.get_chatbot.data.channels_data.whatsapp.enabled,\n  channels_whatsapp_value: r.get_chatbot.data.channels_data.whatsapp.value,\n  channels_whatsapp_message: r.get_chatbot.data.channels_data.whatsapp.message,\n\n  toggle_channels_form: r.get_chatbot.data.channels_data.form.enabled,\n  channels_form_value: r.get_chatbot.data.channels_data.form.value,\n  channels_form_message: r.get_chatbot.data.channels_data.form.message,\n\n  toggle_linkpreviews: r.get_chatbot.data.link_previews,\n\n  toggle_emailgate_enabled: r.get_chatbot.data.email_gate.activated,\n  toggle_emailgate_blocking: r.get_chatbot.data.email_gate.blocking,\n  confirmation_message: r.get_chatbot.data.email_gate.confirmation_message\n}',
          setting: 'form'
        },
        { request: '148b2e82-9260-425b-9d0d-bfafd9a7f64d', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' }
      ],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      id: 'cef48ed6-4988-47f1-a4ee-23c51143f00f',
      name: 'set file preview notice visibility',
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849',
      type: 'element',
      attributes: [{ name: 'csv-upload-warning-notice' }],
      actions: [{ setting: 'style', style: 'display', value: 'if (v.csvContent && v.csv_rows.length > 0) {\n  return "none"\n} else {\n  return "flex"\n}' }]
    },
    {
      condition: 'return (n.path.includes("instellingen"))',
      name: 'Settings | navigation',
      id: 'cf336c5a-4844-4fff-936e-6c05a3d2cfc4',
      trigger: 'page-loading',
      after: [
        {
          function:
            'function changeTabs() {\n  // Define all your tab elements\n  const settingsAlgemeen = document.querySelector("[settings-tab=\'algemeen\']");\n  const settingsWidget = document.querySelector("[settings-tab=\'widget\']");\n  const settingsExtraopties = document.querySelector("[settings-tab=\'extraopties\']");\n  const settingsHumanhandoff = document.querySelector("[settings-tab=\'humanhandoff\']");\n  const settingsNotifications = document.querySelector("[settings-tab=\'notificaties\']");\n  const settingsOverig = document.querySelector("[settings-tab=\'overig\']");\n  const settingsBeveiliging = document.querySelector("[settings-tab=\'beveiliging\']");\n\n  window.updateSettingsDisplay = function (activeTab) {\n    const tabElements = {\n      algemeen: settingsAlgemeen,\n      widget: settingsWidget,\n      extraopties: settingsExtraopties,\n      humanhandoff: settingsHumanhandoff,\n      notificaties: settingsNotifications,\n      overig: settingsOverig,\n      beveiliging: settingsBeveiliging,\n    };\n\n    // console.log(\'tabElements: \', tabElements);\n\n    // Hide all elements\n    Object.values(tabElements).forEach((el) => {\n      if (el) el.style.display = "none";\n    });\n\n    // Show the active element\n    const activeElement = tabElements[activeTab];\n    if (activeElement) activeElement.style.display = "block";\n  };\n\n  // Update display with the initial tab\n  window.updateSettingsDisplay(v.active_settings_tab);\n}\n\nfunction settingsTabClickEventListeners() {\n  window.Wized = window.Wized || [];\n  window.Wized.push((Wized) => {\n    const settingsTabItems = document.querySelectorAll("[w-el=\'settings-tab\']");\n\n    settingsTabItems.forEach((item) => {\n      item.addEventListener("click", (event) => {\n        settingsTabItems.forEach((tab) => tab.classList.remove("active"));\n        const clickedItem = event.currentTarget;\n        clickedItem.classList.add("active");\n        const dataValue = clickedItem.getAttribute("data-value");\n        Wized.data.v.active_settings_tab = dataValue;\n        // console.log(\'datavalue: \', dataValue);\n\n        // Call updateSettingsDisplay to reflect the change\n        window.updateSettingsDisplay(Wized.data.v.active_settings_tab);\n      });\n    });\n  });\n}\n\nsettingsTabClickEventListeners();\nchangeTabs();\n',
          action: 'run-function'
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      name: 'update data source form - KB',
      attributes: [{ name: 'form-edit-kb' }],
      id: 'd07dabaa-41c1-49ad-b9dd-675848468312',
      type: 'element',
      actions: [
        { value: 'return {\n status: r.get_datasources.data.find(item => item.id === v.active_datasource).status\n}', setting: 'form' },
        {
          function: 'Wized.requests.execute("update_kb");\n\nawait Wized.requests.waitFor(\'update_kb\');\n\nWized.requests.execute("get_datasources");\n',
          action: 'run-function',
          event: 'submit',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee'
    },
    {
      name: 'channels visibility - phone',
      attributes: [{ name: 'visibility_toggle_channels_phone' }],
      id: 'd088a8ed-12d7-4291-a1ed-4542b08bfc9e',
      type: 'element',
      actions: [{ style: 'display', value: 'if (i.toggle_channels_call == true) {\n  return "block"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b'
    },
    {
      name: 'empty state | chats / inbox > geen chatbots (copy)',
      attributes: [{ name: 'cloak-prompt' }],
      id: 'd0aac957-e52b-4f65-a0c0-3011d421f05b',
      type: 'element',
      actions: [{ value: 'return (r.get_chatbots.data.length !== 0)', setting: 'visibility' }],
      folderId: '319c7ed9-3917-444b-91aa-11a3ed455fdb'
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      condition: 'return (r.get_user_data.ok == true && r.get_user_data.data[0].organizations.length > 0)',
      name: 'get chatbots after get_user',
      id: 'd3e18308-ad3e-45cc-bd52-bd133f7634c7',
      trigger: 'after-request',
      after: [
        { request: '9425c8a3-851f-4aea-994c-af3b88ad7fe8', action: 'perform-request' },
        { request: '8cc144e4-b421-46f5-a9e7-ee3f00940a07', condition: 'return (v.active_chatbot !== null)', action: 'perform-request', hasCondition: true }
      ],
      type: 'event',
      hasCondition: true,
      folderId: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c'
    },
    {
      id: 'd430f1aa-af04-4210-a3e1-247a2db91e85',
      name: 'update status',
      folderId: '55214649-2bac-4398-a861-03d94d2aad9d',
      type: 'element',
      attributes: [{ name: 'change-status' }],
      actions: [
        {
          setting: 'on-event',
          event: 'click',
          action: 'run-function',
          function:
            'const dataValue = event.currentTarget.getAttribute("data-value");\n\nv.dataSourceUpdatedStatus = dataValue;\n\nconst modals = document.querySelectorAll(\'[dropdown-modal]\');\n\nmodals.forEach(modal => {\n  modal.style.opacity = "0";\n  modal.style.transform = "translateY(-20px)";\n  setTimeout(() => {\n    modal.style.display = "none";\n  }, 200);\n})\n'
        }
      ]
    },
    {
      name: 'render KB topics list',
      attributes: [{ name: 'doument-list-item' }],
      id: 'd62c7370-87e6-4196-93ae-b0b309fcfa25',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.filteredKbList;', setting: 'list' },
        { condition: 'return true', class: 'visible', setting: 'class' },
        { value: 'return v.filteredKbList[v.i].id', key: 'id', setting: 'attribute' },
        {
          function:
            '    // data logic\n\n    const dataValue = event.currentTarget.getAttribute("id");\n\n    v.active_kb_topic = dataValue; \n    Wized.requests.execute("get_kb_topic");\n\n    // Element visibility\n\n    // const dataSourcesContainer = document.querySelector("[w-el=\'edit-datasources-container\']");\n    const editTopicContainer = document.querySelector("[w-el=\'edit-topic-container\']");\n\n    editTopicContainer.style.transform = \'translateX(20px)\';\n\t\teditTopicContainer.style.opacity = 0;\n\t\teditTopicContainer.style.display = \'flex\';\n    setTimeout(() => {\n      editTopicContainer.style.transform = \'translateX(0)\';\n      editTopicContainer.style.opacity = 1;\n    }, 50);\n\n    const scrollBox = document.querySelector("[content-scrollbox]");\n    if (scrollBox) {\n      scrollBox.scrollTop = 0;\n    }',
          action: 'run-function',
          event: 'click',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      name: 'empty state | chats / inbox > geen chats',
      attributes: [{ name: 'emptystate-chats' }],
      id: 'd67e7f9f-bf66-4ac5-8cb1-8580794f7785',
      type: 'element',
      actions: [{ value: 'return (v.chats.length == 0 && v.usedFilters == false)', setting: 'visibility' }],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      condition: 'return (n.path == "/redirect")',
      name: 'impersonization',
      id: 'd6abef92-f650-4c05-8864-8f69e0a2d7dc',
      trigger: 'condition',
      after: [
        {
          function:
            'function getQueryParam(param) {\n  const urlParams = new URLSearchParams(window.location.search);\n  return urlParams.get(param);\n}\n\nsetTimeout(() => {\n  const sessionObject = getQueryParam("session_object");\n  if (sessionObject) {\n    localStorage.setItem("sb-sygpwnluwwetrkmwilea-auth-token", sessionObject);\n    n.path = \'/\'\n  }\n}, 500);',
          action: 'run-function'
        }
      ],
      type: 'event',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8'
    },
    {
      condition: "return (n.href.includes('?tn='))",
      name: 'toast query params',
      after: [
        {
          function:
            '// clear query param\n// window.location.replace(window.location.href.split(\'?\')[0]);\n\nlet message;\n\nif ((n.href.includes(\'?tn=cc\'))) {\n  message = "Chatbot aangemaakt"\n} else if ((n.href.includes(\'?tn=cd\'))){\n  message =  "Databron aangemaakt"\n} else if ((n.href.includes(\'?tn=dc\'))) {\n  message = "Chatbot verwijderd"\n} else {\n  return\n}\n\n// toast notifications\n\nconst toastMessage = {\n  id: crypto.randomUUID(),\n  expiration: new Date().getTime() + 5000,\n  type: "success",\n  message: message,\n};\n\n// transitions\n\nfunction openToast(toastElement) {\n  toastElement.style.display = "flex";\n  toastElement.style.opacity = 0;\n  toastElement.style.transform = "translateY(40px) scale(0.6)";\n\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 1;\n      toastElement.style.transform = "translateY(0) scale(1)";\n    });\n  });\n}\n\nfunction closeToast(toastElement) {\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 0;\n      toastElement.style.transform = "translateY(40px) scale(0.6)";\n      setTimeout(() => {\n        toastElement.style.display = "none";\n      }, 150);\n    });\n  });\n}\n\nasync function manageToast(toastElement) {\n  openToast(toastElement);\n  await new Promise((resolve) => setTimeout(resolve, 5000));\n  closeToast(toastElement);\n}\n\nv.toast_log.push(toastMessage);\n\nconst toastElement = document.querySelector(\n  `[toast_item_id=\'${toastMessage.id}\']`\n);\n\nmanageToast(toastElement);',
          action: 'run-function'
        }
      ],
      trigger: 'page-complete',
      id: 'd7846486-ff64-42dc-81ec-5abfeea93b7b',
      type: 'event',
      hasCondition: true,
      folderId: 'a4ad4e2f-834f-4b84-bb43-5fc23d252a62'
    },
    {
      name: '1b. default_message - body',
      attributes: [{ name: 'default_message-body' }],
      id: 'd7b0d7b9-9191-4913-b14f-8e43c9baa378',
      type: 'element',
      actions: [
        {
          type: 'html',
          value:
            'if (  ["default_user", "default_bot", "default_agent"].includes(\n    v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type\n  )) {\n\nconst messageBody = v.chats.find(chat => chat.id === v.active_chat).messages[v.i].body;\nreturn marked.parse(messageBody);\n\n}',
          setting: 'text'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      id: 'd9f686c2-c735-4468-8076-cb4de82bfc5d',
      name: 'render data-sources list',
      folderId: '55214649-2bac-4398-a861-03d94d2aad9d',
      type: 'element',
      attributes: [{ name: 'datasource-list-item' }],
      actions: [
        { setting: 'list', value: 'return r.get_datasources.data', indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72' },
        { setting: 'class', class: 'visible', condition: 'return true' },
        { setting: 'attribute', key: 'datasource_id', value: 'return r.get_datasources.data[v.i].id' },
        { setting: 'attribute', key: 'data_type', value: 'return r.get_datasources.data[v.i].data_type' },
        {
          setting: 'on-event',
          event: 'click',
          action: 'run-function',
          function:
            'v.dataSourceUpdatedStatus = null;\n\nconst dataValue = event.currentTarget.getAttribute("datasource_id");\n\nWized.data.v.active_datasource = dataValue;\n\nWized.requests.execute("get_datasource");\n\n// Element visibility\nconst editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\nconst pdfForm = document.querySelector("[w-el=\'form-container-edit-pdf\']");\nconst csvForm = document.querySelector("[w-el=\'form-container-edit-csv\']");\nconst urlForm = document.querySelector("[w-el=\'form-container-edit-url\']");\nconst apiForm = document.querySelector("[w-el=\'form-container-edit-api\']");\nconst pdf2Form = document.querySelector("[w-el=\'form-container-edit-pdf2\']");\n\neditDatasourcesForms.forEach((form) => {\n    form.style.display = "none";\n});\n\nconst activeType = r.get_datasources.data.find(item => item.id === v.active_datasource).data_type;\n\nif (activeType === "pdf") {\n    pdfForm.style.display = "flex";\n} else if (activeType === "csv") {\n    csvForm.style.display = "flex";\n} else if (activeType === \'pdf2\') {\n    pdf2Form.style.display = \'flex\';\n} else if (activeType === "url") {\n    Wized.requests.execute(\'get_scrape_pages\');\n    const checkboxes = document.querySelectorAll(\'input[w-el="scrape-list-checkbox"], input[w-el="scrape-list-checkbox-wildcard"]\');\n    checkboxes.forEach(checkbox => {\n        checkbox.checked = false;\n    });\n    document.querySelector(\'[w-el="scrape-addurl-controls"]\').style.display = \'flex\';\n    lastChecked = null;\n    await Wized.requests.waitFor("get_scrape_pages");\n    if (r.get_datasources.data.find(item => item.id === v.active_datasource).data_type == "url") {\n        urlForm.style.display = \'flex\';\n    }\n} else if (activeType === "api") {\n    apiForm.style.display = "flex";\n    \n    var activedataSource = r.get_datasources.data.find((item) => item.id === v.active_datasource);\n    v.apiHeadersArray = activedataSource.datasource_type_config.headers;\n    v.apiPropertiesArrayII = activedataSource.datasource_type_config.properties;\n\n    // multi-select boxes\n\n    // datasource_type_config.method\n    const checkboxesApi = document.querySelectorAll("[multi-select=\'api_method\']");\n    var hiddenInputMethod = document.querySelector("[multi-select-input=\'api_method\']");\n\n    var dbValue = r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.method;\n\n    checkboxesApi.forEach(function (checkbox) {\n        if (checkbox.getAttribute("data-value") === dbValue) {\n            checkbox.classList.add("selected");\n        }\n        hiddenInputMethod.value = dbValue;\n        $(\'[w-el="api-form-active-method"]\').text(dbValue);\n    });\n\n    checkboxesApi.forEach(function (checkbox) {\n        checkbox.addEventListener("click", function () {\n            checkboxesApi.forEach(function (option) {\n                option.classList.remove("selected");\n            });\n            checkbox.classList.add("selected");\n\n            var newValueCheckboxMethod = checkbox.getAttribute("data-value");\n            hiddenInputMethod.value = newValueCheckboxMethod;\n            $(\'[w-el="api-form-active-method"]\').text(newValueCheckboxMethod);\n        });\n    });\n\n    //\n\n    // datasource_type_config.protocol\n    const checkboxesProtocol = document.querySelectorAll(\'[multi-select="api_authprotocol"]\');\n    var hiddenInputProtocol = document.querySelector(\'[multi-select-input="api_authprotocol"]\');\n\n    var dbValue = r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.protocol;\n\n    checkboxesProtocol.forEach(function (checkbox) {\n        if (checkbox.getAttribute("data-value") === dbValue) {\n            checkbox.classList.add("selected");\n        }\n        hiddenInputProtocol.value = dbValue;\n        i["input-api_authprotocol"] = dbValue;\n        $(\'[w-el="api-form-active-authprotocol"]\').text(dbValue);\n    });\n\n    checkboxesProtocol.forEach(function (checkbox) {\n        checkbox.addEventListener("click", function () {\n            checkboxesProtocol.forEach(function (option) {\n                option.classList.remove("selected");\n            });\n            checkbox.classList.add("selected");\n\n            var newValueProtocol = checkbox.getAttribute("data-value");\n            hiddenInputProtocol.value = newValueProtocol;\n            i["input-api_authprotocol"] = newValueProtocol;\n            $(\'[w-el="api-form-active-authprotocol"]\').text(newValueProtocol);\n        });\n    });\n\n    //\n\n    // datasource_type_config.bodyType\n    const checkboxesBodytype = document.querySelectorAll("[multi-select=\'api_body_type\']");\n    var hiddenInputBodytype = document.querySelector("[multi-select-input=\'api_body_type\']");\n\n    var dbValue = r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.bodyType;\n\n    checkboxesBodytype.forEach(function (checkbox) {\n        if (checkbox.getAttribute("data-value") === dbValue) {\n            checkbox.classList.add("selected");\n        }\n        hiddenInputBodytype.value = dbValue;\n        i["input-api_body_type"] = dbValue;\n        $(\'[w-el="api-form-active-bodytype"]\').text(dbValue);\n    });\n\n    checkboxesBodytype.forEach(function (checkbox) {\n        checkbox.addEventListener("click", function () {\n            checkboxesBodytype.forEach(function (option) {\n                option.classList.remove("selected");\n            });\n            checkbox.classList.add("selected");\n\n            var newValueBodyType = checkbox.getAttribute("data-value");\n            hiddenInputBodytype.value = newValueBodyType;\n            i["input-api_body_type"] = newValueBodyType;\n            $(\'[w-el="api-form-active-bodytype"]\').text(newValueBodyType);  \n        });\n    });\n\n    // text-editor\n    // outputScheme code-editor\n\n    let textarea = document.getElementById("code-editor");\n    let codeMirrorInstance;\n    let validModal = document.querySelector("[w-el=\'modal-valid-json\']");\n    let invalidModal = document.querySelector("[w-el=\'modal-invalid-json\']");\n\n    function isValidJsonObject(value) {\n        try {\n            const parsed = JSON.parse(value);\n            return (\n            !!parsed && typeof parsed === "object" && !Array.isArray(parsed)\n            );\n        } catch (e) {\n            return false;\n        }\n    }\n\n    function objectIsValid() {\n        validModal.style.display = "flex";\n        invalidModal.style.display = "none";\n        v.outputSchemaObjectIsValid = true;\n    }\n\n    function objectIsInvalid() {\n        validModal.style.display = "none";\n        invalidModal.style.display = "flex";\n        v.outputSchemaObjectIsValid = false;\n    }\n\n    function programmaticallySetValue(value, textarea, codeMirrorInstance) {\n    if (v.codemirrorInitialized == false) {\n        codeMirrorInstance = CodeMirror.fromTextArea(textarea, {\n        mode: "application/json",\n        theme: "dracula",\n        lineNumbers: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        indentUnit: 2,\n        tabSize: 2,\n        gutters: ["CodeMirror-lint-markers"],\n        lint: {\n            lintOnChange: true,\n            tooltips: false\n        }\n        });\n\n        // input event listener\n        codeMirrorInstance.on("change", function (cm, change) {\n        inputEventValue = cm.getValue();\n        // console.log("Content changed:", cm.getValue());\n        if (isValidJsonObject(inputEventValue)) {\n            objectIsValid();\n        } else {\n            objectIsInvalid();\n        }\n\n    });\n    }\n\n    textarea.value = value;\n    if (v.codemirrorInitialized == false) {\n        codeMirrorInstance.setValue(value);\n        if (isValidJsonObject(value)) {\n            objectIsValid();\n        } else {\n            objectIsInvalid();\n        }\n    }\n    v.codemirrorInitialized = true;\n    }\n\n    const activeDatasource = r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config;\n    const rawValue = activeDatasource.outputSchema;\n    const value = JSON.parse(rawValue);\n    // console.log(value);\n\n    if (activeDatasource.outputformatting_enabled == true) {\n        programmaticallySetValue(value, textarea, codeMirrorInstance);\n    }\n}\n\nconst scrollBox = document.querySelector("[content-scrollbox]");\nif (scrollBox) {\n    scrollBox.scrollTop = 0;\n}\n\nWized.requests.execute("get_chatbots_datasources_joins");',
          hasCondition: true,
          condition: 'return (n.path.includes("/kennis/databronnen"))'
        },
        {
          setting: 'on-event',
          event: 'click',
          action: 'run-function',
          function:
            'const dataValue = event.currentTarget.getAttribute("datasource_id");\nconst dataType = event.currentTarget.getAttribute("data_type");\n\nWized.data.v.active_datasource = dataValue;\nWized.data.v.active_datasource_type = dataType;\n\nn.path = \'/kennis/databronnen/\';',
          hasCondition: true,
          condition: 'return (!n.path.includes("/kennis/databronnen"))'
        },
        {
          setting: 'style',
          style: 'background-color',
          value: "if (r.get_datasources.data[v.i].id == v.active_datasource && n.path.includes(\"/kennis/databronnen\") ) {\n  return '#F7F7FF'\n} else {\n  return '#fff'\n}"
        },
        {
          setting: 'style',
          style: 'outline',
          value: "if (r.get_datasources.data[v.i].id == v.active_datasource && n.path.includes(\"/kennis/databronnen\") ) {\n  return '2px solid #F3F3FF'\n} else {\n  return 'none'\n}"
        },
        {
          setting: 'class',
          class: 'selected',
          condition: 'if (r.get_datasources.data[v.i].id == v.active_datasource && n.path.includes("/kennis/databronnen") ) {\n  return true\n} else {\n  return false\n}'
        }
      ]
    },
    {
      name: 'trigger delete_scrape_rpcfunction on btn click',
      attributes: [{ name: 'form-delete-scrape-urls' }],
      id: 'dEuTexfCSyfSUdAG4PnB',
      type: 'element',
      actions: [
        {
          function:
            'Wized.requests.execute(\'delete_scrape_rpcfunction\');\ndocument.querySelectorAll(\'[popupmodal]\').forEach(function(el) {\n    el.style.display = \'none\';\n});\nawait Wized.requests.waitFor(\'delete_scrape_rpcfunction\');\n\nif (r.delete_scrape_rpcfunction.ok) {\n  const deletedCount = r.delete_scrape_rpcfunction.data.deleted_count;\n  window.showToastNotification(`${deletedCount} URLs succesvol verwijderd`, "success");\n  const deletedUrls = r.delete_scrape_rpcfunction.data.deleted_urls\n  v.scrapetool_urls_list_deleted = [...v.scrapetool_urls_list_deleted, ...deletedUrls];\n  const checkboxes = document.querySelectorAll(\'input[w-el="scrape-list-checkbox"], input[w-el="scrape-list-checkbox-wildcard"]\');\n  checkboxes.forEach(checkbox => {\n    checkbox.checked = false;\n  });\n  document.querySelector(\'[w-el="scrape-selected-controls"]\').style.display = "none";\n  document.querySelector(\'[w-el="scrape-addurl-controls"]\').style.display = "flex";\n}\n',
          action: 'run-function',
          event: 'submit',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      name: 'scrape urls container visibility',
      attributes: [{ name: 'scrape-urlslist-containr' }, { name: 'upsert-urls-fombtn' }],
      id: 'dMu3HehGK4yMb4f3dIJC',
      type: 'element',
      actions: [{ style: 'display', value: 'if (v.crawledpages.length !== 0) {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      name: 'update inbox notification settings user',
      attributes: [{ name: 'checkbox-inbox-notifications' }],
      id: 'da624e14-9373-4c83-8b8e-822b072d96d4',
      type: 'element',
      actions: [
        { function: 'Wized.requests.execute("update_user_notifications")', action: 'run-function', event: 'click', setting: 'on-event' },
        { value: 'return r.get_user_data.data[0].inbox_notifications_enabled', setting: 'value' }
      ],
      folderId: '9604a1d7-0df8-496f-b4b4-8f0975084ef1'
    },
    {
      name: 'datasource sharing - active list - set chatbot avatar',
      attributes: [{ name: 'datasource-sharing-list-item-avatar' }],
      id: 'dbb4dd5d-ff39-42a6-8407-b58f7354890a',
      type: 'element',
      actions: [
        { value: 'return r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).avatar_url', key: 'src', setting: 'attribute' },
        {
          value:
            'return (r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).avatar_url !== "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png")',
          setting: 'visibility'
        }
      ],
      folderId: '8dbe2088-cc0b-4206-bb53-9ae90e2d4679'
    },
    {
      request: '8578e3e8-9133-4087-bdcd-c038e305fcb9',
      condition: 'return (n.path == "/")',
      name: 'Set variables & run on page load (7 days)',
      id: 'dbf2250f-ccb5-4526-91a5-fa5c8d8c4944',
      trigger: 'after-request',
      after: [
        {
          function:
            '// define data\n\nconst chatsData = r.get_chats_analytics.data;\n\n//// Construct array chats\n\nlet chatsCountArray7 = [];\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 6 + i);\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return createdAt >= dayStart && createdAt <= dayEnd;\n  }).length;\n\n  chatsCountArray7.push(filteredChatsCount);\n}\n\n// set var manually\n\n{\n  {\n    chatsCountArray7.some((item) => item > 0)\n      ? (v.numbers_7 = chatsCountArray7)\n      : (v.numbers_7 = [10, 38, 13, 26, 25, 40, 20]);\n  }\n}\n\n// push chats chart\n\nwindow.Wized.push((Wized) => {\n  const colors = {\n    main: {\n      default: "#7E79F0", // purple\n      half: "EFE9FE", // middle purple\n      quarter: "#FCFBFF", // Light purple\n      zero: "rgba(225, 255, 58, 0)",\n    },\n    secondary: {\n      default: "rgba(80, 102, 120, 1)",\n      quarter: "rgba(80, 102, 120, 0.25)",\n    },\n  };\n\n  const weight = v.numbers_7;\n  const labels = [1, 2, 3, 4, 5, 6, 7];\n\n  // Ensure the DOM is fully loaded before initializing the chart\n  const ctx = document.getElementById("canvas2").getContext("2d");\n  const chart = new Chart(ctx, {\n    type: "line",\n    data: {\n      labels: labels,\n      datasets: [\n        {\n          fill: true, // Ensure the area under the line is filled\n          // backgroundColor: colors.main.quarter, // Use a light green for the fill color\n          backgroundColor: (context) => {\n            if (!context.chart.chartArea) {\n              return;\n            }\n            // console.log(context.chart.chatArea)\n            const {\n              ctx,\n              data,\n              chartArea: { top, bottom },\n            } = context.chart;\n            const gradientBg = ctx.createLinearGradient(0, top, 0, bottom);\n            gradientBg.addColorStop(0, "rgb(126,121,240,0.25)");\n            gradientBg.addColorStop(1, "rgba(255, 255, 255, 0)");\n            return gradientBg;\n          },\n          borderColor: colors.main.default,\n          pointBackgroundColor: colors.main.default,\n          data: weight,\n          lineTension: 0.4,\n          borderWidth: 2,\n          pointRadius: 0,\n          pointBorderColor: "rgba(0, 0, 0, 0)",\n          pointBackgroundColor: "rgba(0, 0, 0, 0)",\n        },\n      ],\n    },\n    options: {\n      devicePixelRatio: 2.5,\n      clip: false,\n      responsive: true,\n      maintainAspectRatio: false,\n      interaction: {\n        intersect: false,\n        mode: "index",\n      },\n      plugins: {\n        legend: {\n          display: false, // Ensures no legend is displayed\n        },\n        tooltip: {\n          enabled: false,\n        },\n      },\n      scales: {\n        x: {\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n        y: {\n          min: 0.9 * Math.min(...weight),\n          max: 1.1 * Math.max(...weight),\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n      },\n      hover: {\n        intersect: false,\n      },\n    },\n  });\n});\n\n//// Construct array Human Handoffs\n\nlet HandoffCountArray7 = [];\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 6 + i);\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return (\n      createdAt >= dayStart &&\n      createdAt <= dayEnd &&\n      chat.agent_requested === true\n    );\n  }).length;\n\n  HandoffCountArray7.push(filteredChatsCount);\n}\n\n// set var manually\n\n{\n  {\n    HandoffCountArray7.some((item) => item > 0)\n      ? (v.handoff_7 = HandoffCountArray7)\n      : (v.handoff_7 = [10, 38, 13, 26, 25, 40, 20]);\n  }\n}\n\n// push handoff chart\n\nwindow.Wized.push((Wized) => {\n  const colors = {\n    main: {\n      default: "#7E79F0", // purple\n      half: "EFE9FE", // middle purple\n      quarter: "#FCFBFF", // Light purple\n      zero: "rgba(225, 255, 58, 0)",\n    },\n    secondary: {\n      default: "rgba(80, 102, 120, 1)",\n      quarter: "rgba(80, 102, 120, 0.25)",\n    },\n  };\n\n  const weight2 = v.handoff_7;\n  const labels = [1, 2, 3, 4, 5, 6, 7];\n\n  // Ensure the DOM is fully loaded before initializing the chart\n  const ctx = document.getElementById("canvas3").getContext("2d");\n  const chart = new Chart(ctx, {\n    type: "line",\n    data: {\n      labels: labels,\n      datasets: [\n        {\n          fill: true, // Ensure the area under the line is filled\n          // backgroundColor: colors.main.quarter, // Use a light green for the fill color\n          backgroundColor: (context) => {\n            if (!context.chart.chartArea) {\n              return;\n            }\n            // console.log(context.chart.chatArea)\n            const {\n              ctx,\n              data,\n              chartArea: { top, bottom },\n            } = context.chart;\n            const gradientBg = ctx.createLinearGradient(0, top, 0, bottom);\n            gradientBg.addColorStop(0, "rgb(126,121,240,0.25)");\n            gradientBg.addColorStop(1, "rgba(255, 255, 255, 0)");\n            return gradientBg;\n          },\n          borderColor: colors.main.default,\n          pointBackgroundColor: colors.main.default,\n          data: weight2,\n          lineTension: 0.4,\n          borderWidth: 2,\n          pointRadius: 0,\n          pointBorderColor: "rgba(0, 0, 0, 0)",\n          pointBackgroundColor: "rgba(0, 0, 0, 0)",\n        },\n      ],\n    },\n    options: {\n      devicePixelRatio: 2.5,\n      clip: false,\n      responsive: true,\n      maintainAspectRatio: false,\n      interaction: {\n        intersect: false,\n        mode: "index",\n      },\n      plugins: {\n        legend: {\n          display: false, // Ensures no legend is displayed\n        },\n        tooltip: {\n          enabled: false,\n        },\n      },\n      scales: {\n        x: {\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n        y: {\n          min: 0.9 * Math.min(...weight2),\n          max: 1.1 * Math.max(...weight2),\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n      },\n      hover: {\n        intersect: false,\n      },\n    },\n  });\n});\n\n//aantal chats\n\nlet chatsSum = 0;\n\nchatsCountArray7.forEach((day) => {\n  chatsSum += day;\n});\n\ndocument.querySelector(\'[w-el="aantal-chats"]\').innerHTML = chatsSum;\n\n//aantal handoffs\n\nlet handoffSum = 0;\n\nHandoffCountArray7.forEach((day) => {\n  handoffSum += day;\n});\n\ndocument.querySelector(\'[w-el="aantal-handoffs"]\').innerHTML = handoffSum;\n\n//// relative change chats\n\nlet chatsSumPrevious = 0;\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 13 + i);\n\n  const dayStart = new Date(currentDateTime);\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart);\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const dailyChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return createdAt >= dayStart && createdAt <= dayEnd;\n  }).length;\n\n  chatsSumPrevious += dailyChatsCount;\n}\n\n// console.log(chatsSumPrevious);\n\nlet relativeChange = ((chatsSum - chatsSumPrevious) / chatsSumPrevious) * 100;\n\n{\n  isFinite(relativeChange)\n    ? (relativeChange =\n        ((chatsSum - chatsSumPrevious) / chatsSumPrevious) * 100)\n    : isNaN(relativeChange)\n    ? (relativeChange = 0.001)\n    : (relativeChange = 100);\n}\n\n// console.log(\'chatsChange:\' + relativeChange);\n\n{\n  relativeChange >= 0\n    ? (document.querySelector(\'[w-el="chats-change-positive"]\').style.display =\n        "flex")\n    : (document.querySelector(\'[w-el="chats-change-positive"]\').style.display =\n        "none");\n}\n\n{\n  relativeChange >= 0\n    ? (document.querySelector(\'[w-el="chats-change-negative"]\').style.display =\n        "none")\n    : (document.querySelector(\'[w-el="chats-change-negative"]\').style.display =\n        "flex");\n}\n\ndocument.querySelector(\'[w-el="chats-text-change-negative"]\').innerHTML =\n  relativeChange.toFixed(1) + "%";\ndocument.querySelector(\'[w-el="chats-text-change-positive"]\').innerHTML =\n  "+" + relativeChange.toFixed(1) + "%";\n\n//// relative change handoffs\n\nlet handoffSumPrevious = 0;\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 13 + i);\n\n  const dayStart = new Date(currentDateTime);\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart);\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const dailyChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return (\n      createdAt >= dayStart &&\n      createdAt <= dayEnd &&\n      chat.agent_requested === true\n    );\n  }).length;\n\n  handoffSumPrevious += dailyChatsCount;\n}\n\nlet relativeChangeHandoff =\n  ((handoffSum - handoffSumPrevious) / handoffSumPrevious) * 100;\n\n// console.log(\'handoffChange:\' + relativeChangeHandoff);\n\n{\n  isFinite(relativeChangeHandoff)\n    ? (relativeChangeHandoff =\n        ((handoffSum - handoffSumPrevious) / handoffSumPrevious) * 100)\n    : isNaN(relativeChangeHandoff)\n    ? (relativeChangeHandoff = 0.001)\n    : (relativeChangeHandoff = 100);\n}\n\n// console.log(\'handoffChange:\' + relativeChangeHandoff);\n\n{\n  relativeChangeHandoff >= 0\n    ? (document.querySelector(\n        \'[w-el="handoff-change-positive"]\'\n      ).style.display = "flex")\n    : (document.querySelector(\n        \'[w-el="handoff-change-positive"]\'\n      ).style.display = "none");\n}\n\n{\n  relativeChangeHandoff >= 0\n    ? (document.querySelector(\n        \'[w-el="handoff-change-negative"]\'\n      ).style.display = "none")\n    : (document.querySelector(\n        \'[w-el="handoff-change-negative"]\'\n      ).style.display = "flex");\n}\n\ndocument.querySelector(\'[w-el="handoff-text-change-negative"]\').innerHTML =\n  relativeChangeHandoff.toFixed(1) + "%";\n\ndocument.querySelector(\'[w-el="handoff-text-change-positive"]\').innerHTML =\n  "+" + relativeChangeHandoff.toFixed(1) + "%";\n',
          action: 'run-function'
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: '8fda368d-3d91-4ddc-84e0-352930ddb0c4'
    },
    {
      request: '8578e3e8-9133-4087-bdcd-c038e305fcb9',
      condition: 'return (n.path == "/")',
      name: 'Set variables & run on page load (30 days)',
      id: 'dc7cdd15-8fd1-4e8e-b37e-7b4afe69cd69',
      trigger: 'after-request',
      after: [
        {
          function:
            "// define data\n\nconst chatsData = r.get_chats_analytics.data;\n\n/// Construct total chats array\n\nlet chatsCountArray = [];\n\nfor (let i = 0; i <= 29 ; i++) {\n  const currentDateTime = new Date ();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 29 + i)\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter(chat => {\n  const createdAt = new Date(chat.created_at);\n  return createdAt >= dayStart && createdAt <= dayEnd;\n  }).length;\n\n  chatsCountArray.push(filteredChatsCount); \n};\n\n// set total data manually\n\n{{\nchatsCountArray.some(item => item > 0) ? v.totalChats_30 = chatsCountArray : v.totalChats_30 = [3950, 4000, 5300, 2700, 3900, 4000, 4100, 2100, 3050, 4500, 2300, 2400, 5100, 2200, 2650, 4400, 5500, 4700, 5400, 3700, 3850, 5300, 6000,2300,2580,2450,2840,3840,3730,6400];\n}}\n\n// Construct array chats without human handoff\n\nlet successCountArray = [];\n\nfor (let i = 0; i <= 29 ; i++) {\n  const currentDateTime = new Date ();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 29 + i)\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter(chat => {\n  const createdAt = new Date(chat.created_at);\n  return createdAt >= dayStart && createdAt <= dayEnd && chat.agent_requested === false;\n  }).length;\n\n  successCountArray.push(filteredChatsCount); \n}\n\n// set var manually\n\n{{\nsuccessCountArray.some(item => item > 0) ? v.success_30 = successCountArray : v.success_30 = [3598, 2925, 4211, 1609, 3576, 2865, 2983, 1021, 2010, 3368, 1193, 1012, 3789, 1023, 1642, 3296, 4463, 3668, 4031, 2547, 2733, 4223, 4894,1200,1500,1400,1800,2800,2700,3200];\n}}\n\n// get current time for labels\n\nconst currentDateTime = new Date();\n\n// set labels var manually\n\nconst datesArray = [];\n\nfor (let i = 0; i < 30; i++) {\n    const date = new Date(); // Get the current date and time\n    date.setDate(date.getDate() - i); // Subtract i days from the current date\n\n    let dateString;\n\n    if (i === 0) {\n        dateString = \"Vandaag\"; // Today's date label\n    } else if (i === 1) {\n        dateString = \"Gisteren\"; // Yesterday's date label\n    } else {\n        // Format the date as DD-MM-YYYY\n        dateString = date.getDate().toString().padStart(2, '0') + \"-\" \n                   + (date.getMonth() + 1).toString().padStart(2, '0') + \"-\" \n                   + date.getFullYear();\n    }\n\n    datesArray.unshift(dateString); // Add to the start of the array to maintain chronological order\n}\n\nv.labels_30 = datesArray;\n\n// calculate percentage\n\nlet totalChats = 0;\nlet successfulChats = 0;\n\n\n\nchatsCountArray.forEach(number => {\n    totalChats += number;\n});\n\nsuccessCountArray.forEach(number => {\n    successfulChats += number;\n});\n\nlet percentage = (successfulChats / totalChats) * 100;\n\n{\nisNaN(percentage) ? percentage = 100 : percentage = (successfulChats / totalChats) * 100;\n}\n\ndocument.querySelector('[w-el=\"success-percentage\"]').innerHTML = percentage.toFixed(1) + '%';\n\n// push chart\n \nwindow.Wized.push((Wized) => {\n\n    const weight = v.success_30;\n    const weightTotal = v.totalChats_30;\n    const labels = v.labels_30;\n \n    // Ensure the DOM is fully loaded before initializing the chart\n    const ctx = document.getElementById(\"canvasCandle\").getContext(\"2d\");\n    const chart = new Chart(ctx, {\n        type: 'bar',\n        data: {\n            labels: labels,\n            datasets: [\n            {\n                fill: true,\n                data: weight,\n                label: 'Succesvol door AI',\n                borderRadius: { topLeft: 5, topRight: 5, bottomLeft: 0, bottomRight: 0 },\n              \tbackgroundColor: '#7E79F0',\n                borderSkipped: false,\n            },{\n                fill: true,\n                data: weightTotal,\n                label: 'Aantal gesprekken',\n                borderRadius: { topLeft: 5, topRight: 5, bottomLeft: 0, bottomRight: 0 },\n              \tbackgroundColor: '#EFE9FE',\n                borderSkipped: false,\n            },{\n                fill: true,\n                data: Array(30).fill(Math.max(...weightTotal)),\n                borderRadius: { topLeft: 5, topRight: 5, bottomLeft: 0, bottomRight: 0 },\n              \tbackgroundColor: '#FBFBFF',\n                borderSkipped: false,\n            }]\n        },\n        options: {\n        \tclip: false,\n            responsive: true,\n            maintainAspectRatio: false,\n            interaction: {\n      \t\t\t\tintersect: false,\n      \t\t\t\t\tmode: 'index',\n           \t},\n            plugins: {\n                legend: {\n                \tposition: 'bottom',\n                    display: false, // Ensures no legend is displayed\n                },\n                tooltip: {\n                    position: 'average',\n                    filter: function (tooltipItem) {\n        \t\t\treturn tooltipItem.datasetIndex === 0 || tooltipItem.datasetIndex === 1;\n    \t\t\t\t},\n                    itemSort: function (a, b) {\n                    return b.datasetIndex - a.datasetIndex;\n                    },\n                    usePointStyle: true,\n                    caretSize: 6,\n                    caretPadding: 8,\n                \tintersect: false,\n                \tbackgroundColor: '#080808',\n                    borderColor: '#fff',\n                    borderWidth: '2',\n                    footerFontStyle: 'light',\n                    footerColor: '#fff',\n                    titleColor: '#fff',\n                    bodyColor: '#fff',\n                    bodySpacing: -3,\n                    padding: 12,\n                    cornerRadius: 10,\n                    displayColors: false,\n                    footerFont: {\n                        size: 10,\n                        weight: 'normal'\n                    },\n                    bodyFont: {\n                        size: 14,\n                        weight: 'bold'\n                    },\n                    titleFont: {\n                        size: 10,\n                        weight: 'normal',\n                    }\n                }\n            },\n            scales: {\n                x: {\n                \t\tstacked: true,\n                    grid: {\n                        color: '#FFFFFF',\n                        drawBorder: false\n                    },\n                    ticks: {\n                        display: false // X-axis labels to white\n                    }\n                },\n                y: {\n                \t\tbeginAtZero: true,\n                \t\tmin: 0,\n                        max: (Math.max(...weightTotal)),\n                \t\tgrid: {\n                        color: '#F5F5F5',\n                        borderDash: [8, 8],\n                        borderWidth: 2,\n                        drawBorder: false\n                    },\n                    ticks: {\n                        display: false // X-axis labels to white\n                    }\n                }\n            },\n            hover: {\n    \t\t\t\t\tintersect: false\n  \t\t\t\t\t}\n        }\n    })\n});\n",
          action: 'run-function'
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: '8fda368d-3d91-4ddc-84e0-352930ddb0c4'
    },
    {
      request: 'VHepDvprAWpqGBIGUYcA',
      name: 'add urls after get_sitemap',
      id: 'dc8spE8ksY1FpWxA6Ckl',
      trigger: 'after-request',
      after: [
        {
          function:
            "if (r.get_sitemap.ok == true) {\n  const newUrls = r.get_sitemap.data.urls;\n  console.log(\"newUrls\")\n  const popupElement = document.querySelector('[w-el=\"popup-create-datasource\"]');\n  const isPopupVisible = window.getComputedStyle(popupElement).display === 'flex';\n\n  if (isPopupVisible) {\n    // Always add all URLs when the create datasource popup is visible\n    v.crawledpages = [...new Set(newUrls.map(url => url.trim().toLowerCase()))];\n\n    const totalUrlsCount = v.crawledpages.length;\n\n    // Show a toast displaying the total number of URLs found\n    const toastMessage = `${totalUrlsCount} URLs in totaal gevonden`;\n\n    window.showToastNotification(toastMessage, 'success');\n\n    // Show the URL form and hide the website form\n    document.querySelector('[datasourcesform=\"website\"]').style.display = 'none';\n    document.querySelector('[datasourcesform=\"url\"]').style.display = 'flex';\n    \n\n  } else {\n    const existingUrls = v.scrapetool_urls_list || []; // Ensure it's an array\n\n    // Extract and normalize existing URLs\n    const normalizedExistingUrls = existingUrls.map(entry => entry.url.trim().toLowerCase());\n    const existingUrlsSet = new Set(normalizedExistingUrls);\n\n    // Filter new URLs by excluding those already in existingUrlsSet\n    const addedUrls = newUrls.filter(url => !existingUrlsSet.has(url.trim().toLowerCase()));\n\n    // Add only the new URLs to the crawledpages list\n    v.crawledpages = [...new Set(addedUrls.map(url => url.trim().toLowerCase()))];\n\n    // Count the new and total URLs\n    const addedUrlsCount = addedUrls.length;\n    const totalUrlsCount = v.crawledpages.length;\n\n    // Show a notification with the total and newly added URLs in Dutch\n    const toastMessage =\n      addedUrlsCount === newUrls.length\n        ? `${totalUrlsCount} URLs in totaal gevonden` // All URLs are new\n        : addedUrlsCount > 0\n        ? `${totalUrlsCount} URLs in totaal gevonden, ${addedUrlsCount} nieuwe URLs toegevoegd` // Some new URLs\n        : 'Geen nieuwe URLs gevonden'; // No new URLs\n\n    window.showToastNotification(toastMessage, 'success');\n  }\n}\n\n// Hide the spinner\ndocument.querySelectorAll('[spinner]').forEach(function (element) {\nelement.style.display = 'none';\n});",
          action: 'run-function'
        }
      ],
      type: 'event',
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      name: 'active chat timestamp - time',
      attributes: [{ name: 'active-chat-inbox-time' }],
      id: 'dfc57e19-fc8f-4075-bb44-73feeaf40315',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            "const date = new Date(v.chats.find((chat) => chat.id === v.active_chat).created_at);\n\nreturn `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;",
          setting: 'text'
        }
      ],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      id: 'e0sEg75CYiNnaK0plOQl',
      name: 'redirect after create_user',
      folderId: '282de06d-bce3-4d8b-b577-d9e0ec11a35d',
      type: 'event',
      trigger: 'after-request',
      request: '7e33da97-52fa-4536-b037-9ea1ac76a478',
      after: [
        { action: 'navigate-to', url: 'return "/"', hasCondition: true, condition: 'return (r.create_user.ok == true)' },
        {
          action: 'run-function',
          function:
            "const spinner = document.querySelector('[spinner=\"auth\"]');\nconst signupButton = document.querySelector('[multi-step-signup=\"button\"]');\nspinner.style.display = 'none';\nsignupButton.setAttribute('value', 'Account maken');",
          hasCondition: true,
          condition: 'return (!r.create_user.ok == true)'
        }
      ]
    },
    {
      name: 'set chat label - phone',
      attributes: [{ name: 'phone-label' }],
      id: 'e26c91f1-afb6-4f29-8ea5-3345d626e4ad',
      type: 'element',
      actions: [
        {
          value: "return (\n  (v.chats[v.i].enduser_phone !== null && v.chats[v.i].enduser_phone !== '') ||\n  (v.chats[v.i].chat_user_phone !== null && v.chats[v.i].chat_user_phone !== '')\n);\n",
          setting: 'visibility'
        }
      ],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'organization dropdown - set initials',
      attributes: [{ name: 'organization-initials' }],
      id: 'e3cfb156-aa33-4ee4-8b6f-1a4e96602585',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_user_data.data[0].organizations[0].company_name.charAt(0);\n', setting: 'text' }],
      folderId: '9604a1d7-0df8-496f-b4b4-8f0975084ef1'
    },
    {
      name: 'preview - button',
      attributes: [{ name: 'btn-preview' }],
      id: 'e77e8029-b8db-4e62-b8c2-79dfd969bcc1',
      type: 'element',
      actions: [
        {
          value:
            'const chatbotId = v.active_chatbot;\n\nconst pageUrl = window.location.href;\nlet targetPath;\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  targetPath = `/?id=${chatbotId}`;\n} else {\n  targetPath = `/?id=${chatbotId}&dev=true`;\n}\n\ntargetUrl = "https://preview.sleak.chat"\nreturn targetUrl + targetPath\n',
          key: 'href',
          setting: 'attribute'
        }
      ],
      folderId: '1e11a85b-77a9-441a-a07e-79727b419fd9'
    },
    {
      name: 'empty state | chats / inbox > filtering',
      attributes: [{ name: 'empty-state-filtering' }],
      id: 'e7be7e0e-603d-42cb-9386-08a392d8f5a6',
      type: 'element',
      actions: [{ value: 'return (v.chats.length == 0 && v.usedFilters == true)', setting: 'visibility' }],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      id: 'e7fbce04-68fa-4bfe-a0ec-b008974ea0b0',
      name: 'Live chat - send admin message',
      folderId: '25fe132c-9171-46e3-b363-84ff68552eeb',
      type: 'element',
      attributes: [{ name: 'admin-ui-chat-form' }],
      actions: [
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          resetForm: true,
          action: 'perform-request',
          request: 'ff801139-7e06-4a92-92f6-07f59dd0d500',
          hasCondition: true,
          condition: 'return (v.chats.find((chat) => chat.id === v.active_chat).livechat == true && i["admin-ui-chat-input"].length > 0)'
        }
      ]
    },
    {
      name: '3d. link_preview - description',
      attributes: [{ name: 'link_preview-descr' }],
      id: 'e8ce6adc-f76f-4893-b71e-54e6a4b92e47',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.title\n\n}',
          setting: 'text'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      request: '8578e3e8-9133-4087-bdcd-c038e305fcb9',
      condition: 'return (n.path == "/chatbot")',
      name: 'Set variables & run on page load (7 days chatbot)',
      id: 'e8f274dc-0dc5-4249-afa6-d1f866fdd751',
      trigger: 'after-request',
      after: [
        {
          function:
            'await new Promise((res) => setTimeout(res, 100));\n\n// define data\n\nconst chatsData = r.get_chats_analytics.data;\n\n//// Construct array chats\n\nlet chatsCountArray7 = [];\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 6 + i);\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return (\n      createdAt >= dayStart &&\n      createdAt <= dayEnd &&\n      chat.chatbot_id === v.active_chatbot.data\n    );\n  }).length;\n\n  chatsCountArray7.push(filteredChatsCount);\n}\n\n// set var manually\n\n{\n  {\n    chatsCountArray7.some((item) => item > 0)\n      ? (v.numbers_7 = chatsCountArray7)\n      : (v.numbers_7 = [10, 38, 13, 26, 25, 40, 20]);\n  }\n}\n\n// push chats chart\n\nwindow.Wized.push((Wized) => {\n  const colors = {\n    main: {\n      default: "#7E79F0", // purple\n      half: "EFE9FE", // middle purple\n      quarter: "#FCFBFF", // Light purple\n      zero: "rgba(225, 255, 58, 0)",\n    },\n    secondary: {\n      default: "rgba(80, 102, 120, 1)",\n      quarter: "rgba(80, 102, 120, 0.25)",\n    },\n  };\n\n  const weight = v.numbers_7;\n  const labels = [1, 2, 3, 4, 5, 6, 7];\n\n  // Ensure the DOM is fully loaded before initializing the chart\n  const ctx = document.getElementById("canvas2").getContext("2d");\n    chatbotsChart1 = new Chart(ctx, {\n    type: "line",\n    data: {\n      labels: labels,\n      datasets: [\n        {\n          fill: true, // Ensure the area under the line is filled\n          // backgroundColor: colors.main.quarter, // Use a light green for the fill color\n          backgroundColor: (context) => {\n            if (!context.chart.chartArea) {\n              return;\n            }\n            // console.log(context.chart.chatArea);\n            const {\n              ctx,\n              data,\n              chartArea: { top, bottom },\n            } = context.chart;\n            const gradientBg = ctx.createLinearGradient(0, top, 0, bottom);\n            gradientBg.addColorStop(0, "rgb(126,121,240,0.25)");\n            gradientBg.addColorStop(1, "rgba(255, 255, 255, 0)");\n            return gradientBg;\n          },\n          borderColor: colors.main.default,\n          pointBackgroundColor: colors.main.default,\n          data: weight,\n          lineTension: 0.4,\n          borderWidth: 2,\n          pointRadius: 0,\n          pointBorderColor: "rgba(0, 0, 0, 0)",\n          pointBackgroundColor: "rgba(0, 0, 0, 0)",\n        },\n      ],\n    },\n    options: {\n      devicePixelRatio: 2.5,\n      clip: false,\n      responsive: true,\n      maintainAspectRatio: false,\n      interaction: {\n        intersect: false,\n        mode: "index",\n      },\n      plugins: {\n        legend: {\n          display: false, // Ensures no legend is displayed\n        },\n        tooltip: {\n          enabled: false,\n        },\n      },\n      scales: {\n        x: {\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n        y: {\n          min: 0.9 * Math.min(...weight),\n          max: 1.1 * Math.max(...weight),\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n      },\n      hover: {\n        intersect: false,\n      },\n    },\n  });\n});\n\n//// Construct array Human Handoffs\n\nlet HandoffCountArray7 = [];\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 6 + i);\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return (\n      createdAt >= dayStart &&\n      createdAt <= dayEnd &&\n      chat.agent_requested === true &&\n      chat.chatbot_id === v.active_chatbot.data\n    );\n  }).length;\n\n  HandoffCountArray7.push(filteredChatsCount);\n}\n\n// set var manually\n\n{\n  {\n    HandoffCountArray7.some((item) => item > 0)\n      ? (v.handoff_7 = HandoffCountArray7)\n      : (v.handoff_7 = [10, 38, 13, 26, 25, 40, 20]);\n  }\n}\n\n// push handoff chart\n\nwindow.Wized.push((Wized) => {\n  const colors = {\n    main: {\n      default: "#7E79F0", // purple\n      half: "EFE9FE", // middle purple\n      quarter: "#FCFBFF", // Light purple\n      zero: "rgba(225, 255, 58, 0)",\n    },\n    secondary: {\n      default: "rgba(80, 102, 120, 1)",\n      quarter: "rgba(80, 102, 120, 0.25)",\n    },\n  };\n\n  const weight2 = v.handoff_7;\n  const labels = [1, 2, 3, 4, 5, 6, 7];\n\n  // Ensure the DOM is fully loaded before initializing the chart\n  const ctx = document.getElementById("canvas3").getContext("2d");\n    chatbotsChart2 = new Chart(ctx, {\n    type: "line",\n    data: {\n      labels: labels,\n      datasets: [\n        {\n          fill: true, // Ensure the area under the line is filled\n          // backgroundColor: colors.main.quarter, // Use a light green for the fill color\n          backgroundColor: (context) => {\n            if (!context.chart.chartArea) {\n              return;\n            }\n            // console.log(context.chart.chatArea);\n            const {\n              ctx,\n              data,\n              chartArea: { top, bottom },\n            } = context.chart;\n            const gradientBg = ctx.createLinearGradient(0, top, 0, bottom);\n            gradientBg.addColorStop(0, "rgb(126,121,240,0.25)");\n            gradientBg.addColorStop(1, "rgba(255, 255, 255, 0)");\n            return gradientBg;\n          },\n          borderColor: colors.main.default,\n          pointBackgroundColor: colors.main.default,\n          data: weight2,\n          lineTension: 0.4,\n          borderWidth: 2,\n          pointRadius: 0,\n          pointBorderColor: "rgba(0, 0, 0, 0)",\n          pointBackgroundColor: "rgba(0, 0, 0, 0)",\n        },\n      ],\n    },\n    options: {\n      devicePixelRatio: 2.5,\n      clip: false,\n      responsive: true,\n      maintainAspectRatio: false,\n      interaction: {\n        intersect: false,\n        mode: "index",\n      },\n      plugins: {\n        legend: {\n          display: false, // Ensures no legend is displayed\n        },\n        tooltip: {\n          enabled: false,\n        },\n      },\n      scales: {\n        x: {\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n        y: {\n          min: 0.9 * Math.min(...weight2),\n          max: 1.1 * Math.max(...weight2),\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n      },\n      hover: {\n        intersect: false,\n      },\n    },\n  });\n});\n\n//aantal chats\n\nlet chatsSum = 0;\n\nchatsCountArray7.forEach((day) => {\n  chatsSum += day;\n});\n\ndocument.querySelector(\'[w-el="chatbot-total-chats"]\').innerHTML = chatsSum;\n\n//aantal handoffs\n\nlet handoffSum = 0;\n\nHandoffCountArray7.forEach((day) => {\n  handoffSum += day;\n});\n\ndocument.querySelector(\'[w-el="chatbot-total-handoffs"]\').innerHTML =\n  handoffSum;\n',
          action: 'run-function'
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: '8fda368d-3d91-4ddc-84e0-352930ddb0c4'
    },
    {
      name: 'set file preview visibility',
      attributes: [{ name: 'csv-upload-preview' }],
      id: 'e9608d11-d0a9-4181-bc62-28bd1eb8b790',
      type: 'element',
      actions: [{ style: 'display', value: 'if (v.csvContent && v.csv_rows.length > 0) {\n  return "flex"\n} else {\n  return "none"\n}', setting: 'style' }],
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849'
    },
    {
      condition: 'if (i["csv-upload"]["0"]) {\n  return true\n}',
      name: 'set csvContent variable',
      after: [
        {
          function:
            'var file = i["csv-upload"]["0"];\n\nvar reader = new FileReader();\n\nreader.onload = function (e) {\n  \n  // v.csvContent = e.target.result;\n\n  function sizeInMBorKB(sizeBytes) {\n      const sizeMB = (sizeBytes / (1024 * 1024)).toFixed(2);\n      if (sizeBytes < 1024 * 1024) {\n        const sizeKB = (sizeBytes / 1024).toFixed(2);\n        return `${sizeKB} KB`;\n      }\n      return `${sizeMB} MB`;\n    }\n    const fileSize = file.size;\n    const readableSize = sizeInMBorKB(fileSize);\n\n    const createdAt = new Date();\n      const prettyDate = createdAt.getDate().toString().padStart(2, \'0\') + "-" + (createdAt.getMonth() + 1).toString().padStart(2, \'0\') + "-" + createdAt.getFullYear();\n      const prettyTime = createdAt.getHours().toString().padStart(2, \'0\') + ":" + createdAt.getMinutes().toString().padStart(2, \'0\');\n\n    v.csvContent = {\n      value: e.target.result,\n      name: file.name,\n      size: readableSize,\n      date: prettyDate,\n      time: prettyTime,\n    };\n    // console.log(v.csvContent)\n};\n\nreader.readAsText(file);\n',
          action: 'run-function'
        }
      ],
      trigger: 'condition',
      id: 'e9efa383-7324-4e04-862e-880ba31b552e',
      type: 'event',
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849'
    },
    {
      id: 'eb3452d6-ea72-476b-a358-0aaf9c13927b',
      name: 'Data sources elements - set img src',
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7',
      type: 'element',
      attributes: [{ name: 'datasource-list-item-img-src' }],
      actions: [
        {
          setting: 'attribute',
          key: 'src',
          value:
            "if (r.get_datasources.data[v.i].data_type == 'pdf') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc1cd277ec15f33fdc7b3_file-info-alt.svg'\n} else if (r.get_datasources.data[v.i].data_type == 'csv') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc226b395d689963bd587_database.svg'\n} else if (r.get_datasources.data[v.i].data_type === 'pdf2') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/67239dd4e768c478e10fb6b4_file%20(1).svg'\n} else if (r.get_datasources.data[v.i].data_type == 'url') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7e4473d4ee68c12db_link-h.svg'\n} else if (r.get_datasources.data[v.i].data_type == 'api') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7ac7247ea9e3f5e3f_code-branch.svg'\n}"
        }
      ]
    },
    {
      name: 'settings form handling - notificaties',
      attributes: [{ name: 'form-settings-notificaties' }],
      id: 'ec850419-30b1-45b8-86fb-c449e77d139f',
      type: 'element',
      actions: [
        {
          value:
            'return {\n  notifications_email: r.get_chatbot.data.notifications.emails,\n  toggle_chatInitiated: r.get_chatbot.data.notifications.events.chatInitiated,\n  toggle_sentContactDetails: r.get_chatbot.data.notifications.events.sentContactDetails,\n  toggle_humanHandoffActivated: r.get_chatbot.data.notifications.events.humanHandoffActivated,\n  toggle_livechatNewMessage: r.get_chatbot.data.notifications.events.livechatNewMessage\n}',
          setting: 'form'
        },
        { request: 'b754a62d-249b-48ba-aa44-9809723fefb8', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' }
      ],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      id: 'ed291ffa-1cf9-4619-9130-b2989f448623',
      name: 'Active data source elements - set type',
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7',
      type: 'element',
      attributes: [{ name: 'active-datasource-list-item-type' }],
      actions: [
        {
          setting: 'text',
          type: 'text',
          value:
            "const dataType = r.get_datasources.data.find(item => item.id === v.active_datasource).data_type\n\nif (dataType == 'pdf') {\n    return 'kennisbank'\n} else if (dataType == 'csv') {\n    return 'CSV bestand'\n} else if (dataType === 'pdf2') {\n    return 'PDF bestand';\n} else if (dataType == 'url') {\n    return 'Website'\n} else if (dataType == 'api') {\n    return 'API koppeling'\n}"
        }
      ]
    },
    {
      request: '9425c8a3-851f-4aea-994c-af3b88ad7fe8',
      condition: 'return !v.active_chatbot\n',
      name: 'set active_chatbot if null',
      id: 'ed6ad6a8-dd20-456f-bde9-9d26ad12b5b2',
      trigger: 'after-request',
      after: [
        {
          condition: 'return (r.get_chatbots.data.length !== 0)',
          function:
            '// for first item ?\n\nWized.data.v.active_chatbot = r.get_chatbots.data[0].id;\n\ndata.dynamicActiveChatbotName = r.get_chatbots.data[0].name;\nlocalStorage.setItem("activeName", r.get_chatbots.data[0].name);\ndata.dynamicActiveChatbotUrl = r.get_chatbots.data[0].website_url;\nlocalStorage.setItem("activeUrl", r.get_chatbots.data[0].website_url);\n\n// re-fetch data-sources for new active chatbot\nWized.requests.execute("get_datasources");\n\n// re-fetch new active chatbot ???\nWized.requests.execute("get_chatbot");',
          action: 'run-function',
          hasCondition: true
        },
        {
          condition: 'return (r.get_chatbots.data.length == 0)',
          function: 'document.querySelector("[w-el=\'datasources-skeleton-wrapper\']").style.display = "none";',
          action: 'run-function',
          hasCondition: true
        }
      ],
      type: 'event',
      hasCondition: true,
      folderId: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c'
    },
    {
      name: 'Set active chatbot initials',
      attributes: [{ name: 'dropdown-active-chatbot-initials' }],
      id: 'ed841720-767e-43ae-96f5-de740960bd36',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).name.charAt(0)\n', setting: 'text' }],
      folderId: '206c14ea-c3ef-4b95-bdd4-2150463e4999'
    },
    {
      condition: 'return (n.path == "/redirect" && r.get_user.ok == true)',
      name: 'redirection',
      trigger: 'condition',
      after: [
        {
          function:
            'function getQueryParam(param) {\n  const urlParams = new URLSearchParams(window.location.search);\n  return urlParams.get(param);\n}\n\nconst targetUrl = getQueryParam("url");\nconsole.log(targetUrl);\nif (!targetUrl) {\n  console.log("no target url")\n} else {\n  setTimeout(() => {\n    n.path = "https://dashboard.sleak.chat/" + targetUrl;\n  }, 1000);\n}',
          action: 'run-function'
        }
      ],
      id: 'edc98b15-bdad-46c2-8b55-d4e71a4472b5',
      type: 'event',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8'
    },
    {
      name: '4b. success_message - email',
      attributes: [{ name: 'success_message-email' }],
      id: 'edd0e73b-da32-4ea3-ba5e-0dc8a0053857',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "success_message") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type_data.email\n\n}',
          setting: 'text'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'api headers empty state visibility',
      attributes: [{ name: 'emptystate-api-list-headers' }],
      id: 'eecd4ab3-272f-4e3a-8fc8-a9694eab7a66',
      type: 'element',
      actions: [{ value: 'return (v.apiHeadersArray.length == 0)', setting: 'visibility' }],
      folderId: '9e6f3363-0e9e-4dd2-8928-334d30e52b27'
    },
    {
      name: 'delete datasource form',
      attributes: [{ name: 'form-delete-datasource' }],
      id: 'ef271ee3-8b5a-4df9-b3d4-394b5d5be8b3',
      type: 'element',
      actions: [
        {
          function:
            'window.Wized = window.Wized || [];\n    window.Wized.push(async (Wized) => {\n\n    Wized.requests.execute("delete_datasource");\n\n    const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n    editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n    document.querySelectorAll(\'[popupmodal]\').forEach((item) => {\n    item.style.display = "none";\n    });\n\n    await Wized.requests.waitFor("delete_datasource");\n\n    Wized.requests.execute("get_datasources");\n    await Wized.requests.waitFor("get_datasources");\n\n    v.active_datasource = r.get_datasources.data[0].id;\n\n\n    // Element visibility\n    const pdfForm = document.querySelector("[w-el=\'form-container-edit-pdf\']");\n    const csvForm = document.querySelector("[w-el=\'form-container-edit-csv\']");\n    const urlForm = document.querySelector("[w-el=\'form-container-edit-url\']");\n    const apiForm = document.querySelector("[w-el=\'form-container-edit-api\']");\n\n    const activeType = r.get_datasources.data[0].data_type;\n\n    if (activeType === "pdf") {\n        pdfForm.style.display = "flex";\n    } else if (activeType === "csv") {\n        csvForm.style.display = "flex";\n    } else if (activeType === "url") {\n        urlForm.style.display = "flex";\n    } else if (activeType === "api") {\n        apiForm.style.display = "flex";\n    }\n\n    return r.get_datasources.data[0].data_type;\n\n});',
          action: 'run-function',
          event: 'submit',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee'
    },
    {
      request: '828aa4d6-8919-45cb-8964-f0cd7f2b48a2',
      condition: 'return r.signout_user.statusText == "Success"',
      name: 'navigate to login after signout',
      id: 'efdb1290-cccc-4dc9-9b1d-a126541fd8e4',
      after: [{ function: "localStorage.setItem('sleak_loggedin', false);\nn.path = '/login'", action: 'run-function' }],
      trigger: 'after-request',
      type: 'event',
      hasCondition: true,
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8'
    },
    {
      id: 'f0d7b38a-52d9-4ebb-936a-d86a4e76c8fe',
      name: 'disable live chat - form',
      folderId: '25fe132c-9171-46e3-b363-84ff68552eeb',
      type: 'element',
      attributes: [{ name: 'livechat-chatbar-container' }],
      actions: [
        {
          setting: 'on-event',
          event: 'click',
          action: 'run-function',
          function: 'window.showToastNotification(\'Schakel livechat in om te chatten\', "warning");',
          hasCondition: true,
          condition: 'return !v.chats.find((chat) => chat.id === v.active_chat).livechat'
        },
        { setting: 'class', class: 'hidden', condition: 'return !v.chats.find((chat) => chat.id === v.active_chat).livechat' }
      ]
    },
    {
      request: '86c07921-dadf-4787-99ed-7f7ad261183c',
      name: '[DEPR] get_kb_items after create_kb_item',
      trigger: 'after-request',
      after: [{ request: '9d139b25-dc47-41e5-8bfd-f09ec49d71da', action: 'perform-request' }],
      id: 'f123fb29-6019-4d27-a68a-a2b9502cef68',
      type: 'event',
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c'
    },
    {
      name: 'organization dropdown - set email)',
      attributes: [{ name: 'organization-email' }],
      id: 'f12d196e-b80c-4d63-aa76-1b96555d0177',
      type: 'element',
      actions: [{ type: 'text', value: 'return r.get_user_data.data[0].organizations[0].email_address', setting: 'text' }],
      folderId: '9604a1d7-0df8-496f-b4b4-8f0975084ef1'
    },
    {
      condition: 'return (v.active_datasource !== null)',
      name: 'get joins',
      trigger: 'condition',
      id: 'f38b21a7-bcd0-4ab5-9e42-2d7b77a08051',
      after: [{ condition: "return (n.path.includes('/kennis/'))", function: 'Wized.requests.execute("get_chatbots_datasources_joins");', action: 'run-function', hasCondition: true }],
      type: 'event',
      folderId: '55214649-2bac-4398-a861-03d94d2aad9d'
    },
    {
      name: '3a. LIST ITEM - link_preview (copy)',
      attributes: [{ name: 'message-type-email_gate' }],
      id: 'f3ce3485-a5b1-48f9-9a07-489893617ef4',
      type: 'element',
      actions: [
        {
          value:
            'const formChatType = v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type\nreturn (formChatType == "fallbackmessage_form" || formChatType == "email_gate");\n',
          setting: 'visibility'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: '3f. link_preview - container url',
      attributes: [{ name: 'link_preview-container' }],
      id: 'f4533e82-1bbf-47fe-a519-58d0e44f8560',
      type: 'element',
      actions: [
        {
          value:
            'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type == "link_preview" == true) {\n    function formatUrl(url) {\n      if (!url.startsWith("http://") && !url.startsWith("https://")) {\n        return `https://${url}`;\n      }\n      return url;\n    }\n    const url = v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type_data.url;\n    return formatUrl(url);\n}',
          key: 'href',
          setting: 'attribute'
        }
      ],
      folderId: '45787f48-6bd2-43a9-b98d-6fd20db89712'
    },
    {
      name: 'Data sources elements - set type',
      attributes: [{ name: 'datasource-list-item-type' }],
      id: 'f4bac186-5285-4d12-9f06-686f1d536c49',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            "if (r.get_datasources.data[v.i].data_type == 'pdf') {\n    return 'kennisbank'\n} else if (r.get_datasources.data[v.i].data_type == 'csv') {\n    return 'CSV'\n} else if (r.get_datasources.data[v.i].data_type == 'url') {\n    return 'URL'\n} else if (r.get_datasources.data[v.i].data_type == 'api') {\n    return 'API'\n}",
          setting: 'text'
        }
      ],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'Data sources elements - set status color',
      attributes: [{ name: 'datasource-list-item-status' }],
      id: 'f58b6ef4-6ee7-41b8-9dfe-6e549a68c996',
      type: 'element',
      actions: [
        {
          style: 'background-color',
          value:
            'if (r.get_datasources.data[v.i].status == "draft") {\n  return "#e7b549"\n} else if (r.get_datasources.data[v.i].status == "active") {\n  return "#25d366"\n} else if (r.get_datasources.data[v.i].status == "inactive") {\n  return "#F37A80"\n}',
          setting: 'style'
        }
      ],
      folderId: 'f5742bd4-3be1-4f6b-8ea4-a77e7aaf22a7'
    },
    {
      name: 'set chat - operator avatar ',
      attributes: [{ name: 'chat-list-item-operator' }],
      id: 'f8150d49-d34b-4f6e-bb6f-5fcf11affce9',
      type: 'element',
      actions: [{ value: 'return (r.get_chatbots.data.find((item) => item.id === (v.chats[v.i].chatbot_id)).avatar_url)', key: 'src', setting: 'attribute' }],
      folderId: '25e9cc3d-2659-4485-9b30-26916278b400'
    },
    {
      name: 'installation script text',
      attributes: [{ name: 'installation-script-container' }],
      id: 'f93ab5d3-7085-4d19-ab01-5b9e0a7c591e',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'const userId = r.get_chatbot.data.id;\n\nconst pageUrl = window.location.href;\nlet sourceUrl;\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  sourceUrl = "https://cdn.sleak.chat";\n} else {\n  sourceUrl = "https://cdn.dev.sleak.chat";\n}\n\nif (i["installation-script-toggle"] == false) {\n  return `<!-- sleak.chat sleakbot embed snippet -->\n  <script id="sleakbot" src="${sourceUrl}/fetchsleakbot.js" chatbot-id="${userId}" ></script>`\n} else if (i["installation-script-toggle"] == true) {\n  return `<script>\nÂ var sleakGtmScript = document.createElement(\'script\');\nÂ sleakGtmScript.id = \'sleakbot\';\nÂ sleakGtmScript.src = \'${sourceUrl}/fetchsleakbot.js\';\nÂ sleakGtmScript.setAttribute(\'chatbot-id\', \'${userId}\');\nÂ document.body.appendChild(sleakGtmScript);\n</script>`\n}',
          setting: 'text'
        },
        {
          function:
            'const userId = r.get_chatbot.data.id;\n\nconst pageUrl = window.location.href;\nlet sourceUrl;\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  sourceUrl = "https://cdn.sleak.chat";\n} else {\n  sourceUrl = "https://cdn.dev.sleak.chat";\n}\n\nlet textToCopy;\n\nif (i["installation-script-toggle"] == false) {\n  textToCopy = `<!-- sleak.chat sleakbot embed snippet -->\n  <script id="sleakbot" src="${sourceUrl}/fetchsleakbot.js" chatbot-id="${userId}" ></script>`\n} else if (i["installation-script-toggle"] == true) {\n  textToCopy = `<script>\nÂ var sleakGtmScript = document.createElement(\'script\');\nÂ sleakGtmScript.id = \'sleakbot\';\nÂ sleakGtmScript.src = \'${sourceUrl}/fetchsleakbot.js\';\nÂ sleakGtmScript.setAttribute(\'chatbot-id\', \'${userId}\');\nÂ document.body.appendChild(sleakGtmScript);\n</script>`\n}\n\nnavigator.clipboard.writeText(textToCopy)\n  .catch(error => console.error(\'Error in copying text: \', error));\n\n\n// toast notifications\n\nconst toastMessage = {\n  "id": crypto.randomUUID(),\n  "expiration": new Date().getTime() + 5000,\n  "type": "success",\n  "message": "Installatiecode gekopieerd naar klembord"\n};\n\n// transitions\n\nfunction openToast(toastElement) {\n  toastElement.style.display = "flex";\n  toastElement.style.opacity = 0;\n  toastElement.style.transform = "translateY(40px) scale(0.6)";\n\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 1;\n      toastElement.style.transform = "translateY(0) scale(1)";\n    });\n  });\n}\n\nfunction closeToast(toastElement) {\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 0;\n      toastElement.style.transform = "translateY(40px) scale(0.6)";\n      setTimeout(() => {\n        toastElement.style.display = "none";\n      }, 150);\n    });\n  });\n}\n\nasync function manageToast(toastElement) {\n  openToast(toastElement);\n  await new Promise(resolve => setTimeout(resolve, 5000));\n  closeToast(toastElement);\n}\n\nv.toast_log.push(toastMessage)\n\nconst toastElement = document.querySelector(`[toast_item_id=\'${toastMessage.id}\']`);\n\nmanageToast(toastElement);\n',
          action: 'run-function',
          event: 'click',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'f8158d09-0ac8-4653-9ebe-dba0b72a2b38'
    },
    {
      id: 'fa06f10d-f1ae-4859-80c8-50647accc89b',
      name: 'set file preview file size',
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849',
      type: 'element',
      attributes: [{ name: 'csv-upload-preview-filesize' }],
      actions: [{ setting: 'text', type: 'text', value: 'return v.csvContent.size' }]
    },
    {
      request: '2b0b056c-0433-40b4-b023-013a58dd4123',
      name: 'load more array handling',
      trigger: 'after-request',
      after: [
        {
          function:
            '// re-index scrollbox element with new height\nvar scrollBox = document.querySelector(\'[w-el="chats-list-container"]\');\nconst chatItems = document.querySelectorAll(".chat-list-item");\n\nconst loadMoreChats = r.get_chats_pagination.data;\n\nconst existingChats = v.loadmorechats;\n\nv.loadmorechats = [...existingChats, ...loadMoreChats];\n',
          action: 'run-function'
        }
      ],
      id: 'fa21fd8d-095b-4374-8974-b9413af2d437',
      type: 'event',
      folderId: '99a16fdd-65fc-4ba5-9c99-4847a2473e67'
    },
    {
      name: 'render chats list - chatbot page',
      attributes: [{ name: 'chat-list-item-chatbotpage' }],
      id: 'fab77c2c-cc5f-4d50-9f99-4c0e6d967142',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.chats.slice(0,3);', setting: 'list' },
        { value: 'return v.chats[v.i].id', key: 'id', setting: 'attribute' },
        {
          function: 'const dataValue = event.currentTarget.getAttribute("id");\n\nv.active_chat = dataValue;\n\nWized.requests.execute("update_chat_hasunread");',
          action: 'run-function',
          event: 'click',
          setting: 'on-event'
        }
      ],
      folderId: '1e11a85b-77a9-441a-a07e-79727b419fd9'
    },
    {
      name: 'settings form handling - overig',
      attributes: [{ name: 'form-settings-overig' }],
      id: 'fbcc24d8-fe12-4d43-a915-30cad1e8e600',
      type: 'element',
      actions: [
        { value: 'return {\n  "toggle_publishing": r.get_chatbot.data.publishing.published,\n  "custom_css": r.get_chatbot.data.custom_css\n};\n', setting: 'form' },
        { request: 'aeea49d9-098f-4c0f-afa0-8da0cbbd187d', action: 'perform-request', event: 'submit', preventDefault: true, setting: 'on-event' }
      ],
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd'
    },
    {
      name: 'skeleton loader | inbox',
      attributes: [{ name: 'inbox-loading-1' }, { name: 'inbox-loading-2' }],
      id: 'fe89a676-f3e3-4901-9a2c-0009ae212a65',
      type: 'element',
      actions: [{ value: 'return (r.get_chats.ok == null)', setting: 'visibility' }],
      folderId: '26ec31b2-ef32-4dba-9742-7c0dc3e2f98d'
    },
    {
      name: 'render messages list',
      attributes: [{ name: 'message-list-item' }],
      id: 'ff7bcfea-d188-4aaf-aaa1-85b7f51a1dde',
      type: 'element',
      actions: [
        { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.chats.find(chat => chat.id === v.active_chat).messages;\n', setting: 'list' },
        { condition: 'return true', class: 'visible', setting: 'class' },
        { condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_bot")', class: 'bot', setting: 'class' },
        { condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_agent")', class: 'agent', setting: 'class' },
        { condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].author_type == "user")', class: 'user', setting: 'class' },
        { value: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].id)', key: 'message_list_id', setting: 'attribute' }
      ],
      folderId: '99a16fdd-65fc-4ba5-9c99-4847a2473e67'
    },
    {
      name: 'scraped urls list - set url (copy)',
      attributes: [{ name: 'scrapelist-scraped-datum' }],
      id: 'l3Rjs2XFk4qejXYO9f8K',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'const formatDateWithoutTime = (date) => {\n    const now = new Date();\n    const day = date.getDate();\n    const monthNames = ["jan", "feb", "mrt", "apr", "mei", "jun", "jul", "aug", "sep", "okt", "nov", "dec"];\n    const month = monthNames[date.getMonth()];\n    const year = date.getFullYear() === now.getFullYear() ? \'\' : ` ${date.getFullYear()}`;\n    \n    return `${day} ${month}${year}`;\n};\n\nreturn formatDateWithoutTime(new Date(v.scrapetool_urls_list_filtered[v.i].created_at));\n',
          setting: 'text'
        }
      ],
      folderId: 'PNvaP7BxV1nqggz2UG79'
    },
    {
      id: 'm5WS7PFx9MzqSBLjL4Qr',
      name: 'File upload processing state',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      type: 'element',
      attributes: [{ name: 'fle-upload-loading-state' }],
      actions: [{ setting: 'visibility', value: 'return (r.get_datasources.data.find((item) => item.id === v.active_datasource).file_upload_status == "processing");' }]
    },
    {
      id: 'mDy4deB9txWxN8BqCeSR',
      name: 'mobile inbox - hide messages container on prevBtn click',
      folderId: '8339c00a-50de-4a25-99f6-68a9f4835506',
      type: 'element',
      attributes: [{ name: 'messages-grid-container-prev-btn' }],
      actions: [{ setting: 'on-event', event: 'click', action: 'run-function', function: 'document.querySelector(\'[w-el="messages-grid-container"]\').style.display = "none";' }]
    },
    {
      id: 'nYl4HHSP1otNe6fW8jQd',
      name: 'update data source form - PDF',
      folderId: 'ac2fae40-fa94-482f-ad46-9a95cb4489ee',
      type: 'element',
      attributes: [{ name: 'form-edit-pdf2' }],
      actions: [
        {
          setting: 'form',
          value:
            'return {\n status: r.get_datasources.data.find(item => item.id === v.active_datasource).status,\n tool_description: r.get_datasources.data.find(item => item.id === v.active_datasource).tool_description\n}'
        },
        {
          setting: 'on-event',
          event: 'submit',
          preventDefault: true,
          action: 'run-function',
          function: 'Wized.requests.execute("update_pdf2");\n\nawait Wized.requests.waitFor(\'update_pdf2\');\n\nWized.requests.execute("get_datasources");\n'
        }
      ]
    },
    {
      id: 'opKMfddnXQSBoVH0Cm4m',
      name: 'set pdf2 file preview size',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      type: 'element',
      attributes: [{ name: 'pdf2-upload-preview-filesize' }],
      actions: [
        {
          setting: 'text',
          type: 'text',
          value:
            'function sizeInMBorKB(sizeBytes) {\n  const sizeMB = (sizeBytes / (1024 * 1024)).toFixed(2);\n  if (sizeBytes < 1024 * 1024) {\n    const sizeKB = (sizeBytes / 1024).toFixed(2);\n    return `${sizeKB} KB`;\n  }\n  return `${sizeMB} MB`;\n}\n\nconst fileSize = i["pdf2-upload"]["0"].size;\nreturn sizeInMBorKB(fileSize);'
        }
      ]
    },
    {
      name: 'chatbot count - max',
      attributes: [{ name: 'chatbot-count-max' }],
      id: 'q8wGqQYFhfmRGR662oMk',
      type: 'element',
      actions: [
        {
          type: 'text',
          value:
            'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nif (maxChatbots !== null){\n  return maxChatbots\n} else if (organization.subscription_plan && organization.subscription_plan.includes("expert")) {\n  return 3\n} else {\n  return 1\n}',
          setting: 'text'
        }
      ],
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a'
    },
    {
      id: 'rZJwrWC9pt1mUC4itRl6',
      name: 'file upload status text',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      type: 'element',
      attributes: [{ name: 'active-datasource-fileupload-status' }],
      actions: [
        {
          setting: 'text',
          type: 'text',
          value:
            'const activeDatasourcestatus = (r.get_datasources.data.find((item) => item.id === v.active_datasource).file_upload_status);\n\nif (activeDatasourcestatus == "success") {\n  return "Upload voltooid"\n} else if (activeDatasourcestatus == "processing") {\n  return "Aan het verwerken"\n} else if (activeDatasourcestatus == "failed") {\n  return "Fout opgetreden"\n} else if (activeDatasourcestatus == "") {\n  // orange\n  return "#e7b549"\n}\n'
        }
      ]
    },
    {
      id: 'rkVohcoRlLNVpZJdJ0RN',
      name: 'set pdf2 file preview name',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      type: 'element',
      attributes: [{ name: 'pdf2-upload-preview-name' }],
      actions: [{ setting: 'text', type: 'text', value: 'return i["pdf2-upload"]["0"].name' }]
    },
    {
      id: 'ryURzkzra8PttbOyDSbF',
      name: 'pdf2 input clear btn',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      type: 'element',
      attributes: [{ name: 'clear-pdf2-btn' }],
      actions: [
        {
          setting: 'on-event',
          event: 'click',
          action: 'run-function',
          function: 'i["pdf2-upload"] = {};\nconst form = document.querySelector("[w-el=\'form-create-datasource-pdf2\']")\nform.reset();'
        }
      ]
    },
    {
      request: 'xSr95XwPJqWgVNFcIqGe',
      name: 'add urls after firecrawl_map',
      id: 's2GpvrU7g2ixGZqUADaA',
      trigger: 'after-request',
      after: [
        {
          function:
            "if (r.firecrawl_map.ok == true) {\n  const newUrls = r.firecrawl_map.data.links;\n  const popupElement = document.querySelector('[w-el=\"popup-create-datasource\"]');\n  const isPopupVisible = window.getComputedStyle(popupElement).display === 'flex';\n\n  if (isPopupVisible) {\n    // Always add all URLs when the create datasource popup is visible\n    v.crawledpages = [...new Set(newUrls.map(url => url.trim().toLowerCase()))];\n\n    const totalUrlsCount = v.crawledpages.length;\n\n    // Show a toast displaying the total number of URLs found\n    const toastMessage = `${totalUrlsCount} URLs in totaal gevonden`;\n\n    window.showToastNotification(toastMessage, 'success');\n\n    // Show the URL form and hide the website form\n    document.querySelector('[datasourcesform=\"website\"]').style.display = 'none';\n    document.querySelector('[datasourcesform=\"url\"]').style.display = 'flex';\n    \n\n  } else {\n    const existingUrls = v.scrapetool_urls_list || []; // Ensure it's an array\n\n    // Extract and normalize existing URLs\n    const normalizedExistingUrls = existingUrls.map(entry => entry.url.trim().toLowerCase());\n    const existingUrlsSet = new Set(normalizedExistingUrls);\n\n    // Filter new URLs by excluding those already in existingUrlsSet\n    const addedUrls = newUrls.filter(url => !existingUrlsSet.has(url.trim().toLowerCase()));\n\n    // Add only the new URLs to the crawledpages list\n    v.crawledpages = [...new Set(addedUrls.map(url => url.trim().toLowerCase()))];\n\n    // Count the new and total URLs\n    const addedUrlsCount = addedUrls.length;\n    const totalUrlsCount = v.crawledpages.length;\n\n    // Show a notification with the total and newly added URLs in Dutch\n    const toastMessage =\n      addedUrlsCount === newUrls.length\n        ? `${totalUrlsCount} URLs in totaal gevonden` // All URLs are new\n        : addedUrlsCount > 0\n        ? `${totalUrlsCount} URLs in totaal gevonden, ${addedUrlsCount} nieuwe URLs toegevoegd` // Some new URLs\n        : 'Geen nieuwe URLs gevonden'; // No new URLs\n\n    window.showToastNotification(toastMessage, 'success');\n  }\n}\n\n// Hide the spinner\ndocument.querySelectorAll('[spinner=\"crawl-urls\"]').forEach(function (element) {\nelement.style.display = 'none';\n});",
          action: 'run-function'
        }
      ],
      type: 'event',
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      id: 'sWMOW1HI30sY1zURS365',
      name: 'revert recurring scrape addon',
      folderId: 'PNvaP7BxV1nqggz2UG79',
      type: 'event',
      trigger: 'after-request',
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      after: [
        {
          action: 'run-function',
          function:
            "const hasRecurringAddon = !!r.get_user_data?.data?.[0]?.organizations?.[0]?.subscriptions?.find(sub => sub.subscription_type == 'base' && sub.addon_recurringscrape === true) ?? false;\n\nif (!hasRecurringAddon && r.activate_recurring_scrape_addon.ok !== true) {\n  const closePseudoElement = document.querySelector('[w-el=\"reduccingscrape-addon-reverse\"]');\n  const recurringCheckbox = document.querySelector('[w-el=\"recurring-checkbox-container\"]');\n  const recurringPopup = document.querySelector('[popupmodal=\"recurringscrape-upgrade\"]');\n\n  console.log('no addon');\n  recurringCheckbox.addEventListener('click', function () {\n    recurringPopup.style.transform = 'translateY(5px)';\n    recurringPopup.style.opacity = 0;\n    recurringPopup.style.display = 'flex';\n    setTimeout(() => {\n      recurringPopup.style.transform = 'translateY(0)';\n      recurringPopup.style.opacity = 1;\n    }, 10);\n  });\n\n  closePseudoElement.addEventListener('click', function () {\n    i['toggle-recurringscrape'] = false;\n  });\n  document.addEventListener('keydown', function (event) {\n    if (event.key === 'Escape') {\n      i['toggle-recurringscrape'] = false;\n    }\n  });\n}\n",
          hasCondition: true,
          condition: 'return n.path.includes("/kennis/databronnen");'
        }
      ]
    },
    {
      name: 'scrape viewer click events',
      attributes: [{ name: 'scrapelist-list-item-clck' }],
      id: 'tdYHxF73wTmEgGxzpR2n',
      type: 'element',
      actions: [
        { value: 'return v.scrapetool_urls_list_filtered[v.i].id;\n', key: 'record_id', setting: 'attribute' },
        {
          function:
            'const dataValue = event.currentTarget.getAttribute("record_id");\nlet currentUrl = v.scrapetool_urls_list_filtered.find(item => item.id === dataValue);\n\n$(\'[w-el="scrape-pageviewer-url"]\').text(currentUrl.url);\n$(\'[w-el="scrape-pageviewer-url-container"]\').attr(\'href\', currentUrl.url);\n$(\'[w-el="scrape-pageviewer-charcount"]\').text(currentUrl.content.length);\n\n// Format date in the desired format\nconst formatDate = (date) => {\n    const now = new Date();\n    const day = date.getDate();\n    const monthNames = ["jan", "feb", "mrt", "apr", "mei", "jun", "jul", "aug", "sep", "okt", "nov", "dec"];\n    const month = monthNames[date.getMonth()];\n    const year = date.getFullYear() === now.getFullYear() ? \'\' : ` ${date.getFullYear()}`;\n    const hours = date.getHours().toString().padStart(2, \'0\');\n    const minutes = date.getMinutes().toString().padStart(2, \'0\');\n    \n    return `${day} ${month}${year} - ${hours}:${minutes}`;\n};\n\nconst createdAt = new Date(currentUrl.created_at);\nconst updatedAt = new Date(currentUrl.updated_at);\n\n$(\'[w-el="scrapeviewer-createdat"]\').text(formatDate(createdAt));\n$(\'[w-el="scrapeviewer-updatedat"]\').text(formatDate(updatedAt));\n\n// convert with marked library\n$(\'[w-el="scrape-pageviewer-cotent"]\').html(marked.parse(currentUrl.content));\n\n// Element visibility\nconst editTopicContainer = document.querySelector("[w-el=\'scrape-page-viewer-container\']");\n\neditTopicContainer.style.transform = \'translateX(20px)\';\neditTopicContainer.style.opacity = 0;\neditTopicContainer.style.display = \'flex\';\nsetTimeout(() => {\n    editTopicContainer.style.transform = \'translateX(0)\';\n    editTopicContainer.style.opacity = 1;\n}, 50);\n\nconst scrollBox = document.querySelector("[content-scrollbox]");\nif (scrollBox) {\n    scrollBox.scrollTop = 0;\n}\n',
          action: 'run-function',
          event: 'click',
          preventDefault: true,
          setting: 'on-event'
        }
      ],
      folderId: 'gccMuQyf668xZ0Ngt6Cg'
    },
    {
      id: 'tejTVPmtKKzAUckdvGpT',
      name: 'auth btn loading text',
      folderId: '282de06d-bce3-4d8b-b577-d9e0ec11a35d',
      type: 'element',
      attributes: [{ name: 'loadingwrap' }],
      actions: [
        {
          setting: 'style',
          style: 'display',
          value:
            'if (r.create_user.isRequesting == true || r.auth_user.isRequesting == true || r.create_user.statusText == "Success" || r.auth_user.statusText == "Success") {\n  return "flex"\n} else {\n  return "none"\n}'
        }
      ]
    },
    {
      id: 'wEVfPEhCcE3mzRwblat4',
      name: 'datasource-list-item-imag-src-shared',
      folderId: 'hiARdgSU6l4YoqRL86jN',
      type: 'element',
      attributes: [{ name: 'datasource-list-item-img-src-shared' }],
      actions: [
        {
          setting: 'attribute',
          key: 'src',
          value:
            "if (v.datasourceSharingNavbarList[v.i].data_type == 'pdf') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc1cd277ec15f33fdc7b3_file-info-alt.svg'\n} else if (v.datasourceSharingNavbarList[v.i].data_type == 'csv') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc226b395d689963bd587_database.svg'\n} else if (v.datasourceSharingNavbarList[v.i].data_type === 'pdf2') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/67239dd4e768c478e10fb6b4_file%20(1).svg'\n} else if (v.datasourceSharingNavbarList[v.i].data_type == 'url') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7e4473d4ee68c12db_link-h.svg'\n} else if (v.datasourceSharingNavbarList[v.i].data_type == 'api') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7ac7247ea9e3f5e3f_code-branch.svg'\n}"
        }
      ]
    }
  ],
  elements: [
    {
      id: '002c88c5-c60b-4046-b524-9dbb5fa6314b',
      name: 'scrape-list-checkbox',
      attributes: { values: [{ id: 'd046593f-93a2-4f47-8fdb-a40c92caab17', key: 'id', value: 'return `scrape-page-` + v.i\n' }] }
    },
    {
      id: '004c52f3-1e7c-4d91-a711-30e586dc492e',
      name: 'admin-ui-chat-form',
      events: [
        {
          id: 'd63af01f-dc80-4b3d-96e7-27f558d1a74c',
          type: 'submit',
          actions: [
            {
              id: 'a8e00e03-7d80-4fbf-bb80-a0f352752b21',
              type: 'perform-request',
              request: 'ff801139-7e06-4a92-92f6-07f59dd0d500',
              hasCondition: true,
              condition: 'return (v.chats.find((chat) => chat.id === v.active_chat).livechat == true && i["admin-ui-chat-input"].length > 0)'
            }
          ],
          hasCondition: false,
          preventDefault: true,
          resetForm: true
        }
      ]
    },
    {
      id: '005b5af7-d98b-4666-877d-27a0172767df',
      name: 'active-datasource-fileupload-status-indicator',
      styles: {
        values: [
          {
            id: '23747d00-9a72-4b89-90cf-5d6e8c4e1c86',
            property: 'background-color',
            value:
              'const activeDatasourcestatus = (r.get_datasources.data.find((item) => item.id === v.active_datasource).file_upload_status);\n\nif (activeDatasourcestatus == "success") {\n  return "#00b343"\n} else if (activeDatasourcestatus == "processing") {\n  return "#4285F4"\n} else if (activeDatasourcestatus == "failed") {\n  return "#F37A80"\n} else if (activeDatasourcestatus == "") {\n  // orange\n  return "#e7b549"\n}\n'
          }
        ]
      }
    },
    {
      id: '00c0c831-40c9-4385-9c8b-a5b47648dfe0',
      name: 'datasource-sharing-chatbots-dropdown-list-item-initials',
      text: { value: '// return v.chatbots[v.i].name\nreturn v.datasourceSharingChatbotsDropdown[v.i].name.charAt(0)' }
    },
    { id: '013962ff-84b0-4010-8a6f-1ce6ced31547', name: 'pdf2-upload-preview-name', text: { value: 'return i["pdf2-upload"]["0"].name' } },
    {
      id: '016c6e5f-c27a-496f-ac15-cb672b68d9da',
      name: 'form-settings-algemeen',
      form: {
        value:
          "const rawUrl = r.get_chatbot.data.website_url;\n\nconst formattedUrl = rawUrl.replace('https://', '');\n\nreturn {\n  chatbot_name: r.get_chatbot.data.name,\n  organization_name: r.get_chatbot.data.organization_name,\n  website_url: formattedUrl,\n  language: r.get_chatbot.data.language,\n  first_message: r.get_chatbot.data.first_message,\n  cs_email: r.get_chatbot.data.cs_email\n}\n"
      },
      events: [
        {
          id: '1d0a9cdc-47f8-49f8-831d-5e2eabd92d64',
          type: 'submit',
          actions: [
            { id: 'be82c121-15bd-4803-b320-8fea79303faa', type: 'perform-request', request: '2432144e-fed0-4ad8-8649-a6631c46b1fb' },
            {
              id: 'c7659eb6-3f90-4ff6-94d4-e3b4737e1967',
              type: 'perform-request',
              request: '04896350-7db5-44ee-b832-ca64a811430e',
              hasCondition: true,
              condition:
                'if (i["settigs-avatar-input"]["0"]) {\n  if (i["settigs-avatar-input"] == \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\') {\n    return false\n  } else {\n    return true\n  }\n} else {\n  return false\n}'
            },
            {
              id: 'ef9dd35d-e367-4f77-af1e-8f24a8689f40',
              type: 'perform-request',
              request: '29fa247a-9d03-4453-b85a-4c894e73d52d',
              hasCondition: true,
              condition:
                'if (i["settigs-avatar-input"]["0"]) {\n  if (i["settigs-avatar-input"] == \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\') {\n    return true\n  } else {\n    return false\n  }\n} else {\n  return false\n}'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '019f1f65-ab7e-4048-b7f6-a44093b10532',
      name: 'trial-modal-days-remaining',
      text: {
        value:
          'const organization = r.get_user_data.data[0].organizations[0];\n\nif (organization.subscription_status !== "active" || organization.subscription_status == null) {\n    const currentDate = new Date();\n    const createdAt = new Date(organization.created_at);\n    const trialPeriodDays = 14;\n\n    const diffTime = currentDate - createdAt;\n    \n    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n    const remainingDays = trialPeriodDays - diffDays;\n\n    if (remainingDays > 0) {\n        return `Nog ${remainingDays} dagen over`;\n    } else {\n        return `${Math.abs(remainingDays)} dagen verlopen`;\n    }\n  }',
        type: 'html'
      }
    },
    {
      id: '01c6d6c2-5906-450a-8b1a-3e7f33aa6715',
      name: 'link_preview-container',
      attributes: {
        values: [
          {
            id: 'a9f0ebc3-f295-47b8-a35c-481d45407e70',
            key: 'href',
            value:
              'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type == "link_preview" == true) {\n    function formatUrl(url) {\n      if (!url.startsWith("http://") && !url.startsWith("https://")) {\n        return `https://${url}`;\n      }\n      return url;\n    }\n    const url = v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type_data.url;\n    return formatUrl(url);\n}'
          }
        ]
      }
    },
    { id: '020b1765-3c69-4a13-a36c-db474c2302b5', name: 'emptystate-scrapelist', visibility: { value: 'return (v.scrapetool_urls_list_filtered.length == 0)' } },
    {
      id: '02357c69-e33e-4f1a-b5a7-868569b3fd3e',
      name: 'visibility-channels-disabled',
      styles: { values: [{ id: '326237be-d4a9-4c89-b117-a9bd74f17f25', property: 'display', value: 'if (i["toggle_channels"] == true) {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: '0264317d-dfbc-41d9-8e3b-e1e5381eb4a4',
      name: 'kb-artikel-datum',
      text: {
        value:
          "const rawDate = v.filteredKbList[v.i].created_at;\nconst date = new Date(rawDate);\nconst month = date.toLocaleDateString('nl-NL', { month: 'long' }).substring(0, 3);\nconst day = date.getDate();\nconst formattedDate = `${day} ${month}`;\nreturn formattedDate;"
      }
    },
    {
      id: '02c0274e-286a-406c-a85d-850d83dbfc3a',
      name: 'fle-upload-loading-state',
      visibility: { value: 'return (r.get_datasources.data.find((item) => item.id === v.active_datasource).file_upload_status == "processing");' }
    },
    {
      id: '031daa09-7d97-4c65-b5e3-0b46cc2b0361',
      name: 'archive-chat',
      events: [
        {
          id: 'ea624b43-b527-4528-9b96-86ce40b28868',
          type: 'click',
          actions: [
            {
              id: '58cb48e3-c8ca-4480-a329-67323580d074',
              type: 'run-function',
              function:
                'Wized.requests.execute("update_chat_archive");\n\nawait Wized.requests.waitFor("update_chat_archive");\n\n// remove chat from array\nlet index = v.chats.findIndex((chat) => chat.id === v.active_chat);\n\nif (index !== -1) {\n  let newActiveChatIndex;\n  if (index === v.chats.length - 1) {\n    newActiveChatIndex = v.chats.length > 2 ? index - 1 : null;\n  } else {\n    newActiveChatIndex = index;\n  }\n\n  ["loadmorechats", "newchats", "rawchats"].forEach((chatArrayName) => {\n    let chatArray = v[chatArrayName];\n    let indexInChatArray = chatArray.findIndex(\n      (chat) => chat.id === v.active_chat\n    );\n    if (indexInChatArray !== -1) {\n      chatArray.splice(indexInChatArray, 1);\n    };\n    \n  });\n\n  // Set the new active chat before splicing\n  v.active_chat = v.chats[newActiveChatIndex].id;\n} else {\n  console.error("No chat found for chat with chat_id:", payload.new.chat_id);\n}\n'
            }
          ]
        }
      ]
    },
    {
      id: '0340fdef-04a4-4133-9589-13626a5a90f0',
      name: 'form-create-datasource-url',
      events: [
        {
          id: '8a751e73-3118-4f25-9ccb-71c9167af747',
          type: 'submit',
          actions: [
            {
              id: '31e6a1a0-297d-424a-9492-0c405d837e81',
              type: 'run-function',
              function:
                'Wized.requests.execute("create_url");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\n// redundant?\n// dataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\n\n  // Deprecaten - .find() method gebruiken\n  Wized.data.v.active_datasource_type = "url";\n\n  // Element visibility\n  const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n  const editForm = document.querySelector("[w-el=\'form-container-edit-url\']");\n  editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n  await Wized.requests.waitFor(\'create_url\');\n  console.log("url id = ", r.create_url.data.id);\n\n  Wized.requests.execute("get_datasources");\n  Wized.data.v.active_datasource = r.create_url.data.id;\n\n  await Wized.requests.waitFor("get_datasources");\n  // update container visibility\n  editForm.style.display = "flex";\n\n\n  // reset create forms - al gedaan bovenin?\n  // const allForms = document.querySelectorAll(".datasources-formblock");\n  // const formWrapperInitial = document.getElementById("create-datasource-form");\n  // allForms.style.display = "none";\n  // formWrapperInitial.style.display = "flex";\n\n\n\nWized.requests.execute(\'upsert_urls\');\n  console.log("active datasource = ", v.active_datasource);\n  console.log("upsert_urls executed");\n\n  document.querySelector(\'[popupmodal="create-datasource"]\').style.display = "none";\n\n  window.showProgressBarAndHideControls();\n\n  await Wized.requests.waitFor(\'upsert_urls\');\n\n  console.log("upsert_urls finished");\n  Wized.requests.execute(\'get_scrape_pages\');\n\n  if (r.upsert_urls.ok) {\n    console.log("upsert_urls is OK");\n    v.lastScrapeBatchUrls = v.crawledpages\n\n    // Set the flag indicating a scrape job has been initiated\n    v.isScrapeJobInitiated = true;\n\n    window.updateCheckboxVisibilityAndCounts();\n    \n    // reset crawled array\n    v.crawledpages = []\n  }',
              hasCondition: true,
              condition:
                'const organization = r.get_user_data.data[0].organizations[0];\n\nreturn (n.path.includes (\'/kennis/databronnen\') && v.crawledpages.length > 0 && (organization.subscription_status == "active" && organization.subscription_plan.includes("expert")))'
            },
            {
              id: 'd04ae4d2-dcd2-4b86-9dd6-ad4234f34cdd',
              type: 'run-function',
              function: "Wized.requests.execute(\"create_url\");\nawait Wized.requests.waitFor('create_url');\n\nv.active_datasource = r.create_url.data.id;\n\nn.path = '/kennis/databronnen?tn=cd'",
              hasCondition: true,
              condition: "return (n.path.includes ('/kennis/prompt') || n.path.includes ('/admin-create-datasource'))"
            },
            {
              id: 'eb4e2531-d2b8-48a9-8aca-32de0a767c78',
              type: 'run-function',
              function:
                '// Show expert gate with animations\nconst popup = document.querySelector(\'[popupmodal="expert-gate"]\');\n\npopup.style.transform = "translateY(10px)";\npopup.style.opacity = 0;\npopup.style.display = "flex";\n\nsetTimeout(() => {\n    popup.style.transition = "transform 0.2s ease, opacity 0.2s ease";\n    popup.style.transform = "translateY(0)";\n    popup.style.opacity = 1;\n}, 10);\n',
              hasCondition: true,
              condition: 'const organization = r.get_user_data.data[0].organizations[0];\nreturn (organization.subscription_status !== "active" || !organization.subscription_plan.includes("expert"))'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: '03a59d08-b3d9-4bc5-bdc0-21cf44f87c74', name: 'active-filter-label-livechat', visibility: { value: 'return (v.inboxFilterStatus == "livechat")' } },
    {
      id: '03eac6ce-06da-4d08-b043-67699232917a',
      name: 'datasource-csv-preview-timestamp-filename',
      text: { value: 'return r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.name;' }
    },
    {
      id: '03ed17fb-2bfd-498f-a5fc-ed515443fa7d',
      name: 'active-chatbot-status-label-published',
      visibility: { value: 'return (r.get_chatbots.data.find((item) => item.id === v.active_chatbot).publishing.published == true)' }
    },
    {
      id: '0622cfc0-dbb9-4d65-8877-dcd7fdb0ffb9',
      name: 'form-delete-datasource',
      events: [
        {
          id: 'dc9b15a9-2dd6-4736-bfc2-3f53ac28f9c4',
          type: 'submit',
          actions: [
            {
              id: '36025250-863f-4996-ac49-7bc6fc817988',
              type: 'run-function',
              function:
                'window.Wized = window.Wized || [];\n    window.Wized.push(async (Wized) => {\n\n    Wized.requests.execute("delete_datasource");\n\n    const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n    editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n    document.querySelectorAll(\'[popupmodal]\').forEach((item) => {\n    item.style.display = "none";\n    });\n\n    await Wized.requests.waitFor("delete_datasource");\n\n    Wized.requests.execute("get_datasources");\n    await Wized.requests.waitFor("get_datasources");\n\n    v.active_datasource = r.get_datasources.data[0].id;\n\n\n    // Element visibility\n    const pdfForm = document.querySelector("[w-el=\'form-container-edit-pdf\']");\n    const csvForm = document.querySelector("[w-el=\'form-container-edit-csv\']");\n    const urlForm = document.querySelector("[w-el=\'form-container-edit-url\']");\n    const apiForm = document.querySelector("[w-el=\'form-container-edit-api\']");\n\n    const activeType = r.get_datasources.data[0].data_type;\n\n    if (activeType === "pdf") {\n        pdfForm.style.display = "flex";\n    } else if (activeType === "csv") {\n        csvForm.style.display = "flex";\n    } else if (activeType === "url") {\n        urlForm.style.display = "flex";\n    } else if (activeType === "api") {\n        apiForm.style.display = "flex";\n    }\n\n    return r.get_datasources.data[0].data_type;\n\n});'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: '068f08d2-d85f-4fc8-8544-829ef37b0b46', name: 'datasource-sharing-list-container', visibility: { value: 'return (v.datasourceSharingChatbotsActiveList.length !== 0)' } },
    {
      id: '069673f1-95fb-4983-84e4-80e13291311f',
      name: 'add-datasource-access-btn',
      visibility: { value: 'return (v.datasource_sharing_selected !== null)' },
      events: [
        {
          id: '58481956-dff0-4e21-bde8-261d9e81efca',
          type: 'click',
          actions: [
            {
              id: '4ff760b7-7d22-45e5-bc6f-3f7adf58e663',
              type: 'run-function',
              function:
                'Wized.requests.execute("create_chatbots_datasources_join");\nawait Wized.requests.waitFor("create_chatbots_datasources_join");\n\nv.datasource_sharing_selected = null;\n\nWized.requests.execute("get_chatbots_datasources_joins");'
            }
          ],
          hasCondition: false
        }
      ]
    },
    { id: '07906aa2-2945-4587-8d1e-a885a3bef333', name: 'api-properties-list-item-key', value: { value: 'return v.apiPropertiesArrayII[v.iII].property' } },
    {
      id: '0827a254-c90d-4d54-8400-e02b75d2f300',
      name: 'beta-modal',
      visibility: {
        value:
          'const activeDatasourceType = (r.get_datasources.data.find((item) => item.id === v.active_datasource).data_type);\nreturn (activeDatasourceType == "api" || activeDatasourceType == "url")'
      }
    },
    {
      id: '09317163-98f7-4a70-8cdf-da1c139bc390',
      name: 'create-portal',
      visibility: { value: 'return (r.get_user_data.data[0].organizations[0].subscription_status == "active" || r.get_user_data.data[0].organizations[0].subscription_status == "overdue" )' },
      events: [
        {
          id: '7982feb0-5626-482a-a1d9-fc1c43c06164',
          type: 'click',
          actions: [{ id: '1aa02dc9-fcf7-4ee3-a292-d59708b02ef3', type: 'run-function', function: 'Wized.requests.execute("create_portal_session");' }]
        }
      ]
    },
    {
      id: '0HmIBxZLhnkGiqnbWVGl',
      name: 'tagging-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.chatbotTags' },
      attributes: { values: [{ id: '68682380-55ed-48f6-b1e3-9e981e59357b', key: 'tagging-list-item-tag', value: 'return v.chatbotTags[v.i].tag' }] },
      events: [
        {
          id: '38c103b9-b08b-40b7-9025-a36cd8c482d7',
          type: 'mouseleave',
          actions: [
            {
              id: 'fda11cba-f479-4f6b-b90e-1c4e32f4ab93',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"tagging-delete-btn\"]');\ncloseButton.style.transform = 'translateY(3px)';\ncloseButton.style.opacity = '0';\nsetTimeout(() => {\n  closeButton.style.display = 'none';\n}, 200);"
            }
          ]
        },
        {
          id: '02aee464-5bcc-4d66-85b0-01b15dcb7081',
          type: 'mouseenter',
          actions: [
            {
              id: 'd8637b32-c80c-43ac-a547-4e49d64c766e',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"tagging-delete-btn\"]');\n\ncloseButton.style.display = 'flex';\nsetTimeout(() => {\n  closeButton.style.opacity = '1';\ncloseButton.style.transform = 'translateY(0)';\n}, 1);\n"
            }
          ]
        }
      ]
    },
    { id: '0RM3qBbSFRmmKHu5Trqy', name: 'xml-amount', text: { value: "return (r.get_datasources.data.find((item) => item.id === v.active_datasource).results.total_items_in_database) + ' items';" } },
    {
      id: '0a8e6afb-9e40-46f4-9041-2c8de1409306',
      name: 'api-tool-formattig-visibility',
      styles: {
        values: [
          { id: '3bf52fb5-c597-4b05-9be7-a52b97e0b176', property: 'display', value: 'if (i["input-formattig_enabled"] == true) {\n  return "flex"\n} else {\n  return "none"\n}\n\n// return true' }
        ]
      }
    },
    {
      id: '0a9eeaeb-24e0-44f5-abb1-fd0ce1f9f858',
      name: 'clear-pdf2-btn',
      events: [
        {
          id: '83bf0ec2-edfe-470e-847b-a2243221e982',
          type: 'click',
          actions: [
            {
              id: '3ae0b85a-d6dd-4122-a937-a15843354a73',
              type: 'run-function',
              function: 'i["pdf2-upload"] = {};\nconst form = document.querySelector("[w-el=\'form-create-datasource-pdf2\']")\nform.reset();'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: '0c8f9bcf-180e-4612-baf7-b361843f2b6a',
      name: 'link_preview-img',
      attributes: {
        values: [
          {
            id: 'cc58dd52-881a-46a5-b62e-443b7e51d941',
            key: 'src',
            value:
              'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.image\n\n}'
          }
        ]
      }
    },
    {
      id: '0cb0d38f-92c8-4e20-8cb2-fb3fb914632d',
      name: 'datasource-sharing-list-item-name-url',
      text: { value: 'return r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).website_url' }
    },
    { id: '0d211959-3819-44c1-a79f-9ecf5065f6cb', name: 'chatbot-list-item-url', text: { value: 'return r.get_chatbots.data[v.i].website_url.replace("https://", "")' } },
    { id: '0d51d008-5672-4d0b-9266-d6616a028882', name: 'crawl-urls-total', text: { value: 'return v.crawledpages.length' } },
    {
      id: '0d57c7f5-5d7a-4cde-b1c5-73bcc19680d9',
      name: 'form-password-reset',
      events: [
        {
          id: '344ac048-1702-400b-911c-93246fdf88a4',
          type: 'submit',
          actions: [{ id: '737a3a3f-a7ce-4728-95e8-ba7d62f87f16', type: 'run-function', function: 'Wized.requests.execute("reset_password");' }],
          hasCondition: false
        }
      ]
    },
    {
      id: '0d9862d0-b065-4485-863e-73ebce89cc72',
      name: 'form-edit-api',
      form: {
        value:
          'var dataSource = r.get_datasources.data.find((item) => item.id === v.active_datasource);\n\nreturn {\n  status: dataSource.status,\n  name: dataSource.name,\n  tool_description: dataSource.tool_description,\n  // api_body_type: dataSource.datasource_type_config.bodyType,\n  // method: dataSource.datasource_type_config.method,\n  // protocol: dataSource.datasource_type_config.protocol,\n  body: dataSource.datasource_type_config.body,\n  // api_headers: dataSource.datasource_type_config.headers,\n  // properties: dataSource.datasource_type_config.properties,\n  endpoint_url: dataSource.datasource_type_config.endpointUrl,\n  formatting: dataSource.datasource_type_config.outputSchema,\n  auth_username: dataSource.datasource_type_config.basicAuthCredentials.username,\n  auth_password: dataSource.datasource_type_config.basicAuthCredentials.password,\n  headers_enabled: dataSource.datasource_type_config.headers_enabled,\n  formattig_enabled: dataSource.datasource_type_config.outputformatting_enabled,\n  email_validation: dataSource.datasource_type_config.email_validation.enabled,\n  emailvalidation_keypath: dataSource.datasource_type_config.email_validation.emailKey\n}'
      },
      events: [
        {
          id: '449ff389-2b1f-45e6-909a-4f148914d196',
          type: 'submit',
          actions: [
            {
              id: '10baafe9-8bdb-4172-a60c-1466c3964c91',
              type: 'run-function',
              function: 'Wized.requests.execute("update_api");\n\nawait Wized.requests.waitFor(\'update_api\');\n\nWized.requests.execute("get_datasources");',
              hasCondition: true,
              condition: 'return (v.outputSchemaObjectIsValid == true || v.codemirrorInitialized == false)'
            },
            {
              id: '7e621035-e6f1-473d-b0b8-0be921577661',
              type: 'run-function',
              function:
                '// transitions\n\nfunction openToast(toastElement) {\n  toastElement.style.display = "flex";\n  toastElement.style.opacity = 0;\n  toastElement.style.transform = "translateY(40px) scale(0.6)";\n\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 1;\n      toastElement.style.transform = "translateY(0) scale(1)";\n    });\n  });\n}\n\nfunction closeToast(toastElement) {\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 0;\n      toastElement.style.transform = "translateY(40px) scale(0.6)";\n      setTimeout(() => {\n        toastElement.style.display = "none";\n      }, 150);\n    });\n  });\n}\n\nasync function manageToast(toastElement) {\n  openToast(toastElement);\n  await new Promise((resolve) => setTimeout(resolve, 5000));\n  closeToast(toastElement);\n}\n\n// toast notifications\n\nasync function showToastNotification(message, type) {\n  const toastMessage = {\n    id: crypto.randomUUID(),\n    expiration: new Date().getTime() + 5000,\n    type: type,\n    message: message,\n  };\n\n  v.toast_log.push(toastMessage);\n\n  const toastElement = document.querySelector(\n    `[toast_item_id=\'${toastMessage.id}\']`\n  );\n\n  manageToast(toastElement);\n}\n\n/// \n\n\nshowToastNotification(\n  "Het output schema JSON object is invalide.",\n  "error"\n);',
              hasCondition: true,
              condition: 'return (v.outputSchemaObjectIsValid == false)'
            },
            { id: 'a03ab612-ec29-4f1f-969a-5dc24d3fb2e8', type: 'run-function', function: 'console.log("submit")' }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '0edfe587-7df2-481a-b2f4-6f96d5a469a8',
      name: 'link_preview-descr',
      text: {
        value:
          'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.title\n\n}'
      }
    },
    {
      id: '0f1e8f98-eff9-4e24-9a4f-a399fecc12a8',
      name: 'reset-filters',
      events: [
        {
          id: '27d7fb05-c2e9-411e-80b9-9df931c13581',
          type: 'click',
          actions: [
            {
              id: 'a5b069e6-6fbd-4702-bebf-a366377069ea',
              type: 'run-function',
              function:
                'v.loadmorechats = [];\n\nv.inboxFilterLabel = "open";\nv.inboxFilterStatus = "all";\nv.inboxFilterChatbots = r.get_chatbots.data.map(chatbot => chatbot.id);\n\nWized.requests.execute("get_chats");\n\n// reset active filter preheader\nconst filterbar = document.querySelector("[w-el=\'inbox-subheader-activefilters\']");\nfilterbar.style.display = "none"\n\n// reset filter buttons\ndocument.querySelectorAll(\'[w-el="filter-label"]\').forEach((element) => {\n  element.classList.remove("active");\n});\ndocument.querySelector("[filter-value=\'open\']").classList.add("active");\n\ndocument.querySelectorAll(\'[w-el="filter-status"]\').forEach((element) => {\n  element.classList.remove("active");\n});\ndocument.querySelector("[filter-value=\'all\']").classList.add("active");'
            }
          ],
          hasCondition: false
        }
      ]
    },
    { id: '0f7df2a4-dfb0-4056-b6ce-f049639a673d', name: 'active-chatbot-websiteurl', text: { value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).website_url\n' } },
    { id: '0kEL11w9jfOQM87rQxHu', name: 'listitem-maualtags-tagname', text: { value: 'return v.filteredTags[v.i].tag' } },
    {
      id: '10173b65-9020-4a8c-9d2e-000e4eb68092',
      name: 'create-datasorce-pdf2-selectbox',
      styles: {
        values: [
          {
            id: 'f71e06ee-8454-4a81-a3bc-3300c336c486',
            property: 'display',
            value:
              'const organization = r.get_user_data.data[0].organizations[0];\nconst pdfEnabled = (organization.pdfupload_enabled == true)\nif (pdfEnabled) {\n  return "flex"\n} else {\n  return "none"\n}'
          }
        ]
      }
    },
    { id: '120ee36f-c546-4b3a-8e23-2fba331d3e57', name: 'archive-label', visibility: { value: 'return (\n  (v.chats[v.i].archived == true)\n);\n' } },
    { id: '122d1520-e8fb-4bb3-ae18-94bac2d0eef5', name: 'active-datasource-list-item-name', text: { value: 'return r.get_datasources.data.find(item => item.id === v.active_datasource).name\n' } },
    {
      id: '12807958-de07-45ab-b82b-e6ae43546486',
      name: 'toast-icon',
      attributes: {
        values: [
          {
            id: '3483a0bf-cc74-4364-97d9-9c4d70aae33b',
            key: 'src',
            value:
              '// return v.toast_log[v.i].message\n\nif (v.toast_log[v.i].type == "success") {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b2df4b53fe42c9223f00f2_check-circle%20(3).svg"\n} else if (v.toast_log[v.i].type == "error") {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65abe22a6f01cd5e4b5d261a_exclamation-circle%20(3).svg"\n} else if (v.toast_log[v.i].type == "warning") {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/661e2f3ec25b14bc1450b90b_exclamation-circle%20(5).svg"\n}'
          }
        ]
      }
    },
    {
      name: 'chat-list-item-time',
      id: '129eacb4-72ee-4c4c-85c1-e436d1bac50c',
      text: {
        value:
          '// const lastMessage = v.chats[v.i].messages[v.chats[v.i].messages.length - 1];\n// const messageTimestamp = lastMessage.created_at;\n\nconst messageTimestamp = v.chats[v.i].updated_at;\n\n// static timestamp for testing purposes\n// const messageTimestamp = "2024-07-17 15:37:44.006764+00";\n\n//\n\nfunction padZero(number) {\n  return number < 10 ? "0" + number : number.toString();\n}\n\nconst now = new Date();\nconst created_at = new Date(messageTimestamp);\nconst timeDiff = now - created_at;\nconst minutes = Math.floor(timeDiff / 60000);\nconst hours = Math.floor(minutes / 60);\nconst days = Math.floor(hours / 24);\n\nif (minutes < 1) {\n  return "zojuist";\n} else if (days > 7) {\n  const monthNames = [\n    "januari",\n    "februari",\n    "maart",\n    "april",\n    "mei",\n    "juni",\n    "juli",\n    "augustus",\n    "september",\n    "oktober",\n    "november",\n    "december",\n  ];\n  return `${created_at.getDate()} ${monthNames[created_at.getMonth()]}`;\n} else if (days >= 3) {\n  const dayNames = [\n    "zondag",\n    "maandag",\n    "dinsdag",\n    "woensdag",\n    "donderdag",\n    "vrijdag",\n    "zaterdag",\n  ];\n  return `${dayNames[created_at.getDay()]}`;\n} else if (days > 1) {\n  return `${days} dagen geleden`;\n} else if (\n  now.getUTCFullYear() > created_at.getUTCFullYear() ||\n  now.getUTCMonth() > created_at.getUTCMonth() ||\n  now.getUTCDate() > created_at.getUTCDate()\n) {\n  return "gisteren";\n} else if (hours >= 1) {\n  return `${padZero(created_at.getHours())}:${padZero(\n    created_at.getMinutes()\n  )}`;\n} else {\n  return `${minutes} min. geleden`;\n}\n'
      }
    },
    {
      id: '136babe0-90ca-4230-a09c-2738db539970',
      name: 'chat-list-item-chatbotpage',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.chats.slice(0,3);' },
      attributes: { values: [{ id: '9acf6fd6-df91-42c3-938a-73ad7416f609', key: 'id', value: 'return v.chats[v.i].id' }] },
      events: [
        {
          id: '7d4077af-4040-4dd5-9250-e14497f9f445',
          type: 'click',
          actions: [
            {
              id: '31165af0-e5ce-42fc-b8ff-cb9420aa3a87',
              type: 'run-function',
              function: 'const dataValue = event.currentTarget.getAttribute("id");\n\nv.active_chat = dataValue;\n\nWized.requests.execute("update_chat_hasunread");'
            }
          ],
          hasCondition: false
        }
      ]
    },
    { id: '141b11fc-280c-4c28-9a8f-e214bffc27f7', name: 'dropdown-active-chatbot-name', text: { value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).name' } },
    {
      id: '1468bcde-531f-42e0-94f0-5ddb60e9f8f7',
      name: 'active-chatbot-createdat',
      text: {
        value:
          "const isoDateString = r.get_chatbots.data.find((item) => item.id === v.active_chatbot).created_at;\n\nconst date = new Date(isoDateString);\n\n// Get today's date\nconst today = new Date();\n\n// Calculate the difference in days\nconst differenceInDays = (today - date) / (1000 * 3600 * 24);\n\n// Define the date format options\nconst dateFormatOptions = {\n    month: 'long', // \"april\"\n    day: 'numeric' // \"29\"\n};\n\n// Include the year if the difference is 365 days or more\nif (differenceInDays <= -365) {\n    dateFormatOptions.year = 'numeric'; // \"2024\"\n}\n\n// Convert to a more readable format in Dutch\nconst readableDate = date.toLocaleDateString('nl-NL', dateFormatOptions);\n\nreturn readableDate;"
      }
    },
    {
      id: '17164e90-a6d5-4234-bbde-195f661b3e4e',
      name: 'trial-notice',
      styles: {
        values: [
          {
            id: '27f772a3-0752-4a59-8157-7e3c329e41af',
            property: 'display',
            value: 'if (r.get_user_data.data[0].organizations[0].subscription_status !== "active") {\n  return "flex"\n} else {\n  return "none"\n}'
          }
        ]
      }
    },
    { id: '17200f5d-4121-4383-8da9-7d1c8e6ddfaa', name: 'chats-loaded', visibility: { value: 'return (r.get_chats_pagination.data == 0)' } },
    { id: '1812c80e-355a-403f-95d4-95eac4a4337a', name: 'agents-list-item-name-input', value: { value: 'return r.get_agents.data[v.i].name' } },
    { id: '19308258-5d88-4199-ad63-6b230de33a57', name: 'livechat-label', visibility: { value: 'return v.chats[v.i].livechat === true' } },
    {
      id: '19f0d058-7245-4794-ad9b-0525b3d955ff',
      name: 'api-properties-list-item',
      list: { indexVariable: 'b754b06d-70b9-42de-81b3-0484243d1c91', value: 'return v.apiPropertiesArrayII' },
      attributes: { values: [{ id: '1f821d09-8cbf-482c-8716-703dfebb182b', key: 'index', value: 'return v.apiPropertiesArrayII[v.iII].index' }] },
      events: [
        {
          id: '23bfc5ad-4792-47ae-9ca2-c7acc615bbbf',
          type: 'mouseenter',
          actions: [
            {
              id: '42dfc692-f5ec-4cca-b2e0-35a0ddd6266c',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"api-properties-list-item-delete-btn\"]');\n\ncloseButton.style.display = 'flex';\nsetTimeout(() => {\n  closeButton.style.opacity = '1';\ncloseButton.style.transform = 'translateY(0)';\n}, 1);\n"
            }
          ],
          hasCondition: false
        },
        {
          id: '49474247-fd1c-41c8-89d7-e34ed90d798c',
          type: 'mouseleave',
          actions: [
            {
              id: '04543009-ee80-44bf-990a-9859eef7ab69',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"api-properties-list-item-delete-btn\"]');\ncloseButton.style.transform = 'translateY(3px)';\ncloseButton.style.opacity = '0';\nsetTimeout(() => {\n  closeButton.style.display = 'none';\n}, 200);"
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: '1KHO6TScGrapYNuO9Pfr',
      name: 'tagging-listitem-settings-tagname',
      text: { value: 'return v.chatbotTags[v.i].tag' },
      attributes: {
        values: [
          {
            id: '5482c0e5-8bd6-4074-bb8d-ad1840b4846a',
            key: 'tagging-list-item-description',
            value:
              "const listItems = document.querySelectorAll('[w-el=tagging-list-item]');\n\nconst tagsArray = [];\n\nlistItems.forEach(item => {\n    const tag = item.getAttribute('tagging-list-item-value');\n    const description = item.getAttribute('tagging-list-item-description');\n\n    if (tag && description) {\n        tagsArray.push({\n            tag,\n            description\n        });\n    }\n});\n\nreturn tagsArray\n"
          }
        ]
      }
    },
    {
      id: '1LWMdfbgf7j77FI1ltBa',
      name: 'loadingwrap-xml',
      styles: { values: [{ id: 'd301586e-72cf-4f01-9b41-7f21c4e32914', property: 'display', value: 'if (r.validate_xml.isRequesting) {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: '1a87243c-a2f3-4d1b-b7d2-228c43a209eb',
      name: 'scrapelist-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.scrapetool_urls_list_filtered' },
      attributes: { values: [{ id: '332da846-076a-49e6-978a-51a4a4d013df', key: 'record_id', value: 'return v.scrapetool_urls_list_filtered[v.i].id;\n' }] },
      styles: {
        values: [
          {
            id: '32577f66-8c93-4157-aec9-e661e49a9b37',
            property: 'display',
            value:
              'const amountVisiblePages = i["scrape-pagination-itemsperpage"]; // Get the number of items per page\n\nif (amountVisiblePages == 20) {\n  if (v.i < 20){\n    return "flex"\n  } else {\n    return "none"\n  };  \n} else {\n  return "flex"; \n}'
          }
        ]
      }
    },
    {
      id: '1ad7b490-c207-4acd-bfe5-2643fe6c58cf',
      name: 'active-chat-inbox-chatbot-image',
      attributes: {
        values: [
          {
            id: '714f0a05-d3fe-426a-bd1c-1126e26fb872',
            key: 'src',
            value:
              '// if (v.chats.find((chat) => chat.id === v.active_chat).chatbots.avatar_url) {\n//   return v.chats.find((chat) => chat.id === v.active_chat).chatbots.avatar_url;\n// } else {\n//   return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n// }\n\nreturn r.get_chatbots.data.find((item) => item.id === v.chats.find((chat) => chat.id === v.active_chat).chatbot_id).avatar_url'
          }
        ]
      }
    },
    {
      id: '1b3ffb37-bdea-4a0b-aeee-e0195907e61e',
      name: 'loadingwrap',
      styles: {
        values: [
          {
            id: 'fb432401-3ca6-4698-abde-aa494f3dba88',
            property: 'display',
            value:
              'if (r.create_user.isRequesting == true || r.auth_user.isRequesting == true || r.create_user.statusText == "Success" || r.auth_user.statusText == "Success") {\n  return "flex"\n} else {\n  return "none"\n}'
          }
        ]
      }
    },
    {
      id: '1b69f5c6-35f0-4350-a90d-73171244c727',
      name: 'form-auth-signup',
      events: [
        {
          id: '0c0f855a-9375-4f1e-bb5d-740ab2adf963',
          type: 'submit',
          actions: [
            {
              id: '4fe80997-695b-49e8-9012-d94f1775ded4',
              type: 'run-function',
              function:
                'const signupButton = document.querySelector(\'[multi-step-signup="button"]\');\nconst spinner = document.querySelector(\'[spinner="auth"]\');\nspinner.style.display = \'flex\';\nsignupButton.setAttribute(\'value\', \'\');\n\n// clear local storage\nfor (let i = localStorage.length - 1; i >= 0; i--) {\n    const key = localStorage.key(i);\n    if (key.startsWith(\'wized_\')) {\n        localStorage.removeItem(key);\n    }\n}\n\nv.chatbots = null;\nv.active_chatbot = null;\nv.active_datasource = null;\nv.active_datasource_type = null;\nconsole.log("set to null");\n\nif (n.path === \'/signup\') {\n  if (!localStorage.getItem("sleakSignedUp")) {\n  dataLayer.push({\n    event: "trialSignup",\n    eventCategory: "Form",\n    eventAction: "SignupForm",\n    eventLabel: "Trial Signup",\n  });\n  localStorage.setItem("sleakSignedUp", "true");\n  console.log("signup event");\n  }\n  \n  return Wized.requests.execute(\'create_user\')\n} else {\n  return Wized.requests.execute(\'auth_user\')\n}'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: '1bfe7345-2873-424b-9605-c57df00712ae', name: 'inbox-loading-2', visibility: { value: 'return (r.get_chats.ok == null)' } },
    {
      id: '1e4be8fb-9932-436f-9319-35b0269a7864',
      name: 'form-edit-kb',
      form: { value: 'return {\n status: r.get_datasources.data.find(item => item.id === v.active_datasource).status\n}' },
      events: [
        {
          id: '4313fe58-90ce-4cf1-895b-2f3a3b516d03',
          type: 'submit',
          actions: [
            {
              id: '3f15fa83-f7d7-4e2e-9a75-e4e96eda3a1a',
              type: 'run-function',
              function: 'Wized.requests.execute("update_kb");\n\nawait Wized.requests.waitFor(\'update_kb\');\n\nWized.requests.execute("get_datasources");\n'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: '1kEPym0AKjOxBRZVM0P8', name: 'input-edit-topic-name' },
    {
      id: '2004d342-22e0-4893-bb65-5d42707d9bc3',
      name: 'upsert-urls-fombtn',
      styles: { values: [{ id: '7160d4b3-09d4-42cf-a33e-a66d2daa3eeb', property: 'display', value: 'if (v.crawledpages.length !== 0) {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: '207f330d-40bb-4be7-aae2-b03eee41120f',
      name: 'messages-grid-container-prev-btn',
      events: [
        {
          id: 'a7bdfff5-f69e-4317-9a13-97a7ea4f81fc',
          type: 'click',
          actions: [{ id: '9c669b2e-307f-49c9-91dd-89cbc367c81b', type: 'run-function', function: 'document.querySelector(\'[w-el="messages-grid-container"]\').style.display = "none";' }],
          hasCondition: false
        }
      ]
    },
    {
      id: '21497a5c-c2a5-45f3-a32b-9d054872f84a',
      name: 'outputscheme-toggle-wrap',
      events: [
        {
          id: 'd7376287-7f9d-405e-97c7-6fb68c709cc0',
          type: 'click',
          actions: [
            {
              id: '3c719f1a-fe7e-462e-a337-6f93e8323574',
              type: 'run-function',
              function:
                'setTimeout(() => {\n  // text-editor\n  // outputScheme code-editor\n\n  let textarea = document.getElementById("code-editor");\n  let codeMirrorInstance;\n  let validModal = document.querySelector("[w-el=\'modal-valid-json\']");\n  let invalidModal = document.querySelector("[w-el=\'modal-invalid-json\']");\n\n  function isValidJsonObject(value) {\n    try {\n      const parsed = JSON.parse(value);\n      return !!parsed && typeof parsed === "object" && !Array.isArray(parsed);\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function objectIsValid() {\n    validModal.style.display = "flex";\n    invalidModal.style.display = "none";\n    v.outputSchemaObjectIsValid = true;\n  }\n\n  function objectIsInvalid() {\n    validModal.style.display = "none";\n    invalidModal.style.display = "flex";\n    v.outputSchemaObjectIsValid = false;\n  }\n\n  function programmaticallySetValue(value, textarea, codeMirrorInstance) {\n    if (v.codemirrorInitialized == false) {\n      codeMirrorInstance = CodeMirror.fromTextArea(textarea, {\n        mode: "application/json",\n        theme: "dracula",\n        lineNumbers: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        indentUnit: 2,\n        tabSize: 2,\n        gutters: ["CodeMirror-lint-markers"],\n        lint: {\n          lintOnChange: true,\n          tooltips: false,\n        },\n      });\n\n      // input event listener\n      codeMirrorInstance.on("change", function (cm, change) {\n        inputEventValue = cm.getValue();\n        // console.log("Content changed:", cm.getValue());\n        if (isValidJsonObject(inputEventValue)) {\n          objectIsValid();\n        } else {\n          objectIsInvalid();\n        }\n      });\n    }\n\n    textarea.value = value;\n    if (v.codemirrorInitialized == false) {\n      codeMirrorInstance.setValue(value);\n      if (isValidJsonObject(value)) {\n        objectIsValid();\n      } else {\n        objectIsInvalid();\n      }\n    }\n    v.codemirrorInitialized = true;\n  }\n\n  const activeDatasource = r.get_datasources.data.find(\n    (item) => item.id === v.active_datasource\n  ).datasource_type_config;\n  const rawValue = activeDatasource.outputSchema;\n  const value = JSON.parse(rawValue);\n  // console.log(value);\n\n  programmaticallySetValue(value, textarea, codeMirrorInstance);\n}, 10);',
              hasCondition: true,
              condition: 'return (v.codemirrorInitialized == false)'
            }
          ],
          hasCondition: false
        }
      ]
    },
    { id: '2191d1d3-98bd-43d0-a0e8-08288e5e4bc3', name: 'chat-list-item-name', text: { value: 'return v.chats[v.i].name' } },
    {
      id: '21e575d4-fde0-46b2-95a2-7c4a5ae95e44',
      name: 'chatbots-dropdown-list-item-avatar',
      attributes: { values: [{ id: 'cf004746-aa60-4827-952a-988d712b91a3', key: 'src', value: 'return r.get_chatbots.data[v.i].avatar_url' }] },
      visibility: { value: 'return (r.get_chatbots.data[v.i].avatar_url !== "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png")' }
    },
    {
      id: '22bef221-8305-4408-b2df-1ea455f68026',
      name: 'csv-dragarea',
      styles: { values: [{ id: '7e1fae76-c1ad-47f0-bc98-963817a3b1ce', property: 'display', value: 'if (v.csvContent && v.csv_rows.length > 0) {\n  return "none"\n} else {\n  return "flex"\n}' }] }
    },
    {
      id: '23CfJcS4iWNw6D9SCoFV',
      name: 'activityfeedlist-icon-container',
      attributes: {
        values: [
          {
            id: '6fb20468-f4f8-4bb3-8f60-e53bec7ec22e',
            key: 'class',
            value:
              "if (v.mergedEvents[v.i].event_group == 'message_user') {\n  return 'activity-feed-icon-container blue';\n} else if (v.mergedEvents[v.i].event_group == 'page_view') {\n  return 'activity-feed-icon-container orange';\n} else if (v.mergedEvents[v.i].event_group == 'operator_changed') {\n  return 'activity-feed-icon-container purple';\n} else if (v.mergedEvents[v.i].event_group == 'handoff_requested') {\n  return 'activity-feed-icon-container purple'\n} else if (v.mergedEvents[v.i].event_group == 'form_submission') {\n  return 'activity-feed-icon-container green';\n} else if (v.mergedEvents[v.i].event_group == 'purchase') {\n  return 'activity-feed-icon-container green';\n} else if (v.mergedEvents[v.i].event_group == 'add_to_cart') {\n  return 'activity-feed-icon-container green';\n} else if (v.mergedEvents[v.i].event_group == 'login') {\n  return 'activity-feed-icon-container pink';\n} else if (v.mergedEvents[v.i].event_group == 'sign_up') {\n  return 'activity-feed-icon-container pink';\n} else if (v.mergedEvents[v.i].event_group == 'click') {\n  return 'activity-feed-icon-container green';\n} else {\n  return 'activity-feed-icon-container';\n}\n"
          }
        ]
      }
    },
    {
      id: '23c01feb-3a9b-4b2a-9642-119d4adca334',
      name: 'scrape-rescrape-btn',
      events: [
        {
          id: 'a6f31c8f-ba79-42bd-aabf-dcda091c71d7',
          type: 'click',
          actions: [
            {
              id: '96580ca0-577f-4474-a7c5-d459750237d6',
              type: 'run-function',
              function:
                "const selectedRows = [];\nconst checkboxes = document.querySelectorAll('input[w-el=\"scrape-list-checkbox\"]:checked');\n\ncheckboxes.forEach(checkbox => {\n  const rowElement = checkbox.closest('[w-el=\"scrapelist-list-item\"]');\n  if (rowElement) {\n    const id = rowElement.getAttribute('record_id');\n    const matchedItem = v.scrapetool_urls_list_filtered.find(item => item.id === id);\n    if (matchedItem) {\n      selectedRows.push(matchedItem.url);\n    }\n  }\n});\n\nWized.requests.execute('rescrape_urls');\n\nawait Wized.requests.waitFor('rescrape_urls');\nif (r.rescrape_urls.ok) {\n  v.lastScrapeBatchUrls = selectedRows\n  v.isScrapeJobInitiated = true;\n  window.showProgressBarAndHideControls();\n  window.updateCheckboxVisibilityAndCounts();\n}",
              hasCondition: true,
              condition: 'return Array.from(document.querySelectorAll(\'input[w-el="scrape-list-checkbox"]\')).some(checkbox => checkbox.checked);'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '24021fae-6006-47b6-ac50-9d02ae3de650',
      name: 'form-integrations-webhooks',
      form: {
        value:
          'function removePrefix(url) {\n  const formattedUrl = url.replace("https://", "");\n  return formattedUrl;\n};\n\nconst chatInitiatedEndpoint = removePrefix(r.get_chatbot.data.webhooks.chatInitiated.endpoint_url);\nconst sentContactDetailsEndpoint = removePrefix(r.get_chatbot.data.webhooks.sentContactDetails.endpoint_url);\nconst humanHandoffActivatedEndpoint = removePrefix(r.get_chatbot.data.webhooks.humanHandoffActivated.endpoint_url);\nconst livechatNewMessageEndpoint = removePrefix(r.get_chatbot.data.webhooks.livechatNewMessage.endpoint_url);\n\nreturn {\n  webhooks_toggle_chatInitiated: r.get_chatbot.data.webhooks.chatInitiated.enabled,\n  chatInitiated_endpoint: chatInitiatedEndpoint,\n\n  webhooks_toggle_sentContactDetails: r.get_chatbot.data.webhooks.sentContactDetails.enabled,\n  sentContactDetails_endpoint: sentContactDetailsEndpoint,\n\n  webhooks_toggle_humanHandoffActivated: r.get_chatbot.data.webhooks.humanHandoffActivated.enabled,\n  humanHandoffActivated_endpoint: humanHandoffActivatedEndpoint,\n\n  webhooks_toggle_livechatNewMessage: r.get_chatbot.data.webhooks.humanHandoffActivated.enabled,\n  livechatNewMessage_endpoint: livechatNewMessageEndpoint,\n};'
      },
      events: [
        {
          id: '4ae16ebd-a0af-4d40-be68-495c9de832fb',
          type: 'submit',
          actions: [{ id: '7b46960f-9875-4814-9a54-3ba1366fc81b', type: 'perform-request', request: 'f94c1b4b-1663-4e0b-9987-e2694332fc53' }],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '253fa5c6-6e11-4144-937d-1ad11dab7129',
      name: 'toast-notification',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.toast_log' },
      attributes: { values: [{ id: 'c5674603-c8bf-4a5a-bb5a-46005ad6095b', key: 'toast_item_id', value: 'return v.toast_log[v.i].id' }] },
      classes: {
        values: [
          { id: '6231ec47-503c-4096-b586-0db68a1ab495', class: 'success', condition: 'return (v.toast_log[v.i].type == "success")' },
          { id: 'f557bf52-fd86-4a47-b548-1dbea5920760', class: 'error', condition: 'return (v.toast_log[v.i].type == "error")' },
          { id: 'bee2a5eb-3a5d-4ac4-8af9-59ceb07fe040', class: 'warning', condition: 'return (v.toast_log[v.i].type == "warning")' }
        ]
      }
    },
    {
      id: '256ccaf2-b17b-4725-8e90-5f61f81a759a',
      name: 'datasource-sharing-chatbots-dropdown-list-item-avatar',
      attributes: { values: [{ id: '342c961b-781f-47a9-9633-00d69c0fce7c', key: 'src', value: '// return v.chatbots[v.i].name\nreturn v.datasourceSharingChatbotsDropdown[v.i].avatar_url' }] },
      visibility: {
        value: 'return (v.datasourceSharingChatbotsDropdown[v.i].avatar_url !== "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png")'
      }
    },
    {
      id: '25a14422-3ab8-4058-8a33-5fe099cb9893',
      name: 'message_list_item-body',
      text: {
        value:
          'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "operator_changed") {\n    \n      if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.event_type == "joined") {\n          return "heeft de chat overgenomen"\n      } else if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.event_type == "left") {\n          return "heeft de chat verlaten"\n      }\n\n    }'
      }
    },
    {
      id: '25aa1f1f-2ac1-472e-9d1c-a0a675a170ed',
      name: 'scrapelist-scraped-datum',
      text: {
        value:
          'const formatDateWithoutTime = (date) => {\n    const now = new Date();\n    const day = date.getDate();\n    const monthNames = ["jan", "feb", "mrt", "apr", "mei", "jun", "jul", "aug", "sep", "okt", "nov", "dec"];\n    const month = monthNames[date.getMonth()];\n    const year = date.getFullYear() === now.getFullYear() ? \'\' : ` ${date.getFullYear()}`;\n    \n    return `${day} ${month}${year}`;\n};\n\nreturn formatDateWithoutTime(new Date(v.scrapetool_urls_list_filtered[v.i].created_at));\n'
      }
    },
    { id: '261cffaa-f7ca-4f46-8cee-a5e103b0ec62', name: 'organization-name', text: { value: 'return r.get_user_data.data[0].organizations[0].company_name' } },
    {
      id: '2655a758-3081-4d63-b392-ef63fcfa24ae',
      name: 'form-password-update',
      events: [
        {
          id: '6e7173e4-9a97-448f-b036-670326ef6339',
          type: 'submit',
          actions: [{ id: '69fc6c0b-a6d5-4113-927b-3511315c49d5', type: 'run-function', function: 'Wized.requests.execute("update_password");' }],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '266b3f70-d93e-41fd-a8f0-7c0a2bdc454c',
      name: 'form-edit-pdf2',
      form: {
        value:
          'return {\n status: r.get_datasources.data.find(item => item.id === v.active_datasource).status,\n tool_description: r.get_datasources.data.find(item => item.id === v.active_datasource).tool_description\n}'
      },
      events: [
        {
          id: '20604902-4f4b-47d7-9125-d2b87c59fcc2',
          type: 'submit',
          actions: [
            {
              id: '5fc56d43-c4e5-4f81-bea2-c58bdc6e1711',
              type: 'run-function',
              function: 'Wized.requests.execute("update_pdf2");\n\nawait Wized.requests.waitFor(\'update_pdf2\');\n\nWized.requests.execute("get_datasources");\n'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '287b6c28-fc90-44c7-87ac-249734c1d6b9',
      name: 'active-chatbot-status-label-concept',
      visibility: { value: 'return (r.get_chatbots.data.find((item) => item.id === v.active_chatbot).publishing.published == false)' }
    },
    {
      id: '29d1e821-09b5-4095-9967-43916f953093',
      name: 'active-datasource-list-item-type',
      text: {
        value:
          "const dataType = r.get_datasources.data.find(item => item.id === v.active_datasource).data_type\n\nif (dataType == 'pdf') {\n    return 'kennisbank'\n} else if (dataType == 'csv') {\n    return 'CSV bestand'\n} else if (dataType === 'pdf2') {\n    return 'PDF bestand';\n} else if (dataType == 'url') {\n    return 'Website'\n} else if (dataType == 'api') {\n    return 'API koppeling'\n} else if (dataType == 'xml') {\n    return 'Product feed'\n}"
      }
    },
    {
      id: '29e861ac-5f69-4f6e-9284-82a77da61207',
      name: 'datasource-list-item-indicator-shared',
      styles: {
        values: [
          {
            id: '94960b56-68c9-4182-8f71-61be239d99a8',
            property: 'background-color',
            value:
              'if (v.datasourceSharingNavbarList[v.i].status == "draft") {\n  return "#e7b549"\n} else if (v.datasourceSharingNavbarList[v.i].status == "active") {\n  return "#25d366"\n} else if (v.datasourceSharingNavbarList[v.i].status == "inactive") {\n  return "#F37A80"\n}\n'
          }
        ]
      }
    },
    {
      id: '2b3cd412-2b14-4302-bbfa-6bd5c406f512',
      name: 'authcredentials-visibility',
      styles: { values: [{ id: '83436eb2-7408-42f9-91b5-41ee17c310b2', property: 'display', value: 'if (i["input-api_authprotocol"] !== "none") {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: '2b868c78-2b5c-4aef-89ff-565f0b5ca8a7',
      name: 'livechat-chatbar-container',
      events: [
        {
          id: '3a06170f-8edb-4c54-8adb-d9069203858d',
          type: 'click',
          actions: [
            {
              id: '324fbc02-c883-4c7b-b361-0222be56ced8',
              type: 'run-function',
              function: 'window.showToastNotification(\'Schakel livechat in om te chatten\', "warning");',
              hasCondition: true,
              condition: 'return !v.chats.find((chat) => chat.id === v.active_chat).livechat'
            }
          ],
          hasCondition: false
        }
      ],
      classes: { values: [{ id: 'cba1a93f-9d82-414d-a6c5-0a77c56a8194', class: 'hidden', condition: 'return !v.chats.find((chat) => chat.id === v.active_chat).livechat' }] }
    },
    {
      id: '2e2fb7d7-853b-4859-a23e-c80760a67cc8',
      name: 'api-properties-list-item-delete-btn',
      events: [
        {
          id: '76b7b6e5-706a-4746-bcdf-2742ba0fec98',
          type: 'click',
          actions: [
            {
              id: 'e9e43d1f-f24d-4b81-9254-a7fda553a08f',
              type: 'run-function',
              function:
                "var keys = document.querySelectorAll('[api-properties-table=key]');\nvar values = document.querySelectorAll('[api-properties-table=value]');\nvar properties = [];\n\nkeys.forEach((keyInput, index) => {\n    var valueInput = values[index];\n    properties.push({ index: index, property: keyInput.value, description: valueInput.value });\n});\n\nv.apiPropertiesArrayII = properties;\n\nfunction deleteObjectByIndex(index) {\n  if (index !== -1) {\n    v.apiPropertiesArrayII.splice(index, 1); // Remove 1 item at the given index\n  } else {\n    console.log(\"No object found with index\", index);\n  }\n}\n\nvar actualRow = event.target.closest(\"[w-el='api-properties-list-item']\");\nvar parentContainer = actualRow.parentNode;\nvar children = Array.from(parentContainer.children);\nvar index = children.indexOf(actualRow);\n\ndeleteObjectByIndex(index);\n"
            }
          ],
          hasCondition: false
        }
      ],
      attributes: { values: [{ id: 'fc1417e1-f27e-4331-974f-ffa5ee78f1ae', key: 'index', value: 'return v.apiPropertiesArrayII[v.i].index' }] }
    },
    {
      id: '2e41fcf0-931d-4764-b632-7db278e0b0a5',
      name: 'filter-chatbots-active-image',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.inboxFilterChatbots.slice(0, 3);\n' },
      attributes: {
        values: [
          {
            id: 'c9646ee0-7096-4347-b177-08f90ece982d',
            key: 'src',
            value:
              'if (r.get_chatbots.data.find(item => item.id === v.inboxFilterChatbots[v.i]).avatar_url) {\n  return r.get_chatbots.data.find(item => item.id === v.inboxFilterChatbots[v.i]).avatar_url;\n} else {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\n}'
          }
        ]
      }
    },
    {
      id: '2jmUMhl20q6PvCQUj5Ws',
      name: 'tool-output-logs-documents-deleted-text',
      text: {
        value:
          'const dataType = r.get_outputlogs.data[v.i].data_type\n\nconst chatbot = r.get_chatbots.data.find(entry => entry.id === r.get_outputlogs.data[v.i]?.chatbot_id);\n\nconst datasource = r.get_datasources.data.find(entry => entry.id === r.get_outputlogs.data[0]?.datasource_id);\n\nlet record\nif (dataType == \'kb\') {\n  record = datasource?.kb_topics?.find(entry => entry.id === r.get_outputlogs.data[v.i]?.record_id);\n} else if (dataType == \'url\') {\n  record = r.getall_scrape_pages.data?.find(entry => entry.id === r.get_outputlogs.data[v.i]?.record_id)\n}\n\nif (!chatbot) {\n  return "Chatbot verwijderd"\n} else if (!datasource) {\n  return "Databron verwijderd"\n} else if (!record) {\n  return "Document verwijderd"\n}'
      }
    },
    { id: '3232f816-68e5-46a9-a1ed-555e212e6037', name: 'scrapelst-url', text: { value: 'return v.scrapetool_urls_list_filtered[v.i].url;' } },
    {
      id: '327f19ae-b103-4ca2-b026-a173a65d670c',
      name: 'create-btn-api-properties',
      events: [
        {
          id: 'd6c8daf6-b637-49e3-bb5d-61fa00892df9',
          type: 'click',
          actions: [
            {
              id: 'fea9db98-a3f1-414a-97ba-94a267aba969',
              type: 'run-function',
              function:
                'const nextIndexProperty = v.apiPropertiesArrayII.length;\nconst emptyObjectProperty = { "index": nextIndexProperty, "property": "", "description": "" };\n\nconst newArray = v.apiPropertiesArrayII.concat([emptyObjectProperty]);\n\nv.apiPropertiesArrayII = newArray;\n\n\n'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: '33becc44-c2ae-4b37-bf51-0ae7d03ec6bb',
      name: 'mail-label',
      visibility: {
        value: "return (\n  (v.chats[v.i].enduser_email !== null && v.chats[v.i].enduser_email !== '') ||\n  (v.chats[v.i].chat_user_email !== null && v.chats[v.i].chat_user_email !== '')\n);\n"
      }
    },
    {
      id: '3407288f-124c-4809-a4c3-f11a5177cf49',
      name: 'dropdown-active-chatbot-initials',
      text: { value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).name.charAt(0)\n' }
    },
    {
      id: '3541d184-0d7f-493d-8380-12a361a43936',
      name: 'chime-visibility-mobile',
      styles: { values: [{ id: '440ffb2b-4e0c-411b-8208-55de0a45d3f1', property: 'display', value: 'if ( i.toggle_popup_enabled_mobile == true) {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    { id: '3675f602-5e59-4bce-a6c6-2a17146dba4e', name: 'api-properties-list-item-value', value: { value: 'return v.apiPropertiesArrayII[v.iII].description' } },
    {
      id: '36afab25-5ffc-43fd-a781-301615b06b59',
      name: 'chatbot-count-max',
      text: {
        value:
          'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nif (maxChatbots !== null){\n  return maxChatbots\n} else if (organization.subscription_plan && organization.subscription_plan.includes("expert")) {\n  return 3\n} else {\n  return 1\n}'
      }
    },
    {
      id: '3700e1b4-3426-48f3-9197-0d01e0507276',
      name: 'active-chat-inbox-chatbot-name',
      text: { value: 'return r.get_chatbots.data.find((item) => item.id === v.chats.find((chat) => chat.id === v.active_chat).chatbot_id).name' }
    },
    {
      id: '3ac6e934-3df9-4347-918f-1113c2848252',
      name: 'active-datasource-status-color',
      styles: {
        values: [
          {
            id: 'ee8d4604-27b5-4279-aa82-abe51d982cc9',
            property: 'background-color',
            value:
              'if (v.dataSourceUpdatedStatus !== null) {\n  status = v.dataSourceUpdatedStatus\n} else {\n  status = r.get_datasources.data.find((item) => item.id === v.active_datasource).status;\n}\n\nif (status == "draft") {\n  return "#e7b549"\n} else if (status == "active") {\n  return "#25d366"\n} else if (status == "inactive") {\n  return "#F37A80"\n} else {\n  return "#fff"\n}'
          }
        ]
      }
    },
    {
      id: '3c35e70e-dd48-408b-8dd8-343bc6fcb260',
      name: 'scrapelist-list-item-clck',
      attributes: { values: [{ id: '1a8c423d-7e52-4910-90aa-1e4dd2f4f3ed', key: 'record_id', value: 'return v.scrapetool_urls_list_filtered[v.i].id;\n' }] },
      events: [
        {
          id: '27fd510f-199a-4d10-ae17-4d1b725afbe5',
          type: 'click',
          actions: [
            {
              id: 'f7848448-e8ca-41c9-a129-60c9fc46aa85',
              type: 'run-function',
              function:
                'const dataValue = event.currentTarget.getAttribute("record_id");\nlet currentUrl = v.scrapetool_urls_list_filtered.find(item => item.id === dataValue);\n\n$(\'[w-el="scrape-pageviewer-url"]\').text(currentUrl.url);\n$(\'[w-el="scrape-pageviewer-url-container"]\').attr(\'href\', currentUrl.url);\n$(\'[w-el="scrape-pageviewer-charcount"]\').text(currentUrl.content.length);\n\n// Format date in the desired format\nconst formatDate = (date) => {\n    const now = new Date();\n    const day = date.getDate();\n    const monthNames = ["jan", "feb", "mrt", "apr", "mei", "jun", "jul", "aug", "sep", "okt", "nov", "dec"];\n    const month = monthNames[date.getMonth()];\n    const year = date.getFullYear() === now.getFullYear() ? \'\' : ` ${date.getFullYear()}`;\n    const hours = date.getHours().toString().padStart(2, \'0\');\n    const minutes = date.getMinutes().toString().padStart(2, \'0\');\n    \n    return `${day} ${month}${year} - ${hours}:${minutes}`;\n};\n\nconst createdAt = new Date(currentUrl.created_at);\nconst updatedAt = new Date(currentUrl.updated_at);\n\n$(\'[w-el="scrapeviewer-createdat"]\').text(formatDate(createdAt));\n$(\'[w-el="scrapeviewer-updatedat"]\').text(formatDate(updatedAt));\n\n// convert with marked library\n$(\'[w-el="scrape-pageviewer-cotent"]\').html(marked.parse(currentUrl.content));\n\n// Element visibility\nconst editTopicContainer = document.querySelector("[w-el=\'scrape-page-viewer-container\']");\n\neditTopicContainer.style.transform = \'translateX(20px)\';\neditTopicContainer.style.opacity = 0;\neditTopicContainer.style.display = \'flex\';\nsetTimeout(() => {\n    editTopicContainer.style.transform = \'translateX(0)\';\n    editTopicContainer.style.opacity = 1;\n}, 50);\n\nconst scrollBox = document.querySelector("[content-scrollbox]");\nif (scrollBox) {\n    scrollBox.scrollTop = 0;\n}\n'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '3c5dacb7-f3ed-4687-bd4c-ee8c704cce59',
      name: 'chatbot-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: '// return v.chatbots\nreturn r.get_chatbots.data' },
      styles: { values: [{ id: '1ba779a3-ecbb-4fef-955c-a3b4c72b02ab', property: 'display', value: 'return "flex"' }] },
      attributes: {
        values: [
          {
            id: 'b329d13f-6b34-430c-abe4-c73af209fd4a',
            key: 'data-value',
            value:
              "// hover interactions for chatbot list item actions (target elements after wized init)\n// function fadeInUp(element) {\n//   element.style.display = 'flex';\n//     element.style.opacity = '1';\n//     element.style.transform = 'translateY(0)';\n// }\n// \n// function fadeOutDown(element) {\n//   element.style.opacity = '0';\n//   element.style.transform = 'translateY(20px)';\n//   setTimeout(() => {\n//     element.style.display = 'none';\n//   }, 200);\n// }\n// \n// const listItems = document.querySelectorAll('.chatbot-list-item');\n// \n// listItems.forEach(item => {\n//   const actionWrap = item.querySelector('.chatbot-item-action-wrap');\n// \n// \titem.addEventListener('mouseenter', () => {\n//     fadeInUp(actionWrap);\n//   });\n//   item.addEventListener('mouseleave', () => {\n//     fadeOutDown(actionWrap);\n//   });\n//   \n// });\n\nreturn r.get_chatbots.data[v.i].id"
          },
          { id: 'f70d0058-be20-47f7-b480-ef5e78bbea12', key: 'name', value: 'return r.get_chatbots.data[v.i].name' },
          { id: 'cecd0296-8702-4a75-9d20-445be243966e', key: 'url', value: 'return r.get_chatbots.data[v.i].website_url' }
        ]
      },
      events: [
        {
          id: '45b12232-7f04-4a9a-b53c-c5f522e3e17f',
          type: 'click',
          actions: [
            {
              id: '0fc0bf52-4ec1-4c46-aaab-d328fc4c7bdc',
              type: 'run-function',
              function:
                'const dataValue = event.currentTarget.getAttribute("data-value");\nconst chatbotName = event.currentTarget.getAttribute("name");\n\nconst placement = event.currentTarget.getAttribute("placement");\n\nif (placement === "datasource-sharing") {\n  v.datasource_sharing_selected = dataValue;\n} else {\n  v.active_chatbot = dataValue;\n\n  // toast notifications\n  const toastMessage = {\n    id: crypto.randomUUID(),\n    expiration: new Date().getTime() + 5000,\n    type: "success",\n    message: "Chatbot <b>" + chatbotName + "</b> geselecteerd",\n  };\n\n  // transitions\n  function openToast(toastElement) {\n    toastElement.style.display = "flex";\n    toastElement.style.opacity = 0;\n    toastElement.style.transform = "translateY(40px) scale(0.6)";\n    requestAnimationFrame(() => {\n      requestAnimationFrame(() => {\n        toastElement.style.opacity = 1;\n        toastElement.style.transform = "translateY(0) scale(1)";\n      });\n    });\n  }\n\n  function closeToast(toastElement) {\n    requestAnimationFrame(() => {\n      requestAnimationFrame(() => {\n        toastElement.style.opacity = 0;\n        toastElement.style.transform = "translateY(40px) scale(0.6)";\n        setTimeout(() => {\n          toastElement.style.display = "none";\n        }, 150);\n      });\n    });\n  }\n\n  async function manageToast(toastElement) {\n    openToast(toastElement);\n    await new Promise((resolve) => setTimeout(resolve, 5000));\n    closeToast(toastElement);\n  }\n\n  v.toast_log.push(toastMessage);\n\n  const toastElement = document.querySelector(\n    `[toast_item_id=\'${toastMessage.id}\']`\n  );\n\n  manageToast(toastElement);\n\n  // navigation\n\n  if (n.path !== "/chatbot") {\n    n.path = "/chatbot";\n  } else {\n    v.inboxFilterChatbots = [v.active_chatbot];\n    Wized.requests.execute("get_chats");\n\n    chatbotsChart1.destroy();\n    chatbotsChart2.destroy();\n\n    Wized.requests.execute("get_chats_analytics");\n  }\n}\n'
            }
          ],
          hasCondition: false
        }
      ],
      classes: { values: [{ id: '7704ed6e-9f64-4594-9857-ca8b5cecb18e', class: 'active', condition: '// set active state\nreturn (r.get_chatbots.data[v.i].id == v.active_chatbot)\n' }] }
    },
    {
      id: '3d900031-1aa8-40e9-b36c-7761937c819e',
      name: 'csv-upload-preview',
      styles: { values: [{ id: '49006c7f-e95e-4360-8d2b-a48ff65c7192', property: 'display', value: 'if (v.csvContent && v.csv_rows.length > 0) {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: '3dv7ph9IA5MWMsbqyPXI',
      name: 'message-type_image',
      visibility: { value: 'return (\n  v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "image"\n);\n' },
      styles: {
        values: [
          {
            id: '17b8f383-edc7-4f6b-95ed-0e2f7928d24d',
            property: 'justify-content',
            value:
              "const message = v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n\nif (message.message_type == \"image\") {\n  if (message.author_type == 'agent') {\n    return 'end'\n  } else if (message.author_type == 'user') {\n    return 'start'\n  }\n}"
          }
        ]
      }
    },
    {
      id: '3e879c83-9dbc-43e7-901a-ef1d1ed758de',
      name: 'form-edit-csv',
      form: {
        value:
          'return {\n status: r.get_datasources.data.find(item => item.id === v.active_datasource).status,\n tool_description: r.get_datasources.data.find(item => item.id === v.active_datasource).tool_description\n}'
      },
      events: [
        {
          id: '53687f85-24ce-4312-95e9-d715403335ae',
          type: 'submit',
          actions: [
            {
              id: '66214ea9-2197-47c6-8cfc-d5f92db149b9',
              type: 'run-function',
              function: 'Wized.requests.execute("update_csv");\n\nawait Wized.requests.waitFor(\'update_csv\');\n\nWized.requests.execute("get_datasources");\n'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: '3f4014a3-8d8d-43fa-9e53-c3880f1ab6e5', name: 'api-headers-list-item-key', value: { value: 'return v.apiHeadersArray[v.i].key' } },
    {
      id: '3f5e517e-69d8-48c5-a1b3-c0318f300e23',
      name: 'datasource-sharing-list-item-name',
      text: { value: '// return v.chatbots[v.i].name\nreturn r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).name' }
    },
    {
      id: '41c986e8-fb25-4baf-9905-13bac7832d5c',
      name: 'datasource-list-item-type',
      text: {
        value:
          "if (r.get_datasources.data[v.i].data_type == 'pdf') {\n    return 'kennisbank'\n} else if (r.get_datasources.data[v.i].data_type == 'csv') {\n    return 'CSV'\n} else if (r.get_datasources.data[v.i].data_type == 'url') {\n    return 'URL'\n} else if (r.get_datasources.data[v.i].data_type == 'api') {\n    return 'API'\n}"
      }
    },
    {
      id: '44cff432-51d5-4205-93f5-34a574662db0',
      name: 'form-delete-chatbot',
      events: [
        {
          id: 'efe364b2-8eb9-4543-8c53-2097bf9276b4',
          type: 'submit',
          actions: [{ id: 'a1d3f101-08d3-4d1b-be2d-ad9b9beef5bd', type: 'run-function', function: 'Wized.requests.execute("delete_chatbot");' }],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: '474403bd-767d-4779-98b4-637093719fd0', name: 'csv-upload-preview-filesize', text: { value: 'return v.csvContent.size' } },
    { id: '476a9367-25d9-4729-b820-c4bcea7b8a95', name: 'toast-message', text: { value: 'return v.toast_log[v.i].message', type: 'html' } },
    {
      id: '47c845ff-3cec-4ec2-86f9-8507df1fb186',
      name: 'datasource-list-item-img-src-shared',
      attributes: {
        values: [
          {
            id: '415ed42a-665d-48f4-8917-dde89f4ec679',
            key: 'src',
            value:
              "if (v.datasourceSharingNavbarList[v.i].data_type == 'pdf') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc1cd277ec15f33fdc7b3_file-info-alt.svg'\n} else if (v.datasourceSharingNavbarList[v.i].data_type == 'csv') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc226b395d689963bd587_database.svg'\n} else if (v.datasourceSharingNavbarList[v.i].data_type === 'pdf2') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/67239dd4e768c478e10fb6b4_file%20(1).svg'\n} else if (v.datasourceSharingNavbarList[v.i].data_type == 'url') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7e4473d4ee68c12db_link-h.svg'\n} else if (v.datasourceSharingNavbarList[v.i].data_type == 'api') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7ac7247ea9e3f5e3f_code-branch.svg'\n} else if (r.get_datasources.data[v.i].data_type == 'xml') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/674ffdb4a11fe59e8f7655db_Untitled%20design%20-%202024-12-04T075853.568.png'\n}"
          }
        ]
      }
    },
    {
      id: '48719d0d-ab1c-4a49-b2cc-b4b60bdc561c',
      name: 'datasource-csv-preview-size',
      text: { value: 'return r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.size;' }
    },
    { id: '48Bfg6vfDgU82TxA9Lb5', name: 'tagging-listitem', list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.chatTags' } },
    {
      id: '48da2ff0-1d53-43e4-b7f1-bbbd55085316',
      name: 'form-settings-widget',
      form: {
        value:
          "inputValue = r.get_chatbot.data.primary_color;\n\nif (inputValue.charAt(0) === '#') {\n  primaryColor = inputValue.slice(1);\n} else {\n  primaryColor = inputValue;\n}\n\nreturn {\n  primary_color: primaryColor,\n\n  offset_x_desktop: r.get_chatbot.data.btn_offset.x_desktop,\n  offset_y_desktop: r.get_chatbot.data.btn_offset.y_desktop,\n  offset_x_mobile: r.get_chatbot.data.btn_offset.x_mobile,\n  offset_y_mobile: r.get_chatbot.data.btn_offset.y_mobile,\n\n  toggle_popup_enabled_desktop: r.get_chatbot.data.popup.desktop,\n  toggle_popup_enabled_mobile: r.get_chatbot.data.popup.mobile, \n  popup_chime_desktop: r.get_chatbot.data.popup.chime.desktop,\n  popup_chime_mobile: r.get_chatbot.data.popup.chime.mobile,\n\n  widget_header: r.get_chatbot.data.widget_styling.widget_header,\n  user_message_primary_color: r.get_chatbot.data.widget_styling.user_message_primary_color,\n  widget_border: r.get_chatbot.data.widget_styling.widget_border,\n\n  ai_badge: r.get_chatbot.data.ai_badge,\n\n  toggle_alignbtn_desktop: r.get_chatbot.data.btn_offset.align_right.desktop,\n  toggle_alignbtn_mobile: r.get_chatbot.data.btn_offset.align_right.mobile\n}"
      },
      events: [
        {
          id: '69820acb-07e6-4d38-9ad3-bf6a623b6516',
          type: 'submit',
          preventDefault: true,
          actions: [
            { id: 'fdb7301e-ff6a-4b01-83b2-93886f6ba257', type: 'perform-request', request: '0262a872-8cdd-451c-899b-c5d13661a54f' },
            {
              id: 'ef3f5b4b-5303-4d41-8905-cb6ecdf59a4a',
              type: 'perform-request',
              request: 'b90e0912-d43f-4620-95a8-6aceb6904847',
              hasCondition: true,
              condition: 'if (i["settigs-background-input"]["0"]) {\n  if (i["settigs-background-input"] == null) {\n    return false\n  } else {\n    return true\n  }\n} else {\n  return false\n}'
            },
            {
              id: '644bdf70-7561-4912-9468-1a6fa223b00b',
              type: 'perform-request',
              request: '4d999dbd-a786-4f0b-ae22-0b6e7fed3ab2',
              hasCondition: true,
              condition: '\n  if (i["settigs-background-input"] == null) {\n    return true\n  } else {\n    return false\n  }'
            }
          ]
        }
      ]
    },
    {
      id: '48xav5s3J8r6OhYPm4Lx',
      name: 'activityfeedlist-operator-name',
      text: { value: "if (v.mergedEvents[v.i].event_group === 'operator_changed') return (v.mergedEvents[v.i].message_type_data.operator_name)" }
    },
    {
      id: '494bf31e-612c-43de-a2fc-b41fb861332a',
      name: 'active-chat-inbox-date',
      text: {
        value:
          "const date = new Date(v.chats.find(chat => chat.id === v.active_chat).created_at);\nconst day = date.getDate().toString().padStart(2, '0');\nconst month = (date.getMonth() + 1).toString().padStart(2, '0');\nconst year = date.getFullYear();\nreturn `${day}-${month}${year !== new Date().getFullYear() ? `-${year}` : ''}`;\n"
      }
    },
    {
      id: '4be479ba-f145-4ad0-ad7a-a8dbca62116f',
      name: 'message_list-timestamp',
      text: {
        value:
          'if (["default_user", "default_bot", "default_agent"].includes(\n    v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type\n)) {\n  const rawTimestamp = v.chats.find(chat => chat.id === v.active_chat).messages[v.i].created_at;\n  const date = new Date(rawTimestamp);\n  return `${date.getHours().toString().padStart(2, \'0\')}:${date.getMinutes().toString().padStart(2, \'0\')}`;\n}\n'
      }
    },
    {
      id: '53c267b1-9ca2-4c35-9129-1f21a1c68098',
      name: 'datasource-csv-preview-timestamp-time',
      text: {
        value:
          "const updatedAt = new Date(r.get_datasources.data.find((item) => item.id === v.active_datasource).last_updated)\nreturn updatedAt.getHours().toString().padStart(2, '0') + \":\" + updatedAt.getMinutes().toString().padStart(2, '0');"
      }
    },
    { id: '5PwF7ZIiWvAs4rTSP4H3', name: 'send-file-form-btn', visibility: { value: 'return (i["send-file-upload"]["0"] ? true : false)' } },
    {
      id: '5a1a012c-c45c-4e67-9aa2-a8127c80322a',
      name: 'form-integrations-gtm',
      form: {
        value:
          'return {\n    "gtm_enabled": r.get_chatbot.data.gtm_events.enabled,\n    "toggle_chatInitiated": r.get_chatbot.data.gtm_events.sleakChatInitiated,\n    "toggle_sentContactDetails": r.get_chatbot.data.gtm_events.sleakSentContactDetails,\n    "toggle_humanHandoffActivated": r.get_chatbot.data.gtm_events.sleakHumanHandoffActivated\n}'
      },
      events: [
        {
          id: '8790647c-b5dc-4954-b7cc-5ece61f222bc',
          type: 'submit',
          actions: [{ id: 'beafea96-0551-48f7-a7ec-a946e0c48a4c', type: 'perform-request', request: '96a6fbbd-3c0f-41c2-a192-9e8a05c8b6d6' }],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: '5a44b95c-d1fb-439b-879a-2f5cb46f035c', name: 'chats-list-item-hasunread', visibility: { value: 'return v.chats[v.i].has_unread' } },
    {
      id: '5bad71e0-8f9c-4fd0-a71c-6defc4f04918',
      name: 'message-type-operatorjoined',
      visibility: { value: 'return (\n  v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "operator_changed"\n);\n' }
    },
    {
      id: '5bea297d-22b7-45fa-8f6b-40c8c38f16e6',
      name: 'email_gate_blocking_container',
      styles: { values: [{ id: '824d4e70-bf91-49a7-9153-e19bcc327ae9', property: 'display', value: 'if (i.emailgate_enabled == true) {\n  return "flex"\n} else {\n  return "none"\n}\n\n' }] }
    },
    {
      id: '5d06f37b-d66c-411b-a841-61d0bed37fa0',
      name: 'datasource-sharing-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.datasourceSharingChatbotsActiveList' }
    },
    {
      id: '5e51ed95-c9df-4050-94ff-c7ccfdf34776',
      name: 'form-create-datasource-csv',
      events: [
        {
          id: '2a62ef23-f979-41c2-9e83-957615a4d620',
          type: 'submit',
          preventDefault: true,
          actions: [
            {
              id: '4e0af494-7510-4051-b4e9-c2121a9d67f1',
              type: 'run-function',
              function:
                'Wized.requests.execute("create_csv");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\ndataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\nwindow.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  // Deprecaten - .find() method gebruiken\n  Wized.data.v.active_datasource_type = "csv";\n\n  // Element visibility\n  const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n  const editForm = document.querySelector("[w-el=\'form-container-edit-csv\']");\n  editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n  await Wized.requests.waitFor(\'create_csv\');\n  \n  Wized.requests.execute("upsert_csv");\n  // await Wized.requests.waitFor(\'upsert_csv\');\n\n  Wized.requests.execute("get_datasources");\n  Wized.data.v.active_datasource = r.create_csv.data.id;\n\n  await Wized.requests.waitFor("get_datasources");\n\n  if (v.datasourcesRtSubSubscribed !== true) {\n    window.datasourcesRealtimeInit()\n  }\n\n  // update container visibility\n  editForm.style.display = "flex";\n\n  i["csv-upload"] = {};\n  const form = document.querySelector("[w-el=\'form-create-datasource-csv\']")\n  form.reset();\n  v.csv_rows = []\n\n\n  // reset create forms - al gedaan bovenin?\n  // const allForms = document.querySelectorAll(".datasources-formblock");\n  // const formWrapperInitial = document.getElementById("create-datasource-form");\n  // allForms.style.display = "none";\n  // formWrapperInitial.style.display = "flex";\n});\n',
              hasCondition: true,
              condition:
                'const organization = r.get_user_data.data[0].organizations[0];\n\nreturn (n.path.includes (\'/kennis/databronnen\') && (organization.subscription_status == "active" && organization.subscription_plan.includes("expert")))'
            },
            {
              id: 'e1983a2a-5a96-44b8-a126-03326b84d88d',
              type: 'run-function',
              function:
                "// DEPR\n\n// Wized.requests.execute(\"create_csv\");\n// await Wized.requests.waitFor('create_csv');\n\n// Wized.requests.execute(\"upsert_csv\");\n// await Wized.requests.waitFor('upsert_csv');\n\n// v.active_datasource = r.create_csv.data.id;\n\n// n.path = '/kennis/databronnen?tn=cd'\n\n",
              hasCondition: true,
              condition: "return (n.path.includes ('/kennis/prompt') || n.path.includes ('/admin-create-datasource'))"
            },
            {
              id: 'dd946590-b9cb-46ef-9aa2-571690e6d7f1',
              type: 'run-function',
              function:
                '// Show expert gate with animations\nconst popup = document.querySelector(\'[popupmodal="expert-gate"]\');\n\npopup.style.transform = "translateY(10px)";\npopup.style.opacity = 0;\npopup.style.display = "flex";\n\nsetTimeout(() => {\n    popup.style.transition = "transform 0.2s ease, opacity 0.2s ease";\n    popup.style.transform = "translateY(0)";\n    popup.style.opacity = 1;\n}, 10);\n',
              hasCondition: true,
              condition: 'const organization = r.get_user_data.data[0].organizations[0];\nreturn (organization.subscription_status !== "active" || !organization.subscription_plan.includes("expert"))'
            }
          ]
        }
      ]
    },
    {
      id: '60050ea2-e2e6-4fb2-9cbc-8c3b4d37e6e7',
      name: 'active-datasource-list-item-img-src',
      attributes: {
        values: [
          {
            id: 'cdd5bba8-f7e5-4367-bd27-7c24a2c6c4ad',
            key: 'src',
            value:
              "const dataType = r.get_datasources.data.find(item => item.id === v.active_datasource).data_type\n\nif (dataType == 'pdf') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc1cd277ec15f33fdc7b3_file-info-alt.svg'\n} else if (dataType == 'csv') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc226b395d689963bd587_database.svg'\n} else if (dataType === 'pdf2') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/67239dd4e768c478e10fb6b4_file%20(1).svg'\n} else if (dataType == 'url') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7e4473d4ee68c12db_link-h.svg'\n} else if (dataType == 'api') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7ac7247ea9e3f5e3f_code-branch.svg'\n} else if (dataType == 'xml') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/674f423eb57d8c7dfd9a1521_pngtree-close-html-bracket-embed-code-png-image_5654026.png'\n}"
          }
        ]
      }
    },
    {
      id: '608a0931-25bf-42a8-8a4c-dd4d45d84dae',
      name: 'form-delete-scrape-urls',
      events: [
        {
          id: 'b307a2f5-64f0-43ba-b7a4-178090b97645',
          type: 'submit',
          actions: [
            {
              id: 'c65c998e-4d86-4e2d-9c30-09fc0a587692',
              type: 'run-function',
              function:
                'Wized.requests.execute(\'delete_scrape_rpcfunction\');\ndocument.querySelectorAll(\'[popupmodal]\').forEach(function(el) {\n    el.style.display = \'none\';\n});\nawait Wized.requests.waitFor(\'delete_scrape_rpcfunction\');\n\nif (r.delete_scrape_rpcfunction.ok) {\n  const deletedCount = r.delete_scrape_rpcfunction.data.deleted_count;\n  window.showToastNotification(`${deletedCount} URLs succesvol verwijderd`, "success");\n  const deletedUrls = r.delete_scrape_rpcfunction.data.deleted_urls\n  v.scrapetool_urls_list_deleted = [...v.scrapetool_urls_list_deleted, ...deletedUrls];\n  const checkboxes = document.querySelectorAll(\'input[w-el="scrape-list-checkbox"], input[w-el="scrape-list-checkbox-wildcard"]\');\n  checkboxes.forEach(checkbox => {\n    checkbox.checked = false;\n  });\n  document.querySelector(\'[w-el="scrape-selected-controls"]\').style.display = "none";\n  document.querySelector(\'[w-el="scrape-addurl-controls"]\').style.display = "flex";\n}\n'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '62d24a92-9811-4775-84c9-05ace27d8258',
      name: 'checkbox-inbox-notifications',
      events: [
        {
          id: '9c1c8a14-2f72-40be-b773-571de69a72fe',
          type: 'click',
          actions: [{ id: '6a62a558-efa0-4cde-a006-23c71988f9bf', type: 'run-function', function: 'Wized.requests.execute("update_user_notifications")' }],
          hasCondition: false
        }
      ],
      value: { value: 'return r.get_user_data.data[0].inbox_notifications_enabled' }
    },
    {
      id: '67197c8c-093c-4a6c-907d-ca36c11e0d4e',
      name: 'btn-preview',
      attributes: {
        values: [
          {
            id: 'a9bd9615-9903-4371-8e78-803c4abe937c',
            key: 'href',
            value:
              'const chatbotId = v.active_chatbot;\n\nconst pageUrl = window.location.href;\nlet targetPath;\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  targetPath = `/?id=${chatbotId}`;\n} else {\n  targetPath = `/?id=${chatbotId}&dev=true`;\n}\n\ntargetUrl = "https://preview.sleak.chat"\nreturn targetUrl + targetPath\n'
          }
        ]
      }
    },
    {
      id: '6786d520-5a89-4bd8-9df7-b6a04801400e',
      name: 'scrape-list-status-indicator-dot',
      styles: {
        values: [
          {
            id: '8c711dc6-6572-4aac-90f3-60a7391cd631',
            property: 'background-color',
            value:
              'const scrapeStatus = v.scrapetool_urls_list_filtered[v.i].status;\n\nif (scrapeStatus == "completed") {\n  return "#00b343"\n} else if (scrapeStatus == "queued") {\n  return "#4285F4"\n} else if (scrapeStatus == "failed") {\n  return "#F37A80"\n} else if (scrapeStatus == "not-found") {\n  return "#e7b549"\n}\n'
          }
        ]
      }
    },
    {
      id: '67f815d4-b47d-4ae0-9822-829a81876a32',
      name: 'notice-handoff-external',
      styles: {
        values: [{ id: '40bc9cca-27a4-4f91-bcf7-5d0f0725435e', property: 'display', value: 'if (i["input-handoff-external"] == "escalation") {\n  return "flex"\n} else {\n  return "none"\n}' }]
      }
    },
    {
      id: '6a7edbd9-59eb-4111-b991-10e88330a65a',
      name: 'datasource-sharing-chatbot-list-item-name',
      text: { value: '// return v.chatbots[v.i].name\nreturn v.datasourceSharingChatbotsDropdown[v.i].name' }
    },
    {
      id: '6a997121-7147-45f5-b879-470759d53c55',
      name: 'datasource-sharing-chatbot-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: '// return v.chatbots\nreturn v.datasourceSharingChatbotsDropdown' },
      styles: { values: [{ id: '2f8d32cc-b43b-4566-8b90-80108dfc8462', property: 'display', value: 'return "flex"' }] },
      attributes: {
        values: [
          { id: '4217a581-f439-4c44-bda9-cc08a149e085', key: 'data-value', value: 'return v.datasourceSharingChatbotsDropdown[v.i].id' },
          { id: 'dd32ae37-859a-4476-b5c4-1f7f58c2b46f', key: 'name', value: 'return v.datasourceSharingChatbotsDropdown[v.i].name' }
        ]
      },
      events: [
        {
          id: '224ca6b5-a7ca-4df5-a4be-db4582c746d2',
          type: 'click',
          actions: [
            {
              id: 'c3ae3b3e-4aa1-492c-8711-a853aac4d37f',
              type: 'run-function',
              function: 'const dataValue = event.currentTarget.getAttribute("data-value");\nv.datasource_sharing_selected = dataValue;'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: '6bbe0aa9-d49f-4b45-b247-6c7c71b90ab2',
      name: 'scrape-addcrawlsitemap',
      styles: { values: [{ id: 'eeb5bf0b-3ce4-4cd8-b068-33eb51a946d9', property: 'display', value: 'if (v.crawledpages.length !== 0) {\n  return "none"\n} else {\n  return "flex"\n}' }] }
    },
    { id: '6ebab84c-00d7-44e7-bc92-03fa9b6db380', name: 'emptystate-chats-chatbot', visibility: { value: 'return (r.get_chatbots.data.length == 0)' } },
    {
      id: '6ed4ecdb-8516-4293-8e57-c1100097023b',
      name: 'form-settings-beveiliging',
      form: { value: 'return {\n  moderation_prompt: r.get_chatbot.data.input_moderation.prompt,\n  moderation_fallback: r.get_chatbot.data.input_moderation.fallback_message\n}' },
      events: [
        {
          id: 'feeb1f9d-4df7-4d20-9fd8-4604a1ca32ae',
          type: 'submit',
          actions: [{ id: '1864de43-030f-4db3-9cc3-c435303653a5', type: 'perform-request', request: '392c5e72-c99b-4a39-965f-d40c74befce7' }],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '6f2f56c6-f585-40a9-a919-7fae0869d88d',
      name: 'form-settings-notificaties',
      form: {
        value:
          'return {\n  notifications_email: r.get_chatbot.data.notifications.emails,\n  toggle_chatInitiated: r.get_chatbot.data.notifications.events.chatInitiated,\n  toggle_sentContactDetails: r.get_chatbot.data.notifications.events.sentContactDetails,\n  toggle_humanHandoffActivated: r.get_chatbot.data.notifications.events.humanHandoffActivated,\n  toggle_livechatNewMessage: r.get_chatbot.data.notifications.events.livechatNewMessage,\n\n  toggle_humanHandoffActivated_user: r.get_chatbot.data.notifications.events.humanHandoffActivated_user,\n  toggle_livechatNewMessage_user: r.get_chatbot.data.notifications.events.livechatNewMessage_user,\n\n  chatInitiated_1: r.get_chatbot.data.notifications.custom_emails.chatInitiated.chatInitiated_1,\n  chatInitiated_2: r.get_chatbot.data.notifications.custom_emails.chatInitiated.chatInitiated_2,\n  sentContactDetails_1: r.get_chatbot.data.notifications.custom_emails.sentContactDetails.sentContactDetails_1,\n  sentContactDetails_2: r.get_chatbot.data.notifications.custom_emails.sentContactDetails.sentContactDetails_2,\n  humanHandoffActivated_1: r.get_chatbot.data.notifications.custom_emails.humanHandoffActivated.humanHandoffActivated_1,\n  humanHandoffActivated_2: r.get_chatbot.data.notifications.custom_emails.humanHandoffActivated.humanHandoffActivated_2,\n  humanHandoffActivated_user_1: r.get_chatbot.data.notifications.custom_emails.humanHandoffActivated_user.humanHandoffActivated_user_1,\n  humanHandoffActivated_user_2: r.get_chatbot.data.notifications.custom_emails.humanHandoffActivated_user.humanHandoffActivated_user_2,\n  livechatNewMessage_1: r.get_chatbot.data.notifications.custom_emails.livechatNewMessage.livechatNewMessage_1,\n  livechatNewMessage_2: r.get_chatbot.data.notifications.custom_emails.livechatNewMessage.livechatNewMessage_2,\n  livechatNewMessage_user_1: r.get_chatbot.data.notifications.custom_emails.livechatNewMessage_user.livechatNewMessage_user_1,\n  livechatNewMessage_user_2: r.get_chatbot.data.notifications.custom_emails.livechatNewMessage_user.livechatNewMessage_user_2\n}'
      },
      events: [
        {
          id: '61433456-15dc-45d0-84fc-da337410fb48',
          type: 'submit',
          preventDefault: true,
          actions: [{ id: '4ae7c57a-d924-4967-a199-410f0f0db736', type: 'perform-request', request: 'b754a62d-249b-48ba-aa44-9809723fefb8' }]
        }
      ]
    },
    { id: '6wMfnqXGGRivDrL2ncly', name: 'emptystate-manualtags', visibility: { value: 'return (r.get_chatbots.data.find(item => item.id == v.active_chatbot).tags.length == 0)' } },
    { id: '7043fe36-a164-47f9-ab63-626bbce52419', name: 'handoff-label-2', visibility: { value: 'return v.chats[v.i].agent_requested === true' } },
    { id: '70cd5d80-2b03-476b-9ca3-84c558af26f8', name: 'csv-upload-preview-name', text: { value: 'return v.csvContent.name' } },
    { id: '70e50038-f0c0-4379-aace-27074da2d54f', name: 'test-cloak', visibility: { value: 'return (r.get_chatbot.ok)' } },
    { id: '72123b0d-922c-406a-9350-d4332e7ea58d', name: 'scrape-results-lis-item', list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.crawledpages' } },
    {
      id: '73edb8bb-bb39-47fb-95f8-08ecc42819cd',
      name: 'agents-list-iem-avatar',
      attributes: {
        values: [
          {
            id: '1419c4f9-d140-41a7-95ac-8a768cd5b564',
            key: 'src',
            value:
              'if (i["agent-avatar-input"]["0"]["0"]) {\n    if (i["agent-avatar-input"]["0"] == \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\') {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\n    } else {\n        "object"\n        return URL.createObjectURL(i["agent-avatar-input"]["0"]["0"]);\n        // return i["agent-avatar-input"]\n    }\n} else {\n    if (r.get_agents.ok == true) {\n        if (r.get_agents.data[0].avatar !== null) {\n            return r.get_agents.data[0].avatar;\n        } else {\n            return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n        }    \n\n    } else {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n    }\n}'
          },
          { id: 'dbbca81f-0663-459f-8aeb-c992b0a27d9c', key: 'src', value: 'return r.get_agents.data[v.i].avatar' }
        ]
      }
    },
    {
      id: '744fe7bf-97cf-4fa1-85b6-908cfc570384',
      name: 'message-list-item-default',
      visibility: { value: 'return (\n  ["default_user", "default_bot", "default_agent"].includes(\n    v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type\n  )\n);\n' },
      classes: {
        values: [
          { id: '863061e2-a798-4684-843a-3d9b1202ed42', class: 'user', condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_user")' },
          { id: '05996e17-494b-4e80-a5d2-9fa65105edb8', class: 'agent', condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_agent")' },
          { id: 'ea83ba7c-dc26-41ae-904a-11c0c4fa1d08', class: 'bot', condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_bot")' }
        ]
      }
    },
    {
      id: '748d18b5-4957-4902-af52-129ea737d05e',
      name: 'background-delete',
      events: [
        {
          id: '2b10a17d-f02e-41b1-815b-5589af8c46cb',
          type: 'click',
          actions: [{ id: 'bb6fc271-33af-411d-a612-617029c15efe', type: 'run-function', function: 'i["settigs-background-input"] = null' }],
          hasCondition: false
        }
      ],
      visibility: {
        value:
          'if (i["settigs-background-input"]["0"]) {\n\n    if (!i["settigs-background-input"]) {\n        return false\n    } else {\n        return true\n        // return i["settigs-background-input"]\n    }\n    \n} else {\n    if (r.get_chatbot.ok == true) {\n\n        if (r.get_chatbot.data.background_image !== null) {\n            return true;\n        } else {\n            return false;\n        }    \n\n    } else {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n    }\n}'
      }
    },
    {
      id: '75f4bbcb-a3de-420f-809c-cc6a73bb08a4',
      name: 'create-btn-crawl-websiteurl',
      events: [
        {
          id: 'd3244ffe-f935-4fab-b41d-5147090d8242',
          type: 'click',
          actions: [
            {
              id: 'a91d4a6f-c4f1-4133-b8fe-ab6d3136ac6e',
              type: 'run-function',
              function:
                "function validateUrl(url) {\n  try {\n    const parsedUrl = new URL(url);\n\n    // Check if the hostname contains at least one dot (.)\n    if (!parsedUrl.hostname.includes('.')) {\n      return false;\n    }\n\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nif (i['input-crawl-websiteurl'] && !r.firecrawl_map.isRequesting) {\n  let url = i['input-crawl-websiteurl'].trim();\n\n  // If no protocol is provided, prepend 'https://'\n  if (!/^https?:\\/\\//i.test(url)) {\n    url = 'https://' + url;\n  }\n\n  if (validateUrl(url)) {\n    Wized.requests.execute('firecrawl_map');\n    document.querySelectorAll('[spinner=\"crawl-urls\"]').forEach(function (element) {\n      element.style.display = 'flex';\n    });\n  } else {\n    window.showToastNotification('Ongeldige URL', 'warning');\n  }\n} else {\n  window.showToastNotification('Website URL vereist', 'warning');\n}\n"
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: '7692c13f-0590-4a9d-a198-505c0884a3a2',
      name: 'chat-list-item-body',
      text: {
        value:
          "const messages = v.chats[v.i].messages;\n\nif (v.livechatstatus == true) {\n  const userMessages = messages.filter(msg => msg.message_type === 'default_user' || msg.message_type === 'default_agent');\n  const lastMessage = userMessages.pop();\n  return lastMessage.body;\n} else {\n  const userMessages = messages.filter(msg => msg.message_type === 'default_user');\n  const lastUserMessage = userMessages.pop();\n  return lastUserMessage.body;\n}"
      }
    },
    {
      id: '77e536b0-c3fc-4398-b4f4-9c9f8239052f',
      name: 'pdf2-upload-preview',
      styles: { values: [{ id: '9843f07e-e42f-485c-88c7-5f30e6449faa', property: 'display', value: 'if (i["pdf2-upload"]["0"]) {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    { id: '77fb99ed-9acb-47b7-8587-794ab8684699', name: 'gtm-notice', visibility: { value: 'if (i["installation-script-toggle"] == true) {\n  return true\n} else {\n  return false\n}' } },
    { id: '78713822-2899-4a57-a24b-2f7c4bd441fa', name: 'inbox-skeleton-wrapper', visibility: { value: 'return (r.get_chats_pagination.isRequesting == true)' } },
    {
      id: '79411275-edd1-4289-b86d-c919aed62f97',
      name: 'emptystate-kennisbank',
      visibility: {
        value:
          'const searchQuery = i["kennisbank-search-input"];\n\nif (searchQuery) {\n  return false\n} else if (\n  r.get_datasources.data.find((item) => item.id === v.active_datasource)\n    .data_type == "pdf"\n) {\n  if (\n    r.get_datasources.data.find((item) => item.id === v.active_datasource)\n      .kb_topics.length == 0\n  ) {\n    return true;\n  } else {\n    return false;\n  }\n} else {\n  return false;\n}\n'
      }
    },
    {
      id: '79e0f9cb-829c-4c74-aeb1-7d88515cb461',
      name: 'form-create-datasource-pdf2',
      events: [
        {
          id: 'c3fa08fe-272e-4d27-9995-50c0bc5d26e8',
          type: 'submit',
          preventDefault: true,
          actions: [
            {
              id: '859d573b-6b76-49f8-9252-c731f6e13447',
              type: 'run-function',
              function:
                'Wized.requests.execute("create_pdf2");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\ndataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\n\n// Deprecaten - .find() method gebruiken\nWized.data.v.active_datasource_type = "pdf2";\n\n// Element visibility\nconst editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\nconst editForm = document.querySelector("[w-el=\'form-container-edit-pdf2\']");\neditDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\nawait Wized.requests.waitFor(\'create_pdf2\');\n\nWized.requests.execute("get_datasources");\nWized.data.v.active_datasource = r.create_pdf2.data.id;\n\nawait Wized.requests.waitFor("get_datasources");\n\nif (v.datasourcesRtSubSubscribed !== true) {\n  window.datasourcesRealtimeInit()\n}\n\n// update container visibility\neditForm.style.display = "flex";\n\n// manage clientside before upserting\nWized.requests.execute("upsert_pdf2");\nawait Wized.requests.waitFor(\'upsert_pdf2\');\n\ni["pdf2-upload"] = {};\nconst pdfForm = document.querySelector("[w-el=\'form-create-datasource-pdf2\']")\npdfForm.reset()',
              hasCondition: true,
              condition:
                '// const organization = r.get_user_data.data[0].organizations[0];\n\n// return (n.path.includes (\'/kennis/databronnen\') && (organization.subscription_status == "active" && organization.subscription_plan.includes("expert")))\n\nreturn true'
            },
            {
              id: 'ad741857-b21c-430f-bb92-5686642fbe3e',
              type: 'run-function',
              function:
                '// Show expert gate with animations\nconst popup = document.querySelector(\'[popupmodal="expert-gate"]\');\n\npopup.style.transform = "translateY(10px)";\npopup.style.opacity = 0;\npopup.style.display = "flex";\n\nsetTimeout(() => {\n    popup.style.transition = "transform 0.2s ease, opacity 0.2s ease";\n    popup.style.transform = "translateY(0)";\n    popup.style.opacity = 1;\n}, 10);\n',
              hasCondition: true,
              condition:
                '// const organization = r.get_user_data.data[0].organizations[0];\n// return (organization.subscription_status !== "active" || !organization.subscription_plan.includes("expert"))\n\nreturn false'
            }
          ]
        }
      ]
    },
    {
      id: '7c38d770-01de-4200-8486-6749fa03f86f',
      name: 'chime-visibility-desktop',
      styles: { values: [{ id: 'da611e05-7f80-4ef2-ac7a-fbb925207a6a', property: 'display', value: 'if ( i.toggle_popup_enabled_desktop == true) {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: '7cd7169f-cba9-4b77-816a-e6ec59049186',
      name: 'phone-label',
      visibility: {
        value: "return (\n  (v.chats[v.i].enduser_phone !== null && v.chats[v.i].enduser_phone !== '') ||\n  (v.chats[v.i].chat_user_phone !== null && v.chats[v.i].chat_user_phone !== '')\n);\n"
      }
    },
    { id: '7cfb00d7-ad0a-4589-8989-e600c64b575e', name: 'document-list-item-name', text: { value: '// return r.get_kb_topics.data.data[v.i].name\nreturn v.filteredKbList[v.i].name' } },
    {
      id: '7d6c3a8d-002d-4237-a8d8-9cdd2cc34d82',
      name: 'installation-script-container',
      text: {
        value:
          'const userId = r.get_chatbot.data.id;\n\nconst pageUrl = window.location.href;\nlet sourceUrl;\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  sourceUrl = "https://cdn.sleak.chat";\n} else {\n  sourceUrl = "https://cdn.dev.sleak.chat";\n}\n\nif (i["installation-script-toggle"] == false) {\n  return `<!-- sleak.chat sleakbot embed snippet -->\n  <script id="sleakbot" src="${sourceUrl}/fetchsleakbot.js" chatbot-id="${userId}" ></script>`\n} else if (i["installation-script-toggle"] == true) {\n  return `<script>\nÂ var sleakGtmScript = document.createElement(\'script\');\nÂ sleakGtmScript.id = \'sleakbot\';\nÂ sleakGtmScript.src = \'${sourceUrl}/fetchsleakbot.js\';\nÂ sleakGtmScript.setAttribute(\'chatbot-id\', \'${userId}\');\nÂ document.body.appendChild(sleakGtmScript);\n</script>`\n}'
      },
      events: [
        {
          id: '31a1f2ba-ea05-4e41-be2e-d2a962c21fa9',
          type: 'click',
          actions: [
            {
              id: '0ad9d17c-bffa-4ff2-a419-23ffed51069f',
              type: 'run-function',
              function:
                'const userId = r.get_chatbot.data.id;\n\nconst pageUrl = window.location.href;\nlet sourceUrl;\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  sourceUrl = "https://cdn.sleak.chat";\n} else {\n  sourceUrl = "https://cdn.dev.sleak.chat";\n}\n\nlet textToCopy;\n\nif (i["installation-script-toggle"] == false) {\n  textToCopy = `<!-- sleak.chat sleakbot embed snippet -->\n  <script id="sleakbot" src="${sourceUrl}/fetchsleakbot.js" chatbot-id="${userId}" ></script>`\n} else if (i["installation-script-toggle"] == true) {\n  textToCopy = `<script>\nÂ var sleakGtmScript = document.createElement(\'script\');\nÂ sleakGtmScript.id = \'sleakbot\';\nÂ sleakGtmScript.src = \'${sourceUrl}/fetchsleakbot.js\';\nÂ sleakGtmScript.setAttribute(\'chatbot-id\', \'${userId}\');\nÂ document.body.appendChild(sleakGtmScript);\n</script>`\n}\n\nnavigator.clipboard.writeText(textToCopy)\n  .catch(error => console.error(\'Error in copying text: \', error));\n\n\n// toast notifications\n\nconst toastMessage = {\n  "id": crypto.randomUUID(),\n  "expiration": new Date().getTime() + 5000,\n  "type": "success",\n  "message": "Installatiecode gekopieerd naar klembord"\n};\n\n// transitions\n\nfunction openToast(toastElement) {\n  toastElement.style.display = "flex";\n  toastElement.style.opacity = 0;\n  toastElement.style.transform = "translateY(40px) scale(0.6)";\n\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 1;\n      toastElement.style.transform = "translateY(0) scale(1)";\n    });\n  });\n}\n\nfunction closeToast(toastElement) {\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 0;\n      toastElement.style.transform = "translateY(40px) scale(0.6)";\n      setTimeout(() => {\n        toastElement.style.display = "none";\n      }, 150);\n    });\n  });\n}\n\nasync function manageToast(toastElement) {\n  openToast(toastElement);\n  await new Promise(resolve => setTimeout(resolve, 5000));\n  closeToast(toastElement);\n}\n\nv.toast_log.push(toastMessage)\n\nconst toastElement = document.querySelector(`[toast_item_id=\'${toastMessage.id}\']`);\n\nmanageToast(toastElement);\n'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '7e2ac4ce-d379-4fd5-8803-55228a110ca9',
      name: 'clear-csv-btn',
      events: [
        {
          id: '58cacd7c-3d60-40b6-b5fb-856b3bdd2566',
          type: 'click',
          actions: [
            {
              id: '062ba5b1-ea9c-4ac5-ba65-82fd0c55d0cf',
              type: 'run-function',
              function: 'i["csv-upload"] = {};\nconst form = document.querySelector("[w-el=\'form-create-datasource-csv\']")\nform.reset();\nv.csv_rows = []\nv.csvContent = null'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: '7ecfcd6f-876b-41e4-93bc-df1be3a9e4c9',
      name: 'admin-ui-chat-input',
      styles: {
        values: [
          {
            id: 'c1dc146b-8e97-48c0-9165-8f89e0d9e808',
            property: 'pointer-events',
            value: 'if (v.chats.find((chat) => chat.id === v.active_chat).livechat == false) {\n  return "none"\n} else {\n  return "auto"\n}'
          }
        ]
      }
    },
    {
      id: '7ed6d121-6e17-4a21-8a36-01502855ff65',
      name: 'create-checkout',
      events: [
        {
          id: '3fba537d-4d6e-47fd-9c63-6bd6fd30b54d',
          type: 'click',
          actions: [
            {
              id: 'a87c5933-71be-4f6c-866f-224198b85a5c',
              type: 'run-function',
              function:
                'const priceId = event.currentTarget.getAttribute("price-id");\nv.subscriptionPriceId = priceId;\n\nWized.requests.execute("create_checkout_session");\nawait Wized.requests.waitFor(\'create_checkout_session\');\n\nconst redirectUrl = r.create_checkout_session.data.checkout_url;\n\nfunction checkUserAgent() {\n  const userAgent = navigator.userAgent;\n  return userAgent.includes("Chrome");\n}\n\nif (checkUserAgent()) {\n  window.open(redirectUrl, \'_blank\', \'noopener,noreferrer\');\n} else {\n  window.location.href = redirectUrl;\n}\n'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: '7f3d8f5f-014b-4a2c-90ce-f87a369f6a9d',
      name: 'chat-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.chats;' },
      attributes: { values: [{ id: '3751bb15-4986-4ed5-aac2-f49619083964', key: 'id', value: 'return v.chats[v.i].id' }] },
      events: [
        {
          id: 'b005da4f-8c4f-4972-99ac-d1041e37b4a8',
          type: 'click',
          actions: [
            {
              id: '0716d970-028b-462e-853d-cb8e4b1c29d6',
              type: 'run-function',
              function:
                'const dataValue = event.currentTarget.getAttribute("id");\n\nv.active_chat = dataValue;\n\nv.livechatstatus = v.chats[v.active_chat_index].livechat;\n\nWized.requests.execute("update_chat_hasunread");\n\nif (window.innerWidth <= 768) {\n  document.querySelector(\'[w-el="messages-grid-container"]\').style.display = "flex";\n}'
            }
          ],
          hasCondition: false
        }
      ],
      classes: {
        values: [
          {
            id: 'a89df2f2-6056-44be-87f5-f9daa7128bc5',
            class: 'active',
            condition: "return (v.chats[v.i].id == v.active_chat && n.path.includes(\"inbox\") )\n//   return '#F8FAFF'\n// } else {\n//   return '#fff'\n// }"
          }
        ]
      }
    },
    {
      id: '7fbe5d9e-4aa8-4eac-95be-fb4ca220bb5c',
      name: 'form-livechat',
      events: [
        {
          id: '9085ff14-32e1-4b6f-8895-e2c0ee218117',
          type: 'submit',
          preventDefault: true,
          actions: [
            {
              id: '2bf93f36-ff73-40a7-a0be-999838ddc5cf',
              type: 'run-function',
              function:
                'v.livechatstatus = true;\n\ndocument.querySelector(\'[w-el="admin-ui-chat-input"]\').removeAttribute(\'readonly\');\n\nconst livechatModal = document.querySelector(\'[w-el="livechat-popup"]\');\nlivechatModal.style.display = "none";\n\nfunction changeOperator() {\n  Wized.requests.execute("update_chat_livechat");\n  Wized.requests.execute("create_message_operatorchanged");\n}\n\nif (i["agent-avatar-input"][0]["0"]) {\n  if (r.upsert_agent_avatar_file.ok) {\n    changeOperator();\n  } else {\n    Wized.requests.execute("upsert_agent_avatar_file");\n    \n    if (r.get_agents.data[0].name !== i["agents-list-item-name-input"][0]) {\n        v.active_agent.name = i["agents-list-item-name-input"][0];\n    }\n    \n    await Wized.requests.waitFor("upsert_agent_avatar_file");\n    v.active_agent.avatar = r.upsert_agent_avatar_file.data.publicUrl;\n\n    Wized.requests.execute("update_agent_avatar_file");\n    changeOperator();\n    \n    await Wized.requests.waitFor("update_agent_avatar_file");\n\n    // i["agent-avatar-input"][0]["0"] = null;\n    Wized.requests.execute("get_agents");\n  }\n} else {\n  if (r.get_agents.data[0].name !== i["agents-list-item-name-input"][0]) {\n    v.active_agent.name = i["agents-list-item-name-input"][0];\n    Wized.requests.execute("update_agent_avatar_file");\n\n    changeOperator();\n  } else {\n    changeOperator();\n  }\n}\n\n\nlet joinLivechatEvent = new CustomEvent(\'joinLivechat\', { detail: { message: \'Joining live chat\' } });\nwindow.dispatchEvent(joinLivechatEvent);\n'
            }
          ]
        }
      ]
    },
    {
      id: '80c449b2-2418-4db6-9ee3-8efe86710598',
      name: 'change-status',
      events: [
        {
          id: '7fb7ee26-f1d3-45f6-84cc-ae5283be7ee7',
          type: 'click',
          actions: [
            {
              id: '4f3762b1-a716-4a53-b706-141209317929',
              type: 'run-function',
              function:
                'const dataValue = event.currentTarget.getAttribute("data-value");\n\nv.dataSourceUpdatedStatus = dataValue;\n\nconst modals = document.querySelectorAll(\'[dropdown-modal]\');\n\nmodals.forEach(modal => {\n  modal.style.opacity = "0";\n  modal.style.transform = "translateY(-20px)";\n  setTimeout(() => {\n    modal.style.display = "none";\n  }, 200);\n})\n'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: '83036746-0c67-4786-a643-231f200335f5',
      name: 'filter-chatbots-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return r.get_chatbots.data' },
      attributes: { values: [{ id: '6b83e511-e876-4621-ab5d-c90c478e9584', key: 'id', value: 'return r.get_chatbots.data[v.i].id' }] },
      events: [
        {
          id: '5bbc72bf-569e-4690-adc2-1cd4a95cfed7',
          type: 'click',
          actions: [
            {
              id: 'fec2ed01-9aab-4245-91ef-494cd80ae5f6',
              type: 'run-function',
              function:
                'const targetId = event.currentTarget.getAttribute("id");\nconsole.log(targetId);\n\nif (v.inboxFilterChatbots.includes(targetId)) {\n\n  v.inboxFilterChatbots = v.inboxFilterChatbots.filter(item => item !== targetId);\n} else {\n\n  v.inboxFilterChatbots.push(targetId);\n}\n'
            }
          ],
          hasCondition: false
        }
      ],
      classes: { values: [{ id: 'bd14e7b2-00e7-4460-928f-07a02500e262', class: 'active', condition: 'return (v.inboxFilterChatbots.includes(r.get_chatbots.data[v.i].id))' }] }
    },
    {
      id: '831b6fd7-5a73-4e37-bcd7-13a99b3ce144',
      name: 'chat-list-item-operator',
      attributes: { values: [{ id: 'd5be339a-f39e-4729-85c3-8489207fa00f', key: 'src', value: 'return (r.get_chatbots.data.find((item) => item.id === (v.chats[v.i].chatbot_id)).avatar_url)' }] }
    },
    {
      id: '839a3d5e-74cd-4d7c-be01-ee27d63817e2',
      name: 'visibility_toggle_channels_phone',
      styles: { values: [{ id: '2d4f459c-7be6-48d5-8e4e-73bfdec45630', property: 'display', value: 'if (i.toggle_channels_call == true) {\n  return "block"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: '83c01235-2212-420e-9f3c-612c6f120278',
      name: 'active-language',
      text: {
        value:
          'if (i["input-language"] == "nl") {\n  return `Nederlands <span class="land">ðŸ‡³ðŸ‡±</span>`;\n} else if (i["input-language"] == "en") {\n  return `Engels <span class="land">ðŸ‡¬ðŸ‡§</span>`;\n} else if (i["input-language"] == "fr") {\n  return `Frans <span class="land">ðŸ‡«ðŸ‡·</span>`;\n} else if (i["input-language"] == "de") {\n  return `Duits <span class="land">ðŸ‡©ðŸ‡ª</span>`;\n} else if (i["input-language"] == "es") {\n  return `Spaans <span class="land">ðŸ‡ªðŸ‡¸</span>`;\n} else if (i["input-language"] == "it") {\n  return `Italiaans <span class="land">ðŸ‡®ðŸ‡¹</span>`;\n} else if (i["input-language"] == "pl") {\n  return `Pools <span class="land">ðŸ‡µðŸ‡±</span>`;\n} else if (i["input-language"] == "pt") {\n  return `Portugees <span class="land">ðŸ‡µðŸ‡¹</span>`;\n} ',
        type: 'html'
      }
    },
    {
      id: '83eeb68a-eb46-49c5-85ff-8fee046c05ff',
      name: 'api-headers-list-item-delete-btn',
      events: [
        {
          id: 'cb500ff1-71e9-4a4a-9691-2d34bd09a3b7',
          type: 'click',
          actions: [
            {
              id: 'f7790643-3815-4aca-896e-ea294cfa033a',
              type: 'run-function',
              function:
                "var keys = document.querySelectorAll('[api-headers-table=key]');\nvar values = document.querySelectorAll('[api-headers-table=value]');\nvar headers = [];\n\nkeys.forEach((keyInput, index) => {\n    var valueInput = values[index];\n    headers.push({ index: index, key: keyInput.value, value: valueInput.value });\n});\n\nv.apiHeadersArray = headers;\n\nfunction deleteObjectByIndex(index) {\n  if (index !== -1) {\n    v.apiHeadersArray.splice(index, 1); // Remove 1 item at the given index\n  } else {\n    console.log(\"No object found with index\", index);\n  }\n}\n\nvar actualRow = event.target.closest(\"[w-el='api-headers-list-item']\");\nvar parentContainer = actualRow.parentNode;\nvar children = Array.from(parentContainer.children);\nvar index = children.indexOf(actualRow);\n\ndeleteObjectByIndex(index);\n"
            }
          ],
          hasCondition: false
        }
      ],
      attributes: { values: [{ id: '8bf4d11d-53e6-4970-9c00-25807239165f', key: 'index', value: 'return v.apiHeadersArray[v.i].index' }] }
    },
    {
      id: '843aa0d9-c0ac-47e4-90fa-772e87596f4c',
      name: 'message-type-success_message',
      visibility: { value: 'return (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type == "success_message")\n' }
    },
    {
      id: '864adb03-690c-4805-9f1b-d450fc2d0ddd',
      name: 'chatbot-list-status-indicator',
      styles: {
        values: [
          {
            id: '0a7f9707-3a80-4009-b5a5-7d1a886ade0f',
            property: 'background-color',
            value: 'if (r.get_chatbots.data[v.i].publishing.published == true) {\n  return "#25d366"\n} else if (r.get_chatbots.data[v.i].publishing.published == false) {\n  return "#F37A80"\n}'
          }
        ]
      }
    },
    {
      id: '87977a1f-e346-4790-b1e3-4e5859ea20f8',
      name: 'message_list_item-img',
      attributes: {
        values: [
          {
            id: '45e23411-d2d1-4c1d-ac06-0f3f74581a7a',
            key: 'src',
            value:
              'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "operator_changed") {\n\n      return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.operator_avatar_img\n\n    }'
          }
        ]
      }
    },
    {
      id: '89d6b821-1cb9-4945-a5ff-34a8bf7bb8fb',
      name: 'fom-basis-prompt',
      events: [
        {
          id: 'c0fd3b64-61b4-44cd-8ebf-fc58d61d4fdc',
          type: 'submit',
          actions: [{ id: 'd1f03fea-a9c9-4465-9e44-4fc8165bf1dc', type: 'perform-request', request: '2341ce1b-64f5-4ded-9952-3487bca24247' }],
          hasCondition: false,
          preventDefault: true
        }
      ],
      form: { value: 'return {\n  basis_prompt: r.get_chatbot.data.system_message,\n  identiteit_prompt: r.get_chatbot.data.system_message_identity\n}' }
    },
    {
      id: '8a07b466-1f46-4078-9472-594e884d3d6b',
      name: 'filter-label',
      events: [
        {
          id: '54b07751-f272-427d-8736-f6f5e6726cdf',
          type: 'click',
          actions: [
            {
              id: '3e9b7339-2f22-46b1-bea5-05fbc03c75d3',
              type: 'run-function',
              function:
                'const targetValue = event.currentTarget.getAttribute("filter-value");\n\nv.inboxFilterLabel = targetValue;\n\ndocument.querySelectorAll(\'[w-el="filter-label"]\').forEach((element) => {\n  element.classList.remove("active");\n});\n\nevent.currentTarget.classList.add("active");\n'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: '8aotslQiKyCKB90JPTLZ',
      name: 'active-chat-inbox-url',
      text: { value: "return r.get_chatbots.data\n  .find(item => item.id === v.chats.find(chat => chat.id === v.active_chat).chatbot_id)\n  .website_url.replace(/^https?:\\/\\//, '');" }
    },
    {
      id: '8auKOdU9jnkJXRe2cdQK',
      name: 'outputlogs-api-list-item',
      list: {
        indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72',
        value:
          'const toolOutput = r.get_outputlogs.data[0].tool_output[0];\nconst toolInput = JSON.parse(toolOutput).toolInput;\n\nconst keyValueArray = Object.entries(toolInput).map(([key, value]) => ({\n    property: key,\n    value: value\n}));\nreturn keyValueArray;'
      }
    },
    {
      id: '8b673bba-5235-42a9-8998-da4134dd5a07',
      name: 'scrape-urls-visible',
      text: {
        value:
          'const totalPages = v.scrapetool_urls_list.length\nconst filteredPages = v.scrapetool_urls_list_filtered.length\n\nconst amountVisiblePages = i["scrape-pagination-itemsperpage"]; // Get the number of items per page\n\nif (amountVisiblePages == 20) {\n  if (filteredPages >= 20){\n    return 20\n  } else {\n    return filteredPages\n  };  \n} else {\n  return filteredPages; \n}'
      }
    },
    {
      id: '8c4bac71-38c1-4490-9a01-ffc923bd4091',
      name: 'api-requestbody-visibility',
      styles: { values: [{ id: '9f0e8dd1-561e-44a0-87e9-45e295387dbc', property: 'display', value: 'if (i["input-api_body_type"] == "json") {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: '8ded25a5-31c1-4df6-8c70-91461c7c104d',
      name: 'visibility_toggle_channels_form',
      styles: { values: [{ id: '25878755-b665-4bcf-a7ce-9a2d0ff25943', property: 'display', value: 'if (i.toggle_channels_form == true) {\n  return "block"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: '8sAiZy4t63i6jUX4VeQY',
      name: 'tags-table-visibility',
      styles: { values: [{ id: 'd1ca0498-a174-4ce7-a599-e3cb138c1979', property: 'display', value: 'if (i.ai_tagging_enabled) {\n  return "flex";\n} else {\n  return "none";\n}' }] }
    },
    {
      id: '8t28D1wg0qTeLIEU9glf',
      name: 'activityfeedlist-timestamp',
      text: {
        value:
          "// Function to pad numbers with a leading zero if necessary\nfunction padZero(number) {\n  return number < 10 ? '0' + number : number.toString();\n}\n\nconst messageTimestamp = v.mergedEvents[v.i].created_at;\nconst createdAt = new Date(messageTimestamp);\nconst now = new Date();\n\nconst timeDiffMs = now - createdAt; // Difference in milliseconds\nconst minutes = Math.floor(timeDiffMs / 60000);\nconst hours = Math.floor(timeDiffMs / 3600000);\nconst days = Math.floor(timeDiffMs / 86400000);\n\n// Helper arrays for month and day names in Dutch\nconst monthNames = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\n\nconst dayNames = ['zondag', 'maandag', 'dinsdag', 'woensdag', 'donderdag', 'vrijdag', 'zaterdag'];\n\n// Extract time components\nconst formattedTime = `${padZero(createdAt.getHours())}:${padZero(createdAt.getMinutes())}`;\n\n// Function to check if two dates are on the same day\nfunction isSameDay(d1, d2) {\n  return d1.getFullYear() === d2.getFullYear() && d1.getMonth() === d2.getMonth() && d1.getDate() === d2.getDate();\n}\n\n// Function to check if a date is yesterday relative to another date\nfunction isYesterday(date, referenceDate) {\n  const yesterday = new Date(referenceDate);\n  yesterday.setDate(referenceDate.getDate() - 1);\n  return isSameDay(date, yesterday);\n}\n\nif (minutes < 1) {\n  return `zojuist`;\n} else if (minutes < 60) {\n  return `${minutes} min. geleden - ${formattedTime}`;\n} else if (isSameDay(createdAt, now)) {\n  return `${formattedTime}`;\n} else if (isYesterday(createdAt, now)) {\n  // Yesterday with time\n  return `Gisteren - ${formattedTime}`;\n} else if (days < 7) {\n  // Within the last 7 days\n  return `${dayNames[createdAt.getDay()]} - ${formattedTime}`;\n} else {\n  // Older than 7 days\n  return `${createdAt.getDate()} ${monthNames[createdAt.getMonth()]} ${formattedTime}`;\n}"
      }
    },
    { id: '91b6babc-0fac-4497-82eb-ea82d659b8a8', name: 'chatbots-skeleton', visibility: { value: 'return (r.get_chatbots.ok !== true)' } },
    {
      id: '92200e1a-62cf-4f81-9086-222aad5d0e62',
      name: 'pdf2-dragarea',
      styles: { values: [{ id: 'a46ba4b6-d3ab-4219-bf97-718cded856b0', property: 'display', value: 'if (i[\'pdf2-upload\']["0"]) {\n    return "none";\n} else {\n    return "flex";\n}' }] }
    },
    {
      id: '9237b9f0-5c12-4e8a-8a80-efe01daa93b2',
      name: 'datasource-sharing-selected-name',
      text: {
        value: 'if (!v.datasource_sharing_selected) {\n  return "Chatbot selecteren"\n} else {\n  return (r.get_chatbots.data.find((item) => item.id === v.datasource_sharing_selected)).name\n}'
      }
    },
    {
      id: '9317f1d6-4393-402d-80f8-1a54977206b8',
      name: 'datasource-sharing-chatbot-list-item-url',
      text: { value: '// return v.chatbots[v.i].name\nreturn v.datasourceSharingChatbotsDropdown[v.i].website_url' }
    },
    {
      id: '94f8eef0-a44c-4cef-bf78-0ab875459548',
      name: 'emailgate_confirmation_message',
      styles: { values: [{ id: '9264a64d-71ef-4aa9-9ed2-c0633e16e728', property: 'display', value: 'if (i.emailgate_enabled == true) {\n  return "flex"\n} else {\n  return "none"\n}\n\n' }] }
    },
    { id: '962ef527-9e09-4ed1-90a6-1358334fda9d', name: 'review-button', visibility: { value: 'return (r.get_user_data.data[0].organizations[0].subscription_status == "active")' } },
    { id: '9657b964-e331-4b00-ab8e-8db6c3163202', name: 'active-filter-label-escalated', visibility: { value: 'return (v.inboxFilterStatus == "escalated")' } },
    {
      id: '970d13e5-e312-4885-9495-4bcce844a7cf',
      name: 'form-delete-kb-item',
      events: [
        {
          id: 'eced0de4-9e50-4c73-8a3e-e5c10df49412',
          type: 'submit',
          actions: [
            {
              id: '6a7b3094-e7c2-4f30-ba20-092fb1bb9f89',
              type: 'run-function',
              function:
                'Wized.requests.execute("delete_kb_topic");\n\nawait Wized.requests.waitFor("delete_kb_topic");\n\nWized.requests.execute("get_datasources");\n\n\nv.active_kb_topic = null;\n\nconst modals = document.querySelectorAll(\'[popupmodal]\');\nmodals.forEach((modal) => {\n  modal.style.display = "none";\n});'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: '973f2969-e24f-44c5-bf08-99481ea4831b',
      name: 'kennisbank-search-container',
      styles: {
        values: [
          {
            id: 'da99f3e0-2acd-4713-8055-eda555039cf3',
            property: 'display',
            value:
              'const searchQuery = i["kennisbank-search-input"];\n\nif (v.filteredKbList.length > 0) {\n  return "flex";\n} else if (!searchQuery.length == 0) {\n  return "flex";\n} else {\n  return "none";\n}\n'
          }
        ]
      }
    },
    { id: '9838e123-0263-4e77-ab87-c42676c034cb', name: 'active-chatbot-organization', text: { value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).organization_name\n' } },
    { id: '98c268c5-c08a-47d5-94c3-b7ad386766a6', name: 'chatbot-list-item-name', text: { value: '// return v.chatbots[v.i].name\nreturn r.get_chatbots.data[v.i].name' } },
    { id: '9F5X23mrOg9I2J3jzxcW', name: 'add-tag-btn', visibility: { value: 'return (i["ai-tagging-addtag-value"] !== \'\')' } },
    {
      id: '9a071e85-c02d-41c0-a563-a6b0c6ef62b3',
      name: 'message_list_item-name',
      text: {
        value:
          'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "operator_changed") {\n\n      return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.operator_name\n\n    }'
      }
    },
    {
      id: '9b02e860-679a-46fc-a0ab-2104e2a87097',
      name: 'message-list-item',
      list: {
        indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72',
        value:
          "const activeChat = v.chats.find(chat => chat.id === v.active_chat);\n\n// if (activeChat) {\n//   const hasFileOrImage = activeChat.messages.some(\n//     message => message.message_type === 'file' || message.message_type === 'image'\n//   );\n\n//   if (hasFileOrImage && !v.wfReInit) {\n//     v.wfReInit == true\n//     setTimeout(() => {\n//       console.log(\"Re-initializing Webflow\");\n//       Webflow.destroy();\n//       Webflow.ready();\n//       // Webflow.require('lightbox').ready();\n//       v.wfReInit == false\n//     }, 1000);\n\n//   }\n// }\n\nreturn activeChat ? activeChat.messages : [];\n"
      },
      classes: {
        values: [
          { id: '85903ef2-28ac-44d3-b5e9-b5686c32c78c', class: 'visible', condition: 'return true' },
          { id: '543b2fc3-c06a-4cb9-a0a9-2d080e798408', class: 'bot', condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_bot")' },
          { id: '09c6584f-6021-45de-9e13-0eef199196a4', class: 'agent', condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].message_type == "default_agent")' },
          { id: 'a4cc6d32-be89-4170-97d3-ece2e2e1c536', class: 'user', condition: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].author_type == "user")' }
        ]
      },
      attributes: { values: [{ id: '7c848f5a-2980-4920-976b-9ad42301e15b', key: 'message_list_id', value: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].id)' }] }
    },
    {
      id: '9be8f29a-5ace-445a-95df-06644aec6873',
      name: 'form-create-datasource-pdf',
      events: [
        {
          id: 'c0680b60-7317-468a-886d-7f557fb02fc0',
          type: 'submit',
          actions: [
            {
              id: 'bf42cf54-e82e-4002-a539-234ead2391e0',
              type: 'run-function',
              function:
                'Wized.requests.execute("create_pdf");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\ndataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\nwindow.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  // Deprecaten - .find() method gebruiken\n  Wized.data.v.active_datasource_type = "pdf";\n\n  // Element visibility\n  const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n  const editForm = document.querySelector("[w-el=\'form-container-edit-pdf\']");\n  editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n  await Wized.requests.waitFor(\'create_pdf\');\n\n  Wized.requests.execute("get_datasources");\n  Wized.data.v.active_datasource = r.create_pdf.data.id;\n\n  await Wized.requests.waitFor("get_datasources");\n  // update container visibility\n  editForm.style.display = "flex";\n\n\n  // reset create forms - al gedaan bovenin?\n  // const allForms = document.querySelectorAll(".datasources-formblock");\n  // const formWrapperInitial = document.getElementById("create-datasource-form");\n  // allForms.style.display = "none";\n  // formWrapperInitial.style.display = "flex";\n});',
              hasCondition: true,
              condition: "return (n.path.includes ('/kennis/databronnen'))"
            },
            {
              id: '621c8ece-e144-4a49-b8bd-719a77ab5126',
              type: 'run-function',
              function: "Wized.requests.execute(\"create_pdf\");\nawait Wized.requests.waitFor('create_pdf');\n\nv.active_datasource = r.create_pdf.data.id;\n\nn.path = '/kennis/databronnen?tn=cd'",
              hasCondition: true,
              condition: "return (n.path.includes ('/kennis/prompt'))"
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: '9c7ef782-af2e-4f0b-a72b-8e5969e466e8', name: 'datasource-list-name', text: { value: 'return r.get_datasources.data[v.i].name' } },
    {
      id: '9c844adc-3188-48c9-8488-c22f66e0ca11',
      name: 'datasource-csv-preview-timestamp-date',
      text: {
        value:
          'const updatedAt = new Date(r.get_datasources.data.find((item) => item.id === v.active_datasource).last_updated);\nreturn updatedAt.getDate().toString().padStart(2, \'0\') + "-" + (updatedAt.getMonth() + 1).toString().padStart(2, \'0\') + "-" + updatedAt.getFullYear();'
      }
    },
    {
      id: '9ce271cd-1679-4734-93a6-3d4ad1f3b4d6',
      name: 'datasource-list-item-shared',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.datasourceSharingNavbarList;\n' }
    },
    { id: '9d276c08-82a9-4c26-bc9b-2235f4613de4', name: 'checkbox-livechat', value: { value: 'return v.chats.find((chat) => chat.id === v.active_chat).livechat' } },
    {
      id: '9e8d9161-365a-44bd-ae8e-9bbb96c0aee1',
      name: 'pakketten-btn',
      styles: {
        values: [
          {
            id: 'e4dc3365-d950-4285-8605-447c4d324674',
            property: 'display',
            value: 'if (r.get_user_data.data[0].organizations[0].subscription_status !== "active") {\n  return "flex"\n} else {\n  return "none"\n}'
          }
        ]
      }
    },
    { id: '9tl4ziuGVtFRgVlfZ8B3', name: 'xml-unique-identifier' },
    { id: 'ASFW3UAdfmI6AuGmulo7', name: 'tagging-emptystate', visibility: { value: 'return (v.chatTags.length == 0);' } },
    {
      id: 'AetA2JCBngN6BIg77flP',
      name: 'customf-delete-btnelds',
      attributes: { values: [{ id: 'ffc65b9c-9919-426e-aa25-02ea133177e4', key: 'index', value: 'return v.i' }] },
      events: [
        {
          id: '36c4f128-6a4a-4066-a52e-6dfc41d6c645',
          type: 'click',
          actions: [
            {
              id: '4d01dd70-b028-4f58-aec5-6495c9ccd991',
              type: 'run-function',
              function:
                'const customfieldsArray = [];\n\n// update variable before deleting to prevent losing manually added data\ndocument.querySelectorAll("[w-el=custom-fields-lit-item]").forEach((item, index) => {\n  const key = i["custom-fields-list-item-input"][index];\n  const updateChatName = i.toggle_customfields_override_checkbox[index];\n  const updateEmail = i.toggle_customfields_override_emal[index];\n  console.log(`updatechatname ${index} = `, updateChatName);\n  console.log(`updateemailname ${index} = `, updateEmail);\n  console.log(`fieldname ${index} = `, key);\n  customfieldsArray.push({\n    key,\n    updateChatName,\n    updateEmail\n  });\n});\n\nv.chatbotCustomFields = customfieldsArray;\n\n// splice from array\nconst index = event.currentTarget.getAttribute(\'index\');\nv.chatbotCustomFields.splice(parseInt(index, 10), 1);\n\n'
            }
          ]
        }
      ]
    },
    { id: 'BOTuegZ3xyV6djrpakK2', name: 'livechat-popup-leave' },
    {
      id: 'C119s7sbOFmeL0SXg5XU',
      name: 'archive-chat-tooltip',
      text: {
        value:
          'if (v.chats.find((item) => item.id == v.active_chat).archived == false) {\n  // return "Chat archiveren"\n  return "Archiveren"\n} else if (v.chats.find((item) => item.id == v.active_chat).archived == true) {\n  return "De-archiveren"\n}'
      }
    },
    {
      id: 'CPHVubNpKfdkE0afmuCf',
      name: 'form-send-file',
      events: [
        {
          id: 'e0f171cd-5a45-422c-b8fd-f0ad1948e3fa',
          type: 'submit',
          preventDefault: true,
          actions: [
            {
              id: '748603dc-080e-43f0-8b35-b78b38b0707f',
              type: 'run-function',
              function:
                "Wized.requests.execute('upsert_image_inbox_fullsize');\n\nif (i[\"send-file-upload\"][\"0\"].type.includes('image')) {\n  Wized.requests.execute('upsert_image_inbox');\n  await Wized.requests.waitFor('upsert_image_inbox');\n} \n\nawait Wized.requests.waitFor('upsert_image_inbox_fullsize');\n\ndocument.querySelector('[popupmodal=\"send-file\"]').style.display = \"none\"\n\nif (r.upsert_image_inbox_fullsize.ok == true) {\n  Wized.requests.execute('post_message_fileupload');\n  await Wized.requests.waitFor('post_message_fileupload');\n}\n\ni[\"send-file-upload\"] = {};\nconst form = document.querySelector(\"[w-el='form-send-file']\")\nform.reset();"
            }
          ]
        }
      ]
    },
    { id: 'Cj2W5k1kYJSzWRBAKtnf', name: 'send-file-dragarea', visibility: { value: 'return (i["send-file-upload"]["0"] ? false : true)' } },
    {
      id: 'CqluRNDMpaS6Q80NjZay',
      name: 'image-imagesrc',
      attributes: {
        values: [
          {
            id: 'e0ffb1cd-a473-49a9-b537-a8c0e99c6fc5',
            key: 'src',
            value:
              'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "image") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .file_path\n\n}'
          }
        ]
      }
    },
    {
      id: 'DRU8S1nqGf1yhWRwQ3Bk',
      name: 'export-chats-btn',
      events: [
        {
          id: 'af675f63-38dc-4912-a932-f33600108a51',
          type: 'click',
          actions: [
            {
              id: 'aff49e86-b4ac-4967-aebc-b0027b766893',
              type: 'run-function',
              function:
                'Wized.requests.execute(\'export_chats\');\ndocument.querySelector(\'[spinner="export-chats"]\').style.display = "flex"\n\nawait Wized.requests.waitFor(\'export_chats\');\ndocument.querySelector(\'[spinner="export-chats"]\').style.display = "none"\n\nif (r.export_chats.ok == true) {\n  window.showToastNotification("Chats succesvol geÃ«xporteerd", "success");\n}'
            }
          ]
        }
      ]
    },
    {
      id: 'Dr9mAkUIAIUQPMydl48P',
      name: 'activityfeedlist-icon-image',
      attributes: {
        values: [
          {
            id: '2f514fbd-d11e-42e1-ba07-cd65d5ec980e',
            key: 'src',
            value:
              "if (v.mergedEvents[v.i].event_group == 'message_user') {\n  return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/comment%20(2).svg';\n} else if (v.mergedEvents[v.i].event_group == 'page_view') {\n  return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/compass.svg';\n} else if (v.mergedEvents[v.i].event_group == 'operator_changed') {\n  if (v.mergedEvents[v.i].message_type_data.event_type === 'joined') {\n    return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/comment-check.svg';\n  } else if (v.mergedEvents[v.i].message_type_data.event_type === 'left') {\n    return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/comment-block.svg';\n  }\n} else if (v.mergedEvents[v.i].event_group == 'handoff_requested') {\n  return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/675e02e19f940c031541cebb_map-marker-question.svg'\n} else if (v.mergedEvents[v.i].event_group == 'form_submission') {\n  return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/subject%20(2).svg';\n} else if (v.mergedEvents[v.i].event_group == 'purchase') {\n  return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/dollar-sign-alt.svg';\n} else if (v.mergedEvents[v.i].event_group == 'add_to_cart') {\n  return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/shopping-bag.svg';\n} else if (v.mergedEvents[v.i].event_group == 'login') {\n  return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/user-check.svg';\n} else if (v.mergedEvents[v.i].event_group == 'sign_up') {\n  return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/user-plus.svg';\n} else if (v.mergedEvents[v.i].event_group == 'click') {\n  return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/location-arrow%20(3).svg';\n} else {\n  return 'https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/icons/user-check.svg';\n}"
          }
        ]
      }
    },
    { id: 'EPdLxKFsQP2A5a2cz3kf', name: 'emptystate-manualtag', visibility: { value: 'return (v.filteredTags.length == 0)' } },
    {
      id: 'ETpOXdkDvLqqKWrDrLPV',
      name: 'tagging-delete-btn',
      attributes: { values: [{ id: 'e4aacaad-d43f-4552-b889-6f8e67479e5a', key: 'index', value: 'return v.i' }] },
      events: [
        {
          id: '169c8393-982c-4385-ad9e-f4428c43fdf3',
          type: 'click',
          actions: [
            {
              id: 'a73672d2-c394-41d0-8563-75ef2da6f323',
              type: 'run-function',
              function:
                "const tagsArray = [];\n\n// update variable before deleting to prevent losing manually added data\ndocument.querySelectorAll('[w-el=tagging-list-item]').forEach(item => {\n  const tag = item.getAttribute('tagging-list-item-tag');\n  const description = item.querySelector('[w-el=\"tagging-list-item-description\"]').value;\n  tagsArray.push({\n    tag,\n    description\n  });\n});\n\nv.chatbotTags = tagsArray;\n\n// splice from array\nconst index = event.currentTarget.getAttribute('index');\nv.chatbotTags.splice(parseInt(index, 10), 1);"
            }
          ]
        }
      ]
    },
    {
      id: 'EXwi43mj8rd2phNHfU6R',
      name: 'emptystate-conversationstarters-table-visibility',
      styles: { values: [{ id: '18679e5b-bcb7-42a7-b56a-3ffd7f0c1534', property: 'display', value: 'if (i.toggle_conversationstarters_enabled) {\n  return "flex";\n} else {\n  return "none";\n}' }] }
    },
    {
      id: 'EeE91Qkng5IGrVDBPpLU',
      name: 'tool-output-logs-indicator-button-icon',
      attributes: {
        values: [
          {
            id: '81450753-787f-4f2b-9b47-2b7f41b365e7',
            key: 'src',
            value:
              "if (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].outputlogs.type == 'sourceDocuments') {\n  return \"https://cdn.prod.website-files.com/65911e9735540c235757642f/67239dd4e768c478e10fb6b4_file%20(1).svg\"\n} else if (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].outputlogs.type == 'usedTools') {\n  return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/673b9a61097d507b1731a413_wrench.svg'\n}"
          }
        ]
      }
    },
    { id: 'F7uDZqCtREXI7CeOKErR', name: 'activityfeedlist-list-item-previw', list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.mergedEvents.slice(0, 5);\n' } },
    {
      id: 'FN4re9DuG3nMWinSovGG',
      name: 'filepreview-name',
      text: { value: 'const message = v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n\nif (message.message_type == "file") {\n  return message.message_type_data.file_name\n}' }
    },
    {
      id: 'GPZbuwmdU4sSlMbur4tl',
      name: 'chat-name-edit',
      events: [
        {
          id: '815a5ad6-c92d-495e-9224-dd7c259a46c0',
          type: 'click',
          actions: [
            {
              id: 'be5eb2fd-279d-4d9d-94ce-1d0ae7252d90',
              type: 'run-function',
              function: 'const input = document.querySelector(\'[w-el="inbox-sidebar-chatname-inut"]\');\ninput.style.display = "flex"\ninput.focus();\ninput.select();\n'
            }
          ]
        }
      ]
    },
    {
      id: 'HKzpRIqKlwKAU2YWIFqY',
      name: 'send-file-preview-extension',
      text: { value: 'const fileName = i["send-file-upload"]["0"].name;\nconst fileExtension = fileName.split(\'.\').pop();\nreturn fileExtension\n' }
    },
    {
      id: 'HhKrivzQXBqjzomZqKKS',
      name: 'chatbot-filter-additionalcount',
      visibility: { value: 'return v.inboxFilterChatbots.length > 3;' },
      text: { value: 'if (v.inboxFilterChatbots.length > 3) {\n  return v.inboxFilterChatbots.length\n}' }
    },
    {
      id: 'Hu8B1DYNJSBtnHFvJ2cW',
      name: 'productioptions-selectoxes',
      styles: { values: [{ id: 'c454dc8d-4bd3-4024-a4cd-6516bae05bda', property: 'display', value: 'if (v.csvContent && v.csv_rows.length > 0) {\n  return "none"\n} else {\n  return "block"\n}' }] }
    },
    { id: 'JBSZ2FfyWFp8jpFKzd9e', name: 'activityfeed-showmore-container', visibility: { value: 'return (v.mergedEvents.length > 5)' } },
    { id: 'JsYM5F1ilXDHf9NgxDH9', name: 'tool-output-logs-list-item', list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return r.get_outputlogs.data' } },
    { id: 'K9EtRkgUg43fJdAGHq0Z', name: 'tooloutput-api-respons', text: { type: 'markdown', value: 'const output = JSON.parse(r.get_outputlogs.data[0].tool_output[0])\nreturn output.toolOutput' } },
    { id: 'LEBKh7DqzxTogc17gpzS', name: 'xml-uniqueid-container', visibility: { value: 'return (i["toggle-recurringxml"] == true)' } },
    { id: 'LWWFEBOYHn8sNJFmkA3j', name: 'fileshring-bn-container', visibility: { value: 'return (v.chats.find(item => item.id == v.active_chat).livechat == true)\n' } },
    {
      id: 'LmL0tob6bywx92kmpx8O',
      name: 'toggle_customfields_override_label',
      attributes: {
        values: [
          { id: '41e6ea30-744d-4368-9349-cc4ac9d13af8', key: 'for', value: "return 'customfields_toggle_overridename_' + v.i" },
          { id: 'e3dec097-c4f7-44a3-9a88-3297cbc7ff1e', key: 'index', value: 'return v.i' }
        ]
      },
      events: [
        {
          id: 'bf847ba2-dbdc-45ca-9540-ac9cfecc10b8',
          type: 'click',
          preventDefault: true,
          actions: [
            {
              id: '8f37bfba-87d4-45d4-937b-25f3b110fae9',
              type: 'run-function',
              function:
                'const allCheckboxes = document.querySelectorAll(\'[w-el="toggle_customfields_override_checkbox"]\');\n\nconst currentIndex = parseInt(event.currentTarget.getAttribute(\'index\'), 10);\n\nallCheckboxes.forEach((checkbox, index) => {\n  // checkbox.checked = index === currentIndex;\n  i.toggle_customfields_override_checkbox[index] = index === currentIndex;\n  // console.log(checkbox.checked)\n});\n\nconst customfieldsArray = [];\n\n// update variable before deleting to prevent losing manually added data\ndocument.querySelectorAll("[w-el=custom-fields-lit-item]").forEach((item, index) => {\n  const key = i["custom-fields-list-item-input"][index];\n  const updateChatName = i.toggle_customfields_override_checkbox[index];\n  const updateEmail = i.toggle_customfields_override_emal[index];\n  console.log(`updatechatname ${index} = `, updateChatName);\n  console.log(`updateemailname ${index} = `, updateEmail);\n  console.log(`fieldname ${index} = `, key);\n  customfieldsArray.push({\n    key,\n    updateChatName,\n    updateEmail\n  });\n});\n\nv.chatbotCustomFields = customfieldsArray;'
            }
          ]
        }
      ]
    },
    {
      id: 'MlRiHlsAByIKMPCi8Btm',
      name: 'api-tooloutput-inutvariabescontainer',
      visibility: {
        value:
          'const toolOutput = r.get_outputlogs.data[0].tool_output[0];\nconst toolInput = JSON.parse(toolOutput).toolInput;\n\nconst keyValueArray = Object.entries(toolInput).map(([key, value]) => ({\n    property: key,\n    value: value\n}));\nreturn (keyValueArray.length > 0);'
      }
    },
    {
      id: 'MmIuMbbR3g8ISPih8lmO',
      name: 'file-upload-clear-btn',
      events: [
        {
          id: '051ab22a-2d2d-4eaf-957a-595ba06d44d0',
          type: 'click',
          actions: [
            {
              id: '075a309b-5483-41d2-a638-988be0c13b89',
              type: 'run-function',
              function: 'i["send-file-upload"] = {};\nconst form = document.querySelector("[w-el=\'form-send-file\']")\nform.reset();'
            }
          ]
        }
      ]
    },
    {
      id: 'NBI7uallFWQ05IYG6IQ7',
      name: 'toggle_customfields_override_emal',
      value: { value: 'return v.chatbotCustomFields[v.i].updateEmail' },
      attributes: {
        values: [
          { id: '5f518ac0-6eea-44c5-bae0-f7a83b8d6980', key: 'id', value: "return 'customfields_toggle_overrideemail_' + v.i" },
          { id: '52cac618-7905-4384-8594-32f435655229', key: 'name', value: "return 'customfields_toggle_overrideemail_' + v.i" }
        ]
      }
    },
    {
      id: 'NJWUJigh1H9BPLvKnofk',
      name: 'tagging-listitem-deletebtn',
      attributes: { values: [{ id: '55b4b214-61ce-469b-8f72-e3b417da3ef2', key: 'tag', value: 'if (v.chatTags.length > 0) {\n  return v.chatTags[v.i].tag\n}' }] },
      events: [
        {
          id: '2c314295-5991-4c5c-87dc-2b650e92c946',
          type: 'click',
          actions: [
            {
              id: '62a10726-6a77-49d8-a8c2-2543c86c403b',
              type: 'run-function',
              function:
                "const clickedTag = event.currentTarget.getAttribute('tag')\n\nconst oldTags = v.chatTags\nv.newChatTags = oldTags.filter(item => item.tag !== clickedTag);\n\nWized.requests.execute('update_chat_updatetags');\nawait Wized.requests.waitFor('update_chat_updatetags');"
            }
          ]
        }
      ]
    },
    {
      id: 'NK64RcuALBYVDBJIijec',
      name: 'outputlogs-api-list-item-property',
      text: {
        value:
          'const toolOutput = r.get_outputlogs.data[0].tool_output[0];\nconst toolInput = JSON.parse(toolOutput).toolInput;\n\nconst keyValueArray = Object.entries(toolInput).map(([key, value]) => ({\n    property: key,\n    value: value\n}));\nreturn keyValueArray[v.i].property'
      }
    },
    {
      id: 'NTgXw3A1FOnBNlTvm5Q2',
      name: 'xml-url',
      events: [
        {
          id: '820b0cd1-a013-47ca-a5f5-7ecd79a2f1bd',
          type: 'change',
          actions: [
            {
              id: '2a21786d-64ac-49d5-a537-5139d8c40a49',
              type: 'run-function',
              function: 'const feedUrl = i["xml-url"];\n\ni["xml-url"] = feedUrl.startsWith(\'https://\') ? feedUrl.slice(8) : feedUrl;\n'
            }
          ]
        }
      ]
    },
    {
      id: 'O8l67tL9p8EYBDxRMhkV',
      name: 'inbox-sidebar-chatname-inut',
      value: { value: 'return v.chats.find(chat => chat.id === v.active_chat).name' },
      events: [
        {
          id: '68cacd03-86dc-4d63-9903-1c4687b45697',
          type: 'focusin',
          actions: [
            {
              id: '5f9b64e2-71a9-4708-b2d2-b4ae320c73fb',
              type: 'run-function',
              function:
                'document.querySelector(\'[w-el="chat-name-edit"]\').style.display = "none"\ndocument.querySelector(\'[w-el="inbox-sidebar-chatnamename"]\').style.display = "none"\ndocument.querySelector(\'[w-el="inbox-sidebar-chatname-inut"]\').style.display = "flex"'
            }
          ]
        },
        {
          id: '9d77c3c4-4ac7-42fb-a48c-043f2217a55f',
          type: 'focusout',
          actions: [
            {
              id: '91c9a134-ca1f-461d-8f01-73e2bc22de31',
              type: 'run-function',
              function:
                'document.querySelector(\'[w-el="chat-name-edit"]\').style.display = "flex"\ndocument.querySelector(\'[w-el="inbox-sidebar-chatnamename"]\').style.display = "flex"\ndocument.querySelector(\'[w-el="inbox-sidebar-chatname-inut"]\').style.display = "none"'
            }
          ]
        }
      ]
    },
    {
      id: 'OSOc9o42iUbw2RydPloC',
      name: 'activityfeedlist-operator-avatar',
      attributes: {
        values: [
          {
            id: 'c8562466-01ad-4b5f-9ef7-400ed55db9d1',
            key: 'src',
            value: "if (v.mergedEvents[v.i].event_group === 'operator_changed') return (v.mergedEvents[v.i].message_type_data.operator_avatar_img)"
          },
          {
            id: '8fec4184-fea0-4bf1-93c0-874ef07757b3',
            key: 'srcset',
            value: "if (v.mergedEvents[v.i].event_group === 'operator_changed') return (v.mergedEvents[v.i].message_type_data.operator_avatar_img)"
          }
        ]
      }
    },
    {
      id: 'ObFQz0yk8A6mse3OfwjC',
      name: 'sidebar-customfields-listitem-input',
      value: {
        value:
          'const customFields = v.chats.find(chat => chat.id === v.active_chat).custom_fields;\n\nconst customFieldsArray = Object.entries(customFields).map(([key, value]) => ({\n  key: key,\n  value: value\n}));\n\nreturn customFieldsArray[v.i].value'
      }
    },
    { id: 'OhDkhAf2EcUMY1f6nyK0', name: 'listitem-maualtags-checkbox', visibility: { value: 'const tag = v.filteredTags[v.i].tag\n\nreturn v.chatTags.some(item => item.tag === tag)' } },
    {
      id: 'PlVZM0MAhnN3tI7Nyvbt',
      name: 'conversationstarters-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.chatbotConversationStarters' },
      events: [
        {
          id: '9f1f4983-d70a-4341-951e-c2e41789ed9f',
          type: 'mouseenter',
          actions: [
            {
              id: 'a31702a5-cb40-4171-b722-e30834c8e8ed',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"conversationstarters-delete-btn\"]');\n\ncloseButton.style.display = 'flex';\nsetTimeout(() => {\n  closeButton.style.opacity = '1';\ncloseButton.style.transform = 'translateY(0)';\n}, 1);\n"
            }
          ]
        },
        {
          id: 'c7b925c4-5b97-465b-a28e-60008304607b',
          type: 'mouseleave',
          actions: [
            {
              id: 'cfb75bae-32ad-4993-b95c-fe965df3cfce',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"conversationstarters-delete-btn\"]');\ncloseButton.style.transform = 'translateY(3px)';\ncloseButton.style.opacity = '0';\nsetTimeout(() => {\n  closeButton.style.display = 'none';\n}, 200);"
            }
          ]
        }
      ]
    },
    { id: 'R5vi4CFW0XQkQQp7qqo2', name: 'inbox-sidebar-chatnamename', text: { value: 'return i["inbox-sidebar-chatname-inut"];\n' } },
    { id: 'RXLYkY4Ex5ytbG7pUEas', name: 'emptystate-chats-customfieldslist', visibility: { value: 'return (v.chatbotCustomFields.length == 0)' } },
    {
      id: 'RhztwLyjpeeQzU4MMU4J',
      name: 'tool-output-logs-list-updated-time-container',
      visibility: {
        value:
          'const dataSource = r.get_datasources_organization.data.find(entry => entry.id === r.get_outputlogs.data[v.i].datasource_id);\n\nreturn dataSource && dataSource.last_updated ? true : false;\n'
      }
    },
    { id: 'S7YRJEZ8AlM358y1RUfj', name: 'emptystate-conversationstarters', visibility: { value: 'return (v.chatbotConversationStarters.length == 0)' } },
    { id: 'SFYjtzutWMYIOntA2TNN', name: 'conversationstarters-list-item-value', value: { value: 'return v.chatbotConversationStarters[v.i].answer' } },
    {
      id: 'SMq8g6D7UwOCcPixCrqW',
      name: 'subscription-overdue-modal2',
      visibility: { value: 'return (r.get_user_data.data[0].organizations[0].subscription_status == "overdue")' },
      styles: { values: [{ id: 'f1426406-0ad5-411f-9cae-ef175b985c9f', property: 'display', value: 'if (r.get_user_data.data[0].organizations[0].subscription_status == "overdue") return \'flex\'' }] }
    },
    {
      id: 'T4MDxOqgbOEUqizcgE3g',
      name: 'send-file-upload',
      events: [
        {
          id: 'ba660d62-d109-41c9-bf18-c035ceb51c67',
          type: 'change',
          actions: [
            {
              id: 'e107e521-33ad-4b4f-a204-911a4e0eeeed',
              type: 'run-function',
              function:
                "if (i[\"send-file-upload\"][\"0\"].type.includes('image')) {\n\n  const config = {\n    maxSizeMB: 0.1,\n    maxWidthOrHeight: 520,\n    debug: true\n  };\n\n  function getCompressedImage(file) {\n    return BrowserImageResizer.readAndCompressImage(file, config)\n      .then(compressedImage => {\n        console.log('âœ… Compressed Image:', compressedImage);\n\n        const sanitizedFileName = i['send-file-upload']['0'].name.replace(/[^a-z0-9_\\-\\.]/gi, '_');\n        const fileName = `${sanitizedFileName.split('.').slice(0, -1).join('.')}-preview.${sanitizedFileName.split('.').pop()}`;\n        const compressedFile = new File([compressedImage], fileName, { type: file.type });\n        const dataTransfer = new DataTransfer();\n        dataTransfer.items.add(compressedFile);\n\n        return dataTransfer.files[0];\n      })\n      .catch(error => {\n        console.error('Error during image compression:', error);\n        return null;\n      });\n  }\n\n  const file = i['send-file-upload']['0'];\n\n  let fileResult;\n\n\n  fileResult = await getCompressedImage(file);\n  await Promise.all([fileResult]);\n\n  console.log('âœ… Resolved File:', fileResult);\n\n  v.compressedImageInbox = fileResult;\n  console.log('variable = ', v.compressedImageInbox);\n\n}"
            }
          ]
        }
      ]
    },
    { id: 'TRic2PxiuzlW6loLo02w', name: 'btn-icon-xml', visibility: { value: 'return (!r.validate_xml.isRequesting)' } },
    { id: 'USrdJnJaeedsBe0lWBth', name: 'activityfeedlist-list-item', list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.mergedEvents' } },
    {
      id: 'UUN2I38FQf2hZENdk8SR',
      name: 'open-manualtags-btn',
      events: [
        {
          id: 'fe7e31f9-66ab-4ab5-ac7b-07e2e3195148',
          type: 'click',
          actions: [
            {
              id: 'db487172-ea3c-48dd-9bf5-8d23200b9b72',
              type: 'run-function',
              function: 'const input = document.querySelector(\'[w-el="manualtags-input"]\');\nsetTimeout(() => {\n  input.focus();\n  input.select();\n}, 100);\n'
            }
          ]
        }
      ]
    },
    {
      id: 'UWrd8inhewOGUfjtgpY8',
      name: 'custom-fields-lit-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.chatbotCustomFields' },
      attributes: {
        values: [
          { id: 'b4745a23-0820-41d7-8f3c-ddeaf972ecbd', key: 'index', value: 'return v.i' },
          { id: 'e85d0b37-23c7-4f8b-ba4a-2b79122cc5bb', key: 'field-name', value: 'return v.chatbotCustomFields[v.i].key' }
        ]
      },
      events: [
        {
          id: 'd4e71621-2265-482a-8828-ff321498eec8',
          type: 'mouseenter',
          actions: [
            {
              id: '0f0f163e-3750-490e-a6b8-714090daadbb',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"customf-delete-btnelds\"]');\n\ncloseButton.style.display = 'flex';\nsetTimeout(() => {\n  closeButton.style.opacity = '1';\n  closeButton.style.transform = 'translateY(0)';\n}, 1);"
            }
          ]
        },
        {
          id: '8091ec46-b251-4d46-a961-e1a98d056e5f',
          type: 'mouseleave',
          actions: [
            {
              id: 'beeff8e7-de51-42c1-8bcf-cd8bea3c1d88',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"customf-delete-btnelds\"]');\ncloseButton.style.transform = 'translateY(3px)';\ncloseButton.style.opacity = '0';\nsetTimeout(() => {\n  closeButton.style.display = 'none';\n}, 200);"
            }
          ]
        }
      ]
    },
    { id: 'UxUhhntYxmMDKF9e5WaG', name: 'tagging-listitem-settings' },
    {
      id: 'V7bUThs2iCgsWIJ5zmH2',
      name: 'xml-amount-container',
      visibility: { value: 'return !!(r.get_datasources.data.find((item) => item.id === v.active_datasource).results.total_items_in_database);' }
    },
    {
      id: 'X4CA5G5PKF4VyungDbrC',
      name: 'tool-output-logs-list-updated-time',
      text: {
        value:
          'const dataSource = r.get_datasources_organization.data.find(entry => entry.id === r.get_outputlogs.data[v.i].datasource_id);\nconst date = new Date(dataSource.last_updated);\nconst formattedDate = `${date.getDate()}-${date.getMonth() + 1}`;\nreturn formattedDate;\n'
      }
    },
    {
      id: 'X8wJlcC5lPQXCgKLv3rm',
      name: 'sidebar-customfields-listitem-fieldname',
      text: {
        value:
          'const customFields = v.chats.find(chat => chat.id === v.active_chat).custom_fields;\n\nconst customFieldsArray = Object.entries(customFields).map(([key, value]) => ({\n  key: key,\n  value: value\n}));\n\nreturn customFieldsArray[v.i].key'
      }
    },
    { id: 'XVd0BAKMxWlklfQvelTi', name: 'custom-fields-list-item-input', value: { value: 'return v.chatbotCustomFields[v.i].key' } },
    { id: 'YB07ozvNYfCDAfs1dOE2', name: 'auth-form-button' },
    { id: 'Ym4hVxW3RC4N4wuAP3fM', name: 'emptystate-tagging', visibility: { value: 'return (v.chatbotTags.length == 0)' } },
    {
      id: 'Yr4ve38nSCEGMFSMyQNB',
      name: 'debug-list-item-input',
      value: {
        value:
          'const array = [\n  { "tag": "retourneren", "description": "voor alle vragen over het retourneren van producten" },\n  { "tag": "productvraag", "description": "Voor alle vragen over specifieke producten" },\n  { "tag": "klacht", "description": "wijs deze tag toe aan gesprekken van bezoekers die klachten hebben" },\n  { "tag": "betaling", "description": "voor vragen over betalingen en facturen" },\n  { "tag": "verzending", "description": "voor vragen over de status van verzendingen" },\n  { "tag": "account", "description": "voor hulp bij inloggen of accountproblemen" },\n  { "tag": "korting", "description": "voor vragen over kortingscodes en aanbiedingen" }\n]\n\nreturn array[v.i].description'
      }
    },
    {
      id: 'a0278e9f-046b-4ed2-b535-8ee62f358f17',
      name: 'form-delete-chat',
      events: [
        {
          id: 'e440509a-8bd2-4b65-a26d-07356967e2b0',
          type: 'submit',
          actions: [
            {
              id: '325909b2-928d-4d03-b205-c146f7b24a79',
              type: 'run-function',
              function:
                'window.Wized = window.Wized || [];\n\nWized.requests.execute("delete_chat");\n\ndocument.querySelectorAll("[popupmodal]").forEach((item) => {\n  item.style.display = "none";\n});\n\nawait Wized.requests.waitFor("delete_chat");\n\n// remove chat from array\nlet index = v.chats.findIndex((chat) => chat.id === v.active_chat);\n\nif (index !== -1) {\n  let newActiveChatIndex;\n  if (index === v.chats.length - 1) {\n    newActiveChatIndex = v.chats.length > 2 ? index - 1 : null;\n  } else {\n    newActiveChatIndex = index;\n  }\n\n  ["loadmorechats", "newchats", "rawchats"].forEach((chatArrayName) => {\n    let chatArray = v[chatArrayName];\n    let indexInChatArray = chatArray.findIndex(\n      (chat) => chat.id === v.active_chat\n    );\n    if (indexInChatArray !== -1) {\n      chatArray.splice(indexInChatArray, 1);\n      // console.log("chat removed from", chatArrayName);\n    }\n  });\n\n  // Set the new active chat before splicing\n  v.active_chat = v.chats[newActiveChatIndex].id;\n  // console.log("new chat", v.chats[newActiveChatIndex].id);\n} else {\n  console.error("No chat found for chat with chat_id:", payload.new.chat_id);\n}\n'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: 'a044f63d-b543-4d55-b53e-cd29352734b8',
      name: 'datasource-sharing-list-item-initials',
      text: { value: '// return v.chatbots[v.i].name\nreturn r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).name.charAt(0)\n' }
    },
    { id: 'a05bdc26-f3e5-4f3d-8b3d-1dee17d7eed2', name: 'organization-email', text: { value: 'return r.get_user_data.data[0].organizations[0].email_address' } },
    {
      id: 'a2d24570-c8c2-44e9-9f21-973cbbdc4429',
      name: 'agents-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return r.get_agents.data' },
      classes: { values: [{ id: '2c36a4ad-9283-4019-bc2d-a32eefcc34d9', class: 'visible', condition: 'return true' }] },
      attributes: { values: [{ id: 'ae352bbe-2ef9-4477-ae46-34fbd46bbf2a', key: 'id', value: 'return r.get_agents.data[v.i].id' }] }
    },
    {
      id: 'a3a4011a-00ce-445a-bc4b-90e9a416b7b0',
      name: 'datasource-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return r.get_datasources.data' },
      classes: {
        values: [
          { id: '4d1e4db0-e2a2-48ff-8ba5-d755212f6136', class: 'visible', condition: 'return true' },
          {
            id: 'c1dfa1b2-1ef2-420c-b510-ae8c9b8db06a',
            class: 'selected',
            condition: 'if (r.get_datasources.data[v.i].id == v.active_datasource && n.path.includes("/kennis/databronnen") ) {\n  return true\n} else {\n  return false\n}'
          }
        ]
      },
      styles: {
        values: [
          {
            id: '4a2e4100-deb0-4a50-bdbd-32bdef8f54ae',
            property: 'background-color',
            value:
              "if (r.get_datasources.data[v.i].id == v.active_datasource && n.path.includes(\"/kennis/databronnen\") ) {\n  return '#F7F7FF'\n  // return '#fff'\n} else {\n  return 'transparent'\n}"
          },
          {
            id: '3226299b-4c87-42a0-b4a7-12ae6b295efb',
            property: 'outline',
            value: "if (r.get_datasources.data[v.i].id == v.active_datasource && n.path.includes(\"/kennis/databronnen\") ) {\n  return '2px solid #F3F3FF'\n} else {\n  return 'none'\n}"
          }
        ]
      },
      attributes: {
        values: [
          { id: '68d82860-9711-418a-aa50-7374de2fda41', key: 'datasource_id', value: 'return r.get_datasources.data[v.i].id' },
          { id: 'e2740840-8876-4741-a3bd-66aa024d8c68', key: 'data_type', value: 'return r.get_datasources.data[v.i].data_type' }
        ]
      },
      events: [
        {
          id: '4c5b01a3-3f00-4759-95a3-369dde8ab85c',
          type: 'click',
          actions: [
            {
              id: '4fef5237-4f14-4b32-8b8b-369b96f1a99a',
              type: 'run-function',
              function:
                'v.dataSourceUpdatedStatus = null;\n\nconst dataValue = event.currentTarget.getAttribute("datasource_id");\n\nWized.data.v.active_datasource = dataValue;\n\nWized.requests.execute("get_datasource");\n\n// Element visibility\nconst editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\nconst pdfForm = document.querySelector("[w-el=\'form-container-edit-pdf\']");\nconst csvForm = document.querySelector("[w-el=\'form-container-edit-csv\']");\nconst urlForm = document.querySelector("[w-el=\'form-container-edit-url\']");\nconst apiForm = document.querySelector("[w-el=\'form-container-edit-api\']");\nconst pdf2Form = document.querySelector("[w-el=\'form-container-edit-pdf2\']");\nconst xmlForm = document.querySelector("[w-el=\'form-container-edit-xml\']");\n\neditDatasourcesForms.forEach((form) => {\n    form.style.display = "none";\n});\n\nconst activeType = r.get_datasources.data.find(item => item.id === v.active_datasource).data_type;\n\nif (activeType === "pdf") {\n    pdfForm.style.display = "flex";\n} else if (activeType === "csv") {\n    csvForm.style.display = "flex";\n} else if (activeType === \'pdf2\') {\n    pdf2Form.style.display = \'flex\';\n} else if (activeType === \'xml\') {\n    xmlForm.style.display = \'flex\'\n} else if (activeType === "url") {\n    Wized.requests.execute(\'get_scrape_pages\');\n    const checkboxes = document.querySelectorAll(\'input[w-el="scrape-list-checkbox"], input[w-el="scrape-list-checkbox-wildcard"]\');\n    checkboxes.forEach(checkbox => {\n        checkbox.checked = false;\n    });\n    document.querySelector(\'[w-el="scrape-addurl-controls"]\').style.display = \'flex\';\n    lastChecked = null;\n    await Wized.requests.waitFor("get_scrape_pages");\n    if (r.get_datasources.data.find(item => item.id === v.active_datasource).data_type == "url") {\n        urlForm.style.display = \'flex\';\n    }\n} else if (activeType === "api") {\n    apiForm.style.display = "flex";\n    \n    var activedataSource = r.get_datasources.data.find((item) => item.id === v.active_datasource);\n    v.apiHeadersArray = activedataSource.datasource_type_config.headers;\n    v.apiPropertiesArrayII = activedataSource.datasource_type_config.properties;\n\n    // multi-select boxes\n\n    // datasource_type_config.method\n    const checkboxesApi = document.querySelectorAll("[multi-select=\'api_method\']");\n    var hiddenInputMethod = document.querySelector("[multi-select-input=\'api_method\']");\n\n    var dbValue = r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.method;\n\n    checkboxesApi.forEach(function (checkbox) {\n        if (checkbox.getAttribute("data-value") === dbValue) {\n            checkbox.classList.add("selected");\n        }\n        hiddenInputMethod.value = dbValue;\n        $(\'[w-el="api-form-active-method"]\').text(dbValue);\n    });\n\n    checkboxesApi.forEach(function (checkbox) {\n        checkbox.addEventListener("click", function () {\n            checkboxesApi.forEach(function (option) {\n                option.classList.remove("selected");\n            });\n            checkbox.classList.add("selected");\n\n            var newValueCheckboxMethod = checkbox.getAttribute("data-value");\n            hiddenInputMethod.value = newValueCheckboxMethod;\n            $(\'[w-el="api-form-active-method"]\').text(newValueCheckboxMethod);\n        });\n    });\n\n    //\n\n    // datasource_type_config.protocol\n    const checkboxesProtocol = document.querySelectorAll(\'[multi-select="api_authprotocol"]\');\n    var hiddenInputProtocol = document.querySelector(\'[multi-select-input="api_authprotocol"]\');\n\n    var dbValue = r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.protocol;\n\n    checkboxesProtocol.forEach(function (checkbox) {\n        if (checkbox.getAttribute("data-value") === dbValue) {\n            checkbox.classList.add("selected");\n        }\n        hiddenInputProtocol.value = dbValue;\n        i["input-api_authprotocol"] = dbValue;\n        $(\'[w-el="api-form-active-authprotocol"]\').text(dbValue);\n    });\n\n    checkboxesProtocol.forEach(function (checkbox) {\n        checkbox.addEventListener("click", function () {\n            checkboxesProtocol.forEach(function (option) {\n                option.classList.remove("selected");\n            });\n            checkbox.classList.add("selected");\n\n            var newValueProtocol = checkbox.getAttribute("data-value");\n            hiddenInputProtocol.value = newValueProtocol;\n            i["input-api_authprotocol"] = newValueProtocol;\n            $(\'[w-el="api-form-active-authprotocol"]\').text(newValueProtocol);\n        });\n    });\n\n    //\n\n    // datasource_type_config.bodyType\n    const checkboxesBodytype = document.querySelectorAll("[multi-select=\'api_body_type\']");\n    var hiddenInputBodytype = document.querySelector("[multi-select-input=\'api_body_type\']");\n\n    var dbValue = r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.bodyType;\n\n    checkboxesBodytype.forEach(function (checkbox) {\n        if (checkbox.getAttribute("data-value") === dbValue) {\n            checkbox.classList.add("selected");\n        }\n        hiddenInputBodytype.value = dbValue;\n        i["input-api_body_type"] = dbValue;\n        $(\'[w-el="api-form-active-bodytype"]\').text(dbValue);\n    });\n\n    checkboxesBodytype.forEach(function (checkbox) {\n        checkbox.addEventListener("click", function () {\n            checkboxesBodytype.forEach(function (option) {\n                option.classList.remove("selected");\n            });\n            checkbox.classList.add("selected");\n\n            var newValueBodyType = checkbox.getAttribute("data-value");\n            hiddenInputBodytype.value = newValueBodyType;\n            i["input-api_body_type"] = newValueBodyType;\n            $(\'[w-el="api-form-active-bodytype"]\').text(newValueBodyType);  \n        });\n    });\n\n    // text-editor\n    // outputScheme code-editor\n\n    let textarea = document.getElementById("code-editor");\n    let codeMirrorInstance;\n    let validModal = document.querySelector("[w-el=\'modal-valid-json\']");\n    let invalidModal = document.querySelector("[w-el=\'modal-invalid-json\']");\n\n    function isValidJsonObject(value) {\n        try {\n            const parsed = JSON.parse(value);\n            return (\n            !!parsed && typeof parsed === "object" && !Array.isArray(parsed)\n            );\n        } catch (e) {\n            return false;\n        }\n    }\n\n    function objectIsValid() {\n        validModal.style.display = "flex";\n        invalidModal.style.display = "none";\n        v.outputSchemaObjectIsValid = true;\n    }\n\n    function objectIsInvalid() {\n        validModal.style.display = "none";\n        invalidModal.style.display = "flex";\n        v.outputSchemaObjectIsValid = false;\n    }\n\n    function programmaticallySetValue(value, textarea, codeMirrorInstance) {\n    if (v.codemirrorInitialized == false) {\n        codeMirrorInstance = CodeMirror.fromTextArea(textarea, {\n        mode: "application/json",\n        theme: "dracula",\n        lineNumbers: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        indentUnit: 2,\n        tabSize: 2,\n        gutters: ["CodeMirror-lint-markers"],\n        lint: {\n            lintOnChange: true,\n            tooltips: false\n        }\n        });\n\n        // input event listener\n        codeMirrorInstance.on("change", function (cm, change) {\n        inputEventValue = cm.getValue();\n        // console.log("Content changed:", cm.getValue());\n        if (isValidJsonObject(inputEventValue)) {\n            objectIsValid();\n        } else {\n            objectIsInvalid();\n        }\n\n    });\n    }\n\n    textarea.value = value;\n    if (v.codemirrorInitialized == false) {\n        codeMirrorInstance.setValue(value);\n        if (isValidJsonObject(value)) {\n            objectIsValid();\n        } else {\n            objectIsInvalid();\n        }\n    }\n    v.codemirrorInitialized = true;\n    }\n\n    const activeDatasource = r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config;\n    const rawValue = activeDatasource.outputSchema;\n    const value = JSON.parse(rawValue);\n    // console.log(value);\n\n    if (activeDatasource.outputformatting_enabled == true) {\n        programmaticallySetValue(value, textarea, codeMirrorInstance);\n    }\n}\n\nconst scrollBox = document.querySelector("[content-scrollbox]");\nif (scrollBox) {\n    scrollBox.scrollTop = 0;\n}\n\nWized.requests.execute("get_chatbots_datasources_joins");',
              hasCondition: true,
              condition: 'return (n.path.includes("/kennis/databronnen"))'
            },
            {
              id: 'dea60555-5ef5-44a5-9fd3-0902cba44aa1',
              type: 'run-function',
              function:
                'const dataValue = event.currentTarget.getAttribute("datasource_id");\nconst dataType = event.currentTarget.getAttribute("data_type");\n\nWized.data.v.active_datasource = dataValue;\nWized.data.v.active_datasource_type = dataType;\n\nn.path = \'/kennis/databronnen/\';',
              hasCondition: true,
              condition: 'return (!n.path.includes("/kennis/databronnen"))'
            }
          ]
        }
      ]
    },
    {
      id: 'a4d98bb5-ae39-47f3-b557-e1c72a49ee84',
      name: 'datasource-list-item-img-src',
      attributes: {
        values: [
          {
            id: '256a88f7-aa6b-4a6d-a953-ab657e8a8a71',
            key: 'src',
            value:
              "if (r.get_datasources.data[v.i].data_type == 'kb') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc1cd277ec15f33fdc7b3_file-info-alt.svg'\n} else if (r.get_datasources.data[v.i].data_type == 'csv') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc226b395d689963bd587_database.svg'\n} else if (r.get_datasources.data[v.i].data_type === 'pdf' || r.get_datasources.data[v.i].data_type === 'pdf2') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/67239dd4e768c478e10fb6b4_file%20(1).svg'\n} else if (r.get_datasources.data[v.i].data_type == 'url') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7e4473d4ee68c12db_link-h.svg'\n} else if (r.get_datasources.data[v.i].data_type == 'api') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7ac7247ea9e3f5e3f_code-branch.svg'\n} else if (r.get_datasources.data[v.i].data_type == 'xml') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/674ffdb4a11fe59e8f7655db_Untitled%20design%20-%202024-12-04T075853.568.png'\n}"
          }
        ]
      }
    },
    {
      id: 'a5b8cfd4-fb8e-48d3-a700-b452f7eea7dd',
      name: 'avatar-delete',
      events: [
        {
          id: 'defb9131-44c7-4aef-9fde-8c0c81878e08',
          type: 'click',
          actions: [
            {
              id: 'c53a9acb-49af-4e40-be3c-6e8149eb261e',
              type: 'run-function',
              function: 'i["settigs-avatar-input"] = "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"'
            }
          ],
          hasCondition: false
        }
      ]
    },
    { id: 'a7a67f2d-3990-4b38-b090-02116e66adf3', name: 'chatbots-dropdown-list-item-initials', text: { value: 'return r.get_chatbots.data[v.i].name.charAt(0);' } },
    { id: 'aabb3668-f290-4045-b563-a81eed17e2d1', name: 'emptystate-api-list-properties', visibility: { value: 'return (v.apiPropertiesArrayII.length == 0)' } },
    { id: 'abacbbbc-b1ce-406b-9cc6-56f04aa206bb', name: 'filter-chatbots-name', text: { value: 'return r.get_chatbots.data[v.i].name' } },
    {
      id: 'aca74eac-d5b6-4d15-8265-e286736d0f4d',
      name: 'form-create-chatbot',
      events: [
        {
          id: '3debb08b-1b23-462c-8747-643466ba5718',
          type: 'submit',
          actions: [
            {
              id: '7b3acc92-cb41-4c49-8f63-79f1f0c09730',
              type: 'run-function',
              function:
                "Wized.requests.execute('create_chatbot');\n\n// element visibility\nconst createChatbotModal = document.getElementById('popup-create-chatbot');\n\nawait Wized.requests.waitFor('create_chatbot');\nWized.requests.execute('get_chatbots');\n\n// data logic\n\nv.active_chatbot = r.create_chatbot.data.id\n\nif (n.path !== \"/chatbot\") {\n  n.path = \"/chatbot?tn=cc\"\n} else {\n  createChatbotModal.style.display = \"none\";\n  var form = document.querySelector(\"[w-el='form-create-chatbot']\"); // Replace 'myForm' with your form's ID\n  var inputs = form.querySelectorAll('input');\n  inputs.forEach(function(input) {\n  input.value = '';\n});\n}\n",
              hasCondition: true,
              condition:
                'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nif (maxChatbots !== null) {\n  if (chatbots.length < maxChatbots) {\n    return true\n  } else {\n    return false\n  }\n} else {\n  if (organization.subscription_plan && organization.subscription_plan.includes("expert")) {\n    if (chatbots.length < 3) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    if (chatbots.length < 1) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n}'
            },
            {
              id: '8322feea-2fe3-4e2e-8f35-1b55aad5dd6e',
              type: 'run-function',
              function:
                'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nif (maxChatbots !== null) {\n  if (chatbots.length < maxChatbots) {\n  } else {\n    document.querySelector(\'[w-el="popup-create-chatbot"]\').style.display = "none";\n    window.showToastNotification(`Bij je huidige pakket zijn maximaal ${maxChatbots} chatbots inbegrepen`, "warning");\n  }\n} else {\n  if (organization.subscription_plan && organization.subscription_plan.includes("expert")) {\n    if (chatbots.length < 3) {\n    } else {\n      document.querySelector(\'[w-el="popup-create-chatbot"]\').style.display = "none";\n      window.showToastNotification("Bij je huidige pakket zijn maximaal 3 chatbots inbegrepen", "warning");\n    }\n  } else {\n    if (chatbots.length < 1) {\n    } else {\n      document.querySelector(\'[w-el="popup-create-chatbot"]\').style.display = "none";\n      window.showToastNotification("Bij je huidige pakket is maximaal 1 chatbot inbegrepen", "warning");\n    }\n  }\n}',
              hasCondition: true,
              condition:
                'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nif (maxChatbots !== null) {\n  if (chatbots.length < maxChatbots) {\n    return false\n  } else {\n    return true\n  }\n} else {\n  if (organization.subscription_plan && organization.subscription_plan.includes("expert")) {\n    if (chatbots.length < 3) {\n      return false;\n    } else {\n      return true;\n    }\n  } else {\n    if (chatbots.length < 1) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n}'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: 'ad6fb578-62ff-462a-9116-5e8c688fb937', name: 'user-cloak', visibility: { value: 'return (r.get_user_data.ok)' } },
    {
      id: 'af13c85e-f4ed-40c5-9716-856a504de1b3',
      name: 'datasource-sharing-notice',
      styles: {
        values: [{ id: '24b899a2-c7f6-4154-b9f6-2747ae1e3728', property: 'display', value: 'if (v.datasourceSharingChatbotsDropdown.length == 0) {\n return "flex"\n} else {\n  return "none"\n}' }]
      }
    },
    {
      id: 'b03a23c4-5d38-422b-81cf-f0b9b5a69cf0',
      name: 'api-tool-emailvalidation-visibility',
      styles: { values: [{ id: 'a3c74666-8fe3-4c86-8c48-11802b051ee2', property: 'display', value: 'if (i["input-email_validation"] == true) {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: 'b0bb8054-7c3f-447e-900a-2f5d4cc1e8e1',
      name: 'doument-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.filteredKbList;' },
      classes: { values: [{ id: '31ff1700-c8ad-4ab7-896e-273f1d8d5ba2', class: 'visible', condition: 'return true' }] },
      attributes: { values: [{ id: 'ad82f6f8-93ce-4c7c-b5ad-c12a98bae9e5', key: 'id', value: 'return v.filteredKbList[v.i].id' }] },
      events: [
        {
          id: '016e6050-ff3f-4a0e-ace1-58ad9fcba6bb',
          type: 'click',
          actions: [
            {
              id: 'a929ad38-30db-44f4-9fb0-104249e20dd1',
              type: 'run-function',
              function:
                '    // data logic\n\n    const dataValue = event.currentTarget.getAttribute("id");\n\n    v.active_kb_topic = dataValue; \n    Wized.requests.execute("get_kb_topic");\n\n    // Element visibility\n\n    // const dataSourcesContainer = document.querySelector("[w-el=\'edit-datasources-container\']");\n    const editTopicContainer = document.querySelector("[w-el=\'edit-topic-container\']");\n\n    editTopicContainer.style.transform = \'translateX(20px)\';\n\t\teditTopicContainer.style.opacity = 0;\n\t\teditTopicContainer.style.display = \'flex\';\n    setTimeout(() => {\n      editTopicContainer.style.transform = \'translateX(0)\';\n      editTopicContainer.style.opacity = 1;\n    }, 50);\n\n    const scrollBox = document.querySelector("[content-scrollbox]");\n    if (scrollBox) {\n      scrollBox.scrollTop = 0;\n    }'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: 'b0fe29e3-a9b5-4bda-92b5-e0c2c3629255', name: 'empty-state-filtering', visibility: { value: 'return (v.chats.length == 0 && v.usedFilters == true)' } },
    {
      id: 'b1063889-b1a0-4da8-aad5-1b81869902f2',
      name: 'settings-avatar-imagepreview',
      attributes: {
        values: [
          {
            id: '7525bde9-84a2-4ac5-a1fa-fc6a4bdee39a',
            key: 'src',
            value:
              'if (i["settigs-avatar-input"]["0"]) {\n\n    if (i["settigs-avatar-input"] == \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\') {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\n    } else {\n        return URL.createObjectURL(i["settigs-avatar-input"]["0"]);\n        // return i["settigs-avatar-input"]\n    }\n    \n} else {\n    if (r.get_chatbot.ok == true) {\n\n        if (r.get_chatbot.data.avatar_url !== null) {\n            return r.get_chatbot.data.avatar_url;\n        } else {\n            return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n        }    \n\n    } else {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n    }\n}'
          }
        ]
      }
    },
    {
      id: 'b19ee558-1851-4a28-99e8-e3429ac46b29',
      name: 'active-chatbot-avatar',
      attributes: { values: [{ id: '1d81fcaa-116e-4f10-80c1-a75a722049df', key: 'src', value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).avatar_url\n' }] }
    },
    { id: 'b31a2a21-3a54-4d6d-b46e-2113c70a1f43', name: 'document-list-item-topic', text: { value: 'return v.filteredKbList[v.i].content' } },
    {
      id: 'b3c95b21-860a-4584-8b6f-02de9a1bb5d1',
      name: 'filter-status',
      events: [
        {
          id: '27af7e58-8a16-4820-b9c5-6601a6e5dc6f',
          type: 'click',
          actions: [
            {
              id: '9ef49889-706b-4b15-ad81-bddac98e64c0',
              type: 'run-function',
              function:
                'const targetValue = event.currentTarget.getAttribute("filter-value");\n\nv.inboxFilterStatus = targetValue;\n\ndocument.querySelectorAll(\'[w-el="filter-status"]\').forEach((element) => {\n  element.classList.remove("active");\n});\n\nevent.currentTarget.classList.add("active");\n'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: 'b5384f07-a21d-46b4-b12d-e4ac2c25d292',
      name: 'create-btn-api-headers',
      events: [
        {
          id: '987750e3-310a-48ee-bd5a-e22960e0202a',
          type: 'click',
          actions: [
            {
              id: '7d729b78-5ad4-416b-8f7e-90eaff50eac3',
              type: 'run-function',
              function:
                'const nextIndexProperty = v.apiHeadersArray.length;\nconst emptyObjectProperty = { "index": nextIndexProperty, "key": "", "value": "" };\n\nconst newArray = v.apiHeadersArray.concat([emptyObjectProperty]);\n\nv.apiHeadersArray = newArray;\n\n\n'
            }
          ],
          hasCondition: false
        }
      ]
    },
    { id: 'b7acb3a6-dada-45e7-84dd-1bfd05c99ee2', name: 'active-chat-inbox-name', text: { value: 'return v.chats.find((chat) => chat.id === v.active_chat).name' } },
    {
      id: 'b87e109f-32a0-40b3-ba32-c6ce4012ccc5',
      name: 'scrape-list-status-text',
      text: {
        value:
          'const scrapeStatus = v.scrapetool_urls_list_filtered[v.i].status;\n\nif (scrapeStatus == "completed") {\n  return "Voltooid"\n} else if (scrapeStatus == "queued") {\n  return "Wachtrij"\n} else if (scrapeStatus == "failed") {\n  return "Fout"\n} else if (scrapeStatus == "not-found") {\n  return "Niet gevonden"\n}\n'
      },
      styles: {
        values: [
          {
            id: 'e6938b06-e558-4ef1-8ffd-545b9fd27ab8',
            property: 'color',
            value:
              'const scrapeStatus = v.scrapetool_urls_list_filtered[v.i].status;\n\nif (scrapeStatus == "completed") {\n  return "#00b343"\n} else if (scrapeStatus == "queued") {\n  return "#4285F4"\n} else if (scrapeStatus == "failed") {\n  return "#F37A80"\n} else if (scrapeStatus == "not-found") {\n  return "#e7b549"\n}\n'
          }
        ]
      }
    },
    {
      id: 'b88af88f-3792-4f7b-a070-c0e069850349',
      name: 'scrape-pagination-itemsperpage',
      events: [
        {
          id: '9ba4e79d-920d-4cef-8193-cb0ead119ef3',
          type: 'click',
          actions: [
            {
              id: '62023c54-6221-4303-b674-e91c3f6cf62a',
              type: 'run-function',
              function:
                'console.log("x")\nconst selectedValue = event.currentTarget.getAttribute("data-value");\nconsole.log("x", selectedValue)\ni["scrape-pagination-itemsperpage"] = selectedValue\n\n\nconst visibleTextElement = document.querySelector(\'[w-el="scrape-pagination-text"]\');\nif (visibleTextElement) {\n  visibleTextElement.innerText = selectedValue + " weergeven";\n}'
            }
          ],
          hasCondition: false
        }
      ]
    },
    { id: 'b89b4ff3-8438-4630-8900-f2734d000fcd', name: 'datasource-list-name-shared', text: { value: 'return v.datasourceSharingNavbarList[v.i].name\n' } },
    {
      id: 'b8c1e915-bf99-4f89-b5a7-9c853fc67c2f',
      name: 'form-create-datasource-api',
      events: [
        {
          id: '6e8b4656-c241-4a99-b015-b6e87cf5e8f8',
          type: 'submit',
          actions: [
            {
              id: '3b80c8a2-899e-4d44-bd69-2fb37bc5fa66',
              type: 'run-function',
              function:
                'Wized.requests.execute("create_api");\n\n// hide create chatbot modal\nconst modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\nmodal.style.display = "none";\n\n// reset create forms\nconst allForms = document.querySelectorAll(".datasources-formblock");\n\n// const formWrapperInitial = document.getElementById("create-datasource-form");\nconst formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n\nallForms.forEach((form) => {\n  form.style.display = "none";\n});\nformWrapperInitial.style.display = "flex";\n\ndataSourceSelectValue.value = null;\n\ndocument.querySelectorAll(".select-box").forEach((box) => {\n  box.classList.remove("selected");\n});\n\n////\n\nwindow.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  // Deprecaten - .find() method gebruiken\n  Wized.data.v.active_datasource_type = "api";\n\n  // Element visibility\n  const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n  const editForm = document.querySelector("[w-el=\'form-container-edit-api\']");\n  editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n  await Wized.requests.waitFor(\'create_api\');\n\n  Wized.requests.execute("get_datasources");\n  Wized.data.v.active_datasource = r.create_api.data.id;\n\n  await Wized.requests.waitFor("get_datasources");\n  // update container visibility\n  editForm.style.display = "flex";\n\n\n  // reset create forms - al gedaan bovenin?\n  // const allForms = document.querySelectorAll(".datasources-formblock");\n  // const formWrapperInitial = document.getElementById("create-datasource-form");\n  // allForms.style.display = "none";\n  // formWrapperInitial.style.display = "flex";\n});\n',
              hasCondition: true,
              condition: "return (n.path.includes ('/kennis/databronnen'))"
            },
            {
              id: '8cba3989-741b-43c9-ba4b-7421fd8e2b8f',
              type: 'run-function',
              function: "Wized.requests.execute(\"create_api\");\nawait Wized.requests.waitFor('create_api');\n\nv.active_datasource = r.create_api.data.id;\n\nn.path = '/kennis/databronnen?tn=cd'",
              hasCondition: true,
              condition: "return (n.path.includes ('/kennis/prompt') || n.path.includes ('/admin-create-datasource'))"
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: 'b990d44c-2e70-49ab-ae54-a8ce5dd89bd5',
      name: 'settings-background-imagepreview',
      attributes: {
        values: [
          {
            id: 'af446efe-2887-432c-8d30-960fc57eaf00',
            key: 'src',
            value:
              'if (i["settigs-background-input"]["0"]) {\n\n    if (!i["settigs-background-input"]) {\n        return null\n    } else {\n        return URL.createObjectURL(i["settigs-background-input"]["0"]);\n        // return i["settigs-background-input"]\n    }\n    \n} else {\n    if (r.get_chatbot.ok == true) {\n\n        if (r.get_chatbot.data.background_image !== null) {\n            return r.get_chatbot.data.background_image;\n        } else {\n            return null;\n        }    \n\n    } else {\n        return null;\n    }\n}'
          }
        ]
      },
      visibility: {
        value:
          'if (i["settigs-background-input"]["0"]) {\n\n    if (!i["settigs-background-input"]) {\n        return false\n    } else {\n        return true\n        // return i["settigs-background-input"]\n    }\n    \n} else {\n    if (r.get_chatbot.ok == true) {\n\n        if (r.get_chatbot.data.background_image !== null) {\n            return true;\n        } else {\n            return false;\n        }    \n\n    } else {\n        return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png";\n    }\n}'
      }
    },
    {
      id: 'bJjzENC6XKrrA4GWRTZK',
      name: 'activityfeedlist-eventgroupname',
      text: {
        value:
          "if (v.mergedEvents[v.i].event_group == 'message_user') {\n  if (v.mergedEvents[v.i].created_at === Math.min(...v.mergedEvents.map(event => event.created_at))) {\n    return 'Chat gestart';\n  } else {\n    return 'Bericht gestuurd';\n  }\n} else if (v.mergedEvents[v.i].event_group == 'page_view') {\n  return 'Pagina bezocht';\n} else if (v.mergedEvents[v.i].event_group == 'operator_changed') {\n  if (v.mergedEvents[v.i].message_type_data.event_type === 'joined') {\n    return 'Chat overgenomen';\n  } else if (v.mergedEvents[v.i].message_type_data.event_type === 'left') {\n    return 'Chat verlaten';\n  }\n} else if (v.mergedEvents[v.i].event_group == 'handoff_requested') {\n  return 'Menselijke hulp aangevraagd'\n} else if (v.mergedEvents[v.i].event_group == 'form_submission') {\n  return 'Formulier ingevuld';\n} else if (v.mergedEvents[v.i].event_group == 'purchase') {\n  return 'Aankoop voltooid';\n} else if (v.mergedEvents[v.i].event_group == 'add_to_cart') {\n  return 'Toevoeging aan winkelwagen';\n} else if (v.mergedEvents[v.i].event_group == 'login') {\n  return 'Ingelogd';\n} else if (v.mergedEvents[v.i].event_group == 'sign_up') {\n  return 'Account aangemaakt';\n} else if (v.mergedEvents[v.i].event_group == 'click') {\n  return 'Geklikt [ test ]';\n} else {\n  return 'not pre-definec';\n}"
      }
    },
    { id: 'bQuJqaGLI9HYZzU1VnUJ', name: 'customfields-list-container', visibility: { value: 'return (v.chatbotCustomFields.length > 0)' } },
    {
      id: 'ba2b56f5-1133-42c3-a027-14c7bd887b37',
      name: 'logout-btn',
      events: [
        {
          id: '48fa2ffe-580b-432b-b033-20fcc5f4bab7',
          type: 'click',
          actions: [
            {
              id: 'e78353f5-f82e-4bf8-8899-1d38c9a701a7',
              type: 'run-function',
              function:
                '// clear local storage\nfor (let i = localStorage.length - 1; i >= 0; i--) {\n    const key = localStorage.key(i);\n    if (key.startsWith(\'wized_\')) {\n        localStorage.removeItem(key);\n    }\n}\n\nWized.requests.execute("signout_user");'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: 'bb74eaa8-143a-4231-bbc7-dc4cbfce8496',
      name: 'agent-list-item-edit',
      events: [
        {
          id: '4aacc04d-1e4b-4e70-8252-67f4e504b424',
          type: 'click',
          actions: [
            {
              id: '3a846e14-0cbf-4292-a350-c753edea814c',
              type: 'run-function',
              function:
                'const editAgentBtn = document.querySelector("[w-el=\'agent-list-item-edit\']");\nconst agentInput = document.querySelector("[w-el=\'agents-list-item-name-input\']");\nconst agentPseudo = document.querySelector("[w-el=\'agents-list-item-name-pseudo\']");\nconst agentImagePseudo = document.querySelector("[w-el=\'edit-agent-image-btn\']");\n\ne.stopPropagation(); // Stop the event from propagating to the document\nagentInput.focus();\nagentPseudo.style.visibility = "hidden";\n// agentImagePseudo.style.display = "flex";\n\ndocument.addEventListener("click", (e) => {\n    let isEditButton = Array.from(editAgentBtn).some(btn => btn.contains(e.target));\n    if (!agentInput.contains(e.target) && !agentImagePseudo.contains(e.target) && !isEditButton) {\n        agentPseudo.style.visibility = "visible";\n        // agentImagePseudo.style.display = "none";\n    }\n});'
            }
          ],
          hasCondition: false
        }
      ]
    },
    { id: 'bc39d8a2-3f0d-4b71-9f5f-f4b7d8fd688f', name: 'emptystate-chatbots', visibility: { value: 'return (r.get_chatbots.data.length == 0)' } },
    {
      id: 'bcd431de-e813-4faf-b031-398a01f49a5a',
      name: 'activate-recurring-scrape-addon',
      events: [
        {
          id: '41bb3b1f-193b-4062-ace9-af02981733ac',
          type: 'click',
          actions: [
            {
              id: '9109bfac-f94e-4496-bb3b-3e0958da8f26',
              type: 'run-function',
              function:
                'Wized.requests.execute("activate_recurring_scrape_addon");\nawait Wized.requests.waitFor(\'activate_recurring_scrape_addon\');\n\nconst modal = document.querySelector(\'[popupmodal="recurringscrape-upgrade"]\');\nmodal.style.display = "none"\n\nif (r.activate_recurring_scrape_addon.ok == true) {\n\n  window.showToastNotification(\'Periodieke scraping addon ge-activeerd\', "success");\n  Wized.requests.execute("update_url");\n\n}'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: 'be014d34-c3e8-4f70-a5f6-779d95322b87',
      name: 'scrape-list-status',
      styles: {
        values: [
          {
            id: '15078b5e-2105-4ff0-bcb3-f76490712c31',
            property: 'background-color',
            value:
              'const scrapeStatus = v.scrapetool_urls_list_filtered[v.i].status;\n\nif (scrapeStatus == "completed") {\n  return "#E4FAEC"\n} else if (scrapeStatus == "queued") {\n  return "#E6F0FF"\n} else if (scrapeStatus == "failed") {\n  return "#FFF0F0"\n} else if (scrapeStatus == "not-found") {\n  return "#FBF3E0"\n}'
          }
        ]
      }
    },
    {
      id: 'c0a1ce6d-df98-4504-b825-a5465d678196',
      name: 'expert-gate-activatebtn',
      events: [
        {
          id: 'b8f8b0ad-bcaf-4d47-864b-e04c5a653d54',
          type: 'click',
          actions: [
            {
              id: 'e778da14-c261-4543-ac40-b20d3237dd5b',
              type: 'run-function',
              function:
                'const organization = r.get_user_data.data[0].organizations[0];\n\nif (organization.subscription_plan == "active") {\n\n  Wized.requests.execute("create_portal_session");\n\n} else  {\n\n  const priceId = "price_1NIIgZDFhUQDWcdkAZ3QBkMi"\n  // dev\n  // const priceId = "price_1NIIgZDFhUQDWcdkXLttXIiW"\n  v.subscriptionPriceId = priceId;\n\n  Wized.requests.execute("create_checkout_session");\n  await Wized.requests.waitFor(\'create_checkout_session\');\n\n  const redirectUrl = r.create_checkout_session.data.checkout_url;\n\n  function checkUserAgent() {\n    const userAgent = navigator.userAgent;\n    return userAgent.includes("Chrome");\n  }\n\n  if (checkUserAgent()) {\n    window.open(redirectUrl, \'_blank\', \'noopener,noreferrer\');\n  } else {\n    window.location.href = redirectUrl;\n  }\n\n}'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: 'c0bd641d-5132-4a66-9ab2-4bef609106b6',
      name: 'form-settings-overig',
      form: { value: 'return {\n  "toggle_publishing": r.get_chatbot.data.publishing.published,\n  "custom_css": r.get_chatbot.data.custom_css\n};\n' },
      events: [
        {
          id: '9f94f5e3-0728-4546-8136-158aacda79c9',
          type: 'submit',
          actions: [{ id: 'c69481c2-fde0-466d-a02a-6f0970a914dc', type: 'perform-request', request: 'aeea49d9-098f-4c0f-afa0-8da0cbbd187d' }],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    { id: 'c10d87e0-8682-461b-bee6-06e0f8886bee', name: 'chatbot-count-current', text: { value: 'return r.get_chatbots.data.length' } },
    {
      id: 'c5642919-6b74-461d-acc2-81e5310d8eca',
      name: 'dataource-sharing-dropdown-container',
      styles: {
        values: [{ id: 'e573354c-ab75-42be-80cf-036a618049fb', property: 'display', value: 'if (v.datasourceSharingChatbotsDropdown.length == 0) {\n return "none"\n} else {\n  return "flex"\n}' }]
      }
    },
    { id: 'c64408f3-259c-4534-af0e-89945c3f7ae9', name: 'cloak-prompt', visibility: { value: 'return (r.get_chatbots.data.length !== 0)' } },
    { id: 'c81f7689-65b4-4caf-9fdc-0281c31410ff', name: 'emptystate-datasources', visibility: { value: 'return (r.get_datasources.data.length == 0 && r.get_chatbots.data.length !== 0)' } },
    {
      id: 'c82389c8-f7d4-428c-8e9a-3213c69a6393',
      name: 'active-datasource-fileupload-status',
      text: {
        value:
          'const activeDatasourcestatus = (r.get_datasources.data.find((item) => item.id === v.active_datasource).file_upload_status);\n\nif (activeDatasourcestatus == "success") {\n  return "Upload voltooid"\n} else if (activeDatasourcestatus == "processing") {\n  return "Aan het verwerken"\n} else if (activeDatasourcestatus == "failed") {\n  return "Fout opgetreden"\n} else if (activeDatasourcestatus == "") {\n  // orange\n  return "#e7b549"\n}\n'
      }
    },
    {
      id: 'c959c763-d254-4063-80fd-650888c968f1',
      name: 'visibility-handoff-disabled',
      styles: {
        values: [{ id: 'bcaa36f1-0659-4936-9a70-6bd348e71ddb', property: 'display', value: 'if (i["input-handoff-external"] == "disabled") {\n  return "none"\n} else {\n  return "flex"\n}' }]
      }
    },
    {
      id: 'cIWCtErGNCTVaAFiTk30',
      name: 'form-create-datasource-xml',
      events: [
        {
          id: 'f0d396b3-020b-4c5e-93b2-ef51597cbcbf',
          type: 'submit',
          preventDefault: true,
          actions: [
            {
              id: '905cc317-11bc-4770-a900-7299fcfe4620',
              type: 'run-function',
              function:
                'Wized.requests.execute(\'validate_xml\');\nawait Wized.requests.waitFor(\'validate_xml\');\n\nif (r.validate_xml.status !== 200) {\n  \n  console.log(JSON.stringify(r.validate_xml.data))\n  const errorStatus = r.validate_xml.data.status\n  console.log(errorStatus)\n  window.showToastNotification(errorStatus, "warning");\n\n} else {\n\n  Wized.requests.execute(\'create_xml\');\n\n  // hide create chatbot modal\n  const modal = document.querySelector(\'[w-el="popup-create-datasource"]\');\n  modal.style.display = "none";\n\n  // reset create forms\n  const allForms = document.querySelectorAll(\'[datasourceform]\');\n  const formWrapperInitial = document.querySelector("[w-el=\'create-datasource-initial\']");\n  allForms.forEach((form) => {\n    form.style.display = "none";\n  });\n  formWrapperInitial.style.display = "flex";\n\n  dataSourceSelectValue.value = null;\n\n  document.querySelectorAll(".select-box").forEach((box) => {\n    box.classList.remove("selected");\n  });\n\n  ////\n\n  window.Wized = window.Wized || [];\n  window.Wized.push(async (Wized) => {\n\n    // Deprecaten - .find() method gebruiken\n    Wized.data.v.active_datasource_type = \'xml\';\n\n    // Element visibility\n    const editDatasourcesForms = document.querySelectorAll(".edit-datasource-form");\n    const editForm = document.querySelector("[w-el=\'form-container-edit-xml\']");\n    editDatasourcesForms.forEach((form) => {form.style.display = "none";});\n\n    await Wized.requests.waitFor(\'create_xml\');\n    \n    Wized.requests.execute(\'submit_xml_productfeed\');\n\n    Wized.requests.execute("get_datasources");\n    Wized.data.v.active_datasource = r.create_xml.data.id;\n\n    await Wized.requests.waitFor("get_datasources");\n    \n    // update container visibility\n    editForm.style.display = "flex";\n\n    const form = document.querySelector("[w-el=\'form-create-datasource-xml\']");\n    form.reset();\n\n    if (v.datasourcesRtSubSubscribed !== true) {\n      window.datasourcesRealtimeInit() \n    }\n\n  });\n}',
              hasCondition: true,
              condition:
                'const organization = r.get_user_data.data[0].organizations[0];\n\nreturn (n.path.includes (\'/kennis/databronnen\') && (organization.subscription_status == "active" && organization.subscription_plan.includes("expert")))'
            },
            {
              id: '390be6b9-42dd-49fb-914e-1276882cacb0',
              type: 'run-function',
              function:
                '// Show expert gate with animations\nconst popup = document.querySelector(\'[popupmodal="expert-gate"]\');\n\npopup.style.transform = "translateY(10px)";\npopup.style.opacity = 0;\npopup.style.display = "flex";\n\nsetTimeout(() => {\n    popup.style.transition = "transform 0.2s ease, opacity 0.2s ease";\n    popup.style.transform = "translateY(0)";\n    popup.style.opacity = 1;\n}, 10);\n',
              hasCondition: true,
              condition: 'const organization = r.get_user_data.data[0].organizations[0];\nreturn (organization.subscription_status !== "active" || !organization.subscription_plan.includes("expert"))'
            }
          ]
        }
      ]
    },
    {
      id: 'cK1wkq7SJxXIe3NJBHox',
      name: 'tool-output-logs-list-datatype',
      text: { value: 'const dataSource = r.get_datasources_organization.data.find(entry => entry.id === r.get_outputlogs.data[v.i].datasource_id);\nreturn dataSource.name' }
    },
    { id: 'cMXUghMgk4r6UhHIYpst', name: 'btn-icon-sendfile', visibility: { value: 'return (!r.upsert_image_inbox_fullsize.isRequesting && !r.upsert_image_inbox.isRequesting )' } },
    {
      id: 'cc0778cb-a12a-4ea5-b65d-c51a7f786d0b',
      name: 'default_message-body',
      text: {
        value:
          'if (  ["default_user", "default_bot", "default_agent"].includes(\n    v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type\n  )) {\n\nconst messageBody = v.chats.find(chat => chat.id === v.active_chat).messages[v.i].body;\nreturn marked.parse(messageBody);\n\n}',
        type: 'html'
      }
    },
    {
      id: 'cc1e98ab-cf98-4973-a6da-2f07f5390e6d',
      name: 'pdf2-upload-preview-filesize',
      text: {
        value:
          'function sizeInMBorKB(sizeBytes) {\n  const sizeMB = (sizeBytes / (1024 * 1024)).toFixed(2);\n  if (sizeBytes < 1024 * 1024) {\n    const sizeKB = (sizeBytes / 1024).toFixed(2);\n    return `${sizeKB} KB`;\n  }\n  return `${sizeMB} MB`;\n}\n\nconst fileSize = i["pdf2-upload"]["0"].size;\nreturn sizeInMBorKB(fileSize);'
      }
    },
    {
      id: 'cec99225-f49f-4660-bb65-1f706d4834eb',
      name: 'form-livechat-leave',
      events: [
        {
          id: '53a9bc5a-71c6-4aba-8413-73fdbc4d0120',
          type: 'submit',
          preventDefault: true,
          resetForm: true,
          actions: [
            {
              id: '25dce7cc-10a2-427a-8492-799ace4fcda4',
              type: 'run-function',
              function:
                "v.livechatstatus = false;\n\ndocument.querySelector('[w-el=\"admin-ui-chat-input\"]').setAttribute('readonly', true);\n\nconst livechatModal = document.querySelector('[w-el=\"livechat-popup-leave\"]');\nlivechatModal.style.display = 'none';\n\nlet leaveLivechatEvent = new Event('leaveLivechat');\nwindow.dispatchEvent(leaveLivechatEvent);\n\nWized.requests.execute(\"update_chat_livechat\");\nWized.requests.execute(\"create_message_operatorchanged\");"
            }
          ]
        }
      ]
    },
    {
      id: 'ceedb479-72c9-4d7b-bbff-8c1a8c1f9d8e',
      name: 'datasource-sharing-list-item-delete-btn',
      attributes: {
        values: [{ id: 'fad9cbf8-d359-4392-9b85-4105d2c39af8', key: 'id', value: '// return r.get_chatbots_datasources_joins.data[v.i].id\nreturn v.datasourceSharingChatbotsActiveList[v.i].id' }]
      },
      events: [
        {
          id: 'ab3ae41b-06f9-462d-8bc6-1262291f839c',
          type: 'click',
          actions: [
            {
              id: '35255278-4c5b-4cec-a7e4-43b019933005',
              type: 'run-function',
              function:
                'const dataValue = event.currentTarget.getAttribute("id");\nv.delete_chatbots_datasources_join = dataValue;\nconsole.log(dataValue);\n\nWized.requests.execute("delete_chatbots_datasources_join");\nawait Wized.requests.waitFor("delete_chatbots_datasources_join");\n\nWized.requests.execute("get_chatbots_datasources_joins");'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: 'cff45f85-1a3f-4d27-bb53-e5c85a9d53a9',
      name: 'form-settings-humanhandff',
      form: {
        value:
          'function removePrefix(url) {\n  const formattedUrl = url.replace("https://", "");\n  return formattedUrl;\n}\n\nlet handoffEndpoint;\nif (r.get_chatbot.data.human_handoff.endpoint) {\n  handoffEndpoint = removePrefix(r.get_chatbot.data.human_handoff.endpoint);\n}\n\nreturn {\n  handoff_type: r.get_chatbot.data.human_handoff.type,\n  handoff_endpoint: handoffEndpoint,\n  handoff_trigger: r.get_chatbot.data.human_handoff.triggers[0],\n\n  handoff_prompt: r.get_chatbot.data.human_handoff.prompt,\n\n  handoff_fallback_before: r.get_chatbot.data.human_handoff.fallback_before,\n  handoff_fallback_after: r.get_chatbot.data.human_handoff.fallback_after,\n};'
      },
      events: [
        {
          id: '217c8208-87b4-4a88-82e0-f4cbdec34078',
          type: 'submit',
          actions: [{ id: '904c3a11-81d5-498e-8257-d88aeb443c99', type: 'perform-request', request: '372875e4-b533-436f-ad8d-7e4dd5bf0a4f' }],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: 'cuP9GyDIHTf1Y5C15VV4',
      name: 'ai-tagging-addtag-value',
      visibility: { value: 'return (v.chatbotTags.length < 100)' },
      events: [
        {
          id: 'a5fc70a1-f2ff-45f6-82dc-43d9636cc898',
          type: 'keydown',
          actions: [
            {
              id: '3ea5c9ec-7211-46db-9db5-323a6d7f6b8e',
              type: 'run-function',
              function:
                'if (event.key == "Enter") {\n  event.preventDefault();\n  const value = i["ai-tagging-addtag-value"];\n  if (value == \'\') return\n  v.chatbotTags.push({ tag: value, description: "" });\n  i["ai-tagging-addtag-value"] = "";\n}'
            }
          ]
        }
      ]
    },
    { id: 'd3a3f949-9e38-4d8d-85ad-2e0dc2a22080', name: 'crawl-list-item-value', text: { value: 'return v.crawledpages[v.i]' } },
    {
      id: 'd456ee4b-11dc-4cfc-9449-fb59c20b477f',
      name: 'helpcenter-schedule-call-btn',
      attributes: {
        values: [
          {
            id: '4302f9a1-c271-49c7-8bf3-9adba9bce618',
            key: 'href',
            value:
              'if (r.get_user_data.data[0].organizations[0].subscription_status !== "active") {\n  return "https://www.sleak.chat/product-demo"\n} else {\n  const callButton = document.querySelector(\'[w-el="helpcenter-schedule-call-btn"]\')\n  callButton.querySelector(\'.purplebox-text\').textContent = \'Online videocall\';\n  return "https://calendly.com/sleak-chat/support"\n}'
          }
        ]
      }
    },
    {
      id: 'd50d4197-7573-4f11-971a-3bc3752c4f2d',
      name: 'form-upsert-urls',
      events: [
        {
          id: '10565eec-7e0a-4a8f-b78e-68f5356535eb',
          type: 'submit',
          actions: [
            {
              id: '73d9d861-1606-4dd3-ade7-667919ddcaa8',
              type: 'run-function',
              function:
                'Wized.requests.execute(\'upsert_urls\');\ndocument.querySelector(\'[popupmodal="add-crawl-urls"]\').style.display = "none";\n\nwindow.showProgressBarAndHideControls();\n\nawait Wized.requests.waitFor(\'upsert_urls\');\nif (r.upsert_urls.ok) {\n  v.lastScrapeBatchUrls = v.crawledpages\n  console.log("set crawled pages = ", v.lastScrapeBatchUrls)\n\n  // Set the flag indicating a scrape job has been initiated\n  v.isScrapeJobInitiated = true;\n\n  window.updateCheckboxVisibilityAndCounts();\n  \n  // reset crawled array\n  v.crawledpages = []\n}',
              hasCondition: true,
              condition: 'return (v.crawledpages.length !== 0)'
            }
          ],
          hasCondition: false,
          preventDefault: true,
          resetForm: true
        }
      ]
    },
    {
      id: 'd7b35194-b847-4c63-bab5-4d50b2633a6d',
      name: 'active-datasource-status',
      text: {
        value:
          'if (v.dataSourceUpdatedStatus !== null) {\n  status = v.dataSourceUpdatedStatus\n} else {\n  status = r.get_datasources.data.find((item) => item.id === v.active_datasource).status;\n}\n\nif (status == "draft") {\n  return "Concept"\n} else if (status == "active") {\n  return "Actief"\n} else if (status == "inactive") {\n  return "Inactief"\n} else {\n  return ""\n}'
      }
    },
    { id: 'dE7KmHvFQIthkP7Giwed', name: 'activityfeedlist-operatorcontainer', visibility: { value: "return (v.mergedEvents[v.i].event_group === 'operator_changed')" } },
    {
      id: 'dadfab69-d621-44e5-9f9e-57ec22508a33',
      name: 'api-headers-visibility',
      styles: { values: [{ id: '08843358-2490-4f5d-b4eb-1446897fc3d3', property: 'display', value: 'if (i["input-headers_enabled"] == false) {\n  return "none"\n} else {\n  return "flex"\n}' }] }
    },
    {
      id: 'db2cf51d-e118-4115-81f4-90d4c11c5066',
      name: 'form-edit-url',
      form: {
        value:
          'var dataSource = r.get_datasources.data.find((item) => item.id === v.active_datasource);\n\nreturn {\n  status: dataSource.status,\n  website_url: dataSource.datasource_type_config.website_url,\n  recurringscrape: dataSource.recurring\n}'
      },
      events: [
        {
          id: 'bc3d924c-ea18-4ca0-b0f5-a1e2a573771a',
          type: 'submit',
          preventDefault: true,
          actions: [
            {
              id: 'e77161d1-5cce-4ff3-8753-5c2c84d1bc27',
              type: 'run-function',
              function: 'Wized.requests.execute("update_url");\n\nawait Wized.requests.waitFor(\'update_url\');\n\nWized.requests.execute("get_datasources");\n'
            }
          ]
        }
      ]
    },
    { id: 'db8fdb50-d7f5-4d97-b558-fdb2e3cf7326', name: 'organization-initials', text: { value: 'return r.get_user_data.data[0].organizations[0].company_name.charAt(0);\n' } },
    {
      id: 'dbJFHULIDdHeWKSHRn6F',
      name: 'debug-list-item',
      list: {
        indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72',
        value:
          'return [\n  { "tag": "retourneren", "description": "voor alle vragen over het retourneren van producten" },\n  { "tag": "productvraag", "description": "Voor alle vragen over specifieke producten" },\n  { "tag": "klacht", "description": "wijs deze tag toe aan gesprekken van bezoekers die klachten hebben" },\n  { "tag": "betaling", "description": "voor vragen over betalingen en facturen" },\n  { "tag": "verzending", "description": "voor vragen over de status van verzendingen" },\n  { "tag": "account", "description": "voor hulp bij inloggen of accountproblemen" },\n  { "tag": "korting", "description": "voor vragen over kortingscodes en aanbiedingen" }\n]'
      }
    },
    { id: 'dc9b4bc0-3f56-4936-a6a3-d1189a18cda1', name: 'api-headers-list-item-value', value: { value: 'return v.apiHeadersArray[v.i].value' } },
    {
      id: 'de5ba892-03f0-46a9-bec8-8f37e59cbb01',
      name: 'message-type-link_preview',
      visibility: { value: 'return (\n  v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview"\n);\n' }
    },
    {
      id: 'dfZEb99FdjfD1vvtMbHg',
      name: 'toggle_customfields_override_checkbox',
      value: { value: 'return v.chatbotCustomFields[v.i].updateChatName' },
      attributes: {
        values: [
          { id: '07b4db97-4e9d-42cb-a8d9-c45562d07e36', key: 'id', value: "return 'customfields_toggle_overridename_' + v.i" },
          { id: 'fc20f7c8-a577-4f1f-92b1-6e01ddbf6b09', key: 'name', value: "return 'customfields_toggle_overridename_' + v.i" }
        ]
      }
    },
    {
      id: 'e0d3ef47-111e-4717-89fb-538e5e3d5f55',
      name: 'filter-chatbots-img',
      attributes: {
        values: [
          {
            id: 'b0bdbf2e-490d-4780-993f-dc128d247607',
            key: 'src',
            value:
              'if (r.get_chatbots.data[v.i].avatar_url) {\n  return r.get_chatbots.data[v.i].avatar_url\n} else {\n  return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\n}'
          }
        ]
      }
    },
    {
      id: 'e243e7c2-0961-486d-bf49-d4db0e5d8ec3',
      name: 'api-headers-list-item',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.apiHeadersArray' },
      attributes: { values: [{ id: 'e19393cf-120c-4b8d-85a9-2c960b7a9893', key: 'index', value: 'return v.apiHeadersArray[v.i].index' }] },
      events: [
        {
          id: 'b152df3c-fd36-41de-92c8-5f79e3c6d0ab',
          type: 'mouseenter',
          actions: [
            {
              id: 'ca58480e-72d7-47d7-b673-93f512a1f190',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"api-headers-list-item-delete-btn\"]');\n\ncloseButton.style.display = 'flex';\nsetTimeout(() => {\n  closeButton.style.opacity = '1';\ncloseButton.style.transform = 'translateY(0)';\n}, 1);\n"
            }
          ],
          hasCondition: false
        },
        {
          id: '4d32af7a-0a68-4c63-8eb0-28d805a623b4',
          type: 'mouseleave',
          actions: [
            {
              id: '42433d7e-85de-4642-857b-5150caae2399',
              type: 'run-function',
              function:
                "const triggerElement = event.target;\nconst closeButton = triggerElement.querySelector('[w-el=\"api-headers-list-item-delete-btn\"]');\ncloseButton.style.transform = 'translateY(3px)';\ncloseButton.style.opacity = '0';\nsetTimeout(() => {\n  closeButton.style.display = 'none';\n}, 200);"
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: 'e2a5c75e-ead7-4d30-ae9b-7089f9ce96c0',
      name: 'form-settings-extraopties',
      form: {
        value:
          'return {\n  toggle_channels: r.get_chatbot.data.channels_data.enabled,\n  \n  toggle_channels_phone: r.get_chatbot.data.channels_data.phone.enabled,\n  channels_phone_value: r.get_chatbot.data.channels_data.phone.value,\n  channels_phone_message: r.get_chatbot.data.channels_data.phone.message,\n\n  toggle_channels_whatsapp: r.get_chatbot.data.channels_data.whatsapp.enabled,\n  channels_whatsapp_value: r.get_chatbot.data.channels_data.whatsapp.value,\n  channels_whatsapp_message: r.get_chatbot.data.channels_data.whatsapp.message,\n\n  toggle_channels_form: r.get_chatbot.data.channels_data.form.enabled,\n  channels_form_value: r.get_chatbot.data.channels_data.form.value,\n  channels_form_message: r.get_chatbot.data.channels_data.form.message,\n\n  toggle_linkpreviews: r.get_chatbot.data.link_previews,\n\n  toggle_emailgate_enabled: r.get_chatbot.data.email_gate.activated,\n  toggle_emailgate_blocking: r.get_chatbot.data.email_gate.blocking,\n  confirmation_message: r.get_chatbot.data.email_gate.confirmation_message,\n  toggle_conversationstarters: r.get_chatbots.data.find(item => item.id == v.active_chatbot).conversation_starters_enabled\n}'
      },
      events: [
        {
          id: '195a4880-82c4-4d79-98fb-239d98eec56e',
          type: 'submit',
          preventDefault: true,
          actions: [{ id: 'f7f405bb-af9c-4e78-a329-953ed56dfe55', type: 'perform-request', request: '148b2e82-9260-425b-9d0d-bfafd9a7f64d' }]
        }
      ]
    },
    { id: 'e2df1791-a8c0-4586-bc02-cfa3d7778515', name: 'active-filter-label-archived', visibility: { value: 'return (v.inboxFilterLabel == "archived")' } },
    { id: 'e3351cc2-aa61-4563-b16b-5621363c1e3a', name: 'user-name', text: { value: 'return r.get_user_data.data[0].first_name' } },
    { id: 'e44444ea-75d0-4829-ac7b-ec1539d80b1b', name: 'emptystate-chats', visibility: { value: 'return (v.chats.length == 0 && v.usedFilters == false)' } },
    {
      id: 'e4775bec-edff-4d71-aad9-34cb81afee7c',
      name: 'emptystate-kblist-search',
      visibility: { value: 'const searchQuery = i["kennisbank-search-input"];\n\nreturn (searchQuery && v.filteredKbList.length == 0)' }
    },
    { id: 'e4a90f1d-cf97-4245-8ced-5b841fdec83a', name: 'active-chatbot-url', text: { value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).website_url' } },
    {
      id: 'e549b9fd-5fbf-4a60-b9f5-2c13002c7d46',
      name: 'chat-list-item-avatar',
      styles: { values: [{ id: 'ea560680-eb7c-4744-a2ee-0e1cf8186f6d', property: 'background-image', value: "const image = v.chats[v.i].avatar;\nreturn `url('${image}')`" }] }
    },
    { id: 'e5F76bx1MbKz5h3QbQLZ', name: 'subscription-overdue-modal', visibility: { value: 'return (r.get_user_data.data[0].organizations[0].subscription_status == "overdue")\n' } },
    {
      id: 'e5c9869c-fd2d-4e64-8722-10ef682b9d16',
      name: 'active-chat-inbox-time',
      text: {
        value:
          "const date = new Date(v.chats.find((chat) => chat.id === v.active_chat).created_at);\n\nreturn `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;"
      }
    },
    {
      id: 'e70dc529-5eb4-42df-9157-e829f629e675',
      name: 'visibility_toggle_channels_whatsapp',
      styles: { values: [{ id: 'e1d0b51d-f038-4bac-80ba-d107c05d4488', property: 'display', value: 'if (i.toggle_channels_whatsapp == true) {\n  return "block"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: 'e7b0b8e6-ea10-4687-92ff-23e5a4f429a5',
      name: 'scrape-list-checkbox-label',
      attributes: { values: [{ id: 'ab97f28e-c004-4f99-aebb-f9aa52c75262', key: 'for', value: 'return `scrape-page-` + v.i' }] },
      events: [
        {
          id: '20bb3989-9c5c-4a82-9077-4465984f84a6',
          type: 'click',
          preventDefault: true,
          actions: [
            {
              id: '524b0f72-8678-4e77-ba52-c6e1c2b2fd42',
              type: 'run-function',
              function: 'thisElement = event.currentTarget\n// console.log("click", thisElement, event)\n// console.log("shift = ", event.shiftKey)\nwindow.checkboxLabelClick(thisElement, event)'
            }
          ]
        }
      ]
    },
    {
      id: 'e8552720-2e02-49fc-b0f7-fdec39689433',
      name: 'link_preview-title',
      text: {
        value:
          'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.title\n\n}'
      }
    },
    { id: 'eUrVgeuANPcXt6iX9GvJ', name: 'activityfeedlist-content-wrap', visibility: { value: 'return (v.mergedEvents[v.i].content ? true : false)' } },
    {
      id: 'eab1085c-7bae-4fa9-b23e-c61ffc96d141',
      name: 'success_message-email',
      text: {
        value:
          'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "success_message") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i].message_type_data.email\n\n}'
      }
    },
    {
      id: 'efa62413-c1be-4b59-a0d2-626ac99a12e3',
      name: 'create-btn-crawl-sitemap',
      events: [
        {
          id: '3b13eea6-7d20-41f7-9420-c826b17b04a6',
          type: 'click',
          actions: [
            {
              id: '82cff75c-bedf-4c65-8567-27a3eeba36cc',
              type: 'run-function',
              function:
                "function validateUrl(url) {\n  try {\n    const parsedUrl = new URL(url);\n\n    // Check if the URL ends with .xml\n    if (!parsedUrl.pathname.endsWith('.xml')) {\n      return false;\n    }\n\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nif (i['input-crawl-sitemap'] && !r.get_sitemap.isRequesting) {\n  let url = i['input-crawl-sitemap'].trim();\n\n  // If no protocol is provided, prepend 'https://'\n  if (!/^https?:\\/\\//i.test(url)) {\n    url = 'https://' + url;\n  }\n\n  if (validateUrl(url)) {\n    Wized.requests.execute('get_sitemap');\n    document.querySelectorAll('[spinner=\"get-sitemap\"]').forEach(function (element) {\n      element.style.display = 'flex';\n    });\n  } else {\n    window.showToastNotification('Ongeldige sitemap URL - een sitemap URL eindigt met \".xml\"', 'warning');\n  }\n} else {\n  window.showToastNotification('Website URL vereist', 'warning');\n}\n"
            }
          ],
          hasCondition: false
        }
      ]
    },
    { id: 'f0aff5df-c4ec-4ab7-bd39-862ae7343429', name: 'datasource-list-sharing-container', visibility: { value: 'return (v.datasourceSharingNavbarList.length > 0);\n' } },
    {
      id: 'f0b1bd5a-5505-4b75-beb6-421f4dd50f01',
      name: 'dropdown-active-chatbot-avatar',
      attributes: { values: [{ id: 'f78b03e4-3c40-40e8-ac2c-1f0f74a432af', key: 'src', value: 'return r.get_chatbots.data.find((item) => item.id === v.active_chatbot).avatar_url\n' }] },
      visibility: {
        value:
          'return (r.get_chatbots.data.find((item) => item.id === v.active_chatbot).avatar_url !== "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png")'
      }
    },
    {
      id: 'f16afae9-c02a-4c8e-a5ca-7f12e01bfce4',
      name: 'form-auth',
      events: [
        {
          id: '2f50b566-643b-4376-a38f-208f115f4b61',
          type: 'submit',
          actions: [
            {
              id: 'c43b9cef-1a8d-40f4-a739-cd2d16b727ed',
              type: 'run-function',
              function:
                'const signupButton = document.querySelector(\'[multi-step-signup="button"]\');\nconst spinner = document.querySelector(\'[spinner="auth"]\');\nspinner.style.display = \'flex\';\nsignupButton.setAttribute(\'value\', \'\');\n\n// clear local storage\nfor (let i = localStorage.length - 1; i >= 0; i--) {\n    const key = localStorage.key(i);\n    if (key.startsWith(\'wized_\')) {\n        localStorage.removeItem(key);\n    }\n}\n\nv.chatbots = null;\nv.active_chatbot = null;\nv.active_datasource = null;\nv.active_datasource_type = null;\nconsole.log("set to null");\n\nif (n.path === \'/signup\') {\n  if (!localStorage.getItem("sleakSignedUp")) {\n  dataLayer.push({\n    event: "trialSignup",\n    eventCategory: "Form",\n    eventAction: "SignupForm",\n    eventLabel: "Trial Signup",\n  });\n  localStorage.setItem("sleakSignedUp", "true");\n  console.log("signup event");\n  }\n  \n  return Wized.requests.execute(\'create_user\')\n} else {\n  return Wized.requests.execute(\'auth_user\')\n}'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: 'f1f6a13a-e08e-4986-bb68-07edaed6933c',
      name: 'datasource-list-item-status',
      styles: {
        values: [
          {
            id: 'a5353e97-a127-4cb8-8179-6fac2add07c3',
            property: 'background-color',
            value:
              'if (r.get_datasources.data[v.i].status == "draft") {\n  return "#e7b549"\n} else if (r.get_datasources.data[v.i].status == "active") {\n  return "#25d366"\n} else if (r.get_datasources.data[v.i].status == "inactive") {\n  return "#F37A80"\n}'
          }
        ]
      }
    },
    {
      id: 'f23d6c63-40db-4417-83af-d245ff60b6d8',
      name: 'link_preview-url',
      text: {
        value:
          'if (v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "link_preview") {\n    \n  return v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n        .message_type_data.url \n\n}'
      }
    },
    {
      id: 'f2e9e594-0c30-4652-9773-cc551aff14ee',
      name: 'message-type-email_gate',
      visibility: {
        value:
          'const formChatType = v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type\nreturn (formChatType == "fallbackmessage_form" || formChatType == "email_gate");\n'
      }
    },
    {
      id: 'f2fa0553-adb9-4a10-8be4-05d4bbb70854',
      name: 'scrape-urlslist-containr',
      styles: { values: [{ id: 'c1f768fa-ee9b-4fba-b769-b27321881875', property: 'display', value: 'if (v.crawledpages.length !== 0) {\n  return "flex"\n} else {\n  return "none"\n}' }] }
    },
    {
      id: 'f3ee5963-868a-4f09-b54d-63f87d8c7d34',
      name: 'filter-apply',
      events: [
        {
          id: 'c4bea3a6-bddb-4685-ac30-e06c5aa95e0b',
          type: 'click',
          actions: [
            { id: '244a5e6a-b9d8-449e-b284-7aaf669179a3', type: 'perform-request', request: 'fefe687b-b6dd-4efc-af07-f5b4c1810457' },
            {
              id: '84eb7b28-cc30-4953-9617-60cd12100218',
              type: 'run-function',
              function:
                'v.loadmorechats = [];\nv.usedFilters = true;\n\nconst dropdownModals = document.querySelectorAll(\'[w-el="filters-dropdown"]\');\n\ndropdownModals.forEach(function(modal) {\n    modal.style.display = "none";\n});\n\nconst filterbar = document.querySelector("[w-el=\'inbox-subheader-activefilters\']");\nif (v.inboxFilterLabel == "archived") {\n    filterbar.style.display = "flex";\n} else if (v.inboxFilterStatus == "escalated" || v.inboxFilterStatus == "livechat") {\n    filterbar.style.display = "flex";\n} else if (v.inboxFilterLabel == "open" && v.inboxFilterStatus == "all" ) {\n    filterbar.style.display = "none";\n}'
            }
          ],
          hasCondition: false,
          preventDefault: true
        }
      ]
    },
    {
      id: 'f40727b2-0e36-4cd7-b0e7-41505b91bcb9',
      name: 'chats-list-container',
      events: [
        {
          id: '2b272c9e-fb73-44f2-8828-8c745ac437e4',
          type: 'scroll',
          actions: [
            {
              id: '0c88ccf9-11d9-4141-82b0-512cd2cf9776',
              type: 'perform-request',
              request: '2b0b056c-0433-40b4-b023-013a58dd4123',
              hasCondition: true,
              condition:
                '// console.log("scroll");\nvar scrollBox = document.querySelector(\'[w-el="chats-list-container"]\');\n\nconst chatItems = document.querySelectorAll(".chat-list-item");\n\nconst isAtBottom = scrollBox.scrollHeight - scrollBox.scrollTop === scrollBox.clientHeight;\nreturn (isAtBottom)'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: 'f526db94-c160-4a89-a42b-5fc1698983f7',
      name: 'livechat-toggle',
      events: [
        {
          id: '850e6a59-f811-4ee5-8124-31c5879b3848',
          type: 'click',
          actions: [
            {
              id: '76f4fde7-28ba-407e-b694-d911751dd431',
              type: 'run-function',
              function:
                'if (v.chats.find((chat) => chat.id === v.active_chat).livechat == false) {\n  const livechatModal = document.querySelector(\'[w-el="livechat-popup"]\');\n  livechatModal.style.display = "flex";\n  livechatModal.style.opacity = 1;\n} else if (v.chats.find((chat) => chat.id === v.active_chat).livechat == true) {\n  const livechatModal = document.querySelector(\'[w-el="livechat-popup-leave"]\');\n  livechatModal.style.display = "flex";\n  livechatModal.style.opacity = 1;\n}\n\n'
            }
          ],
          hasCondition: false
        }
      ]
    },
    {
      id: 'f7d3d3f1-7029-4d15-94d1-0cc9e122e2e3',
      name: 'chat-message-timestamp',
      text: {
        value:
          "const date = new Date(v.chats.find((chat) => chat.id === v.active_chat).created_at);\n\nlet options = { weekday: 'long', day: 'numeric', month: 'long' };\nlet formattedDate = date.toLocaleDateString('nl-NL', options);\n\nif (date.getFullYear() !== new Date().getFullYear()) {\n  formattedDate += ' ' + date.getFullYear();\n}\n\nreturn formattedDate.charAt(0).toUpperCase() + formattedDate.slice(1);"
      }
    },
    {
      id: 'f9d5e598-473f-461e-b401-aa9244313fa7',
      name: 'form-create-topic',
      events: [
        {
          id: '379581f0-f373-4413-9c1a-ec220c196b97',
          type: 'submit',
          actions: [
            {
              id: 'e11ae695-278e-45b0-b4cb-34525424aa77',
              type: 'run-function',
              function:
                'window.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  const modals = document.querySelectorAll(\'[popupmodal]\');\n  modals.forEach((modal) => {\n    modal.style.display = "none";\n  });\n\n  Wized.requests.execute("create_kb_topic");\n  await Wized.requests.waitFor("create_kb_topic");\n  Wized.requests.execute("get_datasources");\n})'
            }
          ],
          hasCondition: false,
          preventDefault: true,
          resetForm: true
        }
      ]
    },
    {
      id: 'fWhZDV08isYDrj5Tpw0A',
      name: 'conversationstarters-delete-btn',
      attributes: { values: [{ id: 'ff76bbf0-bdac-49ff-877a-eb0ef5663efb', key: 'index', value: 'return v.i' }] },
      events: [
        {
          id: '460df1aa-9b31-4b29-916f-99f3e0eba3b3',
          type: 'click',
          actions: [
            {
              id: 'bd44b5ce-8611-423c-ba19-f593f5732e84',
              type: 'run-function',
              function:
                "const convStartersArray = [];\n\ndocument.querySelectorAll('[w-el=conversationstarters-list-item]').forEach(item => {\n  const question = item.querySelector('[w-el=\"conversationstarters-list-item-key\"]').value;\n  const answer = item.querySelector('[w-el=\"conversationstarters-list-item-value\"]').value;\n  convStartersArray.push({\n    question,\n    answer\n  });\n});\n\nconsole.log('convStartersTagsArray', convStartersArray);\n\nv.chatbotConversationStarters = convStartersArray;\n\n// splice from array\nconst index = event.currentTarget.getAttribute('index');\nv.chatbotConversationStarters.splice(parseInt(index, 10), 1);"
            }
          ]
        }
      ]
    },
    {
      id: 'fa894f63-aa40-46ee-a946-2af556aad7a8',
      name: 'csv-upload-warning-notice',
      styles: { values: [{ id: 'e0fbd2ba-4a40-4984-9c01-8d76ac9149ec', property: 'display', value: 'if (v.csvContent && v.csv_rows.length > 0) {\n  return "none"\n} else {\n  return "flex"\n}' }] }
    },
    {
      id: 'fbe3f9db-407d-47b3-966e-4744e1b73962',
      name: 'datasource-sharing-list-item-avatar',
      attributes: {
        values: [
          { id: '5e1b42d6-3eef-4b00-9b9b-7e8fe1b44b39', key: 'src', value: 'return r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).avatar_url' }
        ]
      },
      visibility: {
        value:
          'return (r.get_chatbots.data.find((item) => item.id === v.datasourceSharingChatbotsActiveList[v.i].chatbot_id).avatar_url !== "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png")'
      }
    },
    { id: 'fc569017-8961-4cad-8951-4be522eb13b8', name: 'emptystate-api-list-headers', visibility: { value: 'return (v.apiHeadersArray.length == 0)' } },
    {
      id: 'fc5b2f3f-9b28-480a-be50-c1222f576f8b',
      name: 'chatbot-count-label',
      visibility: {
        value:
          'const organization = r.get_user_data.data[0].organizations[0];\nconst chatbots = r.get_chatbots.data;\nconst maxChatbots = r.get_user_data.data[0].organizations[0].chatbot_limit;\n\nreturn (organization.subscription_plan && organization.subscription_plan.includes("expert") || maxChatbots !== null)'
      }
    },
    { id: 'ff96e19a-5d77-49e4-a3e3-62c65c25695d', name: 'inbox-loading-1', visibility: { value: 'return (r.get_chats.ok == null)' } },
    {
      id: 'gQvC51qk0cD2i9EgJAkl',
      name: 'tool-output-logs-list-name',
      text: {
        value:
          "const dataType = r.get_outputlogs.data[v.i].data_type\n\nconst rawContent = r.get_outputlogs.data[v.i].content\n\nif (dataType == 'url') {\n  const parsedContent = JSON.parse(rawContent)\n  return parsedContent.pageInfo.sourceURL\n} else if (dataType == 'csv') {\n  return 'CSV rij'\n} else if (dataType == 'kb') {\n  return r.get_outputlogs.data[v.i].metadata.document_name\n} else if (dataType == 'pdf2' || dataType == 'pdf') {\n  return 'PDF pagina'\n} else if (dataType == 'xml') {\n  return 'item ' + r.get_outputlogs.data[v.i].metadata.product_id\n}"
      }
    },
    { id: 'gzFlozGcISfPzG73oyEL', name: 'tagging-list-item-description', value: { value: 'return v.chatbotTags[v.i].description' } },
    {
      id: 'hB9UmLkjCCnuYURwDltV',
      name: 'form-edit-xml',
      form: {
        value:
          'return {\n status: r.get_datasources.data.find(item => item.id === v.active_datasource).status,\n recurringxml: r.get_datasources.data.find(item => item.id === v.active_datasource).recurring\n}'
      },
      events: [
        {
          id: '0ea4bd41-d705-4ba9-926a-03cc9bc518c5',
          type: 'submit',
          preventDefault: true,
          actions: [
            {
              id: '2839529d-f3c5-49f9-85dc-9d09a0113789',
              type: 'run-function',
              function: 'Wized.requests.execute("update_xml");\nawait Wized.requests.waitFor(\'update_xml\');\n\nWized.requests.execute("get_datasources");'
            }
          ]
        }
      ]
    },
    { id: 'i390FfcUxDKD4EPewCnS', name: 'activityfeedlist-content-text', text: { type: 'markdown', value: 'if (v.mergedEvents[v.i].content) return (v.mergedEvents[v.i].content)' } },
    {
      id: 'iotfbp72dOVO2GLNZr3f',
      name: 'form-sidebar-editchat',
      events: [
        {
          id: 'a6168ca0-9368-447b-a167-ccd9d63597e8',
          type: 'submit',
          preventDefault: true,
          actions: [
            {
              id: '04397bd6-4821-4abe-9a7c-21e4ce0f8348',
              type: 'run-function',
              function: 'Wized.requests.execute(\'update_chat_sidebar\');\ndocument.querySelector(\'[popupmodal="inbox-sidebar"]\').style.display = "none"'
            }
          ]
        }
      ]
    },
    {
      id: 'itGa6m57OZIu5TJ8IdPh',
      name: 'form-edit-topic',
      form: {
        value:
          'return {\n  "name": r.get_datasources.data.find(item => item.id === v.active_datasource).kb_topics.find(item => item.id === v.active_kb_topic).name,\n  "content": r.get_datasources.data.find(item => item.id === v.active_datasource).kb_topics.find(item => item.id === v.active_kb_topic).content\n}\n'
      },
      events: [
        {
          id: '10829ade-400f-4d59-97e1-893f7f790a44',
          type: 'submit',
          preventDefault: true,
          actions: [
            {
              id: 'cedf41ea-3081-4e26-9040-da38bd7c238c',
              type: 'run-function',
              function:
                'window.Wized = window.Wized || [];\nwindow.Wized.push(async (Wized) => {\n\n  Wized.requests.execute("update_kb_topic");\n  await Wized.requests.waitFor("update_kb_topic");\n  Wized.requests.execute("get_datasources");\n\n  const modals = document.querySelectorAll(\'[popupmodal]\');\n  modals.forEach((modal) => {\n    modal.style.display = "none";\n  });\n\n})'
            }
          ]
        }
      ]
    },
    {
      id: 'itvCHrRusTWO91FvappD',
      name: 'tool-output-logs-indicator-button',
      visibility: { value: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].outputlogs.has_outputlogs == true)' },
      attributes: { values: [{ id: 'e1e9064d-4f43-4480-9350-772e70cef7be', key: 'id', value: 'return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].id)' }] },
      events: [
        {
          id: '161ee475-4179-4789-9375-fc1c840a3763',
          type: 'click',
          actions: [
            {
              id: '54f681d6-394b-40d5-85e8-4c1517a4d910',
              type: 'run-function',
              function:
                "v.selectedMessageId = event.currentTarget.getAttribute('id');\nconsole.log('ðŸ‡³ðŸ‡± v.selectedMessageId = ', v.selectedMessageId)\n\ndocument.querySelectorAll('[spinner=\"outputlogs\"]').forEach(element => {\n  element.style.display = 'none';\n});\nevent.currentTarget.querySelector('[spinner=\"outputlogs\"]').style.display = 'flex';\n\nlet clickedMessage;\nclickedMessage = v.allchats.find(chat => chat.id === v.active_chat).messages.find(chat => chat.id === v.selectedMessageId);\ndataType = clickedMessage.outputlogs.type;\n\nwindow.showOutputLogs(dataType);"
            }
          ]
        }
      ]
    },
    {
      id: 'j8gzQBlO9BSzA9fPW1ZT',
      name: 'tool-output-logs-list-body',
      text: {
        type: 'markdown',
        value:
          "const dataType = r.get_outputlogs.data[v.i].data_type\n\nconst rawContent = r.get_outputlogs.data[v.i].content\nif (dataType == 'url') {\n  const parsedContent = JSON.parse(rawContent)\n  return parsedContent.pageContent\n} else {\n  return rawContent\n}"
      }
    },
    { id: 'kOi79iAqarZztSy7N4SB', name: 'tagging-listitem-tagname', text: { value: 'if (v.chatTags.length > 0) {\n  return v.chatTags[v.i].tag\n}' } },
    {
      id: 'mRfU7NyVhtVcimDsyau0',
      name: 'form-integrations-customfields',
      events: [
        {
          id: '2b86fec7-beed-455b-83b4-c5560a2f11b0',
          type: 'submit',
          preventDefault: true,
          actions: [{ id: 'a7cc6185-1c82-45e0-bc7b-823b881428ab', type: 'perform-request', request: 'xNoMjXiDQOgQtxJJ0KlD' }]
        }
      ]
    },
    {
      id: 'mdgLlnjAiX1SvV5aNjHS',
      name: 'tool-output-logs-list-body-preview',
      text: {
        value:
          "const dataType = r.get_outputlogs.data[v.i].data_type\n\nconst rawContent = r.get_outputlogs.data[v.i].content\nif (dataType == 'url') {\n  const parsedContent = JSON.parse(rawContent)\n  return parsedContent.pageContent\n} else {\n  return rawContent\n}"
      }
    },
    {
      id: 'n7fYlnjInBhX6yVnG7xO',
      name: 'btn-open-inbox-sidebar',
      events: [
        {
          id: 'bed14cc4-e28b-455d-8e2e-b67794eca982',
          type: 'click',
          actions: [
            {
              id: '8d9be7ab-df0a-42de-9982-757ec36e607a',
              type: 'run-function',
              function:
                "const sidebar = document.querySelector('[w-el=\"inbox-sidebar\"]');\n\nWized.requests.execute('get_chatevents');\nawait Wized.requests.waitFor('get_chatevents');\n\nconst chat = v.chats.find(chat => chat.id === v.active_chat);\n\n// archived toevoegen\n\n$('[w-el=\"inbox-sidebar-chatnamename\"]').text(chat.name);\n$('[w-el=\"inbox-sidebar-uuid\"]').text(chat.id);\n$('[w-el=\"inbox-sidebar-avatar\"]').attr('src', chat.avatar)\n\nif (chat.livechat === true || chat.agent_requested === true) {\n  $('[w-el=\"inbox-sidebar-label\"]').css('display', 'flex');\n  if (chat.livechat === true) {\n    $('[w-el=\"inbox-sidebar-label-text\"]').text('Live chat');\n    $('[w-el=\"inbox-sidebar-label-indicator\"]').css('background-color', '#25D366');\n  } else if (chat.agent_requested === true) {\n    $('[w-el=\"inbox-sidebar-label-text\"]').text('Aandacht vereist');\n    $('[w-el=\"inbox-sidebar-label-indicator\"]').css('background-color', '#E7B549');\n  }\n}\n\n$('[w-el=\"inbox-sidebar-email\"]').text(chat.enduser_email || chat.chat_user_email || 'Geen e-mailadres');\n$('[w-el=\"inbox-sidebar-phone\"]').text(chat.enduser_phone || chat.chat_user_phone || 'Geen telefoonnummer');\n$('[w-el=\"inbox-sidebar-landingpage\"]').text(chat.landingpage || 'Onbekend');\n$('[w-el=\"inbox-sidebar-device\"]').text(chat.device || 'Onbekend');\n$('[w-el=\"inbox-sidebar-device-icon\"]').each(function () {\n  if (chat.device == 'mobile') {\n    $(this).attr('src', 'https://cdn.prod.website-files.com/65911e9735540c235757642f/65fc8dd3952a95d3b744fd30_mobile-android-alt%20(1).svg').show();\n  } else if (chat.device == 'desktop') {\n    $(this).attr('src', 'https://cdn.prod.website-files.com/65911e9735540c235757642f/65fc8dcf9ffc6bc1a2d5fcb5_desktop%20(1).svg').show();\n  } else {\n    $(this).removeAttr('src').hide();\n  }\n});\n\nconst createdTime = chat.created_at;\nconst lastMessageTime = chat.messages[chat.messages.length - 1].created_at;\nconst amountOfMessages = chat.messages.filter(message => message.message_type === 'default_user').length;\n\nfunction prettifyDate(time) {\n  const date = new Date(time);\n  const today = new Date();\n  const yesterday = new Date();\n  yesterday.setDate(today.getDate() - 1);\n  const dayBeforeYesterday = new Date();\n  dayBeforeYesterday.setDate(today.getDate() - 2);\n  if (date.toDateString() === today.toDateString()) {\n    return 'Vandaag';\n  } else if (date.toDateString() === yesterday.toDateString()) {\n    return 'Gisteren';\n  } else if (date.toDateString() === dayBeforeYesterday.toDateString()) {\n    return 'Eergisteren';\n  } else {\n    return date.toLocaleDateString('nl-NL', { day: 'numeric', month: 'long', year: 'numeric' });\n  }\n}\n\n$('[w-el=\"inbox-sidebar-firstmessage\"]').text(prettifyDate(createdTime));\n$('[w-el=\"inbox-sidebar-lastmessage\"]').text(prettifyDate(lastMessageTime));\n$('[w-el=\"inbox-sidebar-totalmessages\"]').text(`${amountOfMessages} bericht${amountOfMessages === 1 ? '' : 'en'}`);\n\nsidebar.style.transform = 'translateX(20px)';\nsidebar.style.opacity = 0;\nsidebar.style.display = 'flex';\nsetTimeout(() => {\n  sidebar.style.transform = 'translateX(0)';\n  sidebar.style.opacity = 1;\n}, 10);\n"
            }
          ]
        }
      ]
    },
    {
      id: 'oDNFJxdMit3tdXlCLu1E',
      name: 'sync-xml-btn',
      visibility: { value: "return (r.get_datasources.data.find((item) => item.id === v.active_datasource).file_upload_status !== 'processing')" },
      events: [
        {
          id: '28a81cd1-589c-45a4-9c3e-898595a511ce',
          type: 'click',
          actions: [
            {
              id: '0c2aa812-33a4-4a2e-9b6b-e47ed8d2ffd9',
              type: 'run-function',
              function:
                'console.log("syncing productfeed")\n\nWized.requests.execute(\'sync_xml_productfeed\');\nr.get_datasources.data.find((item) => item.id === v.active_datasource).file_upload_status = \'processing\'\n\nconsole.log("calling global function")\nif (v.datasourcesRtSubSubscribed !== true) {\n  window.datasourcesRealtimeInit()\n}'
            }
          ]
        }
      ]
    },
    {
      id: 'oFmhG2pYcxRUFUVGuHxh',
      name: 'xml-form-btn',
      styles: { values: [{ id: '76ac7798-fb39-48c0-bd28-19d395654c8c', property: 'color', value: 'if (r.validate_xml.isRequesting) {\n  return "transparent"\n} else {\n  return "#fff"\n}' }] }
    },
    { id: 'p1p88z1tGvtboNWs0NU8', name: 'conversationstarters-list-item-key', value: { value: 'return v.chatbotConversationStarters[v.i].question' } },
    {
      id: 'p2mna1iwgBWZyZ2nI3EX',
      name: 'loadingwrap-sendfile',
      styles: {
        values: [
          {
            id: '9c5ca071-d342-4c21-b3d9-d15ffb1f4129',
            property: 'display',
            value: 'if (r.upsert_image_inbox_fullsize.isRequesting || r.upsert_image_inbox.isRequesting ) {\n  return "flex"\n} else {\n  return "none"\n}'
          }
        ]
      }
    },
    {
      id: 'pPNZb2SuZtrbxy3tvUfD',
      name: 'tool-output-logs-datasource-deleted',
      visibility: {
        value:
          "const dataType = r.get_outputlogs.data[v.i].data_type\n\n// return r.get_datasources_organization.data.find(entry => entry.id === r.get_outputlogs.data[0]?.datasource_id);\nconst datasource = r.get_datasources_organization.data.find(entry => entry.id === r.get_outputlogs.data[0]?.datasource_id);\n\nlet record\nif (dataType == 'kb') {\n  record = datasource?.kb_topics?.find(entry => entry.id === r.get_outputlogs.data[v.i]?.record_id);\n} else if (dataType == 'url') {\n  record = r.getall_scrape_pages.data?.find(entry => entry.id === r.get_outputlogs.data[v.i]?.record_id)\n}\n\nif (dataType == 'kb' || dataType == 'url') {\n  if (datasource && record) {\n    return false\n  } else {\n    return true\n  }\n} else {\n  if (datasource) {\n    return false\n  } else {\n    return true\n  }\n}"
      }
    },
    {
      id: 'pTA1uQyX2NqqyJ4UhfGK',
      name: 'message-type_file',
      visibility: { value: 'return (\n  v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n    .message_type == "file"\n);\n' },
      styles: {
        values: [
          {
            id: 'a9a952c7-9abe-452b-afb7-cf5f6ebe11fd',
            property: 'justify-content',
            value:
              "const message = v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n\nif (message.message_type == \"file\") {\n  if (message.author_type == 'agent') {\n    return 'end'\n  } else if (message.author_type == 'user') {\n    return 'start'\n  }\n}"
          }
        ]
      }
    },
    { id: 'phIkvFJI6VeakitAPcT5', name: 'send-file-upload-preview', visibility: { value: 'return (i["send-file-upload"]["0"] ? true : false)' } },
    {
      id: 'plZ0TyB2RW5YYqwdyJ0F',
      name: 'customfieds-list-add-btn',
      events: [
        {
          id: '132543d1-352f-4a37-acf8-1f89d924bb32',
          type: 'click',
          actions: [{ id: '753c8011-f9bd-49a6-9091-bc6145989428', type: 'run-function', function: "v.chatbotCustomFields.push({ 'key': '', 'updateChatName': '' });" }]
        }
      ]
    },
    {
      id: 'pmx6Em6fXmFNsoqO2Jgp',
      name: 'tool-output-logs-indicator-button-indicator',
      visibility: { value: "return (v.chats.find(chat => chat.id === v.active_chat).messages[v.i].outputlogs.type == 'usedTools')\n\n" }
    },
    {
      id: 'q0EGpHBdLA1gStCvPg7j',
      name: 'outputlogs-api-list-item-value',
      text: {
        value:
          'const toolOutput = r.get_outputlogs.data[0].tool_output[0];\nconst toolInput = JSON.parse(toolOutput).toolInput;\n\nconst keyValueArray = Object.entries(toolInput).map(([key, value]) => ({\n    property: key,\n    value: value\n}));\nreturn keyValueArray[v.i].value'
      }
    },
    {
      id: 'q31pFuI1Ev522NsqfjTT',
      name: 'emptystate-sidebar-customfieldslist',
      visibility: {
        value:
          'const customFields = v.chats.find(chat => chat.id === v.active_chat).custom_fields;\n\nconst customFieldsArray = Object.entries(customFields).map(([key, value]) => ({\n  key: key,\n  value: value\n}));\n\nreturn (customFieldsArray.length == 0)'
      }
    },
    {
      id: 'q3w6F5l1WK2Dl7g3VFeT',
      name: 'sendfile-btn',
      styles: {
        values: [
          {
            id: 'db99c7c4-78cd-426d-ab1b-14fa6b2d4c7c',
            property: 'color',
            value: 'if (!r.upsert_image_inbox_fullsize.isRequesting && !r.upsert_image_inbox.isRequesting) {\n  return "#fff"\n} else {\n  return \'transparent\'\n}'
          }
        ]
      }
    },
    {
      id: 'qZid0xCYFhMRtIxSNrOv',
      name: 'form-settings-inbox',
      form: {
        value:
          'return {\n  ai_tagging: r.get_chatbots.data.find(item => item.id == v.active_chatbot).tagging_enabled,\n  toggle_useruploading: r.get_chatbots.data.find(item => item.id == v.active_chatbot).fileuploads_user\n}'
      },
      events: [
        {
          id: '68b93559-66e2-4316-a592-764ddf00fca8',
          type: 'submit',
          preventDefault: true,
          actions: [{ id: '53703850-fe53-4241-95f8-5dc4facccf9a', type: 'perform-request', request: 'oLlbRjYCiYX6k2srVa87' }]
        }
      ]
    },
    {
      id: 'se72vMPcrdd6gstYvqhg',
      name: 'tool-output-logs-documents-datatype-wrap',
      visibility: {
        value:
          "const dataType = r.get_outputlogs.data[v.i].data_type\n\n// const chatbot = r.get_chatbots.data.find(entry => entry.id === r.get_outputlogs.data[v.i]?.chatbot_id);\n\nconst datasource = r.get_datasources_organization.data.find(entry => entry.id === r.get_outputlogs.data[0]?.datasource_id);\n\n// const record = datasource?.kb_topics?.find(entry => entry.id === r.get_outputlogs.data[v.i]?.record_id);\n\n\nif (dataType == 'kb' || dataType == 'url') {\n  if (datasource) {\n    return true\n  } else {\n    return false\n  }\n} else {\n  if (datasource) {\n    return true\n  } else {\n    return false\n  }\n}"
      }
    },
    {
      id: 'tE3KSDxLkGQmu008ohDB',
      name: 'btn-edit-tooloutput',
      visibility: {
        value:
          "const chatbot = r.get_chatbots.data.find(entry => entry.id === r.get_outputlogs.data[v.i]?.chatbot_id);\n\nconst datasource = r.get_datasources.data.find(entry => entry.id === r.get_outputlogs.data[0]?.datasource_id);\n\nconst record = datasource?.kb_topics?.find(entry => entry.id === r.get_outputlogs.data[v.i]?.record_id);\n\nconst dataType = r.get_outputlogs.data[v.i].data_type\n\nif (datasource && record) {\n  if (dataType == 'kb') return true\n} else {\n  return false\n}\n\n"
      },
      attributes: {
        values: [
          { id: '8d2929cc-c46b-4177-b1c5-208ec91f999f', key: 'record_id', value: 'return r.get_outputlogs.data[v.i].record_id' },
          { id: '739eb8cb-4a35-4a28-9a0d-38b3e764ed14', key: 'datasource_id', value: 'return r.get_outputlogs.data[v.i].datasource_id' }
        ]
      },
      events: [
        {
          id: '50c42a9c-2e2a-41f7-993a-b3dd7302387b',
          type: 'click',
          hasCondition: true,
          condition: 'return (r.get_outputlogs.data[v.i].data_type == "kb")',
          actions: [
            {
              id: '5b0afcd8-e11e-4ca3-88af-1fb86bbc386d',
              type: 'run-function',
              function:
                "const logKbTopic = event.currentTarget.getAttribute(\"record_id\");\nconst kigDatasource = event.currentTarget.getAttribute(\"datasource_id\");\n\nv.active_kb_topic = logKbTopic; \nv.active_datasource = kigDatasource; \n\nconst editTopicContainer = document.querySelector(\"[w-el='edit-topic-container']\");\n\neditTopicContainer.style.transform = 'translateX(20px)';\neditTopicContainer.style.opacity = 0;\neditTopicContainer.style.display = 'flex';\nsetTimeout(() => {\n  editTopicContainer.style.transform = 'translateX(0)';\n  editTopicContainer.style.opacity = 1;\n}, 50);"
            }
          ]
        }
      ]
    },
    {
      id: 'tzSiqbdjY5U9enhGRhaC',
      name: 'sidebar-customfields-listitem',
      list: {
        indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72',
        value: 'const customFields = v.chats.find(chat => chat.id === v.active_chat).custom_fields;\n\nreturn Object.entries(customFields).map(([key, value]) => ({\n  key: key,\n  value: value\n}));'
      }
    },
    {
      id: 'vObdruT5EdqdGqa8m6hl',
      name: 'activityfeedlist-pagevisit-url',
      visibility: { value: 'return (v.mergedEvents[v.i].event_config.url ? true : false)' },
      text: { value: 'if (v.mergedEvents[v.i].event_config.url) return (v.mergedEvents[v.i].event_config.url)' }
    },
    {
      id: 'vfdqj3ovx1wNiE4ZkRUq',
      name: 'copy-child-value',
      events: [
        {
          id: 'e0ed38bd-2c13-48a6-9eb1-f3a0d150db41',
          type: 'click',
          actions: [
            {
              id: '3b3f8b6e-c710-4e93-b1dc-4241a150ed3f',
              type: 'run-function',
              function:
                'const targetElement = event.target.closest(\'[w-el="copy-child-value"]\');\nconst childElement = targetElement.querySelector(\'[child-value]\');\n\nif (childElement) {\n    const textToCopy = childElement.textContent.trim();\n    navigator.clipboard.writeText(textToCopy).then(() => {\n      window.showToastNotification("Gekopieerd", "success");\n    }).catch(err => {\n      console.error(\'Failed to copy text:\', err);\n    });\n}\n'
            }
          ]
        }
      ]
    },
    { id: 'wHqMhg5Y0LyuSteZJqB4', name: 'send-file-preview-name', text: { value: 'return i["send-file-upload"]["0"].name' } },
    {
      id: 'xTGAAMqUX5bK5P4eEZuC',
      name: 'listitem-maualtags',
      list: { indexVariable: '73e1527e-2e47-4aea-b609-6d5c4d232c72', value: 'return v.filteredTags' },
      classes: { values: [{ id: 'c1e79ecf-8153-407a-bd68-21e5cc8944cd', class: 'selected', condition: 'const tag = rv.filteredTags[v.i].tag\n\nreturn v.chatTags.some(item => item.tag === tag)' }] },
      attributes: { values: [{ id: 'a468859f-8e0d-480b-9d38-772ea97ffff2', key: 'tag', value: 'return v.filteredTags[v.i].tag' }] },
      events: [
        {
          id: '214adb74-19f0-4ad3-bb4e-22fff8866268',
          type: 'click',
          actions: [
            {
              id: 'e5cedc0f-5b9b-40b0-8564-6dfc4041250c',
              type: 'run-function',
              function:
                "const clickedTag = event.currentTarget.getAttribute('tag');\n\nif (!v.chatTags.some(item => item.tag === clickedTag)) {\n\n  const oldTags = v.chatTags;\n  v.newChatTags = [...oldTags, { tag: clickedTag }];\n\n  Wized.requests.execute('update_chat_updatetags');\n  await Wized.requests.waitFor('update_chat_updatetags');\n\n} else {\n  \n  const oldTags = v.chatTags\n  v.newChatTags = oldTags.filter(item => item.tag !== clickedTag);\n\n  Wized.requests.execute('update_chat_updatetags');\n  await Wized.requests.waitFor('update_chat_updatetags');\n  \n  \n}"
            }
          ]
        }
      ]
    },
    { id: 'yUBEagx4yelzbsX5KaVZ', name: 'activityfeed-loadmore-count', text: { value: 'const totalCount = v.mergedEvents.length\nif (totalCount > 5) { \n  return totalCount - 5\n}' } },
    {
      id: 'yna3QFYqUqn8i7s5KfeH',
      name: 'create-btn-conversationstarters',
      events: [
        {
          id: '556744eb-2ff1-4834-9e71-78863ac9c7d8',
          type: 'click',
          actions: [{ id: 'e4580255-b47a-438a-93cd-3cd54777176a', type: 'run-function', function: 'v.chatbotConversationStarters.push({ question: "", answer: "" });' }]
        }
      ]
    },
    {
      id: 'zKMRBuoBbIUyaN0mloR8',
      name: 'tool-output-logs-list-datatype-icon',
      attributes: {
        values: [
          {
            id: 'ebfdb62b-0a0a-4925-b759-fd235afe4b0c',
            key: 'src',
            value:
              "const dataType = r.get_outputlogs.data[v.i].data_type\n\nif (dataType == 'kb') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc1cd277ec15f33fdc7b3_file-info-alt.svg'\n} else if (dataType == 'csv') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bbc226b395d689963bd587_database.svg'\n} else if (dataType === 'pdf2' || dataType === 'pdf2') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/67239dd4e768c478e10fb6b4_file%20(1).svg'\n} else if (dataType == 'url') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7e4473d4ee68c12db_link-h.svg'\n} else if (dataType == 'api') {\n    return 'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65bcc7d7ac7247ea9e3f5e3f_code-branch.svg'\n} else if (dataType == 'xml') {\n    return 'https://cdn.prod.website-files.com/65911e9735540c235757642f/674ffdb4a11fe59e8f7655db_Untitled%20design%20-%202024-12-04T075853.568.png'\n}"
          }
        ]
      }
    },
    {
      id: 'zbJWswr0eUJkbZ7e7KjD',
      name: 'toggle_customfields_override_label_emal',
      attributes: {
        values: [
          { id: '92068b11-24f8-45e0-8746-821e6345c7fb', key: 'for', value: "return 'customfields_toggle_overrideemail_' + v.i" },
          { id: '1edb6d29-e75f-4010-86c0-b4b395c6cc18', key: 'index', value: 'return v.i' }
        ]
      },
      events: [
        {
          id: 'd422e8f9-0586-4a64-a59b-fab72ecedd49',
          type: 'click',
          preventDefault: true,
          actions: [
            {
              id: '60e057c0-f484-4966-b8d0-a4fd01220005',
              type: 'run-function',
              function:
                'const allCheckboxes = document.querySelectorAll(\'[w-el="toggle_customfields_override_emal"]\');\n\nconst currentIndex = parseInt(event.currentTarget.getAttribute(\'index\'), 10);\n\nallCheckboxes.forEach((checkbox, index) => {\n  // checkbox.checked = index === currentIndex;\n  i.toggle_customfields_override_emal[index] = index === currentIndex;\n});\n\nconst customfieldsArray = [];\n\n// update variable before deleting to prevent losing manually added data\ndocument.querySelectorAll("[w-el=custom-fields-lit-item]").forEach((item, index) => {\n  const key = i["custom-fields-list-item-input"][index];\n  const updateChatName = i.toggle_customfields_override_checkbox[index];\n  const updateEmail = i.toggle_customfields_override_emal[index];\n  console.log(`updatechatname ${index} = `, updateChatName);\n  console.log(`updateemailname ${index} = `, updateEmail);\n  console.log(`fieldname ${index} = `, key);\n  customfieldsArray.push({\n    key,\n    updateChatName,\n    updateEmail\n  });\n});\n\nv.chatbotCustomFields = customfieldsArray;'
            }
          ]
        }
      ]
    },
    {
      id: 'zdXqoud9XHQY5wzAtCVU',
      name: 'filepreview-donload-btn',
      events: [
        {
          id: '8464098e-abc1-4c70-8765-a94c13868325',
          type: 'click',
          actions: [
            {
              id: 'f9c58d01-0604-4018-bf75-953b54478d2b',
              type: 'run-function',
              function:
                "const message = v.chats.find((chat) => chat.id === v.active_chat).messages[v.i]\n\nif (message.message_type == \"file\") {\n  const downloadFile = async (url, filename) => {\n    try {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`HTTP error! Status: ${response.status}`);\n      }\n\n      const blob = await response.blob();\n      const link = document.createElement('a');\n      link.href = URL.createObjectURL(blob);\n      link.download = filename;\n      document.body.appendChild(link);\n      link.click();\n      link.remove();\n    } catch (error) {\n      console.error('Error downloading file:', error);\n    }\n  };\n\n  const fileUrl = message.file_path;\n  const fileName = message.message_type_data.file_name;\n  downloadFile(fileUrl, fileName);\n\n}"
            }
          ]
        }
      ]
    }
  ],
  events: [
    {
      id: '07531a64-b9ce-43a5-9d2b-e36ebcdc1dad',
      name: 'Integrations | navigation',
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b',
      trigger: 'page-loading',
      hasCondition: true,
      condition: 'return (n.path.includes("integraties"))',
      actions: [
        {
          id: 'c7c53ef6-2385-4628-89ea-69afaf73171d',
          type: 'run-function',
          function:
            'function changeTabs() {\n  // Define all your tab elements\n  const installatie = document.querySelector("[settings-tab=\'installatie\']");\n  const gtm = document.querySelector("[settings-tab=\'gtm\']");\n  const webhooks = document.querySelector("[settings-tab=\'webhooks\']");\n  const customFields = document.querySelector("[settings-tab=\'custom-fields\']");\n\n  window.updateSettingsDisplay = function (activeTab) {\n    const tabElements = {\n      installatie: installatie,\n      gtm: gtm,\n      webhooks: webhooks,\n      "custom-fields": customFields\n    };\n\n    // console.log(\'tabElements: \', tabElements);\n\n    // Hide all elements\n    Object.values(tabElements).forEach((el) => {\n      if (el) el.style.display = "none";\n    });\n\n    // Show the active element\n    const activeElement = tabElements[activeTab];\n    if (activeElement) activeElement.style.display = "block";\n  };\n\n  // Update display with the initial tab\n  window.updateSettingsDisplay(v.active_integrations_tab);\n}\n\nfunction settingsTabClickEventListeners() {\n  window.Wized = window.Wized || [];\n  window.Wized.push((Wized) => {\n    const settingsTabItems = document.querySelectorAll("[w-el=\'settings-tab\']");\n\n    settingsTabItems.forEach((item) => {\n      item.addEventListener("click", (event) => {\n        settingsTabItems.forEach((tab) => tab.classList.remove("active"));\n        const clickedItem = event.currentTarget;\n        clickedItem.classList.add("active");\n        const dataValue = clickedItem.getAttribute("data-value");\n        Wized.data.v.active_integrations_tab = dataValue;\n        // console.log(\'datavalue: \', dataValue);\n\n        // Call updateSettingsDisplay to reflect the change\n        window.updateSettingsDisplay(Wized.data.v.active_integrations_tab);\n      });\n    });\n  });\n}\n\nsettingsTabClickEventListeners();\nchangeTabs();\n'
        }
      ]
    },
    {
      request: '8cc144e4-b421-46f5-a9e7-ee3f00940a07',
      condition: 'return (n.path.includes("instellingen"))',
      name: 'multi-select inputs',
      id: '07a8a5bc-7ebe-49cf-a227-ece1a3ce67a5',
      trigger: 'after-request',
      hasCondition: true,
      folderId: '9eeb505e-1b3e-4d9f-8c6b-b740062d49fd',
      actions: [
        {
          id: '713a7a38-f26b-462a-9d27-a44d14a2fc8a',
          type: 'run-function',
          function:
            'setTimeout(() => {\n\n  // widget_styling.widget_header\n\n  const checkboxes = document.querySelectorAll("[multi-select=\'widget_header\']");\n  var hiddenInput = document.querySelector(\n    "[multi-select-input=\'widget_header\']"\n  );\n\n  var dbValue = r.get_chatbot.data.widget_styling.widget_header;\n\n  checkboxes.forEach(function (checkbox) {\n    if (checkbox.getAttribute("data-value") === dbValue) {\n      checkbox.classList.add("selected");\n    }\n    hiddenInput.value = dbValue;\n  });\n\n  checkboxes.forEach(function (checkbox) {\n    checkbox.addEventListener("click", function () {\n      checkboxes.forEach(function (option) {\n        option.classList.remove("selected");\n      });\n      checkbox.classList.add("selected");\n      hiddenInput.value = checkbox.getAttribute("data-value");\n    });\n  });\n\n}, 1000);'
        },
        {
          id: 'c3374467-945e-47d4-b45a-3d03b42193b9',
          type: 'run-function',
          function:
            'setTimeout(() => {\n\n  // widget_styling.user_message_primary_color\n\n  const checkboxes = document.querySelectorAll("[multi-select=\'user_message\']");\n  var hiddenInput = document.querySelector("[multi-select-input=\'user_message\']");\n\n  var dbValue = r.get_chatbot.data.widget_styling.user_message_primary_color;\n\n  checkboxes.forEach(function (checkbox) {\n    if (checkbox.getAttribute("data-value") === dbValue) {\n      checkbox.classList.add("selected");\n    }\n    hiddenInput.value = dbValue;\n  });\n\n  checkboxes.forEach(function (checkbox) {\n    checkbox.addEventListener("click", function () {\n      checkboxes.forEach(function (option) {\n        option.classList.remove("selected");\n      });\n      checkbox.classList.add("selected");\n      hiddenInput.value = checkbox.getAttribute("data-value");\n    });\n  });\n\n}, 1000);'
        },
        {
          id: '262c4585-b6e9-4ee0-946f-29e441f218f6',
          type: 'run-function',
          function:
            'setTimeout(() => {\n\n  // widget_styling.widget_border\n\n  const checkboxes = document.querySelectorAll("[multi-select=\'widget_border\']");\n  var hiddenInput = document.querySelector("[multi-select-input=\'widget_border\']");\n\n  var dbValue = r.get_chatbot.data.widget_styling.widget_border;\n\n  checkboxes.forEach(function (checkbox) {\n    if (checkbox.getAttribute("data-value") === dbValue) {\n      checkbox.classList.add("selected");\n    }\n    hiddenInput.value = dbValue;\n  });\n\n  checkboxes.forEach(function (checkbox) {\n    checkbox.addEventListener("click", function () {\n      checkboxes.forEach(function (option) {\n        option.classList.remove("selected");\n      });\n      checkbox.classList.add("selected");\n      hiddenInput.value = checkbox.getAttribute("data-value");\n    });\n  });\n\n}, 1000);'
        },
        {
          id: '1ad00f48-7ad2-466e-a9b5-0bac44d531c2',
          type: 'run-function',
          function:
            'setTimeout(() => {\n    // human_handoff.type\n\n    const checkboxes = document.querySelectorAll(\n      "[multi-select=\'human_handoff_type\']"\n    );\n    var hiddenInput = document.querySelector(\n      "[multi-select-input=\'human_handoff_type\']"\n    );\n\n    var dbValue = r.get_chatbot.data.human_handoff.type;\n    hiddenInput.value = dbValue;\n    i["input-handoff-external"] = dbValue;\n\n    checkboxes.forEach(function (checkbox) {\n      if (checkbox.getAttribute("data-value") === dbValue) {\n        checkbox.classList.add("selected");\n      }\n    });\n\n    checkboxes.forEach(function (checkbox) {\n      checkbox.addEventListener("click", function () {\n        checkboxes.forEach(function (option) {\n          option.classList.remove("selected");\n        });\n        checkbox.classList.add("selected");\n        hiddenInput.value = checkbox.getAttribute("data-value");\n        i["input-handoff-external"] = checkbox.getAttribute("data-value");\n      });\n    });\n  }, 2000);'
        },
        {
          id: 'f1d751e9-b970-4d81-84f5-ee44bcca20de',
          type: 'run-function',
          function:
            'setTimeout(() => {\n    // language\n\n    const checkboxes = document.querySelectorAll(\n      "[multi-select=\'language\']"\n    );\n    var hiddenInput = document.querySelector("[multi-select-input=\'language\']");\n\n    var dbValue = r.get_chatbot.data.language;\n\n    checkboxes.forEach(function (checkbox) {\n      if (checkbox.getAttribute("data-value") === dbValue) {\n        checkbox.classList.add("active");\n      }\n      hiddenInput.value = dbValue;\n    });\n\n    checkboxes.forEach(function (checkbox) {\n      checkbox.addEventListener("click", function () {\n        checkboxes.forEach(function (option) {\n          option.classList.remove("active");\n        });\n        checkbox.classList.add("active");\n        hiddenInput.value = checkbox.getAttribute("data-value");\n        console.log("value", checkbox.getAttribute("data-value"));\n        i["input-language"] = checkbox.getAttribute("data-value");\n        console.log("value", i["input-language"])\n      });\n    });\n  }, 1000);'
        }
      ]
    },
    {
      condition: 'return (n.path.includes("/testomgeving") && v.active_chatbot !== null)\n',
      name: 'render testomgeving',
      id: '0855e0e8-0cb9-4136-ac0b-7b43ad5edd63',
      trigger: 'page-loading',
      hasCondition: true,
      actions: [
        {
          id: 'c83857b3-50f5-43ff-867d-c7a2df498e2c',
          type: 'run-function',
          function:
            'function createCookie() {\n  visitorId = crypto.randomUUID();\n  Cookies.set(cookieKey, visitorId, {\n    expires: 365,\n    sameSite: "None",\n    secure: true,\n  });\n  console.log("new cookie = ", visitorId);\n}\n\nconst pageUrl = window.location.href;\nlet baseUrl;\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  baseUrl = "https://widget.sleak.chat";\n} else {\n  baseUrl = "https://staging.sleak.chat";\n}\n\nconst activeChatbot = v.active_chatbot;\n\nconst cookieKey = "sleakVisitorId_admin_" + activeChatbot;\nconsole.log("cookieKey = ", cookieKey);\n\nconst cookie = Cookies.get(cookieKey);\n\nlet visitorId;\n\nif (cookie) {\n  console.log("cookie exists, value = ", cookie);\n  visitorId = cookie;\n} else {\n  console.log("cookie does not exist");\n  createCookie();\n}\n\nconst sleakIframe = document.querySelector("[w-el=\'sleak-ui-iframe\']");\nasync function renderWidget() {\n  const iframeSource = `${baseUrl}/${activeChatbot}/?id=${visitorId}&placement=admin`;\n  sleakIframe.src = iframeSource;\n}\nrenderWidget();\n\n// reset chat\n\nconst resetBtn = document.querySelector("[w-el=\'training-reset-chat\']");\n\nconst testOmgevingSkeleton = document.querySelector(\n  "[w-el=\'testomgeving-skeleton\']"\n);\n\nresetBtn.addEventListener("click", () => {\n  // testOmgevingSkeleton.style.display = "flex";\n  // sleakIframe.style.display = "none";\n  Cookies.set(cookieKey, visitorId, {\n    expires: 365,\n    sameSite: "None",\n    secure: true,\n  });\n  createCookie();\n  renderWidget();\n});\n'
        }
      ]
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      name: 'create users, organizations if not existing',
      id: '09506d63-4fe6-44f4-8800-e80813bb5cb7',
      trigger: 'after-request',
      folderId: '9604a1d7-0df8-496f-b4b4-8f0975084ef1',
      actions: [
        {
          id: 'bab973fa-ca9d-462e-9bf9-e28f0f3673e1',
          type: 'run-function',
          condition: 'return (r.get_user_data.data[0].organizations.length == 0);\n',
          function:
            "Wized.requests.execute('create_organization');\nawait Wized.requests.waitFor('create_organization');\nif (r.create_organization.ok == true) {\n\n  Wized.requests.execute('create_organization_member');\n  await Wized.requests.waitFor('create_organization_member');\n  if (r.create_organization_member.ok == true) {\n\n    Wized.requests.execute('get_user_data');\n\n  }\n}",
          hasCondition: true
        }
      ]
    },
    {
      id: '0f8ee86d-bc89-4801-b600-e84df88da149',
      name: 'set active chat on page load',
      folderId: '8339c00a-50de-4a25-99f6-68a9f4835506',
      trigger: 'after-request',
      request: 'fefe687b-b6dd-4efc-af07-f5b4c1810457',
      hasCondition: true,
      condition: 'return (n.path == "/chat-inbox")',
      actions: [
        {
          id: 'c19a2eb4-2fab-4091-bc39-98660186af95',
          type: 'run-function',
          function:
            '// Set active chat to most recent chat\nv.active_chat = v.chats[0].id;\n\n// if livechat is false, disable input\nif (v.chats.find((chat) => chat.id === v.active_chat).livechat == false) {\n    document.querySelector(\'[w-el="admin-ui-chat-input"]\').setAttribute(\'readonly\', true);\n}\n\nlet skeletonElement = document.querySelector("[w-el=\'skeleton-inbox-initial\']");\nif (skeletonElement.style.display !== "none") {\n    skeletonElement.style.display = "none";\n}\n'
        }
      ]
    },
    {
      id: '109e1281-e5cf-4399-827f-5a2d698ced86',
      name: 'access control',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      trigger: 'page-loading',
      actions: [
        {
          id: '9e870a01-425e-4be2-bf45-407aa7cfa529',
          type: 'run-function',
          function:
            "window.Wized = window.Wized || [];\nwindow.Wized.push(Wized => {\n  console.log('ðŸŸ¢ executing access control function');\n\n  let retryCount;\n\n  const preloader = document.querySelector(\"[w-el='preloader']\");\n\n  function retryGetUser() {\n    const rawRetryCount = localStorage.getItem('retryCount');\n    retryCount = parseInt(rawRetryCount);\n    console.log('ðŸŸ¢ retryGetUser - retryCount = ', retryCount);\n\n    if (retryCount < 4) {\n      console.log('ðŸŸ¢ hard refresh in 10000');\n      retryCount++;\n      localStorage.setItem('retryCount', retryCount);\n      setTimeout(() => {\n        // Wized.requests.execute('get_user');\n        window.location.reload();\n      }, 10000);\n    } else {\n      console.log('ðŸŸ¢ retried thrice');\n      if (n.path !== '/signup' && n.path !== '/login' && n.path !== '/resetpassword' && n.path !== '/payment-success' && n.path !== '/redirect') {\n        console.log('ðŸŸ¢ now redirectiong ( commented out ATM )');\n      }\n    }\n  }\n\n  function isRequestMade(partialEndpoint) {\n    const resources = performance.getEntriesByType('resource');\n    return resources.some(resource => resource.name.includes(partialEndpoint));\n  }\n\n  Wized.on('request', result => {\n    if (result.name === 'get_user') {\n      console.log('ðŸŸ¢ auth request result = ', result);\n\n      setTimeout(() => {\n        console.log('rest exists = ', isRequestMade('https://embed.wized.com/v2/rest-'));\n      }, 5000);\n\n      if (result.ok === true) {\n        console.log('ðŸŸ¢ auth request request == ok = ', result);\n        if (localStorage.getItem('sleak_loggedin') === 'false' || localStorage.getItem('sleak_loggedin') === null) {\n          localStorage.setItem('sleak_loggedin', 'true');\n          setTimeout(() => {\n            preloader.style.display = 'none';\n            console.log('hide element');\n          }, 2000);\n        }\n        retryCount = 0;\n        localStorage.removeItem('retryCount');\n        if (n.path == '/signup' || n.path == '/login') {\n          localStorage.setItem('sleak_loggedin', 'true');\n          n.path = '/';\n        }\n      } else {\n        console.log('ðŸŸ¢ auth request request == not ok = ', result);\n\n        const succesfulInit = isRequestMade('https://embed.wized.com/v2/rest-H2IHDFDC.js');\n        console.log('ðŸŸ¢ rest exists in network = ', succesfulInit);\n        if (succesfulInit) {\n          console.log('ðŸŸ¢ rediredcting to /login [ commented out ] ');\n          // n.path = \"/loigin\"\n        } else {\n          retryGetUser();\n        }\n      }\n    }\n  });\n});\n"
        }
      ]
    },
    {
      request: 'ac8cdd98-98da-45f1-9556-6e3e1cd38837',
      name: 'agents click events',
      trigger: 'after-request',
      id: '151903ae-f8dd-4f98-b56f-315a31939289',
      folderId: 'f2d1f791-109f-4ba0-8d6e-78a76539eb5e',
      actions: [
        {
          id: '848f175c-eab6-4d3d-b4f9-fc96fcd77433',
          type: 'run-function',
          function:
            'v.active_agent = r.get_agents.data[0];\n\nwindow.Wized = window.Wized || [];\nwindow.Wized.push((Wized) => {\n  const agentItems = document.querySelectorAll("[w-el=\'agents-list-item\']");\n\n  agentItems.forEach((item) => {\n    item.addEventListener("click", (event) => {\n      const dataValue = event.currentTarget.getAttribute("id");\n\n      Wized.data.v.active_agent = r.get_agents.data.find(\n        (agent) => agent.id === dataValue\n      );\n    });\n  });\n});'
        }
      ]
    },
    {
      name: 'global showToastNotification function',
      id: '1cdfd897-024d-45d6-96ab-7ba95261339b',
      trigger: 'page-loading',
      actions: [
        {
          id: 'c45c1375-1991-44e8-ba60-edc83b6dee81',
          type: 'run-function',
          function:
            '// transitions\n\nfunction openToast(toastElement) {\n  toastElement.style.display = "flex";\n  toastElement.style.opacity = 0;\n  toastElement.style.transform = "translateY(40px) scale(0.6)";\n\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 1;\n      toastElement.style.transform = "translateY(0) scale(1)";\n    });\n  });\n}\n\nfunction closeToast(toastElement) {\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 0;\n      toastElement.style.transform = "translateY(40px) scale(0.6)";\n      setTimeout(() => {\n        toastElement.style.display = "none";\n      }, 150);\n    });\n  });\n}\n\nasync function manageToast(toastElement) {\n  openToast(toastElement);\n  await new Promise((resolve) => setTimeout(resolve, 5000));\n  closeToast(toastElement);\n}\n\n// toast notifications\n\nwindow.showToastNotification = async function(message, type) {\n  const toastMessage = {\n    id: crypto.randomUUID(),\n    expiration: new Date().getTime() + 5000,\n    type: type,\n    message: message,\n  };\n\n  v.toast_log.push(toastMessage);\n\n  const toastElement = document.querySelector(\n    `[toast_item_id=\'${toastMessage.id}\']`\n  );\n\n  manageToast(toastElement);\n}'
        }
      ]
    },
    {
      id: '2c6c2440-5038-44a4-8505-9adb4eacc937',
      name: 'redirect to checkout url [DEPR]',
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a',
      trigger: 'after-request',
      request: 'ad7fd706-ec0e-4f2c-972b-c7d42a014bfb',
      actions: [
        {
          id: '5a4a0fbb-0223-4d04-9781-b826243aa33f',
          type: 'navigate-to',
          url: 'return r.create_checkout_session.data.checkout_url',
          openInNewTab: true,
          hasCondition: true,
          condition: '// return (r.create_checkout_session.data.checkout_url !== null)\nreturn false'
        },
        {
          id: '07a661fd-74dc-4eb6-91dc-50030280342d',
          type: 'run-function',
          function: "const redirectUrl = r.create_checkout_session.data.checkout_url;\nconsole.log(redirectUrl);\nwindow.open(redirectUrl, '_blank', 'noopener,noreferrer');",
          hasCondition: true,
          condition: 'return false'
        }
      ]
    },
    {
      id: '33ee7d2f-b91e-4ad1-a48a-93d254295ec6',
      name: 'redirect on auth',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      trigger: 'after-request',
      request: '8403ef0c-56ca-46b6-acb6-99ad469be5de',
      actions: [
        {
          id: '7f04a8dc-e356-4e42-952c-ec950c2b6d3d',
          type: 'navigate-to',
          url: "if (window.innerWidth <= 768) {\n  return '/chat-inbox'\n} else {\n  return '/'\n}",
          hasCondition: true,
          condition: "return (!n.path.includes('/redirect') && r.auth_user.ok == true)"
        },
        {
          id: '9f297f61-21d8-4858-976b-95072bc20c08',
          type: 'run-function',
          function:
            "const signupButton = document.querySelector('[multi-step-signup=\"button\"]');\nconst spinner = document.querySelector('[spinner=\"auth\"]');\n\nspinner.style.display = 'none';\nsignupButton.setAttribute('value', 'Inloggen');",
          hasCondition: true,
          condition: 'return (r.auth_user.ok !== true)'
        }
      ]
    },
    {
      id: '44db1bd3-b228-4b97-b1a7-b325b1d908e5',
      name: 'after get_datasources',
      folderId: '55214649-2bac-4398-a861-03d94d2aad9d',
      trigger: 'after-request',
      request: '9d139b25-dc47-41e5-8bfd-f09ec49d71da',
      hasCondition: true,
      condition: 'return n.path.includes("/kennis")',
      actions: [
        {
          id: '9cd9c164-fd10-4e7b-9ac2-62c0a6d07c50',
          type: 'run-function',
          function:
            "document.querySelector(\"[w-el='datasources-skeleton-wrapper']\").style.display = 'none';\n\nif (!v.active_datasource) {\n  // for first item\n  v.active_datasource = r.get_datasources.data[0].id;\n}\n\n// Element visibility\nconst editDatasourcesForms = document.querySelectorAll('[wized-cloak]');\n\nconst pdfForm = document.querySelector(\"[w-el='form-container-edit-pdf']\");\nconst csvForm = document.querySelector(\"[w-el='form-container-edit-csv']\");\nconst urlForm = document.querySelector(\"[w-el='form-container-edit-url']\");\nconst apiForm = document.querySelector(\"[w-el='form-container-edit-api']\");\nconst pdf2Form = document.querySelector(\"[w-el='form-container-edit-pdf2']\");\nconst xmlForm = document.querySelector(\"[w-el='form-container-edit-xml']\");\n\neditDatasourcesForms.forEach(item => {\n  item.style.visibility = 'visible !important';\n  item.style.display = 'flex !important';\n  item.removeAttribute('wized-cloak');\n});\n\n// document.querySelector(\"[w-el='datasources-skeleton-wrapper']\").style.display = \"none\";\n\nconst activeType = r.get_datasources.data.find(item => item.id === v.active_datasource)?.data_type || r.get_datasources.data[0].data_type;\n\nif (activeType === 'pdf') {\n  pdfForm.style.display = 'flex';\n} else if (activeType === 'csv') {\n  csvForm.style.display = 'flex';\n} else if (activeType === 'pdf2') {\n  pdf2Form.style.display = 'flex';\n} else if (activeType === 'xml') {\n  xmlForm.style.display = 'flex'\n} else if (activeType === 'url') {\n  Wized.requests.execute('get_scrape_pages');\n  const checkboxes = document.querySelectorAll('input[w-el=\"scrape-list-checkbox\"], input[w-el=\"scrape-list-checkbox-wildcard\"]');\n  checkboxes.forEach(checkbox => {\n      checkbox.checked = false;\n  });\n  document.querySelector('[w-el=\"scrape-addurl-controls\"]').style.display = 'flex';\n  lastChecked = null;\n  await Wized.requests.waitFor(\"get_scrape_pages\");\n  urlForm.style.display = \"flex\";\n\n} else if (activeType === 'api') {\n  apiForm.style.display = 'flex';\n\n  // headers, properties lists\n  var activedataSource = r.get_datasources.data.find(item => item.id === v.active_datasource);\n  v.apiPropertiesArrayII = activedataSource.datasource_type_config.properties;\n\n  var activedataSource = r.get_datasources.data.find(item => item.id === v.active_datasource);\n  var headersObject = activedataSource.datasource_type_config.headers;\n\n  var headersArray = Object.keys(headersObject).map(key => {\n    return { key: key, value: headersObject[key] };\n  });\n\n  v.apiHeadersArray = headersArray;\n  // multi-select boxes\n\n  // datasource_type_config.method\n  const checkboxesApi = document.querySelectorAll(\"[multi-select='api_method']\");\n  var hiddenInputMethod = document.querySelector(\"[multi-select-input='api_method']\");\n\n  var dbValue = r.get_datasources.data.find(item => item.id === v.active_datasource).datasource_type_config.method;\n\n  checkboxesApi.forEach(function (checkbox) {\n    if (checkbox.getAttribute('data-value') === dbValue) {\n      checkbox.classList.add('selected');\n    }\n    hiddenInputMethod.value = dbValue;\n    $('[w-el=\"api-form-active-method\"]').text(dbValue);\n  });\n\n  checkboxesApi.forEach(function (checkbox) {\n    checkbox.addEventListener('click', function () {\n      checkboxesApi.forEach(function (option) {\n        option.classList.remove('selected');\n      });\n      checkbox.classList.add('selected');\n\n      var newValueCheckboxMethod = checkbox.getAttribute('data-value');\n      hiddenInputMethod.value = newValueCheckboxMethod;\n      $('[w-el=\"api-form-active-method\"]').text(newValueCheckboxMethod);\n    });\n  });\n\n  //\n\n  // datasource_type_config.protocol\n  const checkboxesProtocol = document.querySelectorAll('[multi-select=\"api_authprotocol\"]');\n  var hiddenInputProtocol = document.querySelector('[multi-select-input=\"api_authprotocol\"]');\n\n  var dbValue = r.get_datasources.data.find(item => item.id === v.active_datasource).datasource_type_config.protocol;\n\n  checkboxesProtocol.forEach(function (checkbox) {\n    if (checkbox.getAttribute('data-value') === dbValue) {\n      checkbox.classList.add('selected');\n    }\n    hiddenInputProtocol.value = dbValue;\n    i['input-api_authprotocol'] = dbValue;\n    $('[w-el=\"api-form-active-authprotocol\"]').text(dbValue);\n  });\n\n  checkboxesProtocol.forEach(function (checkbox) {\n    checkbox.addEventListener('click', function () {\n      checkboxesProtocol.forEach(function (option) {\n        option.classList.remove('selected');\n      });\n      checkbox.classList.add('selected');\n\n      var newValueProtocol = checkbox.getAttribute('data-value');\n      hiddenInputProtocol.value = newValueProtocol;\n      i['input-api_authprotocol'] = newValueProtocol;\n      $('[w-el=\"api-form-active-authprotocol\"]').text(newValueProtocol);\n    });\n  });\n\n  //\n\n  // datasource_type_config.bodyType\n  const checkboxesBodytype = document.querySelectorAll(\"[multi-select='api_body_type']\");\n  var hiddenInputBodytype = document.querySelector(\"[multi-select-input='api_body_type']\");\n\n  var dbValue = r.get_datasources.data.find(item => item.id === v.active_datasource).datasource_type_config.bodyType;\n\n  checkboxesBodytype.forEach(function (checkbox) {\n    if (checkbox.getAttribute('data-value') === dbValue) {\n      checkbox.classList.add('selected');\n    }\n    hiddenInputBodytype.value = dbValue;\n    i['input-api_body_type'] = dbValue;\n    $('[w-el=\"api-form-active-bodytype\"]').text(dbValue);\n  });\n\n  checkboxesBodytype.forEach(function (checkbox) {\n    checkbox.addEventListener('click', function () {\n      checkboxesBodytype.forEach(function (option) {\n        option.classList.remove('selected');\n      });\n      checkbox.classList.add('selected');\n\n      var newValueBodyType = checkbox.getAttribute('data-value');\n      hiddenInputBodytype.value = newValueBodyType;\n      i['input-api_body_type'] = newValueBodyType;\n      $('[w-el=\"api-form-active-bodytype\"]').text(newValueBodyType);\n    });\n  });\n\n  // text-editor\n  // outputScheme code-editor\n\n  let textarea = document.getElementById('code-editor');\n  let codeMirrorInstance;\n  let validModal = document.querySelector(\"[w-el='modal-valid-json']\");\n  let invalidModal = document.querySelector(\"[w-el='modal-invalid-json']\");\n\n  function isValidJsonObject(value) {\n    try {\n      const parsed = JSON.parse(value);\n      return !!parsed && typeof parsed === 'object' && !Array.isArray(parsed);\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function objectIsValid() {\n    validModal.style.display = 'flex';\n    invalidModal.style.display = 'none';\n    v.outputSchemaObjectIsValid = true;\n  }\n\n  function objectIsInvalid() {\n    validModal.style.display = 'none';\n    invalidModal.style.display = 'flex';\n    v.outputSchemaObjectIsValid = false;\n  }\n\n  function programmaticallySetValue(value, textarea, codeMirrorInstance) {\n    if (v.codemirrorInitialized == false) {\n      codeMirrorInstance = CodeMirror.fromTextArea(textarea, {\n        mode: 'application/json',\n        theme: 'dracula',\n        lineNumbers: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        indentUnit: 2,\n        tabSize: 2,\n        gutters: ['CodeMirror-lint-markers'],\n        lint: {\n          lintOnChange: true,\n          tooltips: false\n        }\n      });\n\n      // input event listener\n      codeMirrorInstance.on('change', function (cm, change) {\n        inputEventValue = cm.getValue();\n        // console.log(\"Content changed:\", cm.getValue());\n        if (isValidJsonObject(inputEventValue)) {\n          objectIsValid();\n        } else {\n          objectIsInvalid();\n        }\n      });\n    }\n\n    textarea.value = value;\n    if (v.codemirrorInitialized == false) {\n      codeMirrorInstance.setValue(value);\n      if (isValidJsonObject(value)) {\n        objectIsValid();\n      } else {\n        objectIsInvalid();\n      }\n    }\n    v.codemirrorInitialized = true;\n  }\n\n  const activeDatasource = r.get_datasources.data.find(item => item.id === v.active_datasource).datasource_type_config;\n  const rawValue = activeDatasource.outputSchema;\n  const value = JSON.parse(rawValue);\n  // console.log(value);\n\n  if (activeDatasource.outputformatting_enabled == true) {\n    programmaticallySetValue(value, textarea, codeMirrorInstance);\n  }\n\n  //\n}\n"
        }
      ]
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      condition: "return (n.path == '/')",
      name: 'get meter summary on page load',
      id: '5fab3acd-4bcc-4834-9431-8a3a8c858a5d',
      trigger: 'after-request',
      hasCondition: true,
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a',
      actions: [
        {
          id: '44de1cfb-4b89-490c-90af-939458266d74',
          type: 'run-function',
          condition: 'return !!(r.get_user_data?.data?.[0]?.organizations?.[0]?.subscriptions?.find((sub) => sub.subscription_type == "meter")) ?? false;',
          function:
            "Wized.requests.execute('get_meter_summary');\nawait Wized.requests.waitFor('get_meter_summary');\n\nif (r.get_meter_summary.data.data[0]) {\n  document.querySelector('[w-el=\"analytics-meter-summary\"]').innerHTML = r.get_meter_summary.data.data[0].aggregated_value;\n\n  const rawBillingperiod = r.get_meter_summary.data.data[0].start_time;\n\n  let billingPeriod = new Date(rawBillingperiod * 1000);\n\n  const months = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];\n\n  let month = months[billingPeriod.getMonth()];\n\n  const periodValue = 'Periode vanaf ' + billingPeriod.getDate() + ' ' + month;\n  document.querySelector('[w-el=\"analytics-billingperiod\"]').innerHTML = periodValue;\n}",
          hasCondition: true
        }
      ]
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      name: 'get [chats & [DEPR]] agents',
      trigger: 'after-request',
      id: '602ad772-2011-4a25-bb1d-b0adcee524e9',
      folderId: '99a16fdd-65fc-4ba5-9c99-4847a2473e67',
      actions: [
        {
          id: '18f2667b-4c0b-4b91-93d7-42971c5cfae9',
          type: 'perform-request',
          request: 'ac8cdd98-98da-45f1-9556-6e3e1cd38837',
          condition: "return (n.path.includes('/chat-inbox'))",
          hasCondition: true
        }
      ]
    },
    {
      id: '68ae55e9-1c4d-4168-873f-e8cf2f4a1dd0',
      name: 'get chatbot datasources on page load',
      folderId: '55214649-2bac-4398-a861-03d94d2aad9d',
      trigger: 'after-request',
      request: 'd2b868e4-84da-4910-a98d-781589052b49',
      hasCondition: true,
      condition: 'return (r.get_user.ok == true && ((n.path.includes("/kennis/") || n.path.includes("/chat-inbox") || n.path.includes("/testomgeving"))))',
      actions: [
        { id: 'ebecf23b-740d-4519-80ea-a48a48ad02df', type: 'perform-request', request: '9d139b25-dc47-41e5-8bfd-f09ec49d71da', hasCondition: true, condition: 'return (v.active_chatbot !== null)' },
        {
          id: 'dc43a33d-d357-427d-b641-d063dd0e3ecd',
          type: 'perform-request',
          request: 'FHxeltvpj1PvuNNdqOdV',
          hasCondition: true,
          condition: "return (n.path.includes('/chat-inbox') || n.path.includes('/testomgeving'))"
        }
      ]
    },
    {
      request: 'f17bfcd0-9a6f-482d-b7f9-ea4e263098b8',
      name: 'redirect to portal url',
      id: '75574973-6d2a-4c07-9e83-00b2b4138d06',
      trigger: 'after-request',
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a',
      actions: [
        {
          id: '5fed1421-ab40-42a6-8dc3-bb27492d7778',
          type: 'navigate-to',
          condition: 'return (r.create_portal_session.data.checkout_url !== null)',
          hasCondition: true,
          url: 'return r.create_portal_session.data.portal_url',
          openInNewTab: true
        }
      ]
    },
    {
      id: '78b2ffcb-9638-4da2-9b65-bb726015c819',
      name: 'toast notifications handling',
      folderId: 'a4ad4e2f-834f-4b84-bb43-5fc23d252a62',
      trigger: 'page-complete',
      actions: [
        {
          id: 'e105da85-d73d-43db-8ea4-7ab6551ec817',
          type: 'run-function',
          function:
            'Wized.on("request", (result) => {\n  if (result.ok == true) {\n    // console.log(result);\n    if (result.name === "create_kb_topic") {\n      window.showToastNotification("Artikel toegevoegd", "success");\n      console.log(result);\n    } else if (result.name === "update_kb_topic") {\n      window.showToastNotification("Artikel bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "delete_kb_topic") {\n      window.showToastNotification("Artikel verwijderd", "success");\n      console.log(result);\n    } else if (result.name === "create_organization") {\n      window.showToastNotification("Organisatie aangemaakt", "success");\n      console.log(result);\n    } else if (result.name === "create_chatbot") {\n      if (n.path.includes("/kennis/databronnen")) {\n        window.showToastNotification("Chatbot aangemaakt", "success");\n        console.log(result);\n      }\n    } else if (result.name === "delete_chatbot") {\n      v.active_chatbot = null;\n      n.path = "/?tn=dc";\n      console.log(result);\n    } else if (result.name === "update_chatbot") {\n      window.showToastNotification("Chatbot bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "update_chatbot_prompt") {\n      window.showToastNotification("Prompt opgeslagen", "success");\n      console.log(result);\n    } else if (result.name === "create_pdf") {\n      window.showToastNotification("Kennisbank aangemaakt", "success");\n      console.log(result);\n    } else if (result.name === "create_pdf2") {\n      window.showToastNotification("PDF databron aangemaakt", "success");\n      console.log(result);\n    } else if (result.name === "create csv") {\n      window.showToastNotification("CSV databron aangemaakt", "success");\n      console.log(result);\n    } else if (result.name === "create_url") {\n      window.showToastNotification("URL toegevoegd", "success");\n      console.log(result);\n    } else if (result.name === "create_api") {\n      window.showToastNotification("API toegevoegd", "success");\n      console.log(result);\n    } else if (result.name === "update_pdf" || result.name === "update_kb") {\n      window.showToastNotification("Kennisbank databron  bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "update_csv") {\n      window.showToastNotification("CSV databron bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "update_url") {\n      window.showToastNotification("Website databron bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "update_api") {\n      window.showToastNotification("API databron bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "update_xml") {\n      window.showToastNotification("Product feed databron bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name === "delete_datasource") {\n      window.showToastNotification("Databron verwijderd", "success");\n      console.log(result);\n    } else if (result.name === "submit_xml_productfeed") {\n      window.showToastNotification("Product feed synchronisatie gestart", "success");\n      console.log(result);\n    } else if (result.name === "update_chat_livechat") {\n      if (result.data.livechat === true) {\n        window.showToastNotification("Livechat overgenomen", "success");\n      } else if (result.data.livechat === false) {\n        window.showToastNotification("Livechat verlaten", "success");\n      }\n    } else if (result.name === "update_chat_updatetags") {\n      window.showToastNotification("Tags opgeslagen", "success");\n    } else if (result.name.includes("update_chatbot_settings")) {\n      window.showToastNotification("Chatbot instellingen opgeslagen", "success");\n      console.log(result);\n    } else if (result.name.includes("update_chat_sidebar")) {\n      window.showToastNotification("Chat bijgewerkt", "success");\n      console.log(result);\n    } else if (result.name.includes("update_chatbot_integrations")) {\n      window.showToastNotification("Integratie instellingen opgeslagen", "success");\n      console.log(result);\n    } else if (result.name.includes("update_agent_avatar_file")) {\n      window.showToastNotification("Medewerker ge-update", "success");\n      console.log(result);\n    } else if (result.name == "delete_chat") {\n      window.showToastNotification("Chat verwijderd", "success");\n      console.log(result);\n    } else if (result.name == "update_chat_archive") {\n      if (result.data.archived == true) {\n        window.showToastNotification("Chat gearchiveerd", "success");\n      } else if (result.data.archived == false) {\n        window.showToastNotification("Chat uit archief gehaald", "success");\n      }\n    } else if (result.name == "update_user_notifications") {\n      if (result.data.inbox_notifications_enabled == true) {\n        window.showToastNotification("Inbox meldingen ingeschakeld", "success");\n      } else if (result.data.inbox_notifications_enabled == false) {\n        window.showToastNotification("Inbox meldingen uitgeschakeld", "success");\n      }\n      console.log(result);\n    } else if (result.name == "delete_chatbots_datasources_join") {\n      window.showToastNotification("Toegang ingetrokken", "success");\n      console.log(result);\n    } else if (result.name == "create_chatbots_datasources_join") {\n      window.showToastNotification("Toegang gegeven", "success");\n      console.log(result);\n    } else if (result.name === "update_password") {\n      window.showToastNotification("Wachtwoord gereset", "success");\n      console.log(result);\n      n.path = "/";\n      // n.path = "/";\n    } else if (result.name === "reset_password") {\n      window.showToastNotification("Wachtwoord herstel email gestuurd", "success");\n      console.log(result);\n    } else {\n      // console.log(result.name);\n    }\n  } else {\n    if (result.name === "get_user") {\n      console.log(result);\n    } else if (result.name === "auth_user") {\n      console.log(result);\n      if (result.data.error === "Invalid login credentials") {\n        window.showToastNotification("Ongeldig wachtwoord", "error");\n      }\n    } else if (result.name == "create_user") {\n      if (result.data.error == "User already registered") {\n        window.showToastNotification(\n          "Er bestaat al een gebruiker met dit E-mailadres",\n          "error"\n        );\n      }\n    } else if (result.name == "update_password") {\n      if (result.data.error == "New password should be different from the old password") {\n        window.showToastNotification(\n          "Nieuwe wachtwoord moet anders zijn dan het huidige wachtoord",\n          "error"\n        );\n      }\n    } else if (result.name == "validate_xml") {\n    } else {\n      window.showToastNotification(\n        "Er is iets misgegaan. Neem contact op met de Sleak admin voor hulp.",\n        "error"\n      );\n      console.log("error:", result);\n    }\n  }\n});\n'
        }
      ]
    },
    {
      id: '82eN8E89huAFsxW2crpM',
      name: 'datasources RT sub',
      folderId: 'nLn7Qh9PmZWTT77lvcQT',
      trigger: 'page-loading',
      actions: [
        {
          id: 'bb9393a4-f4cd-475e-b9c4-a1899d778fb4',
          type: 'run-function',
          function:
            "// after get_datasources on /kennis/databronnen\n\nwindow.datasourcesRealtimeInit = async function() {\n  let supaClient;\n\n  const { version, client } = await Wized.requests.getClient('supabase');\n\n  supaClient = client;\n\n  // get datasource ids\n  const idsArray = r.get_datasources.data.map(item => item.id);\n  const formattedIds = `in.(${idsArray.join(', ')})`;\n\n  const userId = r.get_user.data.user.id;\n\n  datasourceChannel = supaClient.channel('adminUiDatasources_' + userId)\n\n  datasourceChannel\n    .on(\n      'postgres_changes',\n      {\n        event: 'UPDATE',\n        schema: 'public',\n        table: 'data_sources',\n        filter: `id=${formattedIds}`\n      },\n      payload => {\n        if (payload.new.data_type == 'csv' || payload.new.data_type == 'pdf2' || payload.new.data_type == 'xml') {\n          console.log('realtime update: ', payload);\n          const updatedDatasource = r.get_datasources.data.find(item => item.id === payload.new.id);\n\n          if (updatedDatasource) {\n            const status = payload.new.file_upload_status;\n            const oldStatus = updatedDatasource.file_upload_status;\n            if (oldStatus !== status) {\n              Object.assign(updatedDatasource, payload.new);\n              if (status === 'success') {\n                window.showToastNotification('Bestand succesvol verwerkt', 'success');\n              } else if (status === 'failed') {\n                window.showToastNotification('Er is een fout opgetreden tijdens het verwerken.', 'error');\n              }\n              datasourceChannel.unsubscribe();\n              v.datasourcesRtSubSubscribed = false\n            }\n          }\n        }\n        // xml feed here\n      }\n    )\n\n    .subscribe(status => {\n      console.log('datasources realtime status changed: ', status);\n    });\n\n    v.datasourcesRtSubSubscribed = true\n}\n\n// if (!v.datasourcesRtSubSubscribed) realtimeInit();\nawait Wized.requests.waitFor('get_datasources');\nif (r.get_datasources.data.some(item => ['processing', 'failed'].includes(item.file_upload_status))) {\n  console.log\n  window.datasourcesRealtimeInit()\n}"
        }
      ]
    },
    {
      request: '9425c8a3-851f-4aea-994c-af3b88ad7fe8',
      condition: "return (n.path.includes('/chatbot') && !n.path.includes('/chatbot/preview') && !n.path.includes('/chatbot-instellingen') || n.path == '/')",
      name: 'Get all chats',
      id: '957a10dc-0d56-4f5b-963a-8f8ce0261d6b',
      trigger: 'after-request',
      hasCondition: true,
      folderId: '8fda368d-3d91-4ddc-84e0-352930ddb0c4',
      actions: [{ id: 'e080ca22-1101-49f2-badd-3798416f8d43', type: 'perform-request', request: '8578e3e8-9133-4087-bdcd-c038e305fcb9' }]
    },
    {
      request: 'd2b868e4-84da-4910-a98d-781589052b49',
      name: 'get user data after get_user',
      trigger: 'after-request',
      id: '9f996a6d-00b9-4c05-b154-1fdcc3ba13f1',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      actions: [
        { id: '04f70f5a-00b9-468d-bc50-d7e309448326', type: 'perform-request', request: '76ea538c-0c75-4819-8bc2-0115402aa40f', condition: 'return (r.get_user.ok == true)', hasCondition: true }
      ]
    },
    {
      condition: 'return (n.path.includes("/databronnen"))',
      name: 'clear crawled urls',
      id: 'GxhKz7XVFjnI0yrmYbJ9',
      trigger: 'page-loading',
      hasCondition: true,
      folderId: 'gccMuQyf668xZ0Ngt6Cg',
      actions: [
        {
          id: '8522a5be-ff48-48a5-a83d-71ba80994b04',
          type: 'run-function',
          function:
            "const closeTriggers = document.querySelectorAll('[popupmodal-closetrigger]');\n\nconst popupElement = document.querySelector('[w-el=\"popup-create-datasource\"]');\nconst crawlUrlsElement = document.querySelector('[datasourcesform=\"website\"]');\nconst crawledUrlsElement = document.querySelector('[datasourcesform=\"url\"]');\n\ncloseTriggers.forEach(trigger => {\n    trigger.addEventListener('click', () => {\n        v.crawledpages = [];\n\n        document.querySelector('[w-el=\"form-create-datasource-url\"]').reset();\n        document.querySelector('[w-el=\"form-upsert-urls\"]').reset();\n\n        const isPopupVisible = window.getComputedStyle(popupElement).display === 'flex';\n        const isCrawlElementVisible = window.getComputedStyle(crawledUrlsElement).display === 'flex';\n        \n        // Show the URL form and hide the website form\n        if (isCrawlElementVisible) {\n            crawlUrlsElement.style.display = 'flex';\n        }\n        crawledUrlsElement.style.display = 'none';\n    })\n});\n\nconst crawlStepBackButton = document.querySelector('[daasource-crawl-back]')\ncrawlStepBackButton.addEventListener('click', () => {\n    v.crawledpages = [];\n    crawlUrlsElement.style.display = 'flex';\n    crawledUrlsElement.style.display = 'none';\n\n})"
        }
      ]
    },
    {
      id: 'Jd1QNkK9O36tvqKTZL30',
      name: 'auth debug',
      trigger: 'page-loading',
      actions: [
        {
          id: 'd1619e2d-03c5-48ef-a0f9-f4d1bed88535',
          type: 'run-function',
          function:
            "let supaClientDebug;\n  const { version, client } = await Wized.requests.getClient('supabase');\n  supaClientDebug = client;\n\n  const { data } = supaClientDebug.auth.onAuthStateChange((event, session) => {\n    console.log(event, session);\n    const timestamp = new Date().toLocaleTimeString();\n    console.log('ðŸ”´ auth event timestamp = ', timestamp);\n  });"
        }
      ]
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      condition: 'const organization = r.get_user_data.data[0].organizations[0];\n\nreturn (organization.subscription_status !== "active")',
      name: 'remaining trial days chart',
      id: 'PEEmEnfonqNMALNBtERV',
      trigger: 'after-request',
      hasCondition: true,
      folderId: '5779119e-f2d3-4a89-b784-ea7a58253f4a',
      actions: [
        {
          id: '2960b91d-f474-4b84-99fe-728a078fadf8',
          type: 'run-function',
          function:
            "// Get the organization data\nconst organization = r.get_user_data.data[0].organizations[0];\n\n// Check if the subscription is not active or null\nconst currentDate = new Date();\nconst createdAt = new Date(organization.created_at);\nconst trialPeriodDays = 14;\nconst maxDays = trialPeriodDays + 1; // Adjusted to ensure 14 days is not 100% filled\n\n// Calculate the difference in days between the current date and created date\nconst diffTime = currentDate - createdAt;\nconst diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\nconst remainingDays = trialPeriodDays - diffDays;\n\n// Render the doughnut chart to show the trial status visually\nconst usedDays = maxDays - remainingDays;\n\nif (remainingDays >= 0) {\n  const ctx = document.getElementById('canvasCircle2').getContext('2d');\n\n  // Create a doughnut chart with the remaining and used days\n  const chart = new Chart(ctx, {\n    type: 'doughnut',\n    data: {\n      datasets: [\n        {\n          backgroundColor: ['#EFE9FE', '#7E79F0'], // Colors for remaining and used days\n          data: [usedDays, remainingDays], // Remaining days and used days\n          borderWidth: 0, // Optional: remove borders between segments to make them cleaner\n          borderRadius: 10,\n          borderCapStyle: 'round'\n        }\n      ],\n      labels: ['Remaining Days', 'Used Days'] // Labels for the data\n    },\n    options: {\n      cutout: '60%', // Increase cutout percentage to make the doughnut larger\n      responsive: true,\n      maintainAspectRatio: false,\n      plugins: {\n        legend: {\n          display: false // Hide the legend\n        },\n        tooltip: {\n          enabled: false // Disable tooltips\n        }\n      },\n      hover: {\n        mode: null // Disable hover mode to avoid extra rendering\n      }\n    }\n  });\n} else {\n  console.warn('Trial period has ended.');\n}\n"
        }
      ]
    },
    {
      id: 'Ruh3grZ8PkQaeSxbwdbV',
      name: 'tool output logs accordion',
      trigger: 'page-loading',
      hasCondition: true,
      condition: "return (n.path.includes('/chat-inbox') || n.path.includes('/testomgeving'))",
      actions: [
        {
          id: 'e45eeada-8f3a-414f-9967-3eb12fe10afa',
          type: 'run-function',
          function:
            "window.initToolOutputLogs = function () {\n  // Cleanup existing event handlers to avoid duplication\n  $('[w-el=\"tool-output-logs-list-item\"]').off('click');\n  $('.tool-output-logs-content-preview').css({\n    display: 'flex',\n    opacity: 1,\n    height: '30px'\n  });\n\n  $('.tool-output-logs-content-expanded').css({\n    display: 'none',\n    opacity: 0,\n    height: '0',\n    overflow: 'hidden'\n  });\n\n\n  let clickCooldown = false;\n\n  $('[w-el=\"tool-output-logs-list-item\"]').on('click', function () {\n    if ($(event.target).closest('.tool-output-logs-content-expanded').length) return;\n\n    if (clickCooldown) return;\n    clickCooldown = true;\n    setTimeout(() => {\n      clickCooldown = false;\n    }, 300);\n\n    const $preview = $(this).find('.tool-output-logs-content-preview');\n    const $expanded = $(this).find('.tool-output-logs-content-expanded');\n\n    // Collapse all other items\n    $('.tool-output-logs-content-preview').not($preview).css({\n      display: 'flex'\n    });\n    // Collapse all other items\n    $('.tool-output-logs-content-preview').not($preview).css({\n      opacity: 1,\n      height: '30px',\n      transition: 'height 0.3s ease, opacity 0.3s ease'\n    });\n\n    $('.tool-output-logs-content-expanded').not($expanded).css({\n      opacity: 0,\n      height: '0',\n      overflow: 'hidden',\n      transition: 'height 0.3s ease, opacity 0.3s ease'\n    });\n\n    setTimeout(() => {\n      $('.tool-output-logs-content-expanded').not($expanded).css('display', 'none');\n    }, 300); // Match the transition duration\n\n    // Toggle the clicked item\n    if ($expanded.css('display') === 'none') {\n      // Expand the current item\n      $preview.css({\n        opacity: 0,\n        height: '0',\n        transition: 'height 0.3s ease, opacity 0.3s ease'\n      });\n\n      setTimeout(() => $preview.css('display', 'none'), 300); // Hide after transition ends\n\n      // Temporarily set height to auto to measure full height\n      $expanded.css({\n        display: 'flex',\n        height: 'auto',\n        overflow: 'hidden'\n      });\n\n      const fullHeight = $expanded[0].scrollHeight;\n\n      $expanded.css({\n        height: '0',\n        opacity: 0,\n        transition: 'height 0.3s ease, opacity 0.3s ease'\n      });\n\n      // Trigger reflow to ensure the animation starts\n      $expanded[0].offsetHeight;\n\n      // Animate to full height\n      $expanded.css({\n        height: `${fullHeight}px`,\n        opacity: 1\n      });\n    } else {\n      // Collapse the current item\n      const fullHeight = $expanded[0].scrollHeight;\n\n      $expanded.css({\n        height: `${fullHeight}px`,\n        opacity: 1,\n        overflow: 'hidden',\n        transition: 'height 0.3s ease, opacity 0.3s ease'\n      });\n\n      // Trigger reflow\n      $expanded[0].offsetHeight;\n\n      // Shrink to 0\n      setTimeout(() => {\n        $expanded.css({\n          height: '0',\n          opacity: 0\n        });\n      }, 10);\n\n      // Hide the expanded content after the transition\n      setTimeout(() => $expanded.css('display', 'none'), 300);\n\n      $preview.css({\n        display: 'flex',\n        opacity: 1,\n        height: '30px',\n        transition: 'height 0.3s ease, opacity 0.3s ease'\n      });\n    }\n  });\n};\n"
        }
      ]
    },
    {
      id: 'VyALv7CCxEKtjDSfEpvs',
      name: 'define showOutputlogs function',
      folderId: '8339c00a-50de-4a25-99f6-68a9f4835506',
      trigger: 'after-request',
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      hasCondition: true,
      condition: "return (n.path.includes('/chat-inbox') || n.path.includes('/testomgeving'))",
      actions: [
        {
          id: 'e3378f2e-03d1-4a16-80b0-1be7f01255a7',
          type: 'run-function',
          function:
            "Wized.requests.execute('getall_scrape_pages');\n\nwindow.showOutputLogs = async function (dataType) {\n\n  Wized.requests.execute('get_outputlogs');\n  await Wized.requests.waitFor('get_outputlogs');\n\n  if (dataType == 'sourceDocuments') {\n    document.querySelector('[w-el=\"tool-outputs-wrap-api\"]').style.display = 'none';\n    document.querySelector('[w-el=\"tool-outputs-wrap-retrieval\"]').style.display = 'flex';\n    setTimeout(() => {\n      window.initToolOutputLogs();\n    }, 1000);\n  } else if (dataType == 'usedTools') {\n    let textarea = document.getElementById('code-editor');\n    function initCodemirror() {\n      v.codeMirrorInstance = CodeMirror.fromTextArea(textarea, {\n        readOnly: true,\n        mode: 'application/json',\n        theme: 'dracula',\n        lineWrapping: true,\n        lineNumbers: true,\n        autoCloseBrackets: true,\n        matchBrackets: true,\n        indentUnit: 1,\n        tabSize: 2,\n        gutters: ['CodeMirror-lint-markers']\n      });\n      v.codeMirrorInstance.getWrapperElement().style.backgroundColor = '#2b2b2b';\n      v.codemirrorInitialized = true;\n    }\n\n    function programmaticallySetValue(value) {\n      if (!v.codemirrorInitialized) {\n        initCodemirror();\n      } else {\n        v.codeMirrorInstance.setValue('');\n      }\n\n      const formattedValue = JSON.stringify(JSON.parse(value), null, 2); // Indent by 2 spaces\n      textarea.value = formattedValue;\n      v.codeMirrorInstance.setValue(formattedValue);\n      v.codemirrorInitialized = true;\n    }\n\n    const output = JSON.parse(r.get_outputlogs.data[0].tool_output[0]);\n    console.log('output', output);\n\n    if (output.request) {\n      const datasource = r.get_datasources_organization.data.find(entry => entry.id === r.get_outputlogs.data[0].datasource_id) || null;\n      if (!datasource) {\n        console.log('no datasource');\n        $('[w-el=\"tool-output-logs-api-datasource-deleted\"]').css('display', 'flex');\n        $('[w-el=\"tool-output-logs-api-datatype-wrap\"]').css('display', 'none');\n        $('[w-el=\"tooloutput-api-lastedited-container\"]').css('display', 'none');\n      } else {\n        $('[w-el=\"tool-output-logs-api-datasource-deleted\"]').css('display', 'none');\n        $('[w-el=\"tool-output-logs-api-datatype-wrap\"]').css('display', 'flex');\n        $('[w-el=\"tooloutput-api-name\"]').text(datasource.name);\n        $('[w-el=\"tooloutput-api-lastedited-container\"]').css('display', 'flex');\n        const date = new Date(datasource.last_updated);\n        const formattedDate = `${date.getDate()}-${date.getMonth() + 1}`;\n        $('[w-el=\"tooloutput-api-lastedited\"]').text(formattedDate);\n        console.log('datasource', datasource);\n      }\n\n      // const rawTime = datasource.created_at\n      // $('[w-el=\"tooloutput-api-lastedited\"]').text();\n\n      $('[w-el=\"tooloutput-api-endpoint\"]').text(output.output_parts.endpointUrl);\n      $('[w-el=\"tooloutput-api-responsecode\"]').text(output.request.status);\n      $('[w-el=\"tooloutput-api-responsecode\"]').css('color', output.request.status === 200 ? '#25d366' : '#F37A80');\n      $('[w-el=\"tooloutput-api-respone-indicator\"]').css('background-color', output.request.status === 200 ? '#25d366' : '#F37A80');\n    } else {\n      console.log('no data');\n    }\n\n    document.querySelector('[w-el=\"tool-outputs-wrap-retrieval\"]').style.display = 'none';\n    document.querySelector('[w-el=\"tool-outputs-wrap-api\"]').style.display = 'flex';\n\n    if (output.request.status == 200) {\n      document.querySelector('[w-el=\"tooloutput-api-inputwrap\"]').style.display = 'flex';\n      document.querySelector('[w-el=\"tooloutput-api-errorwrap\"]').style.display = 'none';\n\n      const value = JSON.stringify(output.output_parts.actualresponse);\n      setTimeout(() => {\n        programmaticallySetValue(value, textarea, v.codeMirrorInstance);\n      }, 1);\n    } else {\n      console.log('has no 200');\n\n      document.querySelector('[w-el=\"tooloutput-api-inputwrap\"]').style.display = 'none';\n      document.querySelector('[w-el=\"tooloutput-api-errorwrap\"]').style.display = 'block';\n\n      $('[w-el=\"tooloutput-api-error-text\"]').text(output.request.error);\n    }\n  }\n\n  document.querySelectorAll('[spinner=\"outputlogs\"]').forEach(element => {\n    element.style.display = 'none';\n  });\n\n  const popup = document.querySelector('[popupmodal=\"tool-output-logs\"]');\n  popup.style.transform = 'translateY(5px)';\n  popup.style.opacity = 0;\n  popup.style.display = 'flex';\n  setTimeout(() => {\n    popup.style.transform = 'translateY(0)';\n    popup.style.opacity = 1;\n  }, 10);\n};\n\n//\n//\n//\n\nwindow.addEventListener('message', event => {\n  if (event.origin === 'https://sleak.vercel.app' || event.origin === 'https://staging.sleak.chat' || event.origin === 'https://widget.sleak.chat') {\n    if (event.data.type === 'showOutputLogsAdmin') {\n      v.selectedMessageId = event.data.payload.id;\n      const dataType = event.data.payload.outputlogs.type;\n      console.log(dataType);\n      window.showOutputLogs(dataType);\n    }\n  }\n});\n"
        }
      ]
    },
    {
      id: 'aee0c1be-330e-4f80-a115-964778cd3ecc',
      name: 'validate csv',
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849',
      trigger: 'condition',
      condition: 'if (v.csvContent) {\n  return true\n}',
      actions: [
        {
          id: 'f7a6e4c3-7fb7-4b07-b548-6ee94372550d',
          type: 'run-function',
          function:
            '// Create CSV to JSON Array Function using Papa Parse with dynamic delimiter detection\nasync function readCSVAsNormalizedArrayOfObjects(fileInput) {\n  if (!fileInput) {\n    console.log("No file input provided.");\n    return [];\n  }\n\n  return new Promise((resolve, reject) => {\n    const maxRows = 6000;\n    const maxRowLength = 10000;\n\n    let rowCount = 0;\n    let dataArray = [];\n    let parsingAborted = false;\n\n    // Function to detect the delimiter based on the first occurrence in the first non-empty line\n    function detectDelimiter(text) {\n      const lines = text.split(/\\r\\n|\\n/);\n      let firstNonEmptyLine = "";\n\n      // Find the first non-empty line\n      for (let line of lines) {\n        if (line.trim() !== "") {\n          firstNonEmptyLine = line;\n          break;\n        }\n      }\n\n      console.log("First non-empty line for delimiter detection:", firstNonEmptyLine);\n\n      // List of possible delimiters\n      const possibleDelimiters = [",", ";", "\\t", "|"];\n\n      // Check for the first occurrence of any delimiter\n      for (let delimiter of possibleDelimiters) {\n        if (firstNonEmptyLine.includes(delimiter)) {\n          console.log(`Detected delimiter: \'${delimiter}\'`);\n          return delimiter;\n        }\n      }\n\n      // Default to comma if no delimiter is found\n      console.log("No delimiter detected. Defaulting to comma.");\n      return ",";\n    }\n\n    // First, detect the delimiter\n    const delimiter = detectDelimiter(fileInput);\n\n    // if (delimiter === ";") {\n    //   reject(\'file has ";" delimiter\');\n    //   window.showToastNotification(\n    //     \'CSV gebruikt door ";" gescheiden waarden. Gebruik een bestand met door komma gescheiden waarden.\',\n    //     "error"\n    //   );\n    //   return;\n    // }\n\n    Papa.parse(fileInput, {\n      delimiter: delimiter,\n      header: true,\n      skipEmptyLines: true,\n      quoteChar: \'"\', // Ensure proper handling of quoted fields\n      escapeChar: \'"\',\n      step: function (results, parser) {\n        if (parsingAborted) {\n          parser.abort();\n          return;\n        }\n\n        rowCount++;\n        let row = results.data;\n\n        // Convert the row to a string to check its length\n        let rowString = JSON.stringify(row);\n\n        // Check if the row exceeds the maximum length\n        if (rowString.length > maxRowLength) {\n          // Clear input\n          i["csv-upload"] = {};\n          v.csvContent = null;\n          const form = document.querySelector("[w-el=\'form-create-datasource-csv\']");\n          if (form) {\n            form.reset();\n          }\n\n          console.log(`Row exceeds ${maxRowLength} characters:`, row);\n          window.showToastNotification(\n            `Een of meer rijen overschrijden de karakterlimiet. Upload een bestand met rijen van minder dan ${maxRowLength} karakters.`,\n            "error"\n          );\n\n          parsingAborted = true;\n          parser.abort(); // Stop parsing further rows\n          return;\n        }\n\n        // Check if the row count exceeds the maximum allowed rows\n        if (rowCount > maxRows) {\n          // Clear input\n          i["csv-upload"] = {};\n          v.csvContent = null;\n          const form = document.querySelector("[w-el=\'form-create-datasource-csv\']");\n          if (form) {\n            form.reset();\n          }\n\n          console.log(`Row limit exceeded. Maximum allowed is ${rowCount} rows.`);\n          window.showToastNotification(\n            `Rijlimiet overschreden. Je kunt maximaal ${rowCount} rijen uploaden.`,\n            "error"\n          );\n\n          parsingAborted = true;\n          parser.abort(); // Stop parsing further rows\n          return;\n        }\n\n        // Add the row to the data array without modifying field values\n        dataArray.push(row);\n      },\n      complete: function () {\n        if (parsingAborted) {\n          resolve([]); // Resolve with an empty array if parsing was aborted\n        } else {\n          console.log("Parsed Results:", dataArray);\n          resolve(dataArray); // Resolve with the parsed data\n        }\n      },\n      error: function (err) {\n        console.error("Papa Parse Error:", err);\n        reject(err);\n      },\n    });\n  });\n}\n\n// Turn CSV File into a JSON Array\nvar file = v.csvContent.value;\nreadCSVAsNormalizedArrayOfObjects(file)\n  .then((objects) => {\n    v.csv_rows = objects; // Set your Wized variable\n    console.log("CSV Rows:", v.csv_rows); // Console log the new Wized variable\n    // Further processing can be done here\n  })\n  .catch((error) => {\n    console.error("Error reading file:", error);\n  });\n'
        }
      ]
    },
    {
      condition: 'return (n.path.includes("/kennis") || n.path.includes("/admin-create-datasource"))',
      name: 'csv file drop',
      id: 'aeec71e7-e3c2-4e41-8df4-a39bcdf61547',
      trigger: 'page-complete',
      hasCondition: true,
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849',
      actions: [
        {
          id: 'caaed383-5b4e-4029-b651-731b8d791142',
          type: 'run-function',
          function:
            'const dragArea = document.querySelector(\'[w-el="csv-dragarea"]\');\nconst fileInput = document.querySelector(\'[w-el="csv-upload"]\');\n\n// // Highlight the drag area when file is dragged over it\n// dragArea.addEventListener("dragover", (event) => {\n//   event.preventDefault();\n//   dragArea.style.backgroundColor = "#F5F5FE";\n//   // console.log("File over drag area");\n// });\n\n// // Revert styling when dragging leaves the area\n// dragArea.addEventListener("dragleave", (event) => {\n//   dragArea.style.backgroundColor = "";\n//   // console.log("File left drag area");\n// });\n\n// // Handle the file drop\n// dragArea.addEventListener("drop", (event) => {\n//   event.preventDefault(); // Prevent default behavior (opening the file)\n//   dragArea.style.backgroundColor = "";\n//   dragArea.style.display = "none";\n\n//   const files = event.dataTransfer.files;\n//   if (files.length > 0 && files[0].type === "text/csv") {\n//     const dataTransfer = new DataTransfer();\n//     dataTransfer.items.add(files[0]);\n//     fileInput.files = dataTransfer.files;\n//     // console.log("File uploaded:", fileInput.files[0].name);\n//     // console.log("Data object:", files[0]);\n\n//     // Read the file content\n//     const reader = new FileReader();\n//     reader.onload = function (e) {\n//       // console.log("File content:", e.target.result);\n\n//       function sizeInMBorKB(sizeBytes) {\n//         const sizeMB = (sizeBytes / (1024 * 1024)).toFixed(2);\n//         if (sizeBytes < 1024 * 1024) {\n//           const sizeKB = (sizeBytes / 1024).toFixed(2);\n//           return `${sizeKB} KB`;\n//         }\n//         return `${sizeMB} MB`;\n//       }\n//       const fileSize = files[0].size;\n//       const readableSize = sizeInMBorKB(fileSize);\n\n//       const createdAt = new Date();\n//         const prettyDate = createdAt.getDate().toString().padStart(2, \'0\') + "-" + (createdAt.getMonth() + 1).toString().padStart(2, \'0\') + "-" + createdAt.getFullYear();\n//         const prettyTime = createdAt.getHours().toString().padStart(2, \'0\') + ":" + createdAt.getMinutes().toString().padStart(2, \'0\');\n\n//       v.csvContent = {\n//         value: e.target.result,\n//         name: files[0].name,\n//         size: readableSize,\n//         date: prettyDate,\n//         time: prettyTime,\n//       };\n//       // console.log(v.csvContent)\n\n//     };\n//     reader.readAsText(files[0]);\n//   } else {\n//     alert("Alleen CSV toegestaan.");\n//   }\n// });\n\n// Allow file input via clicking the drag area\ndragArea.addEventListener("click", () => {\n  fileInput.click();\n});\n'
        }
      ]
    },
    {
      name: 'get user on page load',
      trigger: 'page-loading',
      id: 'b2a33695-1336-47b6-a062-f202717860b8',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      actions: [{ id: 'e047b625-6491-45f3-8a3b-013f9ced8bcc', type: 'perform-request', request: 'd2b868e4-84da-4910-a98d-781589052b49' }]
    },
    {
      request: 'b90e0912-d43f-4620-95a8-6aceb6904847',
      name: 'add storage item to row - background',
      id: 'c3bad054-6aab-464d-bdce-c827a3316cdc',
      trigger: 'after-request',
      folderId: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0',
      actions: [
        {
          id: '6a132259-88d9-4e15-9303-297d105ab737',
          type: 'perform-request',
          request: '4d999dbd-a786-4f0b-ae22-0b6e7fed3ab2',
          condition: 'if (i["settigs-background-input"]["0"]) {\n  return true\n} else {\n  return false\n}',
          hasCondition: true
        }
      ]
    },
    {
      request: '04896350-7db5-44ee-b832-ca64a811430e',
      name: 'add storage item to row - avatar',
      id: 'c48623ae-939b-4bc5-9139-dec8b638be70',
      trigger: 'after-request',
      folderId: 'c4d77b67-d7ac-41ef-a77f-2849687d2cd0',
      actions: [
        {
          id: '0a9e385c-6b52-45be-adc1-fd1304bc213c',
          type: 'perform-request',
          request: '29fa247a-9d03-4453-b85a-4c894e73d52d',
          condition: 'if (i["settigs-avatar-input"]["0"]) {\n  return true\n} else {\n  return false\n}',
          hasCondition: true
        }
      ]
    },
    {
      id: 'ca91b26b-7a9c-47f2-b885-f813a2225dfc',
      name: 'after get_chatbots - RT logic + set filiter variables',
      folderId: '8339c00a-50de-4a25-99f6-68a9f4835506',
      trigger: 'after-request',
      request: '9425c8a3-851f-4aea-994c-af3b88ad7fe8',
      actions: [
        {
          id: 'c41d33f1-6565-49b5-aa91-813f025b45f4',
          type: 'run-function',
          function:
            "let chime = new Audio('https://sygpwnluwwetrkmwilea.supabase.co/storage/v1/object/public/app/assets/sleak-chime.mp3');\n\nasync function realtimeInit() {\n  // init supa client\n  let supaClient;\n  const { version, client } = await Wized.requests.getClient('supabase');\n  supaClient = client;\n\n  const { data } = supaClient.auth.onAuthStateChange((event, session) => {\n    console.log(event, session);\n    const timestamp = new Date().toLocaleTimeString();\n    console.log('auth event timestamp = ', timestamp);\n    if (event === 'TOKEN_REFRESHED') {\n      console.log('TOKEN_REFRESHED event - initializing main channel in 10 seconds');\n      setTimeout(() => {\n        console.log('Initializing main channel');\n        adminUiChannel.unsubscribe();\n        initializeMainChannel();\n      }, 5000);\n    }\n  });\n\n  // get ids\n  const idsArray = r.get_chatbots.data.map(item => item.id);\n  const formattedIds = `in.(${idsArray.join(', ')})`;\n  const userId = r.get_user.data.user.id;\n\n  let adminUiChannel;\n  let restartRequired = false;\n  let reconnecting = false;\n  let unsubscribeRequired = false;\n\n  let retryCount = 0;\n\n  function initializeMainChannel() {\n    reconnecting = true;\n\n    const maxRetries = 5;\n\n    console.log('Initializing main channel, attempt:', retryCount + 1);\n\n    adminUiChannel = supaClient.channel('adminUi_' + userId);\n\n    adminUiChannel\n      .on(\n        'postgres_changes',\n        {\n          event: 'INSERT',\n          schema: 'public',\n          table: 'messages',\n          filter: `chatbot_id=${formattedIds}`\n        },\n        payload => {\n          // console.log('New message:', payload);\n\n          const chat = v.allchats.find(chat => chat.id === payload.new.visitor_id);\n          if (chat) {\n            if (!chat.messages) {\n              chat.messages = [];\n            }\n\n            // message entrance animations\n            async function showMessage(toastElement) {\n              toastElement.style.display = 'flex';\n              toastElement.style.opacity = 0;\n              toastElement.style.transform = 'translateY(20px)';\n              requestAnimationFrame(() => {\n                requestAnimationFrame(() => {\n                  toastElement.style.opacity = 1;\n                  toastElement.style.transform = 'translateY(0)';\n                });\n              });\n            }\n\n            async function pushMessage(payload) {\n              chat.messages.push(payload);\n              const activeChat = v.allchats.find(chat => chat.id === v.active_chat);\n              if (activeChat == payload.id) {\n                const toastElement = document.querySelector(`[message_list_id='${payload.id}']`);\n                showMessage(toastElement);\n              }\n            }\n\n            pushMessage(payload.new);\n\n            // chime\n            if (payload.new.message_type === 'default_user') {\n              if (i['checkbox-inbox-notifications'] == true) {\n                chime.play().catch(error => console.error('Error playing chime:', error));\n              }\n            }\n          } else {\n            console.log('No chat found for message with visitor_id:', payload.new.visitor_id);\n          }\n        }\n      )\n\n      // insert chats\n      .on(\n        'postgres_changes',\n        {\n          event: 'INSERT',\n          schema: 'public',\n          table: 'chats',\n          filter: `chatbot_id=${formattedIds}`\n        },\n        payload => {\n          console.log('New chat:', payload);\n\n          if (payload.new.placement !== 'admin') {\n            v.newchats.unshift(payload.new);\n          }\n        }\n      )\n\n      // update chats\n      .on(\n        'postgres_changes',\n        {\n          event: 'UPDATE',\n          schema: 'public',\n          table: 'chats',\n          filter: `chatbot_id=${formattedIds}`\n        },\n        payload => {\n          // console.log(\"Updated chat payload:\", payload);\n          if (payload.new.placement !== 'admin') {\n            const updatedChat = v.allchats.find(chat => chat.id === payload.new.id);\n            if (updatedChat) {\n              Object.assign(updatedChat, payload.new);\n              // console.log('Chat updated:', updatedChat);\n            } else {\n              console.log('No chat found for chat with visitor_id:', payload.new.visitor_id);\n            }\n          }\n        }\n      );\n\n    ////\n\n    adminUiChannel.subscribe((status, err) => {\n      console.log('Messaging channel status changed = ', status);\n      const timestamp = new Date().toLocaleTimeString();\n      console.log('realtime event timestamp = ', timestamp);\n      console.log('reconnecting = ', reconnecting);\n\n      // if (r.get_user_data.data[0].organizations[0].id == '616d0a37-03ac-47ea-91fc-c9eba9f331fc') chime.play();\n\n      if (status == 'CHANNEL_ERROR') console.log('Error:', err);\n\n      if (status !== 'SUBSCRIBED') {\n        if (!reconnecting) {\n          restartRequired = true;\n          if (retryCount > maxRetries) {\n            console.log('Reached maximum retry attempts for main channel.');\n            return;\n          } else {\n            retryCount += 1;\n            console.log('reconnecting');\n            if (status !== 'CLOSED') {\n              unsubscribeRequired = true;\n              console.log('status is not closed, Unsubscribing from main channel');\n              adminUiChannel.unsubscribe();\n            } else {\n              console.log('status is closed, Unsubscribing from main channel');\n              initializeMainChannel();\n            }\n          }\n        }\n      } else {\n        retryCount = 0; // reset count on successful connection\n        console.log('Subscribed - resetting retryCount, retryCount = ', retryCount);\n        restartRequired = false;\n        unsubscribeRequired = false;\n        reconnecting = false;\n      }\n    });\n  }\n\n  initializeMainChannel();\n\n  // visibility change events\n  document.onvisibilitychange = () => {\n    console.log('visibility change', document.visibilityState);\n    if (document.visibilityState === 'visible' && !reconnecting) {\n      // if (document.visibilityState === 'visible' && !reconnecting && restartRequired) { <- this is the original line\n      console.log('restart required', restartRequired);\n      // if (unsubscribeRequired) {\n      adminUiChannel.unsubscribe();\n      unsubscribeRequired = false;\n      // }\n      initializeMainChannel();\n      retryCount = 0;\n      restartRequired = false;\n    } else {\n    } //right now doing nothing on hidden.  Another option is to set a time to close the subscription after x minutes\n  };\n\n  // isTyping channel broadcast\n\n  let isTypingChannel;\n  await new Promise(res => setTimeout(res, 1000));\n  let currentChat = v.active_chat;\n  let inputEventListener = false;\n\n  function initializeLiveChatChannel(supaClient) {\n    isTypingChannel = supaClient.channel('isTyping_' + currentChat);\n\n    // console.log(\"first log\", isTypingChannel);\n\n    isTypingChannel.subscribe(status => {\n      // if (status !== \"SUBSCRIBED\") {\n      //   console.log(\"not subscribed\");\n      // } else {\n      //   console.log(\"Subscribed\");\n      // }\n\n      function sendIsTyping() {\n        isTypingChannel.send({\n          type: 'broadcast',\n          event: 'isTypingAdmin'\n          // payload: { message: \"Subscribed to isTypingChannel\" },\n        });\n      }\n\n      // input event listener\n      const input = document.querySelector(\"[w-el='admin-ui-chat-input']\");\n      let isTypingFlag = false;\n\n      if (inputEventListener == false) {\n        input.addEventListener('input', () => {\n          if (isTypingFlag == false) {\n            console.log('input event');\n            sendIsTyping();\n            isTypingFlag = true;\n            setTimeout(() => {\n              isTypingFlag = false;\n            }, 5000);\n          }\n        });\n      }\n      inputEventListener = true;\n    });\n  }\n\n  function closeLiveChatChannel() {\n    isTypingChannel.unsubscribe();\n    isTypingChannel = null;\n  }\n\n  // operatorChanged event listeners\n  window.addEventListener('joinLivechat', event => {\n    initializeLiveChatChannel(supaClient);\n  });\n  window.addEventListener('leaveLivechat', event => {\n    if (isTypingChannel) {\n      closeLiveChatChannel(supaClient);\n    }\n  });\n\n  if (v.active_chat.livechat == true) {\n    initializeLiveChatChannel(supaClient);\n  }\n}\n\nrealtimeInit();\n",
          hasCondition: true,
          condition: 'return (n.path == "/chat-inbox" && localStorage.getItem("sleakTrialExpired") !== "true")\n'
        },
        {
          id: '5956535b-1201-44ab-b6b2-cbb5549f9716',
          type: 'run-function',
          function: 'v.inboxFilterChatbots = r.get_chatbots.data.map(chatbot => chatbot.id);\n\nWized.requests.execute("get_chats");',
          hasCondition: true,
          condition: 'return (n.path == "/chat-inbox" && localStorage.getItem("sleakTrialExpired") !== "true")\n'
        },
        {
          id: 'bce56335-7119-4003-a932-a170b9f874fd',
          type: 'run-function',
          function: 'v.inboxFilterChatbots = [v.active_chatbot];\n\nWized.requests.execute("get_chats");\n',
          hasCondition: true,
          condition: 'return (n.path == "/chatbot")'
        },
        {
          id: '7b856e23-1177-47ab-8dba-f7dfe617a758',
          type: 'run-function',
          function:
            '// store tagging config in variable\nconst chatbot = r.get_chatbots.data.find(item => item.id == v.active_chatbot)\nif (chatbot.tags.length > 0) {\n  v.chatbotTags = chatbot.tags\n}',
          hasCondition: true,
          condition: "return (n.path.includes('/chatbot-instellingen'))"
        },
        {
          id: '4aea64f1-df74-49f0-b500-aab16d352d24',
          type: 'run-function',
          function:
            '// store custom fields config in variable\nconst chatbot = r.get_chatbots.data.find(item => item.id == v.active_chatbot)\n\nif (chatbot.custom_fields_config.length > 0) {\n  v.chatbotCustomFields = chatbot.custom_fields_config\n}',
          hasCondition: true,
          condition: "return (n.path.includes('/integraties'))"
        },
        {
          id: 'c04961e7-5c60-4e72-aced-b229389f3bd8',
          type: 'run-function',
          function:
            '// store conversatio starters config in variable\nconst chatbot = r.get_chatbots.data.find(item => item.id == v.active_chatbot)\n\nsetTimeout(() => {\n  if (chatbot.conversation_starters.length > 0) {\n  v.chatbotConversationStarters = chatbot.conversation_starters\n}\n}, 500);',
          hasCondition: true,
          condition: "// return (n.path.includes('/chatbot-instellingen'))\nreturn true"
        }
      ]
    },
    {
      id: 'cf336c5a-4844-4fff-936e-6c05a3d2cfc4',
      name: 'Settings | navigation',
      folderId: 'cc645055-40dd-4cef-8be2-ca815f73404b',
      trigger: 'page-loading',
      hasCondition: true,
      condition: 'return (n.path.includes("instellingen"))',
      actions: [
        {
          id: '9175be32-f976-4cdd-aaa4-856aa584c2fd',
          type: 'run-function',
          function:
            'function changeTabs() {\n  // Define all your tab elements\n  const settingsAlgemeen = document.querySelector("[settings-tab=\'algemeen\']");\n  const settingsWidget = document.querySelector("[settings-tab=\'widget\']");\n  const settingsInbox = document.querySelector("[settings-tab=\'inbox\']");\n  const settingsExtraopties = document.querySelector("[settings-tab=\'extraopties\']");\n  const settingsHumanhandoff = document.querySelector("[settings-tab=\'humanhandoff\']");\n  const settingsNotifications = document.querySelector("[settings-tab=\'notificaties\']");\n  const settingsOverig = document.querySelector("[settings-tab=\'overig\']");\n  const settingsBeveiliging = document.querySelector("[settings-tab=\'beveiliging\']");\n\n  window.updateSettingsDisplay = function (activeTab) {\n    const tabElements = {\n      algemeen: settingsAlgemeen,\n      widget: settingsWidget,\n      extraopties: settingsExtraopties,\n      humanhandoff: settingsHumanhandoff,\n      notificaties: settingsNotifications,\n      overig: settingsOverig,\n      beveiliging: settingsBeveiliging,\n      inbox: settingsInbox\n    };\n\n    // console.log(\'tabElements: \', tabElements);\n\n    // Hide all elements\n    Object.values(tabElements).forEach((el) => {\n      if (el) el.style.display = "none";\n    });\n\n    // Show the active element\n    const activeElement = tabElements[activeTab];\n    if (activeElement) activeElement.style.display = "block";\n  };\n\n  // Update display with the initial tab\n  window.updateSettingsDisplay(v.active_settings_tab);\n}\n\nfunction settingsTabClickEventListeners() {\n  window.Wized = window.Wized || [];\n  window.Wized.push((Wized) => {\n    const settingsTabItems = document.querySelectorAll("[w-el=\'settings-tab\']");\n\n    settingsTabItems.forEach((item) => {\n      item.addEventListener("click", (event) => {\n        settingsTabItems.forEach((tab) => tab.classList.remove("active"));\n        const clickedItem = event.currentTarget;\n        clickedItem.classList.add("active");\n        const dataValue = clickedItem.getAttribute("data-value");\n        Wized.data.v.active_settings_tab = dataValue;\n        // console.log(\'datavalue: \', dataValue);\n\n        // Call updateSettingsDisplay to reflect the change\n        window.updateSettingsDisplay(Wized.data.v.active_settings_tab);\n      });\n    });\n  });\n}\n\nsettingsTabClickEventListeners();\nchangeTabs();\n'
        }
      ]
    },
    {
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      condition: 'return (r.get_user_data.ok == true && r.get_user_data.data[0].organizations.length > 0)',
      name: 'get chatbots after get_user',
      id: 'd3e18308-ad3e-45cc-bd52-bd133f7634c7',
      trigger: 'after-request',
      hasCondition: true,
      folderId: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c',
      actions: [
        { id: 'fd44da70-aaed-4494-a377-79fb9b001d29', type: 'perform-request', request: '9425c8a3-851f-4aea-994c-af3b88ad7fe8' },
        { id: '98cfb1a3-db7f-45e9-870d-94b81900706c', type: 'perform-request', request: '8cc144e4-b421-46f5-a9e7-ee3f00940a07', condition: 'return (v.active_chatbot !== null)', hasCondition: true }
      ]
    },
    {
      condition: 'return (n.path == "/redirect")',
      name: 'impersonization',
      id: 'd6abef92-f650-4c05-8864-8f69e0a2d7dc',
      trigger: 'condition',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      actions: [
        {
          id: 'ea9bb752-2e16-40c8-85d9-70672db375db',
          type: 'run-function',
          function:
            'function getQueryParam(param) {\n  const urlParams = new URLSearchParams(window.location.search);\n  return urlParams.get(param);\n}\n\nsetTimeout(() => {\n  const sessionObject = getQueryParam("session_object");\n  if (sessionObject) {\n    localStorage.setItem("sb-sygpwnluwwetrkmwilea-auth-token", sessionObject);\n    n.path = \'/\'\n  }\n}, 500);'
        }
      ]
    },
    {
      condition: "return (n.href.includes('?tn='))",
      name: 'toast query params',
      trigger: 'page-complete',
      id: 'd7846486-ff64-42dc-81ec-5abfeea93b7b',
      hasCondition: true,
      folderId: 'a4ad4e2f-834f-4b84-bb43-5fc23d252a62',
      actions: [
        {
          id: 'cfb946cc-db53-440f-a34a-cd1724d35411',
          type: 'run-function',
          function:
            '// clear query param\n// window.location.replace(window.location.href.split(\'?\')[0]);\n\nlet message;\n\nif ((n.href.includes(\'?tn=cc\'))) {\n  message = "Chatbot aangemaakt"\n} else if ((n.href.includes(\'?tn=cd\'))){\n  message =  "Databron aangemaakt"\n} else if ((n.href.includes(\'?tn=dc\'))) {\n  message = "Chatbot verwijderd"\n} else {\n  return\n}\n\n// toast notifications\n\nconst toastMessage = {\n  id: crypto.randomUUID(),\n  expiration: new Date().getTime() + 5000,\n  type: "success",\n  message: message,\n};\n\n// transitions\n\nfunction openToast(toastElement) {\n  toastElement.style.display = "flex";\n  toastElement.style.opacity = 0;\n  toastElement.style.transform = "translateY(40px) scale(0.6)";\n\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 1;\n      toastElement.style.transform = "translateY(0) scale(1)";\n    });\n  });\n}\n\nfunction closeToast(toastElement) {\n  requestAnimationFrame(() => {\n    requestAnimationFrame(() => {\n      toastElement.style.opacity = 0;\n      toastElement.style.transform = "translateY(40px) scale(0.6)";\n      setTimeout(() => {\n        toastElement.style.display = "none";\n      }, 150);\n    });\n  });\n}\n\nasync function manageToast(toastElement) {\n  openToast(toastElement);\n  await new Promise((resolve) => setTimeout(resolve, 5000));\n  closeToast(toastElement);\n}\n\nv.toast_log.push(toastMessage);\n\nconst toastElement = document.querySelector(\n  `[toast_item_id=\'${toastMessage.id}\']`\n);\n\nmanageToast(toastElement);'
        }
      ]
    },
    {
      id: 'dbf2250f-ccb5-4526-91a5-fa5c8d8c4944',
      name: 'Set variables & run on page load (7 days)',
      folderId: '8fda368d-3d91-4ddc-84e0-352930ddb0c4',
      trigger: 'after-request',
      request: '8578e3e8-9133-4087-bdcd-c038e305fcb9',
      hasCondition: true,
      condition: 'return (n.path == "/")',
      actions: [
        {
          id: '5ea924ef-3999-44cf-9460-7f0e72a63299',
          type: 'run-function',
          function:
            '// define data\n\nconst chatsData = r.get_chats_analytics.data;\n\n//// Construct array chats\n\nlet chatsCountArray7 = [];\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 6 + i);\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return createdAt >= dayStart && createdAt <= dayEnd;\n  }).length;\n\n  chatsCountArray7.push(filteredChatsCount);\n}\n\n// set var manually\n\n{\n  {\n    chatsCountArray7.some((item) => item > 0)\n      ? (v.numbers_7 = chatsCountArray7)\n      : (v.numbers_7 = [10, 38, 13, 26, 25, 40, 20]);\n  }\n}\n\n// push chats chart\n\nwindow.Wized.push((Wized) => {\n  const colors = {\n    main: {\n      default: "#7E79F0", // purple\n      half: "EFE9FE", // middle purple\n      quarter: "#FCFBFF", // Light purple\n      zero: "rgba(225, 255, 58, 0)",\n    },\n    secondary: {\n      default: "rgba(80, 102, 120, 1)",\n      quarter: "rgba(80, 102, 120, 0.25)",\n    },\n  };\n\n  const weight = v.numbers_7;\n  const labels = [1, 2, 3, 4, 5, 6, 7];\n\n  // Ensure the DOM is fully loaded before initializing the chart\n  const ctx = document.getElementById("canvas2").getContext("2d");\n  const chart = new Chart(ctx, {\n    type: "line",\n    data: {\n      labels: labels,\n      datasets: [\n        {\n          fill: true, // Ensure the area under the line is filled\n          // backgroundColor: colors.main.quarter, // Use a light green for the fill color\n          backgroundColor: (context) => {\n            if (!context.chart.chartArea) {\n              return;\n            }\n            // console.log(context.chart.chatArea)\n            const {\n              ctx,\n              data,\n              chartArea: { top, bottom },\n            } = context.chart;\n            const gradientBg = ctx.createLinearGradient(0, top, 0, bottom);\n            gradientBg.addColorStop(0, "rgb(126,121,240,0.25)");\n            gradientBg.addColorStop(1, "rgba(255, 255, 255, 0)");\n            return gradientBg;\n          },\n          borderColor: colors.main.default,\n          pointBackgroundColor: colors.main.default,\n          data: weight,\n          lineTension: 0.4,\n          borderWidth: 2,\n          pointRadius: 0,\n          pointBorderColor: "rgba(0, 0, 0, 0)",\n          pointBackgroundColor: "rgba(0, 0, 0, 0)",\n        },\n      ],\n    },\n    options: {\n      devicePixelRatio: 2.5,\n      clip: false,\n      responsive: true,\n      maintainAspectRatio: false,\n      interaction: {\n        intersect: false,\n        mode: "index",\n      },\n      plugins: {\n        legend: {\n          display: false, // Ensures no legend is displayed\n        },\n        tooltip: {\n          enabled: false,\n        },\n      },\n      scales: {\n        x: {\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n        y: {\n          min: 0.9 * Math.min(...weight),\n          max: 1.1 * Math.max(...weight),\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n      },\n      hover: {\n        intersect: false,\n      },\n    },\n  });\n});\n\n//// Construct array Human Handoffs\n\nlet HandoffCountArray7 = [];\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 6 + i);\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return (\n      createdAt >= dayStart &&\n      createdAt <= dayEnd &&\n      chat.handoff_activated === true\n    );\n  }).length;\n\n  HandoffCountArray7.push(filteredChatsCount);\n}\n\n// set var manually\n\n{\n  {\n    HandoffCountArray7.some((item) => item > 0)\n      ? (v.handoff_7 = HandoffCountArray7)\n      : (v.handoff_7 = [10, 38, 13, 26, 25, 40, 20]);\n  }\n}\n\n// push handoff chart\n\nwindow.Wized.push((Wized) => {\n  const colors = {\n    main: {\n      default: "#7E79F0", // purple\n      half: "EFE9FE", // middle purple\n      quarter: "#FCFBFF", // Light purple\n      zero: "rgba(225, 255, 58, 0)",\n    },\n    secondary: {\n      default: "rgba(80, 102, 120, 1)",\n      quarter: "rgba(80, 102, 120, 0.25)",\n    },\n  };\n\n  const weight2 = v.handoff_7;\n  const labels = [1, 2, 3, 4, 5, 6, 7];\n\n  // Ensure the DOM is fully loaded before initializing the chart\n  const ctx = document.getElementById("canvas3").getContext("2d");\n  const chart = new Chart(ctx, {\n    type: "line",\n    data: {\n      labels: labels,\n      datasets: [\n        {\n          fill: true, // Ensure the area under the line is filled\n          // backgroundColor: colors.main.quarter, // Use a light green for the fill color\n          backgroundColor: (context) => {\n            if (!context.chart.chartArea) {\n              return;\n            }\n            // console.log(context.chart.chatArea)\n            const {\n              ctx,\n              data,\n              chartArea: { top, bottom },\n            } = context.chart;\n            const gradientBg = ctx.createLinearGradient(0, top, 0, bottom);\n            gradientBg.addColorStop(0, "rgb(126,121,240,0.25)");\n            gradientBg.addColorStop(1, "rgba(255, 255, 255, 0)");\n            return gradientBg;\n          },\n          borderColor: colors.main.default,\n          pointBackgroundColor: colors.main.default,\n          data: weight2,\n          lineTension: 0.4,\n          borderWidth: 2,\n          pointRadius: 0,\n          pointBorderColor: "rgba(0, 0, 0, 0)",\n          pointBackgroundColor: "rgba(0, 0, 0, 0)",\n        },\n      ],\n    },\n    options: {\n      devicePixelRatio: 2.5,\n      clip: false,\n      responsive: true,\n      maintainAspectRatio: false,\n      interaction: {\n        intersect: false,\n        mode: "index",\n      },\n      plugins: {\n        legend: {\n          display: false, // Ensures no legend is displayed\n        },\n        tooltip: {\n          enabled: false,\n        },\n      },\n      scales: {\n        x: {\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n        y: {\n          min: 0.9 * Math.min(...weight2),\n          max: 1.1 * Math.max(...weight2),\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n      },\n      hover: {\n        intersect: false,\n      },\n    },\n  });\n});\n\n//aantal chats\n\nlet chatsSum = 0;\n\nchatsCountArray7.forEach((day) => {\n  chatsSum += day;\n});\n\ndocument.querySelector(\'[w-el="aantal-chats"]\').innerHTML = chatsSum;\n\n//aantal handoffs\n\nlet handoffSum = 0;\n\nHandoffCountArray7.forEach((day) => {\n  handoffSum += day;\n});\n\ndocument.querySelector(\'[w-el="aantal-handoffs"]\').innerHTML = handoffSum;\n\n//// relative change chats\n\nlet chatsSumPrevious = 0;\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 13 + i);\n\n  const dayStart = new Date(currentDateTime);\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart);\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const dailyChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return createdAt >= dayStart && createdAt <= dayEnd;\n  }).length;\n\n  chatsSumPrevious += dailyChatsCount;\n}\n\n// console.log(chatsSumPrevious);\n\nlet relativeChange = ((chatsSum - chatsSumPrevious) / chatsSumPrevious) * 100;\n\n{\n  isFinite(relativeChange)\n    ? (relativeChange =\n        ((chatsSum - chatsSumPrevious) / chatsSumPrevious) * 100)\n    : isNaN(relativeChange)\n    ? (relativeChange = 0.001)\n    : (relativeChange = 100);\n}\n\n// console.log(\'chatsChange:\' + relativeChange);\n\n{\n  relativeChange >= 0\n    ? (document.querySelector(\'[w-el="chats-change-positive"]\').style.display =\n        "flex")\n    : (document.querySelector(\'[w-el="chats-change-positive"]\').style.display =\n        "none");\n}\n\n{\n  relativeChange >= 0\n    ? (document.querySelector(\'[w-el="chats-change-negative"]\').style.display =\n        "none")\n    : (document.querySelector(\'[w-el="chats-change-negative"]\').style.display =\n        "flex");\n}\n\ndocument.querySelector(\'[w-el="chats-text-change-negative"]\').innerHTML =\n  relativeChange.toFixed(1) + "%";\ndocument.querySelector(\'[w-el="chats-text-change-positive"]\').innerHTML =\n  "+" + relativeChange.toFixed(1) + "%";\n\n//// relative change handoffs\n\nlet handoffSumPrevious = 0;\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 13 + i);\n\n  const dayStart = new Date(currentDateTime);\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart);\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const dailyChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return (\n      createdAt >= dayStart &&\n      createdAt <= dayEnd &&\n      chat.handoff_activated === true\n    );\n  }).length;\n\n  handoffSumPrevious += dailyChatsCount;\n}\n\nlet relativeChangeHandoff =\n  ((handoffSum - handoffSumPrevious) / handoffSumPrevious) * 100;\n\n// console.log(\'handoffChange:\' + relativeChangeHandoff);\n\n{\n  isFinite(relativeChangeHandoff)\n    ? (relativeChangeHandoff =\n        ((handoffSum - handoffSumPrevious) / handoffSumPrevious) * 100)\n    : isNaN(relativeChangeHandoff)\n    ? (relativeChangeHandoff = 0.001)\n    : (relativeChangeHandoff = 100);\n}\n\n// console.log(\'handoffChange:\' + relativeChangeHandoff);\n\n{\n  relativeChangeHandoff >= 0\n    ? (document.querySelector(\n        \'[w-el="handoff-change-positive"]\'\n      ).style.display = "flex")\n    : (document.querySelector(\n        \'[w-el="handoff-change-positive"]\'\n      ).style.display = "none");\n}\n\n{\n  relativeChangeHandoff >= 0\n    ? (document.querySelector(\n        \'[w-el="handoff-change-negative"]\'\n      ).style.display = "none")\n    : (document.querySelector(\n        \'[w-el="handoff-change-negative"]\'\n      ).style.display = "flex");\n}\n\ndocument.querySelector(\'[w-el="handoff-text-change-negative"]\').innerHTML =\n  relativeChangeHandoff.toFixed(1) + "%";\n\ndocument.querySelector(\'[w-el="handoff-text-change-positive"]\').innerHTML =\n  "+" + relativeChangeHandoff.toFixed(1) + "%";\n'
        }
      ]
    },
    {
      id: 'dc7cdd15-8fd1-4e8e-b37e-7b4afe69cd69',
      name: 'Set variables & run on page load (30 days)',
      folderId: '8fda368d-3d91-4ddc-84e0-352930ddb0c4',
      trigger: 'after-request',
      request: '8578e3e8-9133-4087-bdcd-c038e305fcb9',
      hasCondition: true,
      condition: 'return (n.path == "/")',
      actions: [
        {
          id: '685e5fab-b5d0-41fa-8128-8315741a9033',
          type: 'run-function',
          function:
            "// define data\n\nconst chatsData = r.get_chats_analytics.data;\n\n/// Construct total chats array\n\nlet chatsCountArray = [];\n\nfor (let i = 0; i <= 29 ; i++) {\n  const currentDateTime = new Date ();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 29 + i)\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter(chat => {\n  const createdAt = new Date(chat.created_at);\n  return createdAt >= dayStart && createdAt <= dayEnd;\n  }).length;\n\n  chatsCountArray.push(filteredChatsCount); \n};\n\n// set total data manually\n\n{{\nchatsCountArray.some(item => item > 0) ? v.totalChats_30 = chatsCountArray : v.totalChats_30 = [3950, 4000, 5300, 2700, 3900, 4000, 4100, 2100, 3050, 4500, 2300, 2400, 5100, 2200, 2650, 4400, 5500, 4700, 5400, 3700, 3850, 5300, 6000,2300,2580,2450,2840,3840,3730,6400];\n}}\n\n// Construct array chats without human handoff\n\nlet successCountArray = [];\n\nfor (let i = 0; i <= 29 ; i++) {\n  const currentDateTime = new Date ();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 29 + i)\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter(chat => {\n  const createdAt = new Date(chat.created_at);\n  return createdAt >= dayStart && createdAt <= dayEnd && chat.handoff_activated === false;\n  }).length;\n\n  successCountArray.push(filteredChatsCount); \n}\n\n// set var manually\n\n{{\nsuccessCountArray.some(item => item > 0) ? v.success_30 = successCountArray : v.success_30 = [3598, 2925, 4211, 1609, 3576, 2865, 2983, 1021, 2010, 3368, 1193, 1012, 3789, 1023, 1642, 3296, 4463, 3668, 4031, 2547, 2733, 4223, 4894,1200,1500,1400,1800,2800,2700,3200];\n}}\n\n// get current time for labels\n\nconst currentDateTime = new Date();\n\n// set labels var manually\n\nconst datesArray = [];\n\nfor (let i = 0; i < 30; i++) {\n    const date = new Date(); // Get the current date and time\n    date.setDate(date.getDate() - i); // Subtract i days from the current date\n\n    let dateString;\n\n    if (i === 0) {\n        dateString = \"Vandaag\"; // Today's date label\n    } else if (i === 1) {\n        dateString = \"Gisteren\"; // Yesterday's date label\n    } else {\n        // Format the date as DD-MM-YYYY\n        dateString = date.getDate().toString().padStart(2, '0') + \"-\" \n                   + (date.getMonth() + 1).toString().padStart(2, '0') + \"-\" \n                   + date.getFullYear();\n    }\n\n    datesArray.unshift(dateString); // Add to the start of the array to maintain chronological order\n}\n\nv.labels_30 = datesArray;\n\n// calculate percentage\n\nlet totalChats = 0;\nlet successfulChats = 0;\n\n\n\nchatsCountArray.forEach(number => {\n    totalChats += number;\n});\n\nsuccessCountArray.forEach(number => {\n    successfulChats += number;\n});\n\nlet percentage = (successfulChats / totalChats) * 100;\n\n{\nisNaN(percentage) ? percentage = 100 : percentage = (successfulChats / totalChats) * 100;\n}\n\ndocument.querySelector('[w-el=\"success-percentage\"]').innerHTML = percentage.toFixed(1) + '%';\n\n// push chart\n \nwindow.Wized.push((Wized) => {\n\n    const weight = v.success_30;\n    const weightTotal = v.totalChats_30;\n    const labels = v.labels_30;\n \n    // Ensure the DOM is fully loaded before initializing the chart\n    const ctx = document.getElementById(\"canvasCandle\").getContext(\"2d\");\n    const chart = new Chart(ctx, {\n        type: 'bar',\n        data: {\n            labels: labels,\n            datasets: [\n            {\n                fill: true,\n                data: weight,\n                label: 'Succesvol door AI',\n                borderRadius: { topLeft: 5, topRight: 5, bottomLeft: 0, bottomRight: 0 },\n              \tbackgroundColor: '#7E79F0',\n                borderSkipped: false,\n            },{\n                fill: true,\n                data: weightTotal,\n                label: 'Aantal gesprekken',\n                borderRadius: { topLeft: 5, topRight: 5, bottomLeft: 0, bottomRight: 0 },\n              \tbackgroundColor: '#EFE9FE',\n                borderSkipped: false,\n            },{\n                fill: true,\n                data: Array(30).fill(Math.max(...weightTotal)),\n                borderRadius: { topLeft: 5, topRight: 5, bottomLeft: 0, bottomRight: 0 },\n              \tbackgroundColor: '#FBFBFF',\n                borderSkipped: false,\n            }]\n        },\n        options: {\n        \tclip: false,\n            responsive: true,\n            maintainAspectRatio: false,\n            interaction: {\n      \t\t\t\tintersect: false,\n      \t\t\t\t\tmode: 'index',\n           \t},\n            plugins: {\n                legend: {\n                \tposition: 'bottom',\n                    display: false, // Ensures no legend is displayed\n                },\n                tooltip: {\n                    position: 'average',\n                    filter: function (tooltipItem) {\n        \t\t\treturn tooltipItem.datasetIndex === 0 || tooltipItem.datasetIndex === 1;\n    \t\t\t\t},\n                    itemSort: function (a, b) {\n                    return b.datasetIndex - a.datasetIndex;\n                    },\n                    usePointStyle: true,\n                    caretSize: 6,\n                    caretPadding: 8,\n                \tintersect: false,\n                \tbackgroundColor: '#080808',\n                    borderColor: '#fff',\n                    borderWidth: '2',\n                    footerFontStyle: 'light',\n                    footerColor: '#fff',\n                    titleColor: '#fff',\n                    bodyColor: '#fff',\n                    bodySpacing: -3,\n                    padding: 12,\n                    cornerRadius: 10,\n                    displayColors: false,\n                    footerFont: {\n                        size: 10,\n                        weight: 'normal'\n                    },\n                    bodyFont: {\n                        size: 14,\n                        weight: 'bold'\n                    },\n                    titleFont: {\n                        size: 10,\n                        weight: 'normal',\n                    }\n                }\n            },\n            scales: {\n                x: {\n                \t\tstacked: true,\n                    grid: {\n                        color: '#FFFFFF',\n                        drawBorder: false\n                    },\n                    ticks: {\n                        display: false // X-axis labels to white\n                    }\n                },\n                y: {\n                \t\tbeginAtZero: true,\n                \t\tmin: 0,\n                        max: (Math.max(...weightTotal)),\n                \t\tgrid: {\n                        color: '#F5F5F5',\n                        borderDash: [8, 8],\n                        borderWidth: 2,\n                        drawBorder: false\n                    },\n                    ticks: {\n                        display: false // X-axis labels to white\n                    }\n                }\n            },\n            hover: {\n    \t\t\t\t\tintersect: false\n  \t\t\t\t\t}\n        }\n    })\n});\n"
        }
      ]
    },
    {
      request: 'VHepDvprAWpqGBIGUYcA',
      name: 'add urls after get_sitemap',
      id: 'dc8spE8ksY1FpWxA6Ckl',
      trigger: 'after-request',
      folderId: 'gccMuQyf668xZ0Ngt6Cg',
      actions: [
        {
          id: '5ef14fd2-f6ef-4bcd-8983-e95556f90a80',
          type: 'run-function',
          function:
            "if (r.get_sitemap.ok == true) {\n  const newUrls = r.get_sitemap.data.urls;\n  console.log(\"newUrls\")\n  const popupElement = document.querySelector('[w-el=\"popup-create-datasource\"]');\n  const isPopupVisible = window.getComputedStyle(popupElement).display === 'flex';\n\n  if (isPopupVisible) {\n    // Always add all URLs when the create datasource popup is visible\n    v.crawledpages = [...new Set(newUrls.map(url => url.trim().toLowerCase()))];\n\n    const totalUrlsCount = v.crawledpages.length;\n\n    // Show a toast displaying the total number of URLs found\n    const toastMessage = `${totalUrlsCount} URLs in totaal gevonden`;\n\n    window.showToastNotification(toastMessage, 'success');\n\n    // Show the URL form and hide the website form\n    document.querySelector('[datasourcesform=\"website\"]').style.display = 'none';\n    document.querySelector('[datasourcesform=\"url\"]').style.display = 'flex';\n    \n\n  } else {\n    const existingUrls = v.scrapetool_urls_list || []; // Ensure it's an array\n\n    // Extract and normalize existing URLs\n    const normalizedExistingUrls = existingUrls.map(entry => entry.url.trim().toLowerCase());\n    const existingUrlsSet = new Set(normalizedExistingUrls);\n\n    // Filter new URLs by excluding those already in existingUrlsSet\n    const addedUrls = newUrls.filter(url => !existingUrlsSet.has(url.trim().toLowerCase()));\n\n    // Add only the new URLs to the crawledpages list\n    v.crawledpages = [...new Set(addedUrls.map(url => url.trim().toLowerCase()))];\n\n    // Count the new and total URLs\n    const addedUrlsCount = addedUrls.length;\n    const totalUrlsCount = v.crawledpages.length;\n\n    // Show a notification with the total and newly added URLs in Dutch\n    const toastMessage =\n      addedUrlsCount === newUrls.length\n        ? `${totalUrlsCount} URLs in totaal gevonden` // All URLs are new\n        : addedUrlsCount > 0\n        ? `${totalUrlsCount} URLs in totaal gevonden, ${addedUrlsCount} nieuwe URLs toegevoegd` // Some new URLs\n        : 'Geen nieuwe URLs gevonden'; // No new URLs\n\n    window.showToastNotification(toastMessage, 'success');\n  }\n}\n\n// Hide the spinner\ndocument.querySelectorAll('[spinner]').forEach(function (element) {\nelement.style.display = 'none';\n});"
        }
      ]
    },
    {
      id: 'e0sEg75CYiNnaK0plOQl',
      name: 'redirect after create_user',
      folderId: '282de06d-bce3-4d8b-b577-d9e0ec11a35d',
      trigger: 'after-request',
      request: '7e33da97-52fa-4536-b037-9ea1ac76a478',
      actions: [
        { id: '357a7b71-e6ad-447a-89db-de48772c88a1', type: 'navigate-to', url: 'return "/"', hasCondition: true, condition: 'return (r.create_user.ok == true)' },
        {
          id: '01a2d39e-6eeb-41fe-b221-178681a4d8d5',
          type: 'run-function',
          function:
            "const spinner = document.querySelector('[spinner=\"auth\"]');\nconst signupButton = document.querySelector('[multi-step-signup=\"button\"]');\nspinner.style.display = 'none';\nsignupButton.setAttribute('value', 'Account maken');",
          hasCondition: true,
          condition: 'return (!r.create_user.ok == true)'
        }
      ]
    },
    {
      id: 'e8f274dc-0dc5-4249-afa6-d1f866fdd751',
      name: 'Set variables & run on page load (7 days chatbot)',
      folderId: '8fda368d-3d91-4ddc-84e0-352930ddb0c4',
      trigger: 'after-request',
      request: '8578e3e8-9133-4087-bdcd-c038e305fcb9',
      hasCondition: true,
      condition: 'return (n.path == "/chatbot")',
      actions: [
        {
          id: '56fa3dcb-f9c8-492a-a951-47e9e47393c0',
          type: 'run-function',
          function:
            'await new Promise((res) => setTimeout(res, 100));\n\n// define data\n\nconst chatsData = r.get_chats_analytics.data;\n\n//// Construct array chats\n\nlet chatsCountArray7 = [];\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 6 + i);\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return (\n      createdAt >= dayStart &&\n      createdAt <= dayEnd &&\n      chat.chatbot_id === v.active_chatbot.data\n    );\n  }).length;\n\n  chatsCountArray7.push(filteredChatsCount);\n}\n\n// set var manually\n\n{\n  {\n    chatsCountArray7.some((item) => item > 0)\n      ? (v.numbers_7 = chatsCountArray7)\n      : (v.numbers_7 = [10, 38, 13, 26, 25, 40, 20]);\n  }\n}\n\n// push chats chart\n\nwindow.Wized.push((Wized) => {\n  const colors = {\n    main: {\n      default: "#7E79F0", // purple\n      half: "EFE9FE", // middle purple\n      quarter: "#FCFBFF", // Light purple\n      zero: "rgba(225, 255, 58, 0)",\n    },\n    secondary: {\n      default: "rgba(80, 102, 120, 1)",\n      quarter: "rgba(80, 102, 120, 0.25)",\n    },\n  };\n\n  const weight = v.numbers_7;\n  const labels = [1, 2, 3, 4, 5, 6, 7];\n\n  // Ensure the DOM is fully loaded before initializing the chart\n  const ctx = document.getElementById("canvas2").getContext("2d");\n    chatbotsChart1 = new Chart(ctx, {\n    type: "line",\n    data: {\n      labels: labels,\n      datasets: [\n        {\n          fill: true, // Ensure the area under the line is filled\n          // backgroundColor: colors.main.quarter, // Use a light green for the fill color\n          backgroundColor: (context) => {\n            if (!context.chart.chartArea) {\n              return;\n            }\n            // console.log(context.chart.chatArea);\n            const {\n              ctx,\n              data,\n              chartArea: { top, bottom },\n            } = context.chart;\n            const gradientBg = ctx.createLinearGradient(0, top, 0, bottom);\n            gradientBg.addColorStop(0, "rgb(126,121,240,0.25)");\n            gradientBg.addColorStop(1, "rgba(255, 255, 255, 0)");\n            return gradientBg;\n          },\n          borderColor: colors.main.default,\n          pointBackgroundColor: colors.main.default,\n          data: weight,\n          lineTension: 0.4,\n          borderWidth: 2,\n          pointRadius: 0,\n          pointBorderColor: "rgba(0, 0, 0, 0)",\n          pointBackgroundColor: "rgba(0, 0, 0, 0)",\n        },\n      ],\n    },\n    options: {\n      devicePixelRatio: 2.5,\n      clip: false,\n      responsive: true,\n      maintainAspectRatio: false,\n      interaction: {\n        intersect: false,\n        mode: "index",\n      },\n      plugins: {\n        legend: {\n          display: false, // Ensures no legend is displayed\n        },\n        tooltip: {\n          enabled: false,\n        },\n      },\n      scales: {\n        x: {\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n        y: {\n          min: 0.9 * Math.min(...weight),\n          max: 1.1 * Math.max(...weight),\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n      },\n      hover: {\n        intersect: false,\n      },\n    },\n  });\n});\n\n//// Construct array Human Handoffs\n\nlet HandoffCountArray7 = [];\n\nfor (let i = 0; i <= 6; i++) {\n  const currentDateTime = new Date();\n  currentDateTime.setUTCDate(currentDateTime.getUTCDate() - 6 + i);\n\n  const dayStart = currentDateTime;\n  dayStart.setUTCHours(0, 0, 0, 0); // Start of the day\n  const dayEnd = new Date(dayStart.getTime());\n  dayEnd.setUTCHours(23, 59, 59, 999); // End of the day\n\n  const filteredChatsCount = chatsData.filter((chat) => {\n    const createdAt = new Date(chat.created_at);\n    return (\n      createdAt >= dayStart &&\n      createdAt <= dayEnd &&\n      chat.handoff_activated === true &&\n      chat.chatbot_id === v.active_chatbot.data\n    );\n  }).length;\n\n  HandoffCountArray7.push(filteredChatsCount);\n}\n\n// set var manually\n\n{\n  {\n    HandoffCountArray7.some((item) => item > 0)\n      ? (v.handoff_7 = HandoffCountArray7)\n      : (v.handoff_7 = [10, 38, 13, 26, 25, 40, 20]);\n  }\n}\n\n// push handoff chart\n\nwindow.Wized.push((Wized) => {\n  const colors = {\n    main: {\n      default: "#7E79F0", // purple\n      half: "EFE9FE", // middle purple\n      quarter: "#FCFBFF", // Light purple\n      zero: "rgba(225, 255, 58, 0)",\n    },\n    secondary: {\n      default: "rgba(80, 102, 120, 1)",\n      quarter: "rgba(80, 102, 120, 0.25)",\n    },\n  };\n\n  const weight2 = v.handoff_7;\n  const labels = [1, 2, 3, 4, 5, 6, 7];\n\n  // Ensure the DOM is fully loaded before initializing the chart\n  const ctx = document.getElementById("canvas3").getContext("2d");\n    chatbotsChart2 = new Chart(ctx, {\n    type: "line",\n    data: {\n      labels: labels,\n      datasets: [\n        {\n          fill: true, // Ensure the area under the line is filled\n          // backgroundColor: colors.main.quarter, // Use a light green for the fill color\n          backgroundColor: (context) => {\n            if (!context.chart.chartArea) {\n              return;\n            }\n            // console.log(context.chart.chatArea);\n            const {\n              ctx,\n              data,\n              chartArea: { top, bottom },\n            } = context.chart;\n            const gradientBg = ctx.createLinearGradient(0, top, 0, bottom);\n            gradientBg.addColorStop(0, "rgb(126,121,240,0.25)");\n            gradientBg.addColorStop(1, "rgba(255, 255, 255, 0)");\n            return gradientBg;\n          },\n          borderColor: colors.main.default,\n          pointBackgroundColor: colors.main.default,\n          data: weight2,\n          lineTension: 0.4,\n          borderWidth: 2,\n          pointRadius: 0,\n          pointBorderColor: "rgba(0, 0, 0, 0)",\n          pointBackgroundColor: "rgba(0, 0, 0, 0)",\n        },\n      ],\n    },\n    options: {\n      devicePixelRatio: 2.5,\n      clip: false,\n      responsive: true,\n      maintainAspectRatio: false,\n      interaction: {\n        intersect: false,\n        mode: "index",\n      },\n      plugins: {\n        legend: {\n          display: false, // Ensures no legend is displayed\n        },\n        tooltip: {\n          enabled: false,\n        },\n      },\n      scales: {\n        x: {\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n        y: {\n          min: 0.9 * Math.min(...weight2),\n          max: 1.1 * Math.max(...weight2),\n          grid: {\n            color: "#FFFFFF",\n            drawBorder: false,\n          },\n          ticks: {\n            display: false, // X-axis labels to white\n          },\n        },\n      },\n      hover: {\n        intersect: false,\n      },\n    },\n  });\n});\n\n//aantal chats\n\nlet chatsSum = 0;\n\nchatsCountArray7.forEach((day) => {\n  chatsSum += day;\n});\n\ndocument.querySelector(\'[w-el="chatbot-total-chats"]\').innerHTML = chatsSum;\n\n//aantal handoffs\n\nlet handoffSum = 0;\n\nHandoffCountArray7.forEach((day) => {\n  handoffSum += day;\n});\n\ndocument.querySelector(\'[w-el="chatbot-total-handoffs"]\').innerHTML =\n  handoffSum;\n'
        }
      ]
    },
    {
      condition: 'if (i["csv-upload"]["0"]) {\n  return true\n}',
      name: 'set csvContent variable',
      trigger: 'condition',
      id: 'e9efa383-7324-4e04-862e-880ba31b552e',
      folderId: '5d2e1b6e-42e5-4332-a023-7b90f25f3849',
      actions: [
        {
          id: 'ce11bd75-fce1-455b-b19a-35262f162855',
          type: 'run-function',
          function:
            'var file = i["csv-upload"]["0"];\n\nvar reader = new FileReader();\n\nreader.onload = function (e) {\n  \n  // v.csvContent = e.target.result;\n\n  function sizeInMBorKB(sizeBytes) {\n      const sizeMB = (sizeBytes / (1024 * 1024)).toFixed(2);\n      if (sizeBytes < 1024 * 1024) {\n        const sizeKB = (sizeBytes / 1024).toFixed(2);\n        return `${sizeKB} KB`;\n      }\n      return `${sizeMB} MB`;\n    }\n    const fileSize = file.size;\n    const readableSize = sizeInMBorKB(fileSize);\n\n    const createdAt = new Date();\n      const prettyDate = createdAt.getDate().toString().padStart(2, \'0\') + "-" + (createdAt.getMonth() + 1).toString().padStart(2, \'0\') + "-" + createdAt.getFullYear();\n      const prettyTime = createdAt.getHours().toString().padStart(2, \'0\') + ":" + createdAt.getMinutes().toString().padStart(2, \'0\');\n\n    v.csvContent = {\n      value: e.target.result,\n      name: file.name,\n      size: readableSize,\n      date: prettyDate,\n      time: prettyTime,\n    };\n    // console.log(v.csvContent)\n};\n\nreader.readAsText(file);\n'
        }
      ]
    },
    {
      request: '9425c8a3-851f-4aea-994c-af3b88ad7fe8',
      condition: 'return !v.active_chatbot\n',
      name: 'set active_chatbot if null',
      id: 'ed6ad6a8-dd20-456f-bde9-9d26ad12b5b2',
      trigger: 'after-request',
      hasCondition: true,
      folderId: 'dcb521bb-b33c-403a-9b7d-499d7f4c177c',
      actions: [
        {
          id: '148db9e5-385b-46c8-a609-7196e5520848',
          type: 'run-function',
          condition: 'return (r.get_chatbots.data.length !== 0)',
          function:
            '// for first item ?\n\nWized.data.v.active_chatbot = r.get_chatbots.data[0].id;\n\ndata.dynamicActiveChatbotName = r.get_chatbots.data[0].name;\nlocalStorage.setItem("activeName", r.get_chatbots.data[0].name);\ndata.dynamicActiveChatbotUrl = r.get_chatbots.data[0].website_url;\nlocalStorage.setItem("activeUrl", r.get_chatbots.data[0].website_url);\n\n// re-fetch data-sources for new active chatbot\nWized.requests.execute("get_datasources");\n\n// re-fetch new active chatbot ???\nWized.requests.execute("get_chatbot");',
          hasCondition: true
        },
        {
          id: '6a5eb3fa-c968-4d03-8b91-deed50f50a70',
          type: 'run-function',
          condition: 'return (r.get_chatbots.data.length == 0)',
          function: 'document.querySelector("[w-el=\'datasources-skeleton-wrapper\']").style.display = "none";',
          hasCondition: true
        }
      ]
    },
    {
      id: 'edc98b15-bdad-46c2-8b55-d4e71a4472b5',
      name: 'redirection',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      trigger: 'condition',
      condition: 'return (n.path == "/redirect" && r.get_user.hasRequested == true)',
      actions: [
        {
          id: 'de576981-5cce-479e-92fe-6138e54015fd',
          type: 'run-function',
          function:
            'function getQueryParam(param) {\n  const urlParams = new URLSearchParams(window.location.search);\n  return urlParams.get(param);\n}\n\nif (r.get_user.ok == true) {\n  const targetUrl = getQueryParam("url");\n  console.log(targetUrl);\n  if (!targetUrl) {\n    console.log("no target url")\n  } else {\n    setTimeout(() => {\n      n.path = "https://dashboard.sleak.chat/" + targetUrl;\n    }, 1000);\n  }\n}'
        }
      ]
    },
    {
      id: 'efdb1290-cccc-4dc9-9b1d-a126541fd8e4',
      name: 'navigate to login after signout',
      folderId: 'eef8bcaf-db9d-4882-a53b-fcc0ad9acfd8',
      trigger: 'after-request',
      request: '828aa4d6-8919-45cb-8964-f0cd7f2b48a2',
      hasCondition: true,
      condition: 'return r.signout_user.statusText == "Success"',
      actions: [{ id: 'c6ebab80-a27a-4d95-a866-2bc7e0039a1c', type: 'run-function', function: "localStorage.setItem('sleak_loggedin', false);\nn.path = '/login'" }]
    },
    {
      request: '86c07921-dadf-4787-99ed-7f7ad261183c',
      name: '[DEPR] get_kb_items after create_kb_item',
      trigger: 'after-request',
      id: 'f123fb29-6019-4d27-a68a-a2b9502cef68',
      folderId: '35c9310c-a444-4ece-99e2-cb12a2ef992c',
      actions: [{ id: 'b1c43968-88d6-4020-b816-5f27d9d1a7ef', type: 'perform-request', request: '9d139b25-dc47-41e5-8bfd-f09ec49d71da' }]
    },
    {
      condition: 'return (v.active_datasource !== null)',
      name: 'get joins',
      trigger: 'condition',
      id: 'f38b21a7-bcd0-4ab5-9e42-2d7b77a08051',
      folderId: '55214649-2bac-4398-a861-03d94d2aad9d',
      actions: [
        {
          id: '24768629-5d76-4a1a-92dd-cb29de750f66',
          type: 'run-function',
          condition: "return (n.path.includes('/kennis/'))",
          function: 'Wized.requests.execute("get_chatbots_datasources_joins");',
          hasCondition: true
        }
      ]
    },
    {
      request: '2b0b056c-0433-40b4-b023-013a58dd4123',
      name: 'load more array handling',
      trigger: 'after-request',
      id: 'fa21fd8d-095b-4374-8974-b9413af2d437',
      folderId: '99a16fdd-65fc-4ba5-9c99-4847a2473e67',
      actions: [
        {
          id: '17ec0336-6df4-4261-80d2-64f09507282c',
          type: 'run-function',
          function:
            '// re-index scrollbox element with new height\nvar scrollBox = document.querySelector(\'[w-el="chats-list-container"]\');\nconst chatItems = document.querySelectorAll(".chat-list-item");\n\nconst loadMoreChats = r.get_chats_pagination.data;\n\nconst existingChats = v.loadmorechats;\n\nv.loadmorechats = [...existingChats, ...loadMoreChats];\n'
        }
      ]
    },
    {
      request: 'xSr95XwPJqWgVNFcIqGe',
      name: 'add urls after firecrawl_map',
      id: 's2GpvrU7g2ixGZqUADaA',
      trigger: 'after-request',
      folderId: 'gccMuQyf668xZ0Ngt6Cg',
      actions: [
        {
          id: 'b4d8f323-79ac-414f-9be4-0f3a4ac9054e',
          type: 'run-function',
          function:
            "if (r.firecrawl_map.ok == true) {\n  const newUrls = r.firecrawl_map.data.links;\n  const popupElement = document.querySelector('[w-el=\"popup-create-datasource\"]');\n  const isPopupVisible = window.getComputedStyle(popupElement).display === 'flex';\n\n  if (isPopupVisible) {\n    // Always add all URLs when the create datasource popup is visible\n    v.crawledpages = [...new Set(newUrls.map(url => url.trim().toLowerCase()))];\n\n    const totalUrlsCount = v.crawledpages.length;\n\n    // Show a toast displaying the total number of URLs found\n    const toastMessage = `${totalUrlsCount} URLs in totaal gevonden`;\n\n    window.showToastNotification(toastMessage, 'success');\n\n    // Show the URL form and hide the website form\n    document.querySelector('[datasourcesform=\"website\"]').style.display = 'none';\n    document.querySelector('[datasourcesform=\"url\"]').style.display = 'flex';\n    \n\n  } else {\n    const existingUrls = v.scrapetool_urls_list || []; // Ensure it's an array\n\n    // Extract and normalize existing URLs\n    const normalizedExistingUrls = existingUrls.map(entry => entry.url.trim().toLowerCase());\n    const existingUrlsSet = new Set(normalizedExistingUrls);\n\n    // Filter new URLs by excluding those already in existingUrlsSet\n    const addedUrls = newUrls.filter(url => !existingUrlsSet.has(url.trim().toLowerCase()));\n\n    // Add only the new URLs to the crawledpages list\n    v.crawledpages = [...new Set(addedUrls.map(url => url.trim().toLowerCase()))];\n\n    // Count the new and total URLs\n    const addedUrlsCount = addedUrls.length;\n    const totalUrlsCount = v.crawledpages.length;\n\n    // Show a notification with the total and newly added URLs in Dutch\n    const toastMessage =\n      addedUrlsCount === newUrls.length\n        ? `${totalUrlsCount} URLs in totaal gevonden` // All URLs are new\n        : addedUrlsCount > 0\n        ? `${totalUrlsCount} URLs in totaal gevonden, ${addedUrlsCount} nieuwe URLs toegevoegd` // Some new URLs\n        : 'Geen nieuwe URLs gevonden'; // No new URLs\n\n    window.showToastNotification(toastMessage, 'success');\n  }\n}\n\n// Hide the spinner\ndocument.querySelectorAll('[spinner=\"crawl-urls\"]').forEach(function (element) {\nelement.style.display = 'none';\n});"
        }
      ]
    },
    {
      id: 'sWMOW1HI30sY1zURS365',
      name: 'revert recurring scrape addon',
      folderId: 'PNvaP7BxV1nqggz2UG79',
      trigger: 'after-request',
      request: '76ea538c-0c75-4819-8bc2-0115402aa40f',
      actions: [
        {
          id: '79dd81c1-8b13-4f39-bb95-1fc56ad1bbf5',
          type: 'run-function',
          function:
            "const hasRecurringAddon = !!r.get_user_data?.data?.[0]?.organizations?.[0]?.subscriptions?.find(sub => sub.subscription_type == 'base' && sub.addon_recurringscrape === true) ?? false;\n\nif (!hasRecurringAddon && r.activate_recurring_scrape_addon.ok !== true) {\n  const closePseudoElement = document.querySelector('[w-el=\"reduccingscrape-addon-reverse\"]');\n  const recurringCheckbox = document.querySelector('[w-el=\"recurring-checkbox-container\"]');\n  const recurringPopup = document.querySelector('[popupmodal=\"recurringscrape-upgrade\"]');\n\n  console.log('no addon');\n  recurringCheckbox.addEventListener('click', function () {\n    recurringPopup.style.transform = 'translateY(5px)';\n    recurringPopup.style.opacity = 0;\n    recurringPopup.style.display = 'flex';\n    setTimeout(() => {\n      recurringPopup.style.transform = 'translateY(0)';\n      recurringPopup.style.opacity = 1;\n    }, 10);\n  });\n\n  closePseudoElement.addEventListener('click', function () {\n    i['toggle-recurringscrape'] = false;\n    i['toggle-recurringxml'] = false;\n  });\n  document.addEventListener('keydown', function (event) {\n    if (event.key === 'Escape') {\n      i['toggle-recurringscrape'] = false;\n      i['toggle-recurringxml'] = false;\n    }\n  });\n}\n",
          hasCondition: true,
          condition: 'return n.path.includes("/kennis/databronnen");'
        }
      ]
    }
  ],
  requests: [
    {
      id: '0262a872-8cdd-451c-899b-c5d13661a54f',
      number: 37,
      name: 'update_chatbot_settings_widget',
      folderId: '3ffad400-fc90-4dd0-bf87-f4e01bd8e9da',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'chatbots',
      recordId: 'return v.active_chatbot',
      data: [
        {
          key: 'primary_color',
          value: 'const inputValue = f["form-settings-widget"].primary_color;\n\nif (inputValue.charAt(0) == \'#\') {\n  return inputValue\n} else {\n  return "#" + inputValue\n}'
        },
        {
          key: 'popup',
          value:
            'return {\n    "desktop": f["form-settings-widget"].toggle_popup_enabled_desktop,\n    "mobile": f["form-settings-widget"].toggle_popup_enabled_mobile,\n    "chime": {\n        "mobile": f["form-settings-widget"].popup_chime_mobile,\n        "desktop": f["form-settings-widget"].popup_chime_desktop\n    }\n}'
        },
        {
          key: 'widget_styling',
          value:
            'return {\n    "widget_header": f["form-settings-widget"].widget_header,\n    "user_message_primary_color": f["form-settings-widget"].user_message_primary_color,\n    "widget_border": f["form-settings-widget"].widget_border\n}'
        },
        {
          key: 'btn_offset',
          value:
            'return {\n    "x_desktop": f["form-settings-widget"].offset_x_desktop,\n    "y_desktop": f["form-settings-widget"].offset_y_desktop,\n    "x_mobile": f["form-settings-widget"].offset_x_mobile,\n    "y_mobile": f["form-settings-widget"].offset_y_mobile,\n    "align_right": {\n        "mobile": f["form-settings-widget"].toggle_alignbtn_mobile,\n        "desktop": f["form-settings-widget"].toggle_alignbtn_desktop\n    }\n}'
        },
        { key: 'ai_badge', value: 'return f["form-settings-widget"].ai_badge' }
      ]
    },
    {
      method: 'upload',
      upsert: true,
      type: 'supabase',
      folderId: '0b4805ef-4501-41ec-85aa-8202e40e914a',
      bucket: 'users',
      path: 'const userId = r.get_user.data.user.id;\nreturn userId + \'/\' + f["form-settings-algemeen"].avatar["0"].name',
      number: 36,
      file: '// return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\nreturn f["form-settings-algemeen"].avatar["0"]',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'upsert_avatar_file',
      id: '04896350-7db5-44ee-b832-ca64a811430e'
    },
    {
      recordId: 'return `eq.` + r.get_user.data.user.identities[0].id',
      number: 9,
      method: 'get',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_user_data_DEPR',
      id: '050496f9-8355-40d8-9505-09c4852dc184',
      type: 'supabase',
      folderId: '879ed82b-481f-43dd-96c5-cd5646fb65ae',
      table: 'users'
    },
    {
      number: 5,
      data: [
        { value: 'return f["form-create-chatbot"].chatbot_name;\n', key: 'name' },
        { value: 'return f["form-create-chatbot"].organization_name', key: 'organization_name' },
        { value: 'return f["form-create-chatbot"].cs_email', key: 'cs_email' },
        { value: "const rawUrl = f[\"form-create-chatbot\"].website_url;\n\nconst formattedUrl = rawUrl.replace('https://', '');\n\nreturn `https://${formattedUrl}`\n\n", key: 'website_url' },
        { value: 'return f["form-create-chatbot"].cs_email', key: 'cs_email' },
        { value: 'return r.get_user.data.user.id', key: 'created_by' },
        { value: 'return r.get_user_data.data[0].organizations[0].id', key: 'organization_id' }
      ],
      method: 'create',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'create_chatbot',
      id: '05bf339b-cab8-47ad-9499-92fc88f4443a',
      type: 'supabase',
      table: 'chatbots',
      folderId: '579e40ce-81ee-4ae2-9f2e-6d1ff9e9e84f'
    },
    {
      id: '148b2e82-9260-425b-9d0d-bfafd9a7f64d',
      number: 39,
      name: 'update_chatbot_settings_extraopties',
      folderId: '3ffad400-fc90-4dd0-bf87-f4e01bd8e9da',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'chatbots',
      recordId: 'return v.active_chatbot',
      data: [
        {
          key: 'channels_data',
          value:
            'return {\n  enabled: f["form-settings-extraopties"].toggle_channels,\n  form: {\n    enabled: f["form-settings-extraopties"].toggle_channels_form,\n    value: f["form-settings-extraopties"].channels_form_value,\n    message: f["form-settings-extraopties"].channels_form_message\n  },\n  phone: {\n    enabled: f["form-settings-extraopties"].toggle_channels_phone,\n    value: f["form-settings-extraopties"].channels_phone_value,\n    message: f["form-settings-extraopties"].channels_phone_message\n  },\n  whatsapp: {\n    enabled: f["form-settings-extraopties"].toggle_channels_whatsapp,\n    value: f["form-settings-extraopties"].channels_whatsapp_value,\n    message: f["form-settings-extraopties"].channels_whatsapp_message\n  }\n}'
        },
        { key: 'channels_enabled', value: 'return f["form-settings-extraopties"].toggle_channels' },
        { key: 'link_previews', value: 'return i.toggle_linkpreviews' },
        {
          key: 'email_gate',
          value:
            'return {\n  "activated": f["form-settings-extraopties"].toggle_emailgate_enabled,\n  "blocking": f["form-settings-extraopties"].toggle_emailgate_blocking,\n  "confirmation_message": f["form-settings-extraopties"].confirmation_message\n}'
        },
        { key: 'conversation_starters_enabled', value: 'return i.toggle_conversationstarters_enabled;\n' },
        {
          key: 'conversation_starters',
          value:
            "const convStartersArray = [];\n\ndocument.querySelectorAll('[w-el=conversationstarters-list-item]').forEach(item => {\n  const question = item.querySelector('[w-el=\"conversationstarters-list-item-key\"]').value;\n  const answer = item.querySelector('[w-el=\"conversationstarters-list-item-value\"]').value;\n  convStartersArray.push({\n    question,\n    answer\n  });\n});\n\nreturn convStartersArray"
        }
      ]
    },
    {
      recordId: 'return v.active_datasource',
      number: 51,
      method: 'update',
      data: [
        {
          value:
            'var keys = document.querySelectorAll(\'[api-headers-table=key]\');\nvar values = document.querySelectorAll(\'[api-headers-table=value]\');\nvar headers = {};\n\nkeys.forEach((keyInput, index) => {\n    var valueInput = values[index];\n    headers[keyInput.value] = valueInput.value;\n});\n\nvar propertyKeys = document.querySelectorAll(\'[api-properties-table=key]\');\nvar propertyValues = document.querySelectorAll(\'[api-properties-table=value]\');\nvar properties = [];\npropertyKeys.forEach((keyInput, index) => {\n    var valueInput = propertyValues[index];\n    properties.push({ index: index, property: keyInput.value, description: valueInput.value });\n});\n\nlet mappingObject;\nif (v.codemirrorInitialized == true) {\n  const outputSchemaEditor = document.getElementById("code-editor");\n  const trimmedValue = outputSchemaEditor.value.trim();\n  mappingObject = JSON.stringify(trimmedValue);\n} else {\n  mappingObject = r.get_datasources.data.find((item) => item.id === v.active_datasource).datasource_type_config.outputSchema;\n}\n\n// console.log("finalvalue: ", finalValue);\n\nreturn {\n  body: f["form-edit-api"].body,\n  method: f["form-edit-api"].api_method,\n  bodyType: f["form-edit-api"].api_body_type,\n  protocol: f["form-edit-api"].api_authprotocol,\n  headers: headers,\n  properties: properties,\n  endpointUrl: f["form-edit-api"].endpoint_url,\n  basicAuthCredentials: {\n    password: f["form-edit-api"].auth_password,\n    username: f["form-edit-api"].auth_username,\n  },\n  headers_enabled: f["form-edit-api"].headers_enabled,\n  outputformatting_enabled: f["form-edit-api"].formattig_enabled,\n  outputSchema: mappingObject,\n  email_validation: {\n    enabled: f["form-edit-api"].email_validation,\n    emailKey: f["form-edit-api"].emailvalidation_keypath,\n  },\n};',
          key: 'datasource_type_config'
        },
        { value: 'if (v.dataSourceUpdatedStatus !== null) {\n  return v.dataSourceUpdatedStatus\n}\n\n// return f["form-edit-api"].status', key: 'status' },
        { value: 'return f["form-edit-api"].name', key: 'name' },
        { value: 'return f["form-edit-api"].tool_description', key: 'tool_description' }
      ],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_api',
      id: '18437524-fad3-45ce-90d9-6d2d5e6e9527',
      type: 'supabase',
      table: 'data_sources',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae'
    },
    {
      number: 71,
      method: 'send-password-reset',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'reset_password',
      redirectTo: 'return "https://dashboard.sleak.chat/redirect/?url=password-update/"',
      id: '1d2afc4c-93aa-41a6-b49a-b61b51dc0801',
      type: 'supabase',
      email: 'return f["form-password-reset"].email'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 23,
      data: [
        { value: 'return f["fom-basis-prompt"].basis_prompt', key: 'system_message' },
        { value: 'return i["input-identiteit-prompt"]', key: 'system_message_identity' }
      ],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_chatbot_prompt',
      id: '2341ce1b-64f5-4ded-9952-3487bca24247',
      type: 'supabase',
      folderId: '579e40ce-81ee-4ae2-9f2e-6d1ff9e9e84f',
      table: 'chatbots'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 35,
      method: 'update',
      data: [
        { value: 'return f["form-settings-algemeen"].chatbot_name', key: 'name' },
        { value: 'return f["form-settings-algemeen"].organization_name', key: 'organization_name' },
        {
          value:
            "const rawUrl = f[\"form-settings-algemeen\"].website_url;\n\nconst formattedUrl = rawUrl.replace('https://', '');\n\nf[\"form-settings-algemeen\"].website_url = formattedUrl;\n\nreturn 'https://' + formattedUrl",
          key: 'website_url'
        },
        { value: 'return f["form-settings-algemeen"].language', key: 'language' },
        { value: 'return f["form-settings-algemeen"].first_message', key: 'first_message' },
        { value: 'return f["form-settings-algemeen"].cs_email', key: 'cs_email' }
      ],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_chatbot_settings_algemeen',
      id: '2432144e-fed0-4ad8-8649-a6631c46b1fb',
      type: 'supabase',
      folderId: '3ffad400-fc90-4dd0-bf87-f4e01bd8e9da',
      table: 'chatbots'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 38,
      data: [
        {
          value:
            'if (i["settigs-avatar-input"]["0"]) {\n  if (i["settigs-avatar-input"] == \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\') {\n    return \'https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png\'\n  } else {\n    return r.upsert_avatar_file.data.publicUrl\n  }\n} else {\n  return r.upsert_avatar_file.data.publicUrl\n}',
          key: 'avatar_url'
        }
      ],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_avatar_file',
      id: '29fa247a-9d03-4453-b85a-4c894e73d52d',
      type: 'supabase',
      table: 'chatbots',
      folderId: '0b4805ef-4501-41ec-85aa-8202e40e914a'
    },
    {
      number: 33,
      headers: [
        {
          value:
            '// jwt token\nconst pageUrl = window.location.href;\nlet localStorageKey;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  localStorageKey = "sb-sygpwnluwwetrkmwilea-auth-token";\n} else {\n  localStorageKey = "sb-xvqjuiyrmzkhsfosfozs-auth-token";\n}\n\nconst jwtTokenString = localStorage.getItem(localStorageKey);\nconst jwtToken = JSON.parse(jwtTokenString); // Parse the string into an object\nconst accessToken = jwtToken.access_token;\n\nreturn `Bearer ${accessToken}`;\n\n// const pageUrl = window.location.href;\n// let supaAnon;\n// \n// if (pageUrl.includes("dashboard.sleak.chat")) {\n//   supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n// } else {\n//   supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqZ2F6cGtpdnpmcGdsd2hkc2RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTMwODE1NTYsImV4cCI6MjAyODY1NzU1Nn0.K8ZIKw6_PHjOk17Z2F4SWvrvQ9qjwolTFiPIZMFV6Gw";\n// }\n// \n// return `Bearer ${supaAnon}`\n\n\n\n',
          key: 'Authorization'
        },
        {
          value:
            'const pageUrl = window.location.href;\nlet supaAnon;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n} else {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2cWp1aXlybXpraHNmb3Nmb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTkzMDgyNDQsImV4cCI6MjAzNDg4NDI0NH0.l4EDmKGcSXAolPPAfjL4X1X9T6cxIO0bg9s6oAbu_3E";\n}\n\nreturn `${supaAnon}`\n',
          key: 'apikey'
        },
        { value: "const currentIndex = v.allchats.length;\nconst endOfRange = currentIndex + 20;\n\nreturn currentIndex + '-' + endOfRange\n", key: 'range' }
      ],
      endpoint: "return '/chats?select=*,messages!inner(*),chatbots(id,name,avatar_url)&order=updated_at.desc&messages.order=created_at.asc'",
      method: 'get',
      appId: '49ab8303-bcff-4e34-a9f1-97bda48106fe',
      query: [
        { value: 'const idsArray = v.inboxFilterChatbots;\nconst formattedIds = `in.(${idsArray.join(",")})`;\nreturn formattedIds', key: 'chatbot_id' },
        {
          value:
            'if (v.inboxFilterStatus == "all") {\n  return \'in.(true,false)\'\n} else if (v.inboxFilterStatus == "livechat") {\n  return \'eq.true\'\n} else if (v.inboxFilterStatus == "escalated") {\n  return \'eq.false\'\n}',
          key: 'livechat'
        },
        {
          value:
            'if (v.inboxFilterStatus == "all") {\n  return \'in.(true,false)\'\n} else if (v.inboxFilterStatus == "livechat") {\n  return \'eq.false\'\n} else if (v.inboxFilterStatus == "escalated") {\n  return \'eq.true\'\n}',
          key: 'agent_requested'
        },
        { value: "return 'in.(widget,preview,fullwidth)'", key: 'placement' },
        { value: "if (v.inboxFilterLabel == \"archived\") {\n  return 'eq.true'\n} else {\n  return 'eq.false'\n}", key: 'archived' }
      ],
      name: 'get_chats_pagination',
      id: '2b0b056c-0433-40b4-b023-013a58dd4123',
      type: 'rest',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d'
    },
    {
      recordId: 'return v.active_kb_topic',
      number: 56,
      method: 'delete',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'delete_kb_topic',
      id: '2f7c690e-4d9e-4ce5-a0b9-b5b66f77d0f0',
      type: 'supabase',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      table: 'kb_topics'
    },
    {
      recordId: 'return v.delete_chatbots_datasources_join',
      number: 74,
      method: 'delete',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'delete_chatbots_datasources_join',
      id: '321b1c0e-e74f-4984-bc8a-06ac035473fe',
      type: 'supabase',
      table: 'chatbots_datasources_join',
      folderId: '9bd4f98a-2919-4312-b5e7-d34099241fca'
    },
    {
      id: '33986fde-4b5d-4ff4-aa6f-c977c786dbb5',
      number: 52,
      name: 'update_url',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'data_sources',
      recordId: 'return v.active_datasource',
      data: [
        { key: 'status', value: 'if (v.dataSourceUpdatedStatus !== null) {\n  return v.dataSourceUpdatedStatus\n}\n\n// return f["form-edit-api"].status' },
        {
          key: 'datasource_type_config',
          value:
            'var dataSource = r.get_datasources.data.find((item) => item.id === v.active_datasource,);\n\nreturn {\n  recurring: i["toggle-recurringscrape"],\n  website_url: dataSource.datasource_type_config.website_url,\n};\n'
        },
        { key: 'recurring', value: 'return i["toggle-recurringscrape"]' }
      ]
    },
    {
      recordId: 'return v.active_datasource',
      number: 50,
      method: 'update',
      data: [
        { value: 'if (v.dataSourceUpdatedStatus !== null) {\n  return v.dataSourceUpdatedStatus\n}\n\n// return f["form-edit-api"].status', key: 'status' },
        { value: 'return f["form-edit-csv"].tool_description', key: 'tool_description' }
      ],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_csv',
      id: '36ace6a4-33a5-4cd3-bebf-04ab9cbe9636',
      type: 'supabase',
      table: 'data_sources',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 40,
      data: [
        { value: '// KAN STRAKS WEG\nif (f["form-settings-humanhandff"].handoff_type == "default") {\n  return true\n} else {\n  return false\n}', key: 'chat_routing_enabled' },
        {
          value:
            'function formatEndpoint(url) {\n  const formattedUrl = url.replace("https://", "");\n  return "https://" + formattedUrl;\n}\n\nlet handoffEndpoint;\nif (f["form-settings-humanhandff"]["handoff_endpoint"]) {\n  handoffEndpoint = formatEndpoint(f["form-settings-humanhandff"]["handoff_endpoint"]);\n} else {\n  handoffEndpoint = null\n}\n\nreturn {\n  type: f["form-settings-humanhandff"].handoff_type,\n  endpoint: handoffEndpoint,\n  triggers: [f["form-settings-humanhandff"].handoff_trigger],\n  prompt: f["form-settings-humanhandff"].handoff_prompt,\n  fallback_before: f["form-settings-humanhandff"].handoff_fallback_before,\n  fallback_after: f["form-settings-humanhandff"].handoff_fallback_after,\n};',
          key: 'human_handoff'
        }
      ],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_chatbot_settings_humanhandoff',
      id: '372875e4-b533-436f-ad8d-7e4dd5bf0a4f',
      type: 'supabase',
      folderId: '3ffad400-fc90-4dd0-bf87-f4e01bd8e9da',
      table: 'chatbots'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 41,
      data: [
        { value: 'return {\n    prompt: f["form-settings-beveiliging"].moderation_prompt,\n    fallback_message: f["form-settings-beveiliging"].moderation_fallback\n}', key: 'input_moderation' }
      ],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_chatbot_settings_beveiliging',
      id: '392c5e72-c99b-4a39-965f-d40c74befce7',
      type: 'supabase',
      folderId: '3ffad400-fc90-4dd0-bf87-f4e01bd8e9da',
      table: 'chatbots'
    },
    {
      filter: [{ op: 'eq', column: 'datasource_id', value: 'return v.active_datasource' }],
      number: 75,
      method: 'get-list',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_chatbots_datasources_joins',
      id: '39f16a7c-0760-409e-950f-4540b89939ad',
      filterType: 'and',
      type: 'supabase',
      table: 'chatbots_datasources_join',
      folderId: '9bd4f98a-2919-4312-b5e7-d34099241fca'
    },
    {
      headers: [
        {
          value:
            '// jwt token\nconst pageUrl = window.location.href;\nlet localStorageKey;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  localStorageKey = "sb-sygpwnluwwetrkmwilea-auth-token";\n} else {\n  localStorageKey = "sb-xvqjuiyrmzkhsfosfozs-auth-token";\n}\n\nconst jwtTokenString = localStorage.getItem(localStorageKey);\nconst jwtToken = JSON.parse(jwtTokenString); // Parse the string into an object\nconst accessToken = jwtToken.access_token;\n\nreturn `Bearer ${accessToken}`;',
          key: 'Authorization'
        },
        {
          value:
            'const pageUrl = window.location.href;\nlet supaAnon;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n} else {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2cWp1aXlybXpraHNmb3Nmb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTkzMDgyNDQsImV4cCI6MjAzNDg4NDI0NH0.l4EDmKGcSXAolPPAfjL4X1X9T6cxIO0bg9s6oAbu_3E";\n}\n\nreturn `${supaAnon}`',
          key: 'apikey'
        },
        { value: 'return "application/json"', key: 'Content-Type' },
        { value: 'return "return=minimal"', key: 'Prefer' }
      ],
      number: 78,
      endpoint: "// return '/data_sources?select=id'\nreturn '/data_sources'",
      method: 'post',
      appId: '49ab8303-bcff-4e34-a9f1-97bda48106fe',
      name: 'create_api_rest',
      id: '45063099-f2c4-4de0-a9a0-575602c2241c',
      type: 'rest',
      body: [{ value: '// return {\n//   chatbot_id: v.active_chatbot\n// }\nreturn v.active_chatbot', key: 'chatbot_id' }]
    },
    {
      recordId: 'return v.active_datasource',
      number: 48,
      method: 'delete',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'delete_datasource',
      id: '482f378c-f3f4-4801-9958-0be7b0ccc582',
      type: 'supabase',
      table: 'data_sources',
      folderId: '579e40ce-81ee-4ae2-9f2e-6d1ff9e9e84f'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 65,
      method: 'update',
      data: [{ value: 'if (i["settigs-background-input"] == null) {\n  return null\n} else {\n  return r.upsert_background_file.data.publicUrl\n}', key: 'background_image' }],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_background_file',
      id: '4d999dbd-a786-4f0b-ae22-0b6e7fed3ab2',
      type: 'supabase',
      table: 'chatbots',
      folderId: '0b4805ef-4501-41ec-85aa-8202e40e914a'
    },
    {
      number: 77,
      endpoint: 'return "/webhook/get-meter-summary"',
      method: 'get',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      query: [{ value: 'return r.get_user_data.data[0].organizations[0].subscriptions.find((sub) => sub.subscription_type == "meter").subscription_id', key: 'subscription_id' }],
      name: 'get_meter_summary',
      id: '5286ab4c-210e-42ec-aa6b-ee701a15a2a3',
      type: 'rest',
      folderId: '194e3442-b0d9-4eec-a253-a63b41d014e6'
    },
    {
      method: 'upload',
      upsert: true,
      type: 'supabase',
      folderId: '0b4805ef-4501-41ec-85aa-8202e40e914a',
      bucket: 'users',
      path: 'const userId = r.get_user.data.user.id;\nreturn userId + \'/\' + i["agent-avatar-input"][0]["0"].name',
      number: 69,
      file: '// return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\nreturn i["agent-avatar-input"][0]["0"]',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'upsert_agent_avatar_file',
      id: '67004617-a125-48dd-a979-d5bb3f34a69e'
    },
    {
      recordId: 'return v.active_datasource',
      number: 49,
      method: 'update',
      data: [{ value: 'if (v.dataSourceUpdatedStatus !== null) {\n  return v.dataSourceUpdatedStatus\n}\n\n// return f["form-edit-api"].status', key: 'status' }],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_kb',
      id: '67786e30-c445-4298-9694-a8f8846040bd',
      type: 'supabase',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      table: 'data_sources'
    },
    {
      realtime: true,
      method: 'get-list',
      count: 'exact',
      type: 'supabase',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      filter: [{ op: 'eq', column: 'visitor_id', value: 'return v.active_chat' }],
      number: 8,
      sortColumn: 'created_at',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      sortOrder: 'ascending',
      name: 'get_messages',
      id: '6c74dd3a-497c-43d4-b14f-fc14a70649f5',
      filterType: 'and',
      table: 'messages'
    },
    {
      number: 55,
      data: [
        { value: 'return r.create_organization.data.id', key: 'organization_id' },
        { value: 'return r.get_user_data.data[0].id', key: 'user_id' },
        { value: 'return r.get_user_data.data[0].email', key: 'email' },
        { value: 'return r.create_organization.data.company_name', key: 'organization_name' }
      ],
      method: 'create',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'create_organization_member',
      id: '6e08fdca-af10-4e03-91a2-4ffb40036966',
      type: 'supabase',
      folderId: '9bd4f98a-2919-4312-b5e7-d34099241fca',
      table: 'members'
    },
    {
      id: '6ea99ee9-992d-42ff-8444-b82e200858f0',
      number: 68,
      name: 'upsert_csv',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      type: 'rest',
      method: 'post',
      endpoint: "return '/webhook/upsert-csv';\n",
      credentials: 'same-origin',
      body: [
        { key: 'files', value: '// return f["form-create-datasource-csv"]["csv-upload"]["0"]\nreturn i["csv-upload"]["0"]' },
        { key: 'metadata', value: 'return {\n  "document_name": r.create_csv.data.name,\n  "chatbot_id": v.active_chatbot,\n  "datasource_id": r.create_csv.data.id,\n  "data_type": "csv"\n}' },
        { key: 'datasource_id', value: 'return r.create_csv.data.id' },
        { key: 'chatbot_id', value: 'return  v.active_chatbot' },
        { key: 'document_name', value: 'return r.create_csv.data.name' },
        { key: 'organization_id', value: 'return r.get_user_data.data[0].organizations[0].id' }
      ]
    },
    {
      headers: [
        {
          prefix: 'Bearer',
          value:
            '// jwt token\nconst pageUrl = window.location.href;\nlet localStorageKey;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  localStorageKey = "sb-sygpwnluwwetrkmwilea-auth-token";\n} else {\n  localStorageKey = "sb-xvqjuiyrmzkhsfosfozs-auth-token";\n}\n\nconst jwtTokenString = localStorage.getItem(localStorageKey);\nconst jwtToken = JSON.parse(jwtTokenString); // Parse the string into an object\nconst accessToken = jwtToken.access_token;\n\nreturn `Bearer ${accessToken}`;',
          key: 'Authorization'
        },
        {
          value:
            'const pageUrl = window.location.href;\nlet supaAnon;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n} else {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2cWp1aXlybXpraHNmb3Nmb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTkzMDgyNDQsImV4cCI6MjAzNDg4NDI0NH0.l4EDmKGcSXAolPPAfjL4X1X9T6cxIO0bg9s6oAbu_3E";\n}\n\nreturn `${supaAnon}`',
          key: 'apikey'
        }
      ],
      method: 'get',
      credentials: 'same-origin',
      query: [{ value: 'return `eq.` + r.get_user.data.user.id', key: 'id' }],
      type: 'rest',
      folderId: '879ed82b-481f-43dd-96c5-cd5646fb65ae',
      number: 53,
      endpoint:
        "if (n.path == '/' || n.path.includes('/kennis/databronnen')) {\n  return '/users?select=*,organizations!members(*,subscriptions!stripe_cus_id(*))&organizations.order=created_at.asc'\n} else {\n  return '/users?select=*,organizations!members(*)&organizations.order=created_at.asc'\n}",
      appId: '49ab8303-bcff-4e34-a9f1-97bda48106fe',
      name: 'get_user_data',
      id: '76ea538c-0c75-4819-8bc2-0115402aa40f'
    },
    {
      metadata: [
        { value: 'const firstName =  f["form-auth"].firstname;\nconst lastName = f["form-auth"].lastname;\n\nreturn firstName + ` ` + lastName', key: 'display_name' },
        { value: 'return i["input-signup-companyname"]', key: 'company' },
        { value: 'return f["form-auth-signup"].phone', key: 'phone' },
        { value: 'return f["form-auth-signup"].firstname', key: 'first_name' },
        { value: 'return f["form-auth-signup"].lastname', key: 'last_name' },
        {
          value:
            "function getCookieValue(name) {\n    var nameEQ = name + \"=\";\n    var ca = document.cookie.split(';');\n    for(var i = 0; i < ca.length; i++) {\n        var c = ca[i].trim(); // Trim leading spaces\n        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);\n    }\n    return null;\n}\n\nvar slkLandingPageUrl = getCookieValue('slk_landing_page_url');\nreturn slkLandingPageUrl;\n",
          key: 'session_source'
        }
      ],
      method: 'sign-up',
      type: 'supabase',
      folderId: '879ed82b-481f-43dd-96c5-cd5646fb65ae',
      mode: 'email',
      number: 1,
      password: 'return f["form-auth-signup"].password\n\n',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'create_user',
      id: '7e33da97-52fa-4536-b037-9ea1ac76a478',
      email: 'return f["form-auth-signup"].email;\n',
      emailRedirectTo: 'return "https://dashboard.sleak.chat/login"'
    },
    {
      id: '7njCCUYsysvQ0DjOtis6',
      number: 94,
      name: 'get_chatevents',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'get-list',
      table: 'chat_events',
      filterType: 'and',
      filter: [
        { column: 'organization_id', op: 'eq', value: 'return r.get_user_data.data[0].organizations[0].id' },
        { column: 'chat_id', op: 'eq', value: 'return v.active_chat' }
      ]
    },
    {
      recordId: 'return v.active_chat',
      number: 58,
      data: [{ value: 'return false', key: 'has_unread' }],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_chat_hasunread',
      id: '81580e6b-3d16-4d65-8fc7-50fdfe5fa903',
      type: 'supabase',
      table: 'chats',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d'
    },
    {
      id: '82226b3c-8d16-44b1-a3a1-4e93611378c0',
      number: 19,
      name: 'update_chat_livechat',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'chats',
      recordId: 'return v.active_chat',
      data: [
        { key: 'livechat', value: 'if (v.livechatstatus == true) {\n  return "TRUE"\n} else if (v.livechatstatus == false) {\n  return "FALSE"\n}' },
        {
          key: 'active_agent',
          value:
            'if (v.livechatstatus == true) {\n  return {\n    id: v.active_agent.id,\n    name: v.active_agent.name,\n    avatar: v.active_agent.avatar\n  };\n} else if (v.livechatstatus == false) {\n  return null\n}'
        },
        { key: 'agent_requested', value: 'return "FALSE"' }
      ]
    },
    {
      number: 3,
      method: 'sign-out',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'signout_user',
      id: '828aa4d6-8919-45cb-8964-f0cd7f2b48a2',
      type: 'supabase',
      folderId: '879ed82b-481f-43dd-96c5-cd5646fb65ae'
    },
    {
      mode: 'email',
      number: 2,
      password: 'return f["form-auth"].password',
      method: 'sign-in-password',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'auth_user',
      id: '8403ef0c-56ca-46b6-acb6-99ad469be5de',
      type: 'supabase',
      email: 'return f["form-auth"].email',
      folderId: '879ed82b-481f-43dd-96c5-cd5646fb65ae'
    },
    {
      id: '8578e3e8-9133-4087-bdcd-c038e305fcb9',
      number: 34,
      name: 'get_chats_analytics',
      folderId: 'dce9343b-4a31-4362-bbcf-8109144441a7',
      appId: '49ab8303-bcff-4e34-a9f1-97bda48106fe',
      type: 'rest',
      method: 'get',
      endpoint:
        'const chatbotIds = r.get_chatbots.data.map((chatbot) => chatbot.id);\nconst formattedIds = chatbotIds.join(",");\n\nconst currentDateTime = new Date(); // Gets the current date and time\ncurrentDateTime.setDate(currentDateTime.getDate() - 29); // last 30 days\nconst formattedDateTime = currentDateTime.toISOString().split("T")[0]; // Converts to a string in the local format\n\nif (n.path.includes(\'/chatbot\') && !n.path.includes(\'/chatbot/preview\')) {\n  return  "/chats?chatbot_id=eq." + v.active_chatbot + "&select=created_at,livechat,agent_requested,handoff_activated&order=created_at.desc&created_at=gte." + formattedDateTime;\n} else if (n.path == (\'/\')) {\n  return  "/chats?chatbot_id=in.(" + formattedIds + ")&select=created_at,livechat,agent_requested,handoff_activated&order=created_at.desc&created_at=gte." + formattedDateTime + "&placement=in.(widget,preview,fullwidth)";\n}',
      credentials: 'same-origin',
      headers: [
        { key: 'Prefer', value: "return 'count=exact'" },
        {
          key: 'Authorization',
          prefix: 'Bearer',
          value:
            '// jwt token\nconst pageUrl = window.location.href;\nlet localStorageKey;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  localStorageKey = "sb-sygpwnluwwetrkmwilea-auth-token";\n} else {\n  localStorageKey = "sb-xvqjuiyrmzkhsfosfozs-auth-token";\n}\n\nconst jwtTokenString = localStorage.getItem(localStorageKey);\nconst jwtToken = JSON.parse(jwtTokenString); // Parse the string into an object\nconst accessToken = jwtToken.access_token;\n\nreturn `Bearer ${accessToken}`;\n\n// const pageUrl = window.location.href;\n// let supaAnon;\n// \n// if (pageUrl.includes("dashboard.sleak.chat")) {\n//   supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n// } else {\n//   supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqZ2F6cGtpdnpmcGdsd2hkc2RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTMwODE1NTYsImV4cCI6MjAyODY1NzU1Nn0.K8ZIKw6_PHjOk17Z2F4SWvrvQ9qjwolTFiPIZMFV6Gw";\n// }\n// \n// return `Bearer ${supaAnon}`\n\n\n\n'
        },
        {
          key: 'apikey',
          value:
            'const pageUrl = window.location.href;\nlet supaAnon;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n} else {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2cWp1aXlybXpraHNmb3Nmb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTkzMDgyNDQsImV4cCI6MjAzNDg4NDI0NH0.l4EDmKGcSXAolPPAfjL4X1X9T6cxIO0bg9s6oAbu_3E";\n}\n\nreturn `${supaAnon}`\n'
        },
        { key: 'Content-Type', value: "return 'Authorization'" }
      ]
    },
    {
      number: 25,
      data: [
        { value: 'return v.active_chatbot', key: 'chatbot_id' },
        { value: 'return v.active_datasource', key: 'datasource_id' },
        { value: 'return f["form-create-topic"].name', key: 'name' },
        { value: 'return f["form-create-topic"].content', key: 'content' },
        { value: 'return r.get_user_data.data[0].organizations[0].id', key: 'organization_id' }
      ],
      method: 'create',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'create_kb_topic',
      id: '86c07921-dadf-4787-99ed-7f7ad261183c',
      type: 'supabase',
      table: 'kb_topics',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 24,
      method: 'get',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_chatbot',
      id: '8cc144e4-b421-46f5-a9e7-ee3f00940a07',
      type: 'supabase',
      folderId: '579e40ce-81ee-4ae2-9f2e-6d1ff9e9e84f',
      table: 'chatbots'
    },
    {
      recordId: 'return v.active_chat',
      number: 59,
      method: 'delete',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'delete_chat',
      id: '91c3fd2f-0ea3-4a36-9884-5cb69e0bc812',
      type: 'supabase',
      table: 'chats',
      folderId: '579e40ce-81ee-4ae2-9f2e-6d1ff9e9e84f'
    },
    {
      select: [{ column: '*,data_sources!chatbots_datasources_join(id,name,data_type,status,chatbot_id)' }],
      method: 'get-list',
      type: 'supabase',
      folderId: '579e40ce-81ee-4ae2-9f2e-6d1ff9e9e84f',
      filter: [
        { op: 'eq', column: 'organization_id', value: 'return r.get_user_data.data[0].organizations[0].id' },
        { op: 'eq', column: 'created_by', value: 'return r.get_user.data.user.id' }
      ],
      number: 6,
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_chatbots',
      id: '9425c8a3-851f-4aea-994c-af3b88ad7fe8',
      filterType: 'or',
      table: 'chatbots'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 45,
      method: 'update',
      data: [
        {
          value:
            'return {\n    enabled: f["form-integrations-gtm"].gtm_enabled,\n    sleakChatInitiated: f["form-integrations-gtm"].toggle_chatInitiated,\n    sleakSentContactDetails: f["form-integrations-gtm"].toggle_sentContactDetails,\n    sleakHumanHandoffActivated: f["form-integrations-gtm"].toggle_humanHandoffActivated\n}',
          key: 'gtm_events'
        }
      ],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_chatbot_integrations_gtm',
      id: '96a6fbbd-3c0f-41c2-a192-9e8a05c8b6d6',
      type: 'supabase',
      table: 'chatbots',
      folderId: '65f02e16-efcd-429d-973e-87423edb8916'
    },
    {
      id: '9CPIEOKqBJplQkS1OFq2',
      number: 106,
      name: 'validate_xml',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      type: 'rest',
      method: 'post',
      endpoint: "return '/webhook/validate_xml'",
      credentials: 'same-origin',
      query: [
        { key: 'feed_url', value: 'return \'https://\' + f["form-create-datasource-xml"].website_url' },
        { key: 'splitting_tag', value: 'return f["form-create-datasource-xml"].splitting_tag' },
        { key: 'product_id', value: 'return f["form-create-datasource-xml"].unique_id' }
      ]
    },
    {
      id: '9d139b25-dc47-41e5-8bfd-f09ec49d71da',
      number: 46,
      name: 'get_datasources',
      folderId: 'a6dae514-2ae2-434c-a7d3-0ac47c3ade46',
      appId: '49ab8303-bcff-4e34-a9f1-97bda48106fe',
      type: 'rest',
      method: 'get',
      endpoint:
        "return '/data_sources?select=results,recurring,file_upload_status,created_at,document_modified_at,last_updated,tool_description,id,status,datasource_type_config,name,data_type,chatbot_id,organization_id,kb_topics(*),chatbots!chatbots_datasources_join(id,name,avatar_url,website_url)&order=created_at.desc&kb_topics.order=created_at.desc'",
      credentials: 'same-origin',
      query: [{ key: 'chatbot_id', value: 'return `eq.` + v.active_chatbot' }],
      headers: [
        {
          key: 'Authorization',
          prefix: 'Bearer',
          value:
            '// let accessToken;\n// window.Wized = window.Wized || [];\n// window.Wized.push(async (Wized) => {\n//   const { client } = await Wized.requests.getClient(\'supabase\');\n//   console.log(client);\n//   accessToken = client.changedAccessToken;\n//   console.log(accessToken)\n// });\n\n// jwt token\nconst pageUrl = window.location.href;\nlet localStorageKey;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  localStorageKey = "sb-sygpwnluwwetrkmwilea-auth-token";\n} else {\n  localStorageKey = "sb-xvqjuiyrmzkhsfosfozs-auth-token";\n}\n\nconst jwtTokenString = localStorage.getItem(localStorageKey);\nconst jwtToken = JSON.parse(jwtTokenString); // Parse the string into an object\nconst accessToken = jwtToken.access_token;\n\nreturn `Bearer ${accessToken}`;\n\n// const pageUrl = window.location.href;\n// let supaAnon;\n// \n// if (pageUrl.includes("dashboard.sleak.chat")) {\n//   supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n// } else {\n//   supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqZ2F6cGtpdnpmcGdsd2hkc2RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTMwODE1NTYsImV4cCI6MjAyODY1NzU1Nn0.K8ZIKw6_PHjOk17Z2F4SWvrvQ9qjwolTFiPIZMFV6Gw";\n// }\n// \n// return `Bearer ${supaAnon}`'
        },
        {
          key: 'apikey',
          value:
            '// // auth jwt token\n// \n// const pageUrl = window.location.href;\n// \n// let localStorageKey;\n// \n// if (pageUrl.includes("dashboard.sleak.chat")) {\n//   localStorageKey = "sb-sygpwnluwwetrkmwilea-auth-token";\n// } else {\n//   localStorageKey = "sb-gjgazpkivzfpglwhdsdr-auth-token";\n// }\n// \n// // get from local storage\n// const jwtTokenString = localStorage.getItem(localStorageKey);\n// const jwtToken = JSON.parse(jwtTokenString); // Parse the string into an object\n// const accessToken = jwtToken.access_token;\n// console.log(accessToken);\n// \n// return `${accessToken}`;\n\n\n\n\nconst pageUrl = window.location.href;\nlet supaAnon;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n} else {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2cWp1aXlybXpraHNmb3Nmb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTkzMDgyNDQsImV4cCI6MjAzNDg4NDI0NH0.l4EDmKGcSXAolPPAfjL4X1X9T6cxIO0bg9s6oAbu_3E";\n}\n\nreturn `${supaAnon}`'
        }
      ]
    },
    {
      number: 16,
      data: [
        { value: "return 'api'", key: 'data_type' },
        { value: 'return f["form-create-datasource-api"]["databron-naam-2"]\n', key: 'name' },
        { value: 'return v.active_chatbot', key: 'chatbot_id' },
        { value: 'return r.get_user_data.data[0].organizations[0].id', key: 'organization_id' },
        {
          value:
            'return {\n  "body": "",\n  "method": "get",\n  "headers": {},\n  "bodyType": "none",\n  "protocol": "none",\n  "properties": [],\n  "endpointUrl": "",\n  "outputSchema": "\\"{}\\"",\n  "basicAuthCredentials": {\n    "password": "",\n    "username": ""\n  },\n  "headers_enabled": false,\n  "outputformatting_enabled": false,\n  "email_validation": {"enabled": false, "emailKey": ""}\n\n}',
          key: 'datasource_type_config'
        },
        {
          value:
            'return "Gebruik deze tool als een gebruiker informatie opvraagt over een bestelling, maar ALLEEN als de gebruiker dit expliciet benoemt.\\n\\n BELANGRIJK: Raadpleeg deze tool als er een ordernummer EN een e-mailadres zijn doorgegeven door de gebruiker.  Als een klant slechts Ã©Ã©n van de 2 doorgeeft, vraag je eerst aan de gebruiker om de ontbrekende gegevens door te geven (order id en e-mailadres). "',
          key: 'tool_description'
        }
      ],
      method: 'create',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'create_api',
      id: '9e0a39f0-3232-453b-ab3a-50d7f1041fa1',
      type: 'supabase',
      table: 'data_sources',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae'
    },
    {
      id: 'CPuUy8Lj5wz3FIq8mHZv',
      number: 99,
      name: 'submit_xml_productfeed',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      type: 'rest',
      method: 'post',
      endpoint: "return '/webhook/submit-sitemap-productfeed';",
      credentials: 'same-origin',
      body: [
        { key: 'datasource_id', value: 'return r.create_xml.data.id' },
        { key: 'chatbot_id', value: 'return v.active_chatbot' },
        { key: 'document_name', value: 'return r.create_xml.data.name' },
        { key: 'organization_id', value: 'return r.get_user_data.data[0].organizations[0].id' },
        { key: 'splitting_tag', value: 'return f["form-create-datasource-xml"].splitting_tag' },
        { key: 'feed_url', value: 'return \'https://\' + f["form-create-datasource-xml"].website_url' },
        { key: 'product_id', value: 'return f["form-create-datasource-xml"].unique_id' }
      ]
    },
    {
      id: 'Cu7q7j8FQiDVEP39CHV5',
      number: 97,
      name: 'upsert_image_inbox',
      folderId: '0b4805ef-4501-41ec-85aa-8202e40e914a',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'upload',
      bucket: 'organizations',
      path: "const visitorId = v.active_chat;\nconst organizationId = r.get_user_data.data[0].organizations[0].id;\nconst sanitizedFileName = i['send-file-upload']['0'].name.replace(/[^a-z0-9_\\-\\.]/gi, '_');\n\nconst previewFileName = `${sanitizedFileName.split('.').slice(0, -1).join('.')}-preview.${sanitizedFileName.split('.').pop()}`;\nconst previewFilePath = `${organizationId}/${visitorId}/${previewFileName}`;\n\nreturn previewFilePath;\n",
      file: 'return v.compressedImageInbox',
      upsert: true
    },
    {
      id: 'FHxeltvpj1PvuNNdqOdV',
      number: 105,
      name: 'get_datasources_organization',
      folderId: 'a6dae514-2ae2-434c-a7d3-0ac47c3ade46',
      appId: '49ab8303-bcff-4e34-a9f1-97bda48106fe',
      type: 'rest',
      method: 'get',
      endpoint:
        "return '/data_sources?select=results,recurring,file_upload_status,created_at,document_modified_at,last_updated,tool_description,id,status,datasource_type_config,name,data_type,chatbot_id,organization_id,kb_topics(*)&order=created_at.desc&kb_topics.order=created_at.desc'",
      credentials: 'same-origin',
      query: [{ key: 'organization_id', value: 'const organizationId = r.get_user_data.data[0].organizations[0].id;\nreturn `eq.${organizationId}`' }],
      headers: [
        {
          key: 'Authorization',
          prefix: 'Bearer',
          value:
            '// jwt token\nconst pageUrl = window.location.href;\nlet localStorageKey;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  localStorageKey = "sb-sygpwnluwwetrkmwilea-auth-token";\n} else {\n  localStorageKey = "sb-xvqjuiyrmzkhsfosfozs-auth-token";\n}\n\nconst jwtTokenString = localStorage.getItem(localStorageKey);\nconst jwtToken = JSON.parse(jwtTokenString); // Parse the string into an object\nconst accessToken = jwtToken.access_token;\n\nreturn `Bearer ${accessToken}`;'
        },
        {
          key: 'apikey',
          value:
            'const pageUrl = window.location.href;\nlet supaAnon;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n} else {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2cWp1aXlybXpraHNmb3Nmb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTkzMDgyNDQsImV4cCI6MjAzNDg4NDI0NH0.l4EDmKGcSXAolPPAfjL4X1X9T6cxIO0bg9s6oAbu_3E";\n}\n\nreturn `${supaAnon}`'
        }
      ]
    },
    {
      realtime: true,
      method: 'get-list',
      type: 'supabase',
      folderId: 'CqZ7ecJx8VbThbBpVrsG',
      filter: [{ op: 'eq', column: 'datasource_id', value: 'return v.active_datasource' }],
      number: 84,
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_scrape_pages',
      id: 'JNxSp34O1XC6PQ2G3Hx1',
      filterType: 'and',
      table: 'scrape_pages'
    },
    {
      number: 81,
      endpoint: 'return "/webhook/upsert_urls"',
      method: 'post',
      credentials: 'same-origin',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      name: 'upsert_urls',
      id: 'Lez67QJyqEStShjUiY8j',
      type: 'rest',
      body: [
        {
          value: 'return {\n  organization_id: r.get_user_data.data[0].organizations[0].id,\n  chatbot_id: v.active_chatbot,\n  datasource_id: v.active_datasource,\n  urls: v.crawledpages\n}',
          key: 'data'
        }
      ],
      folderId: 'CqZ7ecJx8VbThbBpVrsG'
    },
    {
      number: 86,
      endpoint: 'return "/webhook/upsert_urls"',
      method: 'post',
      credentials: 'same-origin',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      name: 'rescrape_urls',
      id: 'Tp1WL2c6o4DSZH61vhAm',
      type: 'rest',
      body: [
        {
          value:
            "const selectedRows = [];\nconst checkboxes = document.querySelectorAll('input[w-el=\"scrape-list-checkbox\"]:checked');\n\ncheckboxes.forEach(checkbox => {\n  const rowElement = checkbox.closest('[w-el=\"scrapelist-list-item\"]');\n  if (rowElement) {\n    const id = rowElement.getAttribute('record_id');\n    const matchedItem = v.scrapetool_urls_list_filtered.find(item => item.id === id);\n    if (matchedItem) {\n      selectedRows.push({ url: matchedItem.url, id });\n    }\n  }\n});\n\nreturn {\n  organization_id: r.get_user_data.data[0].organizations[0].id,\n  chatbot_id: v.active_chatbot,\n  datasource_id: v.active_datasource,\n  urls: selectedRows\n};",
          key: 'data'
        }
      ],
      folderId: 'CqZ7ecJx8VbThbBpVrsG'
    },
    {
      id: 'UG4xQVW0qtWSayYxRPpf',
      number: 96,
      name: 'export_chats',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      type: 'rest',
      method: 'post',
      endpoint: 'return "/webhook/chats-export"',
      credentials: 'same-origin',
      query: [{ key: 'chatbot_id', value: 'return v.active_chatbot' }]
    },
    {
      id: 'UkKdMFFxllkg1pL5GWzO',
      number: 108,
      name: 'sync_xml_productfeed',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      type: 'rest',
      method: 'post',
      endpoint: "return '/webhook/submit-sitemap-productfeed';",
      credentials: 'same-origin',
      body: [
        { key: 'datasource_id', value: 'return v.active_datasource' },
        { key: 'chatbot_id', value: 'return v.active_chatbot' },
        { key: 'organization_id', value: 'return r.get_user_data.data[0].organizations[0].id' },
        { key: 'splitting_tag', value: 'return r.get_datasources.data.find((entry) => entry.id === v.active_datasource).datasource_type_config.splitting_tag' },
        { key: 'feed_url', value: 'return r.get_datasources.data.find((entry) => entry.id === v.active_datasource).datasource_type_config.feed_url' },
        { key: 'product_id', value: 'return r.get_datasources.data.find((entry) => entry.id === v.active_datasource).datasource_type_config.product_id' }
      ]
    },
    {
      id: 'V906RxYpeA1Qmnl0atvM',
      number: 92,
      name: 'get_outputlogs',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'get-list',
      table: 'output_logs',
      filterType: 'and',
      filter: [{ column: 'message_id', op: 'eq', value: 'return v.selectedMessageId' }]
    },
    {
      number: 87,
      endpoint: 'return "/webhook/get-sitemap"',
      method: 'post',
      credentials: 'same-origin',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      name: 'get_sitemap',
      id: 'VHepDvprAWpqGBIGUYcA',
      type: 'rest',
      body: [{ value: 'const websiteUrl = i["input-crawl-sitemap"];\nreturn `https://` + websiteUrl', key: 'url' }],
      folderId: 'CqZ7ecJx8VbThbBpVrsG'
    },
    {
      id: 'a1103dab-b50e-40b9-9d71-45a4e8878ede',
      number: 30,
      name: 'create_message_operatorchanged',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'create',
      table: 'messages',
      data: [
        { key: 'author_type', value: "return 'system'" },
        { key: 'message_type', value: "return 'operator_changed'" },
        { key: 'chatbot_id', value: 'return v.chats.find((chat) => chat.id === v.active_chat).chatbot_id' },
        { key: 'visitor_id', value: 'return v.active_chat' },
        {
          key: 'message_type_data',
          value:
            'if (v.livechatstatus == false) {\n  const activeChat = v.chats.find((chat) => chat.id === v.active_chat);\n  const activeAgent = activeChat.active_agent;\n\n  return {\n    event_type: "left",\n    operator_name: activeAgent.name,\n    operator_avatar_img: activeAgent.avatar,\n    id: activeAgent.id\n  };\n} else if (v.livechatstatus == true) {\n  return {\n    event_type: "joined",\n    operator_name: v.active_agent.name,\n    // operator_avatar_img: v.active_agent.avatar,\n    operator_avatar_img: v.active_agent.avatar,\n\n    id: v.active_agent.id\n  };\n}\n'
        }
      ]
    },
    {
      number: 88,
      endpoint: 'return "webhook/recurring-scrape-activation"',
      method: 'post',
      credentials: 'same-origin',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      name: 'activate_recurring_scrape_addon',
      id: 'aIalZXYgkVo1SxFrX7zR',
      type: 'rest',
      body: [{ value: 'return r.get_user_data.data[0].organizations[0].id', key: 'organization_id' }],
      folderId: '194e3442-b0d9-4eec-a253-a63b41d014e6'
    },
    {
      recordId: 'return v.active_chat',
      number: 60,
      data: [{ value: 'if (v.chats.find((item) => item.id == v.active_chat).archived == false) {\n  return true\n} else {\n  return false\n}', key: 'archived' }],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_chat_archive',
      id: 'aaa745c8-a0c4-4868-a159-22d22f9127c9',
      type: 'supabase',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      table: 'chats'
    },
    {
      filter: [
        {
          op: 'eq',
          column: 'organization_id',
          value: '// return r.get_user_data.data.organisation_id\n\n// return r.get_user_data.data_new[0].organisation_id\n\nreturn r.get_user_data.data[0].organizations[0].id'
        }
      ],
      number: 32,
      method: 'get-list',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_agents',
      id: 'ac8cdd98-98da-45f1-9556-6e3e1cd38837',
      type: 'supabase',
      filterType: 'and',
      folderId: '9bd4f98a-2919-4312-b5e7-d34099241fca',
      table: 'agents'
    },
    {
      number: 66,
      endpoint: 'return "webhook/create-checkout-session"',
      method: 'post',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      name: 'create_checkout_session',
      id: 'ad7fd706-ec0e-4f2c-972b-c7d42a014bfb',
      type: 'rest',
      body: [
        { value: 'return r.get_user_data.data[0].organizations[0].id', key: 'organization_id' },
        { value: 'return v.subscriptionPriceId', key: 'price_id' },
        { value: 'return true', key: 'allow_promotion_codes' }
      ],
      folderId: '194e3442-b0d9-4eec-a253-a63b41d014e6'
    },
    {
      number: 54,
      method: 'create',
      data: [
        { value: 'return r.get_user.data.user.user_metadata.company\n', key: 'company_name' },
        { value: 'return r.get_user.data.user.user_metadata.email', key: 'email_address' }
      ],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'create_organization',
      id: 'aebb82fc-910a-4d60-9993-368c35f715ae',
      type: 'supabase',
      table: 'organizations',
      folderId: '9bd4f98a-2919-4312-b5e7-d34099241fca'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 43,
      data: [
        { value: 'return f["form-settings-overig"].custom_css\n', key: 'custom_css' },
        { value: 'return {\n    daterange: null,\n    published: f["form-settings-overig"].toggle_publishing\n  }', key: 'publishing' }
      ],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_chatbot_settings_overig',
      id: 'aeea49d9-098f-4c0f-afa0-8da0cbbd187d',
      type: 'supabase',
      folderId: '3ffad400-fc90-4dd0-bf87-f4e01bd8e9da',
      table: 'chatbots'
    },
    {
      number: 76,
      password: 'return f["form-password-update"].password',
      method: 'update-user',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_password',
      id: 'b006c17d-5f96-44e8-a785-fc96cc1445cb',
      type: 'supabase',
      email: 'return r.get_user.data.user.user_metadata.email',
      folderId: '9bd4f98a-2919-4312-b5e7-d34099241fca'
    },
    {
      number: 12,
      method: 'create',
      data: [
        { value: "return 'pdf'", key: 'data_type' },
        { value: 'return f["form-create-datasource-pdf"]["databron-naam-2"];\n', key: 'name' },
        { value: 'return v.active_chatbot', key: 'chatbot_id' },
        { value: 'return r.get_user_data.data[0].organizations[0].id', key: 'organization_id' }
      ],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'create_pdf',
      id: 'b1f441af-34f5-47dd-a30a-e2ef64e18b2e',
      type: 'supabase',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      table: 'data_sources'
    },
    {
      id: 'b242703f-c2ad-4766-bdb6-e9b2bbe2c2b0',
      number: 14,
      name: 'create_csv',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'create',
      table: 'data_sources',
      data: [
        { key: 'data_type', value: "return 'csv'" },
        { key: 'name', value: 'return f["form-create-datasource-csv"]["databron-naam-2"]\n' },
        { key: 'chatbot_id', value: 'return v.active_chatbot' },
        { key: 'organization_id', value: 'return r.get_user_data.data[0].organizations[0].id' },
        { key: 'datasource_type_config', value: 'return {\n  name: v.csvContent.name,\n  size: v.csvContent.size,\n  time: v.csvContent.time,\n  date: v.csvContent.date\n};' },
        { key: 'tool_description', value: '// DEPRECATED\nreturn "Gebruik deze tool als een gebruiker een vraag stelt over een product over het assortiment"' },
        { key: 'file_upload_status', value: 'return "processing"' }
      ]
    },
    {
      realtime: true,
      method: 'get-list',
      count: 'exact',
      type: 'supabase',
      folderId: 'a6dae514-2ae2-434c-a7d3-0ac47c3ade46',
      filter: [{ op: 'eq', column: 'chatbot_id', value: 'return v.active_chatbot' }],
      number: 26,
      sortColumn: 'created_at',
      sortOrder: 'descending',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_kb_topics',
      id: 'b6bf2304-e7c2-4e5f-a44d-dc2f52422529',
      filterType: 'and',
      table: 'kb_topics'
    },
    {
      id: 'b754a62d-249b-48ba-aa44-9809723fefb8',
      number: 42,
      name: 'update_chatbot_settings_notificaties',
      folderId: '3ffad400-fc90-4dd0-bf87-f4e01bd8e9da',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'chatbots',
      recordId: 'return v.active_chatbot',
      data: [
        {
          key: 'notifications',
          value:
            'const eMail = f["form-settings-notificaties"].notifications_email;\n\nreturn {\n    "emails": [eMail],\n    "events": {\n        "chatInitiated": f["form-settings-notificaties"].toggle_chatInitiated,\n        "sentContactDetails": f["form-settings-notificaties"].toggle_sentContactDetails,\n        "humanHandoffActivated": f["form-settings-notificaties"].toggle_humanHandoffActivated,\n        "livechatNewMessage": f["form-settings-notificaties"].toggle_livechatNewMessage,\n        // new\n        "livechatNewMessage_user": f["form-settings-notificaties"].toggle_humanHandoffActivated_user,\n        "humanHandoffActivated_user": f["form-settings-notificaties"].toggle_livechatNewMessage_user\n        //\n    }, \n    // new\n    "custom_emails": {\n        "chatInitiated": {\n            "chatInitiated_1": f["form-settings-notificaties"].chatInitiated_1,\n            "chatInitiated_2": f["form-settings-notificaties"].chatInitiated_2\n        },\n        "sentContactDetails": {\n            "sentContactDetails_1": f["form-settings-notificaties"].sentContactDetails_1,\n            "sentContactDetails_2": f["form-settings-notificaties"].sentContactDetails_2\n        },\n        "humanHandoffActivated": {\n            "humanHandoffActivated_1": f["form-settings-notificaties"].humanHandoffActivated_1,\n            "humanHandoffActivated_2": f["form-settings-notificaties"].humanHandoffActivated_2,\n        },\n        "humanHandoffActivated_user": {\n            "humanHandoffActivated_user_1": f["form-settings-notificaties"].humanHandoffActivated_user_1,\n            "humanHandoffActivated_user_2": f["form-settings-notificaties"].humanHandoffActivated_user_2\n        },\n        "livechatNewMessage": {\n            "livechatNewMessage_1": f["form-settings-notificaties"].livechatNewMessage_1,\n            "livechatNewMessage_2": f["form-settings-notificaties"].livechatNewMessage_2\n        },\n        "livechatNewMessage_user": {\n            "livechatNewMessage_user_1": f["form-settings-notificaties"].livechatNewMessage_user_1,\n            "livechatNewMessage_user_2": f["form-settings-notificaties"].livechatNewMessage_user_2\n        }\n    //\n    }\n}\n'
        }
      ]
    },
    {
      method: 'upload',
      upsert: true,
      type: 'supabase',
      folderId: '0b4805ef-4501-41ec-85aa-8202e40e914a',
      bucket: 'users',
      path: 'const userId = r.get_user.data.user.id;\nreturn userId + \'/\' + i["settigs-background-input"]["0"].name',
      number: 64,
      file: '// return "https://uploads-ssl.webflow.com/65911e9735540c235757642f/65b53f83acecf90e74bd8844_profile_pic_default.png"\nreturn i["settigs-background-input"]["0"]',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'upsert_background_file',
      id: 'b90e0912-d43f-4620-95a8-6aceb6904847'
    },
    {
      id: 'bNCIQZghdpl01NkzvsVJ',
      number: 100,
      name: 'create_xml',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'create',
      table: 'data_sources',
      data: [
        { key: 'data_type', value: "return 'xml'" },
        { key: 'name', value: 'return f["form-create-datasource-xml"]["databron-naam-2"];' },
        { key: 'chatbot_id', value: 'return v.active_chatbot' },
        { key: 'organization_id', value: 'return r.get_user_data.data[0].organizations[0].id' },
        {
          key: 'datasource_type_config',
          value:
            'const createdAt = new Date();\nconst prettyDate = createdAt.getDate().toString().padStart(2, \'0\') + "-" + (createdAt.getMonth() + 1).toString().padStart(2, \'0\') + "-" + createdAt.getFullYear();\nconst prettyTime = createdAt.getHours().toString().padStart(2, \'0\') + ":" + createdAt.getMinutes().toString().padStart(2, \'0\');\n\nreturn {\n  feed_url: "https://" + f["form-create-datasource-xml"].website_url,\n  splitting_tag: f["form-create-datasource-xml"].splitting_tag,\n  product_id: f["form-create-datasource-xml"].unique_id,\n  name: f["form-create-datasource-xml"].website_url,\n  recurring: false\n};'
        },
        { key: 'tool_description', value: '// DEPRECATED\nreturn "Gebruik deze tool als een gebruiker een vraag stelt over een product over het assortiment"' },
        { key: 'file_upload_status', value: 'return "processing"' }
      ]
    },
    {
      recordId: 'return v.active_kb_topic',
      number: 28,
      data: [
        { value: 'return f["form-edit-topic"].name', key: 'name' },
        { value: 'return f["form-edit-topic"].content', key: 'content' }
      ],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_kb_topic',
      id: 'bc4aac85-c42e-4c61-aabd-a7befa81b8d0',
      type: 'supabase',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      table: 'kb_topics'
    },
    {
      number: 15,
      method: 'create',
      data: [
        { value: "return 'url'", key: 'data_type' },
        { value: 'return f["form-create-datasource-url"]["databron-naam-2"]\n', key: 'name' },
        { value: 'return v.active_chatbot', key: 'chatbot_id' },
        { value: 'return r.get_user_data.data[0].organizations[0].id', key: 'organization_id' },
        {
          value:
            'let datasourceUrl\n\nif (i["input-crawl-websiteurl"]) {\n  datasourceUrl = i["input-crawl-websiteurl"]\n} else if (i["input-crawl-sitemap"]) {\n  datasourceUrl = i["input-crawl-sitemap"]\n}\n\n\nreturn {\n  "website_url": datasourceUrl,\n  "recurring": false\n}',
          key: 'datasource_type_config'
        }
      ],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'create_url',
      id: 'cd5842e3-8ff8-4699-893e-48f7b3770568',
      type: 'supabase',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      table: 'data_sources'
    },
    {
      recordId: 'return v.active_agent.id',
      number: 70,
      data: [
        { value: 'if (i["agent-avatar-input"][0] == null) {\n  return null\n} else {\n  return r.upsert_agent_avatar_file.data.publicUrl\n}', key: 'avatar' },
        { value: 'return i["agents-list-item-name-input"][0]', key: 'name' }
      ],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_agent_avatar_file',
      id: 'cea62ce9-8f13-4753-92f2-94f46bc497f0',
      type: 'supabase',
      folderId: '0b4805ef-4501-41ec-85aa-8202e40e914a',
      table: 'agents'
    },
    {
      number: 4,
      method: 'get-user',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_user',
      id: 'd2b868e4-84da-4910-a98d-781589052b49',
      type: 'supabase',
      folderId: '879ed82b-481f-43dd-96c5-cd5646fb65ae'
    },
    {
      recordId: 'return v.active_chat',
      number: 22,
      method: 'get',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_chat',
      id: 'd8458829-c1a3-467b-92af-79c35ab69b00',
      type: 'supabase',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      table: 'chats'
    },
    {
      recordId: 'return v.active_kb_topic',
      number: 27,
      method: 'get',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'get_kb_topic',
      id: 'da99d7fa-62ad-4478-83a8-05d74e47801f',
      type: 'supabase',
      table: 'kb_topics',
      folderId: 'a6dae514-2ae2-434c-a7d3-0ac47c3ade46'
    },
    {
      number: 72,
      data: [
        { value: 'return v.datasource_sharing_selected', key: 'chatbot_id' },
        { value: 'return v.active_datasource', key: 'datasource_id' }
      ],
      method: 'create',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'create_chatbots_datasources_join',
      id: 'ee3dcbe6-8839-4acb-a539-59a3eeab726c',
      type: 'supabase',
      folderId: '9bd4f98a-2919-4312-b5e7-d34099241fca',
      table: 'chatbots_datasources_join'
    },
    {
      number: 67,
      endpoint: 'return "webhook/create-portal-session"',
      method: 'post',
      credentials: 'same-origin',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      name: 'create_portal_session',
      id: 'f17bfcd0-9a6f-482d-b7f9-ea4e263098b8',
      type: 'rest',
      body: [{ value: 'return r.get_user_data.data[0].organizations[0].id', key: 'organization_id' }],
      folderId: '194e3442-b0d9-4eec-a253-a63b41d014e6'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 47,
      method: 'delete',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'delete_chatbot',
      id: 'f3490006-c2a8-41bb-bd89-2800546adb99',
      type: 'supabase',
      folderId: '579e40ce-81ee-4ae2-9f2e-6d1ff9e9e84f',
      table: 'chatbots'
    },
    {
      recordId: 'return v.active_chatbot',
      number: 44,
      data: [
        {
          value:
            'function formatEndpoint(url) {\n    const formattedUrl = url.replace("https://", "");\n    return "https://" + formattedUrl\n}\n\nconst chatInitiatedEndpoint = formatEndpoint(f["form-integrations-webhooks"].chatInitiated_endpoint);\nconst sentContactDetailsEndpoint = formatEndpoint(f["form-integrations-webhooks"].sentContactDetails_endpoint);\nconst humanHandoffActivatedEndpoint = formatEndpoint(f["form-integrations-webhooks"].humanHandoffActivated_endpoint);\nconst livechatNewMessageEndpoint = formatEndpoint(f["form-integrations-webhooks"].livechatNewMessage_endpoint);\n\nreturn {\n  chatInitiated: {\n    enabled: f["form-integrations-webhooks"].webhooks_toggle_chatInitiated,\n    endpoint_url: chatInitiatedEndpoint,\n  },\n  sentContactDetails: {\n    enabled: f["form-integrations-webhooks"].webhooks_toggle_sentContactDetails,\n    endpoint_url: sentContactDetailsEndpoint,\n  },\n  humanHandoffActivated: {\n    enabled: f["form-integrations-webhooks"].webhooks_toggle_humanHandoffActivated,\n    endpoint_url: humanHandoffActivatedEndpoint,\n  },\n  livechatNewMessage: {\n    enabled: f["form-integrations-webhooks"].webhooks_toggle_livechatNewMessage,\n    endpoint_url: livechatNewMessageEndpoint,\n  },\n};',
          key: 'webhooks'
        }
      ],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_chatbot_integrations_webhooks',
      id: 'f94c1b4b-1663-4e0b-9987-e2694332fc53',
      type: 'supabase',
      folderId: '65f02e16-efcd-429d-973e-87423edb8916',
      table: 'chatbots'
    },
    {
      recordId: 'return r.get_user.data.user.id',
      number: 61,
      data: [{ value: 'if (i["checkbox-inbox-notifications"] == true) {\n  return true\n} else {\n  return false\n}', key: 'inbox_notifications_enabled' }],
      method: 'update',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'update_user_notifications',
      id: 'fd099da8-1abb-43dc-ba72-678fb0d9694d',
      type: 'supabase',
      table: 'users',
      folderId: '9bd4f98a-2919-4312-b5e7-d34099241fca'
    },
    {
      headers: [
        {
          prefix: 'Bearer',
          value:
            '// jwt token\nconst pageUrl = window.location.href;\nlet localStorageKey;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  localStorageKey = "sb-sygpwnluwwetrkmwilea-auth-token";\n} else {\n  localStorageKey = "sb-xvqjuiyrmzkhsfosfozs-auth-token";\n}\n\nconst jwtTokenString = localStorage.getItem(localStorageKey);\nconst jwtToken = JSON.parse(jwtTokenString); // Parse the string into an object\nconst accessToken = jwtToken.access_token;\n\nreturn `Bearer ${accessToken}`;\n\n// const pageUrl = window.location.href;\n// let supaAnon;\n// \n// if (pageUrl.includes("dashboard.sleak.chat")) {\n//   supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n// } else {\n//   supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdqZ2F6cGtpdnpmcGdsd2hkc2RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTMwODE1NTYsImV4cCI6MjAyODY1NzU1Nn0.K8ZIKw6_PHjOk17Z2F4SWvrvQ9qjwolTFiPIZMFV6Gw";\n// }\n// \n// return `Bearer ${supaAnon}`\n\n\n\n',
          key: 'Authorization'
        },
        {
          value:
            'const pageUrl = window.location.href;\nlet supaAnon;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n} else {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2cWp1aXlybXpraHNmb3Nmb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTkzMDgyNDQsImV4cCI6MjAzNDg4NDI0NH0.l4EDmKGcSXAolPPAfjL4X1X9T6cxIO0bg9s6oAbu_3E";\n}\n\nreturn `${supaAnon}`\n',
          key: 'apikey'
        },
        { value: 'return "0-30"', key: 'range' }
      ],
      method: 'get',
      credentials: 'same-origin',
      query: [
        { value: 'const idsArray = v.inboxFilterChatbots;\nconst formattedIds = `in.(${idsArray.join(",")})`;\nreturn formattedIds', key: 'chatbot_id' },
        {
          value:
            'if (v.inboxFilterStatus == "all") {\n  return \'in.(true,false)\'\n} else if (v.inboxFilterStatus == "livechat") {\n  return \'eq.true\'\n} else if (v.inboxFilterStatus == "escalated") {\n  return \'eq.false\'\n}',
          key: 'livechat'
        },
        {
          value:
            'if (v.inboxFilterStatus == "all") {\n  return \'in.(true,false)\'\n} else if (v.inboxFilterStatus == "livechat") {\n  return \'eq.false\'\n} else if (v.inboxFilterStatus == "escalated") {\n  return \'eq.true\'\n}',
          key: 'agent_requested'
        },
        { value: "if (v.inboxFilterLabel == \"archived\") {\n  return 'eq.true'\n} else {\n  return 'eq.false'\n}", key: 'archived' }
      ],
      type: 'rest',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      number: 31,
      endpoint: "return '/chats?select=*,messages!inner(*),chatbots(id,name,avatar_url)&order=updated_at.desc&messages.order=created_at.asc&placement=in.(widget,preview,fullwidth)'",
      appId: '49ab8303-bcff-4e34-a9f1-97bda48106fe',
      name: 'get_chats',
      id: 'fefe687b-b6dd-4efc-af07-f5b4c1810457'
    },
    {
      number: 18,
      method: 'create',
      data: [
        { value: 'return "default_agent"', key: 'message_type' },
        { value: 'return "agent"', key: 'author_type' },
        { value: 'return i["admin-ui-chat-input"]', key: 'body' },
        { value: 'return v.active_chat', key: 'visitor_id' },
        { value: 'return v.chats.find((chat) => chat.id === v.active_chat).chatbot_id', key: 'chatbot_id' },
        { value: 'return v.active_agent.id', key: 'agent_id' }
      ],
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      name: 'post_message',
      id: 'ff801139-7e06-4a92-92f6-07f59dd0d500',
      type: 'supabase',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      table: 'messages'
    },
    {
      id: 'hLEv3iSHrJMIdlAPFnwo',
      number: 93,
      name: 'getall_scrape_pages',
      folderId: 'CqZ7ecJx8VbThbBpVrsG',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'get-list',
      table: 'scrape_pages',
      realtime: true,
      filterType: 'and',
      filter: [{ column: 'organization_id', op: 'eq', value: 'return r.get_user_data.data[0].organizations[0].id;' }]
    },
    {
      id: 'hyOmM52bTqQjuHi1pNhc',
      number: 107,
      name: 'update_chat_sidebar',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'chats',
      recordId: 'return v.active_chat',
      data: [{ key: 'name', value: 'return i["inbox-sidebar-chatname-inut"];\n' }]
    },
    {
      id: 'lbmRW4RBB65Q0DqdZG6t',
      number: 101,
      name: 'update_xml',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'data_sources',
      recordId: 'return v.active_datasource',
      data: [
        { key: 'status', value: 'if (v.dataSourceUpdatedStatus !== null) {\n  return v.dataSourceUpdatedStatus\n}' },
        { key: 'recurring', value: 'return i["toggle-recurringxml"];\n' }
      ]
    },
    {
      id: 'mNlWnvHiecqT81jowkpU',
      number: 95,
      name: 'update_chat_updatetags',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'chats',
      recordId: 'return v.active_chat',
      data: [{ key: 'tags', value: 'return v.newChatTags' }]
    },
    {
      id: 'oLlbRjYCiYX6k2srVa87',
      number: 102,
      name: 'update_chatbot_settings_inbox',
      folderId: '3ffad400-fc90-4dd0-bf87-f4e01bd8e9da',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'chatbots',
      recordId: 'return v.active_chatbot',
      data: [
        {
          key: 'tags',
          value:
            "const tagsArray = [];\n\ndocument.querySelectorAll('[w-el=tagging-list-item]').forEach(item => {\n  const tag = item.getAttribute('tagging-list-item-tag');\n  const description = item.querySelector('[w-el=\"tagging-list-item-description\"]').value;\n  tagsArray.push({\n    tag,\n    description\n  });\n});\n\nreturn tagsArray"
        },
        { key: 'tagging_enabled', value: 'return i.ai_tagging_enabled;' },
        { key: 'fileuploads_user', value: 'return i.toggle_useruploading' }
      ]
    },
    {
      id: 'p3y3riIewARK9DQhi6dU',
      number: 89,
      name: 'upsert_pdf2',
      appId: '45d758d8-1856-489b-9512-2c39b200a1b9',
      type: 'rest',
      method: 'post',
      endpoint: "// return '/embedding/pdf'\nreturn '/webhook/upsert-pdf'",
      credentials: 'same-origin',
      body: [
        { key: 'file', value: '// return f["form-create-datasource-csv"]["csv-upload"]["0"]\nreturn i["pdf2-upload"]["0"]' },
        { key: 'metadata', value: 'return {\n  "document_name": r.create_pdf2.data.name,\n  "chatbot_id": v.active_chatbot,\n  "datasource_id": r.create_pdf2.data.id,\n  "data_type": "pdf2"\n}' },
        { key: 'datasource_id', value: 'return r.create_pdf2.data.id' },
        { key: 'chatbot_id', value: 'return  v.active_chatbot' },
        { key: 'document_name', value: 'return r.create_pdf2.data.name' },
        { key: 'organization_id', value: 'return r.get_user_data.data[0].organizations[0].id' }
      ]
    },
    {
      id: 'sYeNTwlamPdOFKv7JgOk',
      number: 104,
      name: 'upsert_image_inbox_fullsize',
      folderId: '0b4805ef-4501-41ec-85aa-8202e40e914a',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'upload',
      bucket: 'organizations',
      path: "const visitorId = v.active_chat;\nconst organizationId = r.get_user_data.data[0].organizations[0].id;\nconst sanitizedFileName = i['send-file-upload']['0'].name.replace(/[^a-z0-9_\\-\\.]/gi, '_');\n\nconst previewFileName = `${sanitizedFileName.split('.').slice(0, -1).join('.')}.${sanitizedFileName.split('.').pop()}`;\nconst previewFilePath = `${organizationId}/${visitorId}/${previewFileName}`;\n\nreturn previewFilePath;",
      file: 'return i["send-file-upload"]["0"]',
      upsert: true
    },
    {
      headers: [
        {
          prefix: 'Bearer',
          value:
            '// jwt token\nconst pageUrl = window.location.href;\nlet localStorageKey;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  localStorageKey = "sb-sygpwnluwwetrkmwilea-auth-token";\n} else {\n  localStorageKey = "sb-xvqjuiyrmzkhsfosfozs-auth-token";\n}\n\nconst jwtTokenString = localStorage.getItem(localStorageKey);\nconst jwtToken = JSON.parse(jwtTokenString); // Parse the string into an object\nconst accessToken = jwtToken.access_token;\n\nreturn `Bearer ${accessToken}`;',
          key: 'Authorization'
        },
        {
          value:
            'const pageUrl = window.location.href;\nlet supaAnon;\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN5Z3B3bmx1d3dldHJrbXdpbGVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDUzMDIxNTQsImV4cCI6MjAyMDg3ODE1NH0.n2RSjgeqR-41wSO_IFuzPJKcc9bo1DbkXiPEsc1jO00";\n} else {\n  supaAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh2cWp1aXlybXpraHNmb3Nmb3pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTkzMDgyNDQsImV4cCI6MjAzNDg4NDI0NH0.l4EDmKGcSXAolPPAfjL4X1X9T6cxIO0bg9s6oAbu_3E";\n}\n\nreturn `${supaAnon}`',
          key: 'apikey'
        }
      ],
      method: 'post',
      credentials: 'same-origin',
      type: 'rest',
      body: [
        {
          value:
            "function getCheckedRecordUUIDs() {\n  const checkedCheckboxes = document.querySelectorAll('input[w-el=\"scrape-list-checkbox\"]:checked');\n\n  // map checked checkboxes to parent div 'record_id' attribute\n  const checkedUUIDs = Array.from(checkedCheckboxes).map(checkbox => {\n    const recordDiv = checkbox.closest('div[record_id]');\n    return recordDiv ? recordDiv.getAttribute('record_id') : null;\n  });\n\n  return checkedUUIDs;\n}\n\nconst uuidsToDelete = getCheckedRecordUUIDs();\nreturn uuidsToDelete;\n",
          key: 'ids'
        },
        { value: 'return r.get_user_data.data[0].organizations[0].id', key: 'organization_id' }
      ],
      folderId: 'CqZ7ecJx8VbThbBpVrsG',
      number: 85,
      endpoint:
        'const pageUrl = window.location.href;\nlet endpoint\n\nif (pageUrl.includes("dashboard.sleak.chat")) {\n  endpoint = "https://sygpwnluwwetrkmwilea.supabase.co/rest/v1/rpc/delete_scrape_pages";\n} else {\n  endpoint = "https://xvqjuiyrmzkhsfosfozs.supabase.co/rest/v1/rpc/delete_scrape_pages";\n}\n\nreturn endpoint',
      appId: '49ab8303-bcff-4e34-a9f1-97bda48106fe',
      name: 'delete_scrape_rpcfunction',
      id: 'wGfwMTZ260Db9amwYOHj'
    },
    {
      id: 'xNoMjXiDQOgQtxJJ0KlD',
      number: 103,
      name: 'update_chatbot_integrations_customfields',
      folderId: '65f02e16-efcd-429d-973e-87423edb8916',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'chatbots',
      recordId: 'return v.active_chatbot',
      data: [
        {
          key: 'custom_fields_config',
          value:
            'const customfieldsArray = [];\n\n// update variable before deleting to prevent losing manually added data\ndocument.querySelectorAll("[w-el=custom-fields-lit-item]").forEach((item, index) => {\n  const key = i["custom-fields-list-item-input"][index];\n  const updateChatName = i.toggle_customfields_override_checkbox[index];\n  const updateEmail = i.toggle_customfields_override_emal[index];\n  console.log(`updatechatname ${index} = `, updateChatName);\n  console.log(`updateemailname ${index} = `, updateEmail);\n  console.log(`fieldname ${index} = `, key);\n  customfieldsArray.push({\n    key,\n    updateChatName,\n    updateEmail\n  });\n});\n\nv.chatbotCustomFields = customfieldsArray;\n\nreturn v.chatbotCustomFields;\n'
        }
      ]
    },
    {
      headers: [{ prefix: 'Bearer', value: 'return "fc-b0423aa93db6496eb2c157edd34ca483"', key: 'Authorization' }],
      method: 'post',
      credentials: 'same-origin',
      type: 'rest',
      body: [
        { value: 'const websiteUrl = i["input-crawl-websiteurl"];\nreturn `https://` + websiteUrl', key: 'url' },
        { value: 'return false', key: 'ignoreSitemap' },
        { value: 'return false', key: 'includeSubdomains' },
        { value: 'return 1000', key: 'limit' }
      ],
      folderId: 'CqZ7ecJx8VbThbBpVrsG',
      number: 80,
      endpoint: 'return "/map"',
      appId: 'pxgD9BuECTQMg1mdbHak',
      name: 'firecrawl_map',
      id: 'xSr95XwPJqWgVNFcIqGe'
    },
    {
      id: 'xrAUhab4amhhVUpupHNG',
      number: 91,
      name: 'update_pdf2',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'update',
      table: 'data_sources',
      recordId: 'return v.active_datasource',
      data: [{ key: 'status', value: 'if (v.dataSourceUpdatedStatus !== null) {\n  return v.dataSourceUpdatedStatus\n}' }]
    },
    {
      id: 'xyZu5VTET1KRfBp91qe3',
      number: 90,
      name: 'create_pdf2',
      folderId: '64988cf5-3857-4f68-927b-a07d29e6d8ae',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'create',
      table: 'data_sources',
      data: [
        { key: 'data_type', value: "return 'pdf2'" },
        { key: 'name', value: 'return f["form-create-datasource-pdf2"]["naam"]\n' },
        { key: 'chatbot_id', value: 'return v.active_chatbot' },
        { key: 'organization_id', value: 'return r.get_user_data.data[0].organizations[0].id' },
        {
          key: 'datasource_type_config',
          value:
            'function sizeInMBorKB(sizeBytes) {\n  const sizeMB = (sizeBytes / (1024 * 1024)).toFixed(2);\n  if (sizeBytes < 1024 * 1024) {\n    const sizeKB = (sizeBytes / 1024).toFixed(2);\n    return `${sizeKB} KB`;\n  }\n  return `${sizeMB} MB`;\n}\n\nconst createdAt = new Date();\nconst prettyDate = createdAt.getDate().toString().padStart(2, \'0\') + "-" + (createdAt.getMonth() + 1).toString().padStart(2, \'0\') + "-" + createdAt.getFullYear();\nconst prettyTime = createdAt.getHours().toString().padStart(2, \'0\') + ":" + createdAt.getMinutes().toString().padStart(2, \'0\');\n\nconst fileSize = i["pdf2-upload"]["0"].size;\nconst readableSize = sizeInMBorKB(fileSize);\n\nreturn {\n  name: i["pdf2-upload"]["0"].name,\n  size: readableSize,\n  time: prettyTime,\n  date: prettyDate\n};'
        },
        { key: 'file_upload_status', value: 'return "processing"' }
      ]
    },
    {
      id: 'zo86Dm4eN7Cx4FCt5k0g',
      number: 98,
      name: 'post_message_fileupload',
      folderId: 'e4636b01-7b40-4857-bb00-58134146644d',
      appId: '9be75686-8606-497b-b048-0258fd61ab4b',
      type: 'supabase',
      method: 'create',
      table: 'messages',
      data: [
        { key: 'message_type', value: "if (i[\"send-file-upload\"][\"0\"].type.includes('image')) {\n  return 'image'\n} else {\n  return 'file'\n}" },
        { key: 'author_type', value: 'return "agent"' },
        { key: 'visitor_id', value: 'return v.active_chat' },
        { key: 'chatbot_id', value: 'return v.chats.find((chat) => chat.id === v.active_chat).chatbot_id' },
        { key: 'agent_id', value: 'return v.active_agent.id' },
        { key: 'file_path', value: 'return r.upsert_image_inbox_fullsize.data.publicUrl' },
        {
          key: 'message_type_data',
          value: 'return {\n  "file_name": i["send-file-upload"]["0"].name,\n  "file_size": i["send-file-upload"]["0"].size,\n  "file_type": i["send-file-upload"]["0"].type\n}'
        },
        { key: 'organization_id', value: 'return r.get_user.data[0].' }
      ]
    }
  ]
});
